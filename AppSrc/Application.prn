Compiling Program: C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\Application.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 19.1\Pkg\dfallent.pkd)
67438>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJStandardCommandBarSystem.pkg)
67438>>>// these are all the packages used in a standard MDI menubar/toolbar system
67438>>>
67438>>>Use cCJCommandBarSystem.pkg
67438>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJStandardMenuItemClasses.pkg)
67438>>>>>Use Dfpanel.pkg
67438>>>>>Use cCJCommandBarSystem.pkg
67438>>>>>Use LanguageText.pkg
67438>>>>>
67438>>>>>
67438>>>>>Class cCJUndoMenuItem is a cCJMenuItem
67439>>>>>    
67439>>>>>    Procedure Construct_Object
67441>>>>>        Forward Send Construct_Object
67443>>>>>        Set psCaption   to C_$CaptionUndo
67444>>>>>        Set psToolTip to C_$ToolTipUndo
67445>>>>>        Set psDescription to C_$DescUndo
67446>>>>>        Set psImage to "ActionUndo.ico"
67447>>>>>        Set pbActiveUpdate to True
67448>>>>>        Set psCategory to C_$CategoryEdit
67449>>>>>        Set psShortcut to C_$Key_Ctrl_Z
67450>>>>>    End_Procedure
67451>>>>>    
67451>>>>>    Procedure OnExecute Variant vCommandBarControl
67453>>>>>        Send Undo of (focus(Self))
67454>>>>>    End_Procedure
67455>>>>>    
67455>>>>>    Function IsEnabled Returns Boolean
67457>>>>>        Boolean bEnabled
67457>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
67458>>>>>        Function_Return bEnabled
67459>>>>>    End_Function
67460>>>>>    
67460>>>>>End_Class
67461>>>>>
67461>>>>>
67461>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
67462>>>>>    
67462>>>>>    Procedure Construct_Object
67464>>>>>        Forward Send Construct_Object
67466>>>>>        Set psCaption   to C_$CaptionDelete
67467>>>>>        Set psToolTip to C_$ToolTipDelete
67468>>>>>        Set psDescription to C_$DescDelete
67469>>>>>        Set psImage to "actionDelete.ico"
67470>>>>>        Set psShortcut to C_$Key_Delete
67471>>>>>        Set pbActiveUpdate to True
67472>>>>>        Set psCategory to C_$CategoryEdit
67473>>>>>    End_Procedure
67474>>>>>    
67474>>>>>    
67474>>>>>    Procedure OnExecute Variant vCommandBarControl
67476>>>>>        Send Delete of (focus(Self))
67477>>>>>    End_Procedure
67478>>>>>    
67478>>>>>    Function IsEnabled Returns Boolean
67480>>>>>        Boolean bEnabled
67480>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
67481>>>>>        Function_Return bEnabled
67482>>>>>    End_Function
67483>>>>>    
67483>>>>>End_Class
67484>>>>>
67484>>>>>
67484>>>>>Class cCJCutMenuItem is a cCJMenuItem
67485>>>>>    
67485>>>>>    Procedure Construct_Object
67487>>>>>        Forward Send Construct_Object
67489>>>>>        Set psCaption   to C_$CaptionCut
67490>>>>>        Set psToolTip to C_$TooltipCut
67491>>>>>        Set psDescription to C_$DescCut
67492>>>>>        Set psImage to "actionCut.ico"
67493>>>>>        Set psShortcut to C_$Key_Ctrl_X
67494>>>>>        Set pbActiveUpdate to True
67495>>>>>        Set psCategory to C_$CategoryEdit
67496>>>>>    End_Procedure
67497>>>>>    
67497>>>>>    
67497>>>>>    Procedure OnExecute Variant vCommandBarControl
67499>>>>>        Send Cut of (focus(Self))
67500>>>>>    End_Procedure
67501>>>>>    
67501>>>>>    Function IsEnabled Returns Boolean
67503>>>>>        Boolean bEnabled
67503>>>>>        Get CanCut of (Focus(Self)) to bEnabled
67504>>>>>        Function_Return bEnabled
67505>>>>>    End_Function
67506>>>>>    
67506>>>>>End_Class
67507>>>>>
67507>>>>>
67507>>>>>Class cCJCopyMenuItem is a cCJMenuItem
67508>>>>>    
67508>>>>>    Procedure Construct_Object
67510>>>>>        Forward Send Construct_Object
67512>>>>>        Set psCaption   to C_$CaptionCopy
67513>>>>>        Set psToolTip to C_$ToolTipCopy
67514>>>>>        Set psDescription to C_$DescCopy
67515>>>>>        Set psImage to "actionCopy.ico"
67516>>>>>        Set psShortcut to C_$Key_Ctrl_C
67517>>>>>        Set pbActiveUpdate to True
67518>>>>>        Set psCategory to C_$CategoryEdit
67519>>>>>    End_Procedure
67520>>>>>    
67520>>>>>    
67520>>>>>    Procedure OnExecute Variant vCommandBarControl
67522>>>>>        Send Copy of (focus(Self))
67523>>>>>    End_Procedure
67524>>>>>    
67524>>>>>    Function IsEnabled Returns Boolean
67526>>>>>        Boolean bEnabled
67526>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
67527>>>>>        Function_Return bEnabled
67528>>>>>    End_Function
67529>>>>>    
67529>>>>>End_Class
67530>>>>>
67530>>>>>
67530>>>>>Class cCJPasteMenuItem is a cCJMenuItem
67531>>>>>    
67531>>>>>    Procedure Construct_Object
67533>>>>>        Forward Send Construct_Object
67535>>>>>        Set psCaption   to C_$CaptionPaste
67536>>>>>        Set psToolTip to C_$ToolTipPaste
67537>>>>>        Set psDescription to C_$DescPaste
67538>>>>>        Set psImage to "actionPaste.ico"
67539>>>>>        Set pbActiveUpdate to True
67540>>>>>        Set psShortcut to C_$Key_Ctrl_V
67541>>>>>        Set psCategory to C_$CategoryEdit
67542>>>>>    End_Procedure
67543>>>>>    
67543>>>>>    
67543>>>>>    Procedure OnExecute Variant vCommandBarControl
67545>>>>>        Send Paste of (focus(Self))
67546>>>>>    End_Procedure
67547>>>>>    
67547>>>>>    Function IsEnabled Returns Boolean
67549>>>>>        Boolean bEnabled
67549>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
67550>>>>>        Function_Return bEnabled
67551>>>>>    End_Function
67552>>>>>    
67552>>>>>End_Class
67553>>>>>
67553>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
67554>>>>>    
67554>>>>>    Procedure Construct_Object
67556>>>>>        Forward Send Construct_Object
67558>>>>>        Set psCaption   to C_$CaptionSelectAll
67559>>>>>        Set psToolTip to C_$ToolTipSelectAll
67560>>>>>        Set psDescription to C_$DescSelectAll
67561>>>>>        Set pbActiveUpdate to True
67562>>>>>        Set psShortcut to C_$Key_Ctrl_A
67563>>>>>        Set psCategory to C_$CategoryEdit
67564>>>>>    End_Procedure
67565>>>>>    
67565>>>>>    
67565>>>>>    Procedure OnExecute Variant vCommandBarControl
67567>>>>>        Send Select_All of (focus(Self))
67568>>>>>    End_Procedure
67569>>>>>    
67569>>>>>    Function IsEnabled Returns Boolean
67571>>>>>        Boolean bEnabled
67571>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
67572>>>>>        Function_Return bEnabled
67573>>>>>    End_Function
67574>>>>>    
67574>>>>>End_Class
67575>>>>>
67575>>>>>
67575>>>>>Class cCJExitMenuItem is a cCJMenuItem
67576>>>>>    
67576>>>>>    Procedure Construct_Object
67578>>>>>        Forward Send Construct_Object
67580>>>>>        Set psCaption to C_$CaptionExit
67581>>>>>        Set psToolTip to C_$ToolTipExit
67582>>>>>        Set psDescription to C_$ToolTipExit
67583>>>>>        Set psShortcut to C_$Key_Alt_F4
67584>>>>>        Set psCategory to C_$CategoryFile
67585>>>>>    End_Procedure
67586>>>>>    
67586>>>>>    Procedure OnExecute Variant vCommandBarControl
67588>>>>>        Send Exit_Application of Desktop
67589>>>>>    End_Procedure
67590>>>>>    
67590>>>>>End_Class
67591>>>>>
67591>>>>>Class cCJHelpMenuItem is a cCJMenuItem
67592>>>>>    
67592>>>>>    Procedure Construct_Object
67594>>>>>        Forward Send Construct_Object
67596>>>>>        Set psCaption to C_$CaptionHelp
67597>>>>>        Set psDescription to C_$ToolTipHelp
67598>>>>>        Set psToolTip to C_$DescHelp
67599>>>>>        Set psImage to "ActionHelp.ico"
67600>>>>>        Set psShortcut to "F1"
67601>>>>>        Set psCategory to C_$CategoryHelp
67602>>>>>    End_Procedure
67603>>>>>    
67603>>>>>    Procedure OnExecute Variant vCommandBarControl
67605>>>>>        Send Help of (Focus(Self))
67606>>>>>    End_Procedure
67607>>>>>    
67607>>>>>End_Class
67608>>>>>
67608>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
67609>>>>>    
67609>>>>>    Procedure Construct_Object
67611>>>>>        Forward Send Construct_Object
67613>>>>>        Set psCaption to C_$CaptionAddStatusbar
67614>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
67615>>>>>        Set psDescription to  C_$DescAddStatusbar
67616>>>>>        Set psCategory to C_$CategoryWindow
67617>>>>>    End_Procedure
67618>>>>>    
67618>>>>>    Procedure OnExecute Variant vCommandBarControl
67620>>>>>        Handle hoCommandBars hoClientArea
67620>>>>>        Get CommandBarSystemObject to hoCommandBars
67621>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67622>>>>>        If hoClientArea Begin
67624>>>>>            // the clientarea's parent panel has message
67624>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
67625>>>>>        End
67625>>>>>>
67625>>>>>    End_Procedure
67626>>>>>    
67626>>>>>    Function IsChecked Returns Boolean
67628>>>>>        Boolean bOn
67628>>>>>        Handle hoCommandBars hoClientArea
67628>>>>>        Get CommandBarSystemObject to hoCommandBars
67629>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67630>>>>>        If hoClientArea Begin
67632>>>>>            // the clientarea's parent panel has message
67632>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
67633>>>>>        End
67633>>>>>>
67633>>>>>        Function_Return bOn
67634>>>>>    End_Function
67635>>>>>End_Class
67636>>>>>
67636>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
67637>>>>>    
67637>>>>>    Procedure Construct_Object
67639>>>>>        Forward Send Construct_Object
67641>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
67642>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
67643>>>>>        Set psDescription to C_$DescAutoArrangeIcons
67644>>>>>        Set psCategory to C_$CategoryWindow
67645>>>>>    End_Procedure
67646>>>>>    
67646>>>>>    Procedure OnExecute Variant vCommandBarControl
67648>>>>>        Handle hoCommandBars hoClientArea
67648>>>>>        Get CommandBarSystemObject to hoCommandBars
67649>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67650>>>>>        If hoClientArea Begin
67652>>>>>            // the clientarea's parent panel has message
67652>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
67653>>>>>        End
67653>>>>>>
67653>>>>>    End_Procedure
67654>>>>>    
67654>>>>>    Function IsChecked Returns Boolean
67656>>>>>        Boolean bOn
67656>>>>>        Handle hoCommandBars hoClientArea
67656>>>>>        Get CommandBarSystemObject to hoCommandBars
67657>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67658>>>>>        If hoClientArea Begin
67660>>>>>            // the clientarea's parent panel has message
67660>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
67661>>>>>        End
67661>>>>>>
67661>>>>>        Function_Return bOn
67662>>>>>    End_Function
67663>>>>>End_Class
67664>>>>>
67664>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
67665>>>>>    
67665>>>>>    Procedure Construct_Object
67667>>>>>        Forward Send Construct_Object
67669>>>>>        Set psCaption to C_$CaptionRestoreMenus
67670>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
67671>>>>>        Set psDescription to C_$DescRestoreMenus
67672>>>>>        Set psCategory to C_$CategoryWindow
67673>>>>>    End_Procedure
67674>>>>>    
67674>>>>>    Procedure OnExecute Variant vCommandBarControl
67676>>>>>        Handle hoCommandBars
67676>>>>>        Get CommandBarSystemObject to hoCommandBars
67677>>>>>        Send RestoreLayout of hoCommandBars
67678>>>>>    End_Procedure
67679>>>>>    
67679>>>>>End_Class
67680>>>>>
67680>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
67681>>>>>    
67681>>>>>    Procedure Construct_Object
67683>>>>>        Forward Send Construct_Object
67685>>>>>        Set psCaption to C_$CaptionCascade
67686>>>>>        Set psToolTip to C_$ToolTipCascade
67687>>>>>        Set psDescription to  C_$DescCascade
67688>>>>>        Set psImage to "ActionCascade.ico"
67689>>>>>        Set psCategory to C_$CategoryWindow
67690>>>>>    End_Procedure
67691>>>>>    
67691>>>>>    Procedure OnExecute Variant vCommandBarControl
67693>>>>>        Handle hoCommandBars hoClientArea
67693>>>>>        Get CommandBarSystemObject to hoCommandBars
67694>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67695>>>>>        If hoClientArea Begin
67697>>>>>            Send Cascade_Windows of hoClientArea
67698>>>>>        End
67698>>>>>>
67698>>>>>    End_Procedure
67699>>>>>End_Class
67700>>>>>
67700>>>>>Class cCJTileHorizontally is a cCJMenuItem
67701>>>>>    
67701>>>>>    Procedure Construct_Object
67703>>>>>        Forward Send Construct_Object
67705>>>>>        Set psCaption to C_$CaptionTileHorizontally
67706>>>>>        Set psToolTip to C_$ToolTipTileHorizontally
67707>>>>>        Set psDescription to  C_$DescTileHorizontally
67708>>>>>        Set psImage to "ActionTileHorizontally.ico"
67709>>>>>        Set psCategory to C_$CategoryWindow
67710>>>>>    End_Procedure
67711>>>>>    
67711>>>>>    Procedure OnExecute Variant vCommandBarControl
67713>>>>>        Handle hoCommandBars hoClientArea
67713>>>>>        Get CommandBarSystemObject to hoCommandBars
67714>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67715>>>>>        If hoClientArea Begin
67717>>>>>            Send Tile_Windows_Horizontal of hoClientArea
67718>>>>>        End
67718>>>>>>
67718>>>>>    End_Procedure
67719>>>>>End_Class
67720>>>>>
67720>>>>>Class cCJTileVertically is a cCJMenuItem
67721>>>>>    
67721>>>>>    Procedure Construct_Object
67723>>>>>        Forward Send Construct_Object
67725>>>>>        Set psCaption to C_$CaptionTileVertically
67726>>>>>        Set psToolTip to C_$ToolTipTileVertically
67727>>>>>        Set psDescription to  C_$DescTileVertically
67728>>>>>        Set psImage to "ActionTileVertically.ico"
67729>>>>>        Set psCategory to C_$CategoryWindow
67730>>>>>    End_Procedure
67731>>>>>    
67731>>>>>    Procedure OnExecute Variant vCommandBarControl
67733>>>>>        Handle hoCommandBars hoClientArea
67733>>>>>        Get CommandBarSystemObject to hoCommandBars
67734>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67735>>>>>        If hoClientArea Begin
67737>>>>>            Send Tile_Windows_Vertical of hoClientArea
67738>>>>>        End
67738>>>>>>
67738>>>>>    End_Procedure
67739>>>>>End_Class
67740>>>>>
67740>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
67741>>>>>    
67741>>>>>    Procedure Construct_Object
67743>>>>>        Forward Send Construct_Object
67745>>>>>        Set psCaption to C_$CaptionMinimizeWindows
67746>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
67747>>>>>        Set psDescription to  C_$DescMinimizeWindows
67748>>>>>        Set psCategory to C_$CategoryWindow
67749>>>>>    End_Procedure
67750>>>>>    
67750>>>>>    Procedure OnExecute Variant vCommandBarControl
67752>>>>>        Handle hoCommandBars hoClientArea
67752>>>>>        Get CommandBarSystemObject to hoCommandBars
67753>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67754>>>>>        If hoClientArea Begin
67756>>>>>            // the clientarea's parent panel has message
67756>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
67757>>>>>        End
67757>>>>>>
67757>>>>>    End_Procedure
67758>>>>>End_Class
67759>>>>>
67759>>>>>
67759>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
67760>>>>>    
67760>>>>>    Procedure Construct_Object
67762>>>>>        Forward Send Construct_Object
67764>>>>>        Set psCaption to C_$CaptionRestoreWindows
67765>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
67766>>>>>        Set psDescription to  C_$DescRestoreWindows
67767>>>>>        Set psCategory to C_$CategoryWindow
67768>>>>>    End_Procedure
67769>>>>>    
67769>>>>>    Procedure OnExecute Variant vCommandBarControl
67771>>>>>        Handle hoCommandBars hoClientArea
67771>>>>>        Get CommandBarSystemObject to hoCommandBars
67772>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67773>>>>>        If hoClientArea Begin
67775>>>>>            // the clientarea's parent panel has message
67775>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
67776>>>>>        End
67776>>>>>>
67776>>>>>    End_Procedure
67777>>>>>End_Class
67778>>>>>
67778>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
67779>>>>>    
67779>>>>>    Procedure Construct_Object
67781>>>>>        Forward Send Construct_Object
67783>>>>>        Set psCaption to C_$CaptionArrangeIcons
67784>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
67785>>>>>        Set psDescription to  C_$DescArrangeIcons
67786>>>>>        Set psCategory to C_$CategoryWindow
67787>>>>>    End_Procedure
67788>>>>>    
67788>>>>>    Procedure OnExecute Variant vCommandBarControl
67790>>>>>        Handle hoCommandBars hoClientArea
67790>>>>>        Get CommandBarSystemObject to hoCommandBars
67791>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67792>>>>>        If hoClientArea Begin
67794>>>>>            Send Arrange_Icons of hoClientArea
67795>>>>>        End
67795>>>>>>
67795>>>>>    End_Procedure
67796>>>>>    
67796>>>>>End_Class
67797>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJAboutMenuItem.pkg)
67797>>>>>Use cCJCommandBarSystem.pkg
67797>>>>>Use LanguageText.pkg
67797>>>>>
67797>>>>>// It is expected that if you use this class that you provide an about object that is
67797>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
67797>>>>>// because you may wish to create your own custom about package.
67797>>>>>
67797>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
67798>>>>>
67798>>>>>    Procedure Construct_Object
67800>>>>>        Forward Send Construct_Object
67802>>>>>        Set psCaption to C_$CaptionAbout
67803>>>>>        Set psDescription to C_$ToolTipAbout
67804>>>>>        Set psToolTip to C_$DescAbout
67805>>>>>        Set psImage to "ActionAbout.ico"
67806>>>>>        Set psCategory to C_$CategoryHelp
67807>>>>>    End_Procedure
67808>>>>>    
67808>>>>>    Procedure OnExecute Variant vCommandBarControl
67810>>>>>        Handle hoCommandBars hoClientArea
67810>>>>>        Get CommandBarSystemObject to hoCommandBars
67811>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67812>>>>>        If hoClientArea Begin
67814>>>>>            Send Activate_About of hoClientArea
67815>>>>>        End
67815>>>>>>
67815>>>>>    End_Procedure
67816>>>>>
67816>>>>>End_Class
67817>>>>>
67817>>>>>
67817>>>Use cCJDeoMenuItemClasses.pkg
67817>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJMDIWindowsMenuItem.pkg)
67817>>>>>Use cCJCommandBarSystem.pkg
67817>>>>>
67817>>>>>Register_Function Client_ID Returns Integer
67817>>>>>
67817>>>>>// only used by cCJMDIWIndowsMenuItem
67817>>>>>Class cCJMDIWindowItem is a cCJMenuItem
67818>>>>>    
67818>>>>>    Procedure Construct_Object
67820>>>>>        Forward Send Construct_Object
67822>>>>>        Property Handle phWindow 0 // object id of view
67823>>>>>        Set pbControlFlagNoMovable to True
67824>>>>>        Set pbActiveUpdate to True
67825>>>>>    End_Procedure
67826>>>>>    
67826>>>>>    Procedure OnExecute Variant vCommandBarControl
67828>>>>>        Handle hWindow
67828>>>>>        Get phWindow to hWindow
67829>>>>>        Send Activate_View of hWindow
67830>>>>>    End_Procedure
67831>>>>>    
67831>>>>>End_Class
67832>>>>>
67832>>>>>
67832>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
67833>>>>>    
67833>>>>>    Procedure Construct_Object
67835>>>>>        Forward Send Construct_Object
67837>>>>>        Property Handle[] phArrayOfWindows
67838>>>>>        Set peControlType to xtpControlPopup
67839>>>>>        Set psCategory to C_$CategoryWindow
67840>>>>>    End_Procedure
67841>>>>>    
67841>>>>>    // This adds MDI windows to the existing menu items.
67841>>>>>    // This removes any existing windows menus and always adds a new set to the end
67841>>>>>    
67841>>>>>    Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
67843>>>>>        Handle  hClientArea hView
67843>>>>>        String  sLabel
67843>>>>>        Integer i iWindows
67843>>>>>        Handle[] hArrayOfWindows
67844>>>>>        Variant vItem
67844>>>>>        
67844>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
67844>>>>>        // also assume that destroying an action removes all menu instances of that action
67844>>>>>        Get phArrayOfWindows to hArrayOfWindows
67845>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
67846>>>>>        For i from 0 to (iWindows-1)
67852>>>>>>
67852>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
67853>>>>>        Loop
67854>>>>>>
67854>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
67855>>>>>        
67855>>>>>        // Add all views to this menu. Create the action and add the item
67855>>>>>        Move 0 to i
67856>>>>>        Get Client_Id to hClientArea // object id of client area
67857>>>>>        If (hClientArea > 0) Begin
67859>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
67860>>>>>            While (hView <> 0)
67864>>>>>                If (Active_State(hView)) Begin
67866>>>>>                    // create the action
67866>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
67867>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
67868>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
67869>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
67870>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
67872>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
67873>>>>>                    End
67873>>>>>>
67873>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
67874>>>>>                    If (i=0) Begin
67876>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
67877>>>>>                    End
67877>>>>>>
67877>>>>>                    // Create a menu item for this action
67877>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
67878>>>>>                    Increment i
67879>>>>>                End
67879>>>>>>
67879>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
67880>>>>>            Loop
67881>>>>>>
67881>>>>>        End
67881>>>>>>
67881>>>>>        
67881>>>>>        Set phArrayOfWindows to hArrayOfWindows
67882>>>>>        
67882>>>>>    End_Procedure
67883>>>>>    
67883>>>>>End_Class
67884>
67884>Object oHtmlHelp is a cHtmlHelp
67886>End_Object
67887>
67887>Object oApplication is a cApplication
67889>    Set peHelpType to htHtmlHelp
67890>
67890>    Object oConnection is a cConnection
67892>        Use LoginEncryption.pkg
Including file: LoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\LoginEncryption.pkg)
67892>>>Use cLoginEncryption.pkg
Including file: cLoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cLoginEncryption.pkg)
67892>>>>>Use cCryptographer.pkg
Including file: cCryptographer.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCryptographer.pkg)
67892>>>>>>>Use VdfBase.pkg
67892>>>>>>>
67892>>>>>>>Use CryptographerConstants.pkg
Including file: CryptographerConstants.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\CryptographerConstants.pkg)
67892>>>>>>>>>//   Author  : Ulbe Stellema
67892>>>>>>>>>// Algorithm classes
67892>>>>>>>>>Define ALG_CLASS_ANY                    for |CI$00000000 // (0)
67892>>>>>>>>>Define ALG_CLASS_SIGNATURE              for |CI$00002000 // (1 << 13)
67892>>>>>>>>>Define ALG_CLASS_MSG_ENCRYPT            for |CI$00004000 // (2 << 13)
67892>>>>>>>>>Define ALG_CLASS_DATA_ENCRYPT           for |CI$00006000 // (3 << 13)
67892>>>>>>>>>Define ALG_CLASS_HASH                   for |CI$00008000 // (4 << 13)
67892>>>>>>>>>Define ALG_CLASS_KEY_EXCHANGE           for |CI$0000A000 // (5 << 13)
67892>>>>>>>>>Define ALG_CLASS_ALL                    for |CI$0000E000 // (7 << 13)
67892>>>>>>>>>
67892>>>>>>>>>// Algorithm types
67892>>>>>>>>>Define ALG_TYPE_ANY                     for |CI$00000000 // (0)
67892>>>>>>>>>Define ALG_TYPE_DSS                     for |CI$00000200 // (1 << 9)
67892>>>>>>>>>Define ALG_TYPE_RSA                     for |CI$00000400 // (2 << 9)
67892>>>>>>>>>Define ALG_TYPE_BLOCK                   for |CI$00000600 // (3 << 9)
67892>>>>>>>>>Define ALG_TYPE_STREAM                  for |CI$00000800 // (4 << 9)
67892>>>>>>>>>Define ALG_TYPE_DH                      for |CI$00000A00 // (5 << 9)
67892>>>>>>>>>Define ALG_TYPE_SECURECHANNEL           for |CI$00000C00 // (6 << 9)
67892>>>>>>>>>
67892>>>>>>>>>// Generic sub-ids
67892>>>>>>>>>Define ALG_SID_ANY                      for |CI$00000000 // (0)
67892>>>>>>>>>
67892>>>>>>>>>// RSA sub-ids
67892>>>>>>>>>Define ALG_SID_RSA_ANY                  for 0
67892>>>>>>>>>Define ALG_SID_RSA_PKCS                 for 1
67892>>>>>>>>>Define ALG_SID_RSA_MSATWORK             for 2
67892>>>>>>>>>Define ALG_SID_RSA_ENTRUST              for 3
67892>>>>>>>>>Define ALG_SID_RSA_PGP                  for 4
67892>>>>>>>>>
67892>>>>>>>>>// DSS sub-ids
67892>>>>>>>>>Define ALG_SID_DSS_ANY                  for 0
67892>>>>>>>>>Define ALG_SID_DSS_PKCS                 for 1
67892>>>>>>>>>Define ALG_SID_DSS_DMS                  for 2
67892>>>>>>>>>
67892>>>>>>>>>// DES sub_ids
67892>>>>>>>>>Define ALG_SID_DES                      for 1
67892>>>>>>>>>Define ALG_SID_3DES                     for 3
67892>>>>>>>>>Define ALG_SID_DESX                     for 4
67892>>>>>>>>>Define ALG_SID_IDEA                     for 5
67892>>>>>>>>>Define ALG_SID_CAST                     for 6
67892>>>>>>>>>Define ALG_SID_SAFERSK64                for 7
67892>>>>>>>>>Define ALG_SID_SAFERSK128               for 8
67892>>>>>>>>>Define ALG_SID_3DES_112                 for 9
67892>>>>>>>>>Define ALG_SID_CYLINK_MEK               for 12
67892>>>>>>>>>Define ALG_SID_RC5                      for 13
67892>>>>>>>>>Define ALG_SID_AES_128                  for 14
67892>>>>>>>>>Define ALG_SID_AES_192                  for 15
67892>>>>>>>>>Define ALG_SID_AES_256                  for 16
67892>>>>>>>>>Define ALG_SID_AES                      for 17
67892>>>>>>>>>
67892>>>>>>>>>// Fortezza sub-ids
67892>>>>>>>>>Define ALG_SID_SKIPJACK                 for 10
67892>>>>>>>>>Define ALG_SID_TEK                      for 11
67892>>>>>>>>>
67892>>>>>>>>>// RC2 sub-ids
67892>>>>>>>>>Define ALG_SID_RC2                      for 2
67892>>>>>>>>>
67892>>>>>>>>>// Stream cipher sub-ids
67892>>>>>>>>>Define ALG_SID_RC4                      for 1
67892>>>>>>>>>Define ALG_SID_SEAL                     for 2
67892>>>>>>>>>
67892>>>>>>>>>// Diffie-Hellman sub-ids
67892>>>>>>>>>Define ALG_SID_DH_SANDF                 for 1
67892>>>>>>>>>Define ALG_SID_DH_EPHEM                 for 2
67892>>>>>>>>>Define ALG_SID_AGREED_KEY_ANY           for 3
67892>>>>>>>>>Define ALG_SID_KEA                      for 4
67892>>>>>>>>>
67892>>>>>>>>>// Hash sub ids
67892>>>>>>>>>Define ALG_SID_MD2                      for 1
67892>>>>>>>>>Define ALG_SID_MD4                      for 2
67892>>>>>>>>>Define ALG_SID_MD5                      for 3
67892>>>>>>>>>Define ALG_SID_SHA                      for 4
67892>>>>>>>>>Define ALG_SID_SHA1                     for 4
67892>>>>>>>>>Define ALG_SID_MAC                      for 5
67892>>>>>>>>>Define ALG_SID_RIPEMD                   for 6
67892>>>>>>>>>Define ALG_SID_RIPEMD160                for 7
67892>>>>>>>>>Define ALG_SID_SSL3SHAMD5               for 8
67892>>>>>>>>>Define ALG_SID_HMAC                     for 9
67892>>>>>>>>>Define ALG_SID_TLS1PRF                  for 10
67892>>>>>>>>>Define ALG_SID_HASH_REPLACE_OWF         for 11
67892>>>>>>>>>Define ALG_SID_SHA_256                  for 12
67892>>>>>>>>>Define ALG_SID_SHA_384                  for 13
67892>>>>>>>>>Define ALG_SID_SHA_512                  for 14
67892>>>>>>>>>
67892>>>>>>>>>// secure channel sub ids
67892>>>>>>>>>Define ALG_SID_SSL3_MASTER              for 1
67892>>>>>>>>>Define ALG_SID_SCHANNEL_MASTER_HASH     for 2
67892>>>>>>>>>Define ALG_SID_SCHANNEL_MAC_KEY         for 3
67892>>>>>>>>>Define ALG_SID_PCT1_MASTER              for 4
67892>>>>>>>>>Define ALG_SID_SSL2_MASTER              for 5
67892>>>>>>>>>Define ALG_SID_TLS1_MASTER              for 6
67892>>>>>>>>>Define ALG_SID_SCHANNEL_ENC_KEY         for 7
67892>>>>>>>>>
67892>>>>>>>>>// algorithm identifier definitions
67892>>>>>>>>>Define CALG_MD2                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD2)
67892>>>>>>>>>Define CALG_MD4                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD4)
67892>>>>>>>>>Define CALG_MD5                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD5)
67892>>>>>>>>>Define CALG_SHA                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA)
67892>>>>>>>>>Define CALG_SHA1                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA1)
67892>>>>>>>>>Define CALG_MAC                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MAC)
67892>>>>>>>>>Define CALG_RSA_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
67892>>>>>>>>>Define CALG_DSS_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_DSS ior ALG_SID_DSS_ANY)
67892>>>>>>>>>Define CALG_NO_SIGN                     for (ALG_CLASS_SIGNATURE ior ALG_TYPE_ANY ior ALG_SID_ANY)
67892>>>>>>>>>Define CALG_RSA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
67892>>>>>>>>>Define CALG_DES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DES)
67892>>>>>>>>>Define CALG_3DES_112                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES_112)
67892>>>>>>>>>Define CALG_3DES                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES)
67892>>>>>>>>>Define CALG_DESX                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DESX)
67892>>>>>>>>>Define CALG_RC2                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC2)
67892>>>>>>>>>Define CALG_RC4                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_RC4)
67892>>>>>>>>>Define CALG_SEAL                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_SEAL)
67892>>>>>>>>>Define CALG_DH_SF                       for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_SANDF)
67892>>>>>>>>>Define CALG_DH_EPHEM                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_EPHEM)
67892>>>>>>>>>Define CALG_AGREEDKEY_ANY               for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_AGREED_KEY_ANY)
67892>>>>>>>>>Define CALG_KEA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_KEA)
67892>>>>>>>>>Define CALG_HUGHES_MD5                  for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_ANY ior ALG_SID_MD5)
67892>>>>>>>>>Define CALG_SKIPJACK                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_SKIPJACK)
67892>>>>>>>>>Define CALG_TEK                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_TEK)
67892>>>>>>>>>Define CALG_CYLINK_MEK                  for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_CYLINK_MEK)
67892>>>>>>>>>Define CALG_SSL3_SHAMD5                 for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SSL3SHAMD5)
67892>>>>>>>>>Define CALG_SSL3_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL3_MASTER)
67892>>>>>>>>>Define CALG_SCHANNEL_MASTER_HASH        for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MASTER_HASH)
67892>>>>>>>>>Define CALG_SCHANNEL_MAC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MAC_KEY)
67892>>>>>>>>>Define CALG_SCHANNEL_ENC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_ENC_KEY)
67892>>>>>>>>>Define CALG_PCT1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_PCT1_MASTER)
67892>>>>>>>>>Define CALG_SSL2_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL2_MASTER)
67892>>>>>>>>>Define CALG_TLS1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_TLS1_MASTER)
67892>>>>>>>>>Define CALG_RC5                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC5)
67892>>>>>>>>>Define CALG_HMAC                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HMAC)
67892>>>>>>>>>Define CALG_TLS1PRF                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_TLS1PRF)
67892>>>>>>>>>Define CALG_HASH_REPLACE_OWF            for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HASH_REPLACE_OWF)
67892>>>>>>>>>Define CALG_AES_128                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_128)
67892>>>>>>>>>Define CALG_AES_192                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_192)
67892>>>>>>>>>Define CALG_AES_256                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_256)
67892>>>>>>>>>Define CALG_AES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES)
67892>>>>>>>>>Define CALG_SHA_256                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_256)
67892>>>>>>>>>Define CALG_SHA_384                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_384)
67892>>>>>>>>>Define CALG_SHA_512                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_512)
67892>>>>>>>>>
67892>>>>>>>>>// Providers
67892>>>>>>>>>Define MS_DEF_PROV                      for "Microsoft Base Cryptographic Provider v1.0"
67892>>>>>>>>>Define MS_ENHANCED_PROV                 for "Microsoft Enhanced Cryptographic Provider v1.0"
67892>>>>>>>>>Define MS_STRONG_PROV                   for "Microsoft Strong Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_RSA_SIG_PROV              for "Microsoft RSA Signature Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_RSA_SCHANNEL_PROV         for "Microsoft RSA SChannel Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DSS_PROV                  for "Microsoft Base DSS Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DSS_DH_PROV               for "Microsoft Base DSS and Diffie-Hellman Cryptographic Provider"
67892>>>>>>>>>Define MS_ENH_DSS_DH_PROV               for "Microsoft Enhanced DSS and Diffie-Hellman Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DH_SCHANNEL_PROV          for "Microsoft DH SChannel Cryptographic Provider"
67892>>>>>>>>>Define MS_SCARD_PROV                    for "Microsoft Base Smart Card Crypto Provider"
67892>>>>>>>>>Define MS_ENH_RSA_AES_PROV              for "Microsoft Enhanced RSA and AES Cryptographic Provider"
67892>>>>>>>>>
67892>>>>>>>>>// dwFlags definitions for CryptAcquireContext
67892>>>>>>>>>Define CRYPT_VERIFYCONTEXT              for |CI$F0000000
67892>>>>>>>>>Define CRYPT_NEWKEYSET                  for |CI$00000008
67892>>>>>>>>>Define CRYPT_DELETEKEYSET               for |CI$00000010
67892>>>>>>>>>Define CRYPT_MACHINE_KEYSET             for |CI$00000020
67892>>>>>>>>>Define CRYPT_SILENT                     for |CI$00000040
67892>>>>>>>>>
67892>>>>>>>>>// dwFlag definitions for CryptGenKey
67892>>>>>>>>>Define CRYPT_EXPORTABLE                 for |CI$00000001
67892>>>>>>>>>Define CRYPT_USER_PROTECTED             for |CI$00000002
67892>>>>>>>>>Define CRYPT_CREATE_SALT                for |CI$00000004
67892>>>>>>>>>Define CRYPT_UPDATE_KEY                 for |CI$00000008
67892>>>>>>>>>Define CRYPT_NO_SALT                    for |CI$00000010
67892>>>>>>>>>Define CRYPT_PREGEN                     for |CI$00000040
67892>>>>>>>>>Define CRYPT_RECIPIENT                  for |CI$00000010
67892>>>>>>>>>Define CRYPT_INITIATOR                  for |CI$00000040
67892>>>>>>>>>Define CRYPT_ONLINE                     for |CI$00000080
67892>>>>>>>>>Define CRYPT_SF                         for |CI$00000100
67892>>>>>>>>>Define CRYPT_CREATE_IV                  for |CI$00000200
67892>>>>>>>>>Define CRYPT_KEK                        for |CI$00000400
67892>>>>>>>>>Define CRYPT_DATA_KEY                   for |CI$00000800
67892>>>>>>>>>Define CRYPT_VOLATILE                   for |CI$00001000
67892>>>>>>>>>Define CRYPT_SGCKEY                     for |CI$00002000
67892>>>>>>>>>Define CRYPT_ARCHIVABLE                 for |CI$00004000
67892>>>>>>>>>
67892>>>>>>>>>// Provider types
67892>>>>>>>>>Define PROV_RSA_FULL                    for 1
67892>>>>>>>>>Define PROV_RSA_SIG                     for 2
67892>>>>>>>>>Define PROV_DSS                         for 3
67892>>>>>>>>>Define PROV_FORTEZZA                    for 4
67892>>>>>>>>>Define PROV_MS_EXCHANGE                 for 5
67892>>>>>>>>>Define PROV_SSL                         for 6
67892>>>>>>>>>Define PROV_RSA_SCHANNEL                for 12
67892>>>>>>>>>Define PROV_DSS_DH                      for 13
67892>>>>>>>>>Define PROV_EC_ECDSA_SIG                for 14
67892>>>>>>>>>Define PROV_EC_ECNRA_SIG                for 15
67892>>>>>>>>>Define PROV_EC_ECDSA_FULL               for 16
67892>>>>>>>>>Define PROV_EC_ECNRA_FULL               for 17
67892>>>>>>>>>Define PROV_DH_SCHANNEL                 for 18
67892>>>>>>>>>Define PROV_SPYRUS_LYNKS                for 20
67892>>>>>>>>>Define PROV_RNG                         for 21
67892>>>>>>>>>Define PROV_INTEL_SEC                   for 22
67892>>>>>>>>>Define PROV_REPLACE_OWF                 for 23
67892>>>>>>>>>Define PROV_RSA_AES                     for 24
67892>>>>>>>>>
67892>>>>>>>>>// KP_MODE
67892>>>>>>>>>// KP_MODE
67892>>>>>>>>>Define CRYPT_MODE_CBC                   for 1       // Cipher block chaining
67892>>>>>>>>>Define CRYPT_MODE_ECB                   for 2       // Electronic code book
67892>>>>>>>>>Define CRYPT_MODE_OFB                   for 3       // Output feedback mode
67892>>>>>>>>>Define CRYPT_MODE_CFB                   for 4       // Cipher feedback mode
67892>>>>>>>>>Define CRYPT_MODE_CTS                   for 5       // Ciphertext stealing mode
67892>>>>>>>>>Define CRYPT_MODE_CBCI                  for 6       // ANSI CBC Interleaved
67892>>>>>>>>>Define CRYPT_MODE_CFBP                  for 7       // ANSI CFB Pipelined
67892>>>>>>>>>Define CRYPT_MODE_OFBP                  for 8       // ANSI OFB Pipelined
67892>>>>>>>>>Define CRYPT_MODE_CBCOFM                for 9       // ANSI CBC + OF Masking
67892>>>>>>>>>Define CRYPT_MODE_CBCOFMI               for 10      // ANSI CBC + OFM Interleaved
67892>>>>>>>>>
67892>>>>>>>>>// dwParam definitions for CryptGetKeyParam
67892>>>>>>>>>Define KP_IV                            for 1       // Initialization vector
67892>>>>>>>>>Define KP_SALT                          for 2       // Salt value
67892>>>>>>>>>Define KP_PADDING                       for 3       // Padding values
67892>>>>>>>>>Define KP_MODE                          for 4       // Mode of the cipher
67892>>>>>>>>>Define KP_MODE_BITS                     for 5       // Number of bits to feedback
67892>>>>>>>>>Define KP_PERMISSIONS                   for 6       // Key permissions DWORD
67892>>>>>>>>>Define KP_ALGID                         for 7       // Key algorithm
67892>>>>>>>>>Define KP_BLOCKLEN                      for 8       // Block size of the cipher
67892>>>>>>>>>Define KP_KEYLEN                        for 9       // Length of key in bits
67892>>>>>>>>>Define KP_SALT_EX                       for 10      // Length of salt in bytes
67892>>>>>>>>>Define KP_P                             for 11      // DSS/Diffie-Hellman P value
67892>>>>>>>>>Define KP_G                             for 12      // DSS/Diffie-Hellman G value
67892>>>>>>>>>Define KP_Q                             for 13      // DSS Q value
67892>>>>>>>>>Define KP_X                             for 14      // Diffie-Hellman X value
67892>>>>>>>>>Define KP_Y                             for 15      // Y value
67892>>>>>>>>>Define KP_RA                            for 16      // Fortezza RA value
67892>>>>>>>>>Define KP_RB                            for 17      // Fortezza RB value
67892>>>>>>>>>Define KP_INFO                          for 18      // for putting information into an RSA envelope
67892>>>>>>>>>Define KP_EFFECTIVE_KEYLEN              for 19      // setting and getting RC2 effective key length
67892>>>>>>>>>Define KP_SCHANNEL_ALG                  for 20      // for setting the Secure Channel algorithms
67892>>>>>>>>>Define KP_CLIENT_RANDOM                 for 21      // for setting the Secure Channel client random data
67892>>>>>>>>>Define KP_SERVER_RANDOM                 for 22      // for setting the Secure Channel server random data
67892>>>>>>>>>Define KP_RP                            for 23
67892>>>>>>>>>Define KP_PRECOMP_MD5                   for 24
67892>>>>>>>>>Define KP_PRECOMP_SHA                   for 25
67892>>>>>>>>>Define KP_CERTIFICATE                   for 26      // for setting Secure Channel certificate data (PCT1)
67892>>>>>>>>>Define KP_CLEAR_KEY                     for 27      // for setting Secure Channel clear key data (PCT1)
67892>>>>>>>>>Define KP_PUB_EX_LEN                    for 28
67892>>>>>>>>>Define KP_PUB_EX_VAL                    for 29
67892>>>>>>>>>Define KP_KEYVAL                        for 30
67892>>>>>>>>>Define KP_ADMIN_PIN                     for 31
67892>>>>>>>>>Define KP_KEYEXCHANGE_PIN               for 32
67892>>>>>>>>>Define KP_SIGNATURE_PIN                 for 33
67892>>>>>>>>>Define KP_PREHASH                       for 34
67892>>>>>>>>>Define KP_ROUNDS                        for 35
67892>>>>>>>>>Define KP_OAEP_PARAMS                   for 36      // for setting OAEP params on RSA keys
67892>>>>>>>>>Define KP_CMS_KEY_INFO                  for 37
67892>>>>>>>>>Define KP_CMS_DH_KEY_INFO               for 38
67892>>>>>>>>>Define KP_PUB_PARAMS                    for 39      // for setting public parameters
67892>>>>>>>>>Define KP_VERIFY_PARAMS                 for 40      // for verifying DSA and DH parameters
67892>>>>>>>>>Define KP_HIGHEST_VERSION               for 41      // for TLS protocol version setting
67892>>>>>>>>>Define KP_GET_USE_COUNT                 for 42      // for use with PP_CRYPT_COUNT_KEY_USE contexts
67892>>>>>>>>>
67892>>>>>>>>>// dwParam definitions for CryptGetHashParam
67892>>>>>>>>>Define HP_ALGID                         for |CI$0001  // Hash algorithm
67892>>>>>>>>>Define HP_HASHVAL                       for |CI$0002  // Hash value
67892>>>>>>>>>Define HP_HASHSIZE                      for |CI$0004  // Hash value size
67892>>>>>>>>>Define HP_HMAC_INFO                     for |CI$0005  // information for creating an HMA
67892>>>>>>>>>
67892>>>>>>>>>// key BLOB types
67892>>>>>>>>>Define KEYSTATEBLOB                     for |CI$0C
67892>>>>>>>>>Define OPAQUEKEYBLOB                    for |CI$09
67892>>>>>>>>>Define PLAINTEXTKEYBLOB                 for |CI$08
67892>>>>>>>>>Define PRIVATEKEYBLOB                   for |CI$07
67892>>>>>>>>>Define PUBLICKEYBLOB                    for |CI$06
67892>>>>>>>>>Define PUBLICKEYBLOBEX                  for |CI$0A
67892>>>>>>>>>Define SIMPLEBLOB                       for |CI$01
67892>>>>>>>>>Define SYMMETRICWRAPKEYBLOB             for |CI$0B
67892>>>>>>>>>
67892>>>>>>>>>Define CUR_BLOB_VERSION                 for 2
67892>>>>>>>>>
67892>>>>>>>>>//  Structure cryptimportkey
67892>>>>>>>>>Struct PUBLICKEYSTRUC
67892>>>>>>>>>    UChar    bType
67892>>>>>>>>>    UChar    bVersion
67892>>>>>>>>>    UShort   reserved
67892>>>>>>>>>    UInteger aiKeyAlg
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>Struct tPLAINTEXTKEYBLOB
67892>>>>>>>>>    PUBLICKEYSTRUC hdr
67892>>>>>>>>>    PUBLICKEYSTRUC hdr
67892>>>>>>>>>    UInteger       dwKeySize
67892>>>>>>>>>//    UChar[]        rgbKeyData
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>//  Structure for specifying the inner and outer strings when calculating HMAC hash (use with CryptSetHashParam)
67892>>>>>>>>>Struct HMAC_INFO
67892>>>>>>>>>    UInteger HashAlgid
67892>>>>>>>>>    Pointer pbInnerString
67892>>>>>>>>>    DWord cbInnerString
67892>>>>>>>>>    Pointer pbOuterString
67892>>>>>>>>>    DWord cbOuterString
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>External_Function CryptAcquireContext "CryptAcquireContextA" advapi32.dll ;    Pointer phProv ;    Pointer szContainer ;    Pointer szProvider ;    Integer dwProvType ;    Integer dwFlags ;    Returns Boolean
67893>>>>>>>>>
67893>>>>>>>>>External_Function CryptReleaseContext "CryptReleaseContext" advapi32.dll ;    Handle hProv ;    Integer dwFlags ;    Returns Boolean
67894>>>>>>>>>
67894>>>>>>>>>External_Function CryptCreateHash "CryptCreateHash" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hKey ;    Integer dwFlags ;    Pointer phHash ;    Returns Boolean
67895>>>>>>>>>
67895>>>>>>>>>External_Function CryptDestroyHash "CryptDestroyHash" advapi32.dll ;    Handle hHash ;    Returns Boolean
67896>>>>>>>>>
67896>>>>>>>>>External_Function CryptHashData "CryptHashData" advapi32.dll ;    Handle hHash ;    Pointer pbData ;    Integer dwDataLen ;    Integer dwFlags ;    Returns Boolean
67897>>>>>>>>>
67897>>>>>>>>>External_Function CryptDeriveKey "CryptDeriveKey" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hBaseData ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
67898>>>>>>>>>
67898>>>>>>>>>External_Function CryptGetHashParam "CryptGetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    DWord dwFlags ;    Returns Integer
67899>>>>>>>>>
67899>>>>>>>>>External_Function CryptDestroyKey "CryptDestroyKey" advapi32.dll ;    Handle hKey ;    Returns Boolean
67900>>>>>>>>>
67900>>>>>>>>>External_Function CryptImportKey "CryptImportKey" advapi32.dll ;    Handle hProv ;    Pointer pbData ;    Integer dwDataLen ;    Handle hPubKey ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
67901>>>>>>>>>
67901>>>>>>>>>External_Function CryptGetKeyParam "CryptGetKeyParam" advapi32.dll ;    Handle hKey ;    Integer dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwFlags ;    Returns Boolean
67902>>>>>>>>>    
67902>>>>>>>>>External_Function CryptSetKeyParam "CryptSetKeyParam" advapi32.dll ;    Handle   hKey ;    UInteger dwParam ;    Pointer  pbdata ;    UInteger dwFlags ;    Returns  Boolean
67903>>>>>>>>>
67903>>>>>>>>>External_Function CryptEncrypt "CryptEncrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwBufLen ;    Returns Boolean
67904>>>>>>>>>
67904>>>>>>>>>External_Function CryptDecrypt "CryptDecrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Returns Boolean
67905>>>>>>>>>
67905>>>>>>>>>External_Function CryptGenRandom "CryptGenRandom" advapi32.dll ;    Handle hProv ;    DWord dwLen ;    Pointer pbBuffer ;    Returns Boolean
67906>>>>>>>>>    
67906>>>>>>>>>External_Function CryptSetHashParam "CryptSetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Integer dwFlags ;    Returns Boolean
67907>>>>>>>>>    
67907>>>>>>>
67907>>>>>>>Class cCryptographer is a cObject
67908>>>>>>>    
67908>>>>>>>    Procedure Construct_Object
67910>>>>>>>        Forward Send Construct_Object
67912>>>>>>>        
67912>>>>>>>        Property String     psProvider  MS_ENHANCED_PROV
67913>>>>>>>        Property Integer    piProvider  PROV_RSA_FULL
67914>>>>>>>        Property Integer    piCipher    CALG_RC4
67915>>>>>>>        Property Integer    piHash      CALG_MD5
67916>>>>>>>        
67916>>>>>>>        // Private properties
67916>>>>>>>        Property Handle     Private_phProv
67917>>>>>>>    End_Procedure
67918>>>>>>>    
67918>>>>>>>    
67918>>>>>>>    // Acquire key container handle
67918>>>>>>>    Function AcquireContext Returns Handle
67920>>>>>>>        Integer iProvider
67920>>>>>>>        String sProvider
67920>>>>>>>        Handle hProv
67920>>>>>>>        Boolean bOk
67920>>>>>>>        Address addrProv
67920>>>>>>>        
67920>>>>>>>        Move 0 to hProv
67921>>>>>>>        Get piProvider to iProvider
67922>>>>>>>        Get psProvider to sProvider
67923>>>>>>>        
67923>>>>>>>        //  Determine address to be passed as provider
67923>>>>>>>        If (Trim(sProvider) <> "") Begin
67925>>>>>>>            Move (AddressOf(sProvider)) to addrProv
67926>>>>>>>        End
67926>>>>>>>>
67926>>>>>>>        Else Begin
67927>>>>>>>            Move 0 to addrProv
67928>>>>>>>        End
67928>>>>>>>>
67928>>>>>>>        
67928>>>>>>>        //  Acquire Crypto Context
67928>>>>>>>        Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_VERIFYCONTEXT)) to bOk
67929>>>>>>>        If (not(bOk) or hProv = 0) Begin
67931>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET ior CRYPT_VERIFYCONTEXT)) to bOk
67932>>>>>>>        End
67932>>>>>>>>
67932>>>>>>>        
67932>>>>>>>        If (not(bOk) or hProv = 0) Begin
67934>>>>>>>            // Fallback to original
67934>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,0)) to bOk
67935>>>>>>>            
67935>>>>>>>            If (not(bOk) or hProv = 0) Begin
67937>>>>>>>                Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET)) to bOk
67938>>>>>>>            End
67938>>>>>>>>
67938>>>>>>>        End
67938>>>>>>>>
67938>>>>>>>        Set Private_phProv to hProv
67939>>>>>>>        
67939>>>>>>>        Function_Return hProv
67940>>>>>>>    End_Function
67941>>>>>>>    
67941>>>>>>>    // Releases key container handle
67941>>>>>>>    Function ReleaseContext Handle hProv Returns Boolean
67943>>>>>>>        Function_Return (CryptReleaseContext(hProv,0))
67944>>>>>>>    End_Function
67945>>>>>>>    
67945>>>>>>>    // Creates hash object
67945>>>>>>>    Function CreateHash Handle hProv Returns Handle
67947>>>>>>>        Integer iAlgorithm
67947>>>>>>>        Handle hHash
67947>>>>>>>        Boolean bOk
67947>>>>>>>        
67947>>>>>>>        Move 0 to hHash
67948>>>>>>>        Get piHash to iAlgorithm
67949>>>>>>>        Move (CryptCreateHash(hProv,iAlgorithm,0,0,AddressOf(hHash))) to bOk
67950>>>>>>>        
67950>>>>>>>        Function_Return hHash
67951>>>>>>>    End_Function
67952>>>>>>>    
67952>>>>>>>    // Destroys the hash object
67952>>>>>>>    Function DestroyHash Handle hHash Returns Boolean
67954>>>>>>>        Function_Return (CryptDestroyHash(hHash))
67955>>>>>>>    End_Function
67956>>>>>>>    
67956>>>>>>>    // Adds data to hash object
67956>>>>>>>    Function HashData Handle hHash String sData Returns Boolean
67958>>>>>>>        Function_Return (CryptHashData(hHash,AddressOf(sData),Length(sData),0))
67959>>>>>>>    End_Function
67960>>>>>>>    
67960>>>>>>>    // Generates session key
67960>>>>>>>    Function DeriveKey Handle hProv Handle hHash Returns Handle
67962>>>>>>>        Integer iAlgorithm
67962>>>>>>>        Handle hKey
67962>>>>>>>        Boolean bOk
67962>>>>>>>        
67962>>>>>>>        Move 0 to hKey
67963>>>>>>>        Get piCipher to iAlgorithm
67964>>>>>>>        Move (CryptDeriveKey(hProv,iAlgorithm,hHash,CRYPT_EXPORTABLE,AddressOf(hKey))) to bOk
67965>>>>>>>        
67965>>>>>>>        Function_Return hKey
67966>>>>>>>    End_Function
67967>>>>>>>    
67967>>>>>>>    // Imports a plain text key
67967>>>>>>>    Function ImportPlainTextKey Handle hProv UChar[] ucaKey Returns Handle
67969>>>>>>>        tPLAINTEXTKEYBLOB blobhead
67969>>>>>>>        tPLAINTEXTKEYBLOB blobhead
67969>>>>>>>        Boolean   bSuccess
67969>>>>>>>        Handle    hKey
67969>>>>>>>        Integer   iHeadSize iKeySize
67969>>>>>>>        UChar[]   ucaKeyblob
67970>>>>>>>        Integer iVoid
67970>>>>>>>        
67970>>>>>>>        Move (SizeOfType(tPLAINTEXTKEYBLOB)) to iHeadSize
67971>>>>>>>        Move (SizeOfArray(ucaKey)) to iKeySize
67972>>>>>>>        
67972>>>>>>>        Move PLAINTEXTKEYBLOB to blobhead.hdr.bType
67973>>>>>>>        Move CUR_BLOB_VERSION   to blobhead.hdr.bVersion
67974>>>>>>>        Get piCipher            to blobhead.hdr.aiKeyAlg
67975>>>>>>>        Move iKeySize           to blobhead.dwKeySize
67976>>>>>>>        
67976>>>>>>>        Move (ResizeArray(ucaKeyblob, iHeadSize)) to ucaKeyblob
67977>>>>>>>        Move (CopyMemory(AddressOf(ucaKeyblob), AddressOf(blobhead), iHeadSize)) to iVoid
67978>>>>>>>        Move (AppendArray(ucaKeyblob, ucaKey)) to ucaKeyblob
67979>>>>>>>        
67979>>>>>>>        Move 0 to hKey
67980>>>>>>>        Move (CryptImportKey(hProv, AddressOf(ucaKeyblob), SizeOfArray(ucaKeyblob), 0, 0, AddressOf(hKey))) to bSuccess
67981>>>>>>>        If (not(bSuccess)) Begin
67983>>>>>>>            Move (ShowLastError()) to iVoid
67984>>>>>>>        End
67984>>>>>>>>
67984>>>>>>>        
67984>>>>>>>        Function_Return hKey
67985>>>>>>>    End_Function
67986>>>>>>>    
67986>>>>>>>    // Destroys the key
67986>>>>>>>    Function DestroyKey Handle hKey Returns Boolean
67988>>>>>>>        Function_Return (CryptDestroyKey(hKey))
67989>>>>>>>    End_Function
67990>>>>>>>    
67990>>>>>>>    // Retrieves key data
67990>>>>>>>    Function KeyParameter Handle hKey Integer iQuery Returns Integer
67992>>>>>>>        Integer iBuffer iLen
67992>>>>>>>        Boolean bOk
67992>>>>>>>        
67992>>>>>>>        Move (SizeOfType(Integer)) to iLen
67993>>>>>>>        Move (CryptGetKeyParam(hKey,iQuery,AddressOf(iBuffer),AddressOf(iLen),0)) to bOk
67994>>>>>>>        Function_Return iBuffer
67995>>>>>>>    End_Function
67996>>>>>>>    
67996>>>>>>>    // Retrieves a hash value
67996>>>>>>>    Function HashValue Handle lhHash Returns String
67998>>>>>>>        String  lsHash
67998>>>>>>>        Integer liResult
67998>>>>>>>        DWord   dwDataLen
67998>>>>>>>        
67998>>>>>>>        Move 0 to dwDataLen
67999>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,0,AddressOf(dwDataLen),0)) to liResult
68000>>>>>>>        If (liResult = 0) ;            Function_Return ""
68003>>>>>>>        
68003>>>>>>>        Move (Repeat(Character(0),dwDataLen)) to lsHash
68004>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,AddressOf(lsHash),AddressOf(dwDataLen),0)) to liResult
68005>>>>>>>        If (liResult = 0) ;            Function_Return ""
68008>>>>>>>        
68008>>>>>>>        Function_Return lsHash
68009>>>>>>>    End_Function
68010>>>>>>>
68010>>>>>>>    // Encrypts data
68010>>>>>>>    Function Encrypt String sPassword String sData Returns String
68012>>>>>>>        Handle hProv hHash hKey
68012>>>>>>>        Integer iAlgorithm iDataLen iCipherLen iErr
68012>>>>>>>        Boolean bOk
68012>>>>>>>        
68012>>>>>>>        Get AcquireContext to hProv
68013>>>>>>>        If (hProv) Begin
68015>>>>>>>            Get CreateHash hProv to hHash
68016>>>>>>>            If (hHash) Begin
68018>>>>>>>                Get HashData hHash sPassword to bOk
68019>>>>>>>                If (bOk) Begin
68021>>>>>>>                    Get piCipher to iAlgorithm
68022>>>>>>>                    Get DeriveKey hProv hHash to hKey
68023>>>>>>>                End
68023>>>>>>>>
68023>>>>>>>                Get DestroyHash hHash to bOk
68024>>>>>>>            End
68024>>>>>>>>
68024>>>>>>>            
68024>>>>>>>            If (hKey) Begin
68026>>>>>>>                //  First call to determine resulting data size
68026>>>>>>>                Move (Length(sData)) to iDataLen
68027>>>>>>>                Move (Length(sData)) to iCipherLen
68028>>>>>>>                Move (CryptEncrypt(hKey, 0, True, 0, 0, AddressOf(iCipherLen), iDataLen)) to bOk
68029>>>>>>>                
68029>>>>>>>                //  Reserve space in string
68029>>>>>>>                If (iDataLen < iCipherLen) Begin
68031>>>>>>>                    Move (sData + Repeat(" ", iCipherLen - iDataLen)) to sData
68032>>>>>>>                End
68032>>>>>>>>
68032>>>>>>>                
68032>>>>>>>                //  Call to really decrypt
68032>>>>>>>                Move (CryptEncrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen),Length(sData))) to bOk
68033>>>>>>>                //If (not(bOk)) Begin
68033>>>>>>>                //Move "" to sData
68033>>>>>>>                //Move (GetLastError()) to iErr
68033>>>>>>>                //End
68033>>>>>>>                
68033>>>>>>>                Get DestroyKey hKey to bOk
68034>>>>>>>            End 
68034>>>>>>>>
68034>>>>>>>            Get ReleaseContext hProv to bOk
68035>>>>>>>        End 
68035>>>>>>>>
68035>>>>>>>        Function_Return sData
68036>>>>>>>    End_Function
68037>>>>>>>    
68037>>>>>>>    // Decrypts data
68037>>>>>>>    Function Decrypt String sPassword String sData Returns String
68039>>>>>>>        Handle hProv hHash hKey
68039>>>>>>>        Integer iAlgorithm iDataLen
68039>>>>>>>        Boolean bOk
68039>>>>>>>        
68039>>>>>>>        Get AcquireContext to hProv
68040>>>>>>>        If (hProv) Begin
68042>>>>>>>            Get CreateHash hProv to hHash
68043>>>>>>>            If (hHash) Begin
68045>>>>>>>                Get HashData hHash sPassword to bOk
68046>>>>>>>                If (bOk) Begin
68048>>>>>>>                    Get piCipher to iAlgorithm
68049>>>>>>>                    Get DeriveKey hProv hHash to hKey
68050>>>>>>>                End
68050>>>>>>>>
68050>>>>>>>                Get DestroyHash hHash to bOk
68051>>>>>>>            End
68051>>>>>>>>
68051>>>>>>>            
68051>>>>>>>            If (hKey) Begin
68053>>>>>>>                Move (Length(sData)) to iDataLen
68054>>>>>>>                Move (CryptDecrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen))) to bOk
68055>>>>>>>                //  Resulting dat can be shorter as the input string, in that case we shorten the result string
68055>>>>>>>                If (Length(sData) > iDataLen) Begin
68057>>>>>>>                    Move (Left(sData, iDataLen)) to sData
68058>>>>>>>                End
68058>>>>>>>>
68058>>>>>>>                
68058>>>>>>>                Get DestroyKey hKey to bOk
68059>>>>>>>            End
68059>>>>>>>>
68059>>>>>>>            Get ReleaseContext hProv to bOk
68060>>>>>>>        End
68060>>>>>>>>
68060>>>>>>>        Function_Return sData
68061>>>>>>>    End_Function
68062>>>>>>>    
68062>>>>>>>    //  Generates random data.
68062>>>>>>>    Function GenerateRandom Integer iBytes Returns UChar[]
68064>>>>>>>        Handle hProv
68064>>>>>>>        UChar[] uaResult
68065>>>>>>>        Boolean bRes
68065>>>>>>>        
68065>>>>>>>        Get AcquireContext to hProv
68066>>>>>>>        
68066>>>>>>>        Move (ResizeArray(uaResult, iBytes)) to uaResult
68067>>>>>>>        Move (CryptGenRandom(hProv, iBytes, AddressOf(uaResult))) to bRes
68068>>>>>>>        
68068>>>>>>>        Get ReleaseContext hProv to bRes
68069>>>>>>>        
68069>>>>>>>        Function_Return uaResult
68070>>>>>>>    End_Function
68071>>>>>>>    
68071>>>>>>>    //  Generates random data and does a base64 encoding to properly present it as a string.
68071>>>>>>>    Function GenerateRandomString Integer iLenght Returns String
68073>>>>>>>        String sResult
68073>>>>>>>        UChar[] aData
68074>>>>>>>        Address pBase64
68074>>>>>>>        Integer iVoid
68074>>>>>>>        
68074>>>>>>>        Get GenerateRandom iLenght to aData
68075>>>>>>>        
68075>>>>>>>        Move (Base64Encode(AddressOf(aData), iLenght)) to pBase64
68076>>>>>>>        Move pBase64 to sResult
68077>>>>>>>        Move (Free(pBase64)) to iVoid
68078>>>>>>>        
68078>>>>>>>        Function_Return (Left(sResult, iLenght))
68079>>>>>>>    End_Function
68080>>>>>>>    
68080>>>>>>>End_Class
68081>>>>>
68081>>>>>Class cLoginEncryption is a cObject
68082>>>>>    
68082>>>>>    Procedure Construct_Object
68084>>>>>        Forward Send Construct_Object
68086>>>>>        // this must be set to a multi (40ish) character random key
68086>>>>>        Property String psEncryptPassword ""
68087>>>>>        
68087>>>>>        Object oDataCrypter is a cCryptographer
68089>>>>>            Set piHash to CALG_SHA_256
68090>>>>>            Set piCipher to CALG_AES_256
68091>>>>>            Set psProvider to "" //  Not providing a specific provider gives the default provider for the provider type
68092>>>>>            Set piProvider to PROV_RSA_AES
68093>>>>>        End_Object
68094>>>>>    End_Procedure
68095>>>>>    
68095>>>>>    // This can be augmented to return a password encryption key using any
68095>>>>>    // hidden mechanism desired.
68095>>>>>    Function GetEncryptionPassword Returns String
68097>>>>>        String sPassword
68097>>>>>        Get psEncryptPassword to sPassword
68098>>>>>        Function_Return sPassword
68099>>>>>    End_Function
68100>>>>>    
68100>>>>>    // Encrypts a string into an unreadable hash that can later be decrypted using DecryptKey.
68100>>>>>    //
68100>>>>>    // Params:
68100>>>>>    //   sPlainText     String to encrypt.
68100>>>>>    // Returns:
68100>>>>>    //   Base64 encoded hash.
68100>>>>>    Function EncryptPassword String sPlainText Returns String
68102>>>>>        String sEncryptPassword sBinary sBase64
68102>>>>>        Address pBase64
68102>>>>>        Integer iVoid
68102>>>>>        
68102>>>>>        //  Encrypt Key
68102>>>>>        Get GetEncryptionPassword to sEncryptPassword
68103>>>>>        If (sEncryptPassword = "") Begin
68105>>>>>            Error DFERR_PROGRAM "No encryption password set"
68106>>>>>>
68106>>>>>        End
68106>>>>>>
68106>>>>>        
68106>>>>>        Get Encrypt of oDataCrypter sEncryptPassword sPlainText to sBinary
68107>>>>>        
68107>>>>>        If (sPlainText = sBinary or sBinary = "") Begin
68109>>>>>            Error DFERR_PROGRAM "Unable to encrypt database login password"
68110>>>>>>
68110>>>>>            Function_Return ""
68111>>>>>        End
68111>>>>>>
68111>>>>>        
68111>>>>>        //  Encode binary hash to Base64
68111>>>>>        Move (Base64Encode(AddressOf(sBinary), Length(sBinary))) to pBase64
68112>>>>>        Move pBase64 to sBase64
68113>>>>>        Move (Free(pBase64)) to iVoid
68114>>>>>        
68114>>>>>        Function_Return sBase64
68115>>>>>    End_Function
68116>>>>>    
68116>>>>>    
68116>>>>>    // Decrypts the unreadable hash generated by EncryptKey into a readable string.
68116>>>>>    //
68116>>>>>    // Params:
68116>>>>>    //   sBase64EncryptedPassword       Base64 Encrypted password
68116>>>>>    // Returns:
68116>>>>>    //   Readable plain text password
68116>>>>>    Function DecryptPassword String sBase64EncryptedPassword Returns String
68118>>>>>        String sEncryptPassword sPlainText sBinary
68118>>>>>        Boolean bIsHex
68118>>>>>        Integer iLen iVoid
68118>>>>>        Address pBinary
68118>>>>>        
68118>>>>>        If (sBase64EncryptedPassword <> "") Begin
68120>>>>>            //  Decode from Base64
68120>>>>>            Move (Base64Decode(AddressOf(sBase64EncryptedPassword), &iLen)) to pBinary
68121>>>>>            
68121>>>>>            Move (Repeat(Character(0), iLen)) to sBinary
68122>>>>>            Move (CopyMemory(AddressOf(sBinary), pBinary, iLen)) to iVoid
68123>>>>>            
68123>>>>>            Move (Free(pBinary)) to iVoid
68124>>>>>            
68124>>>>>            //  Encrypted binary hash to string
68124>>>>>            Get GetEncryptionPassword to sEncryptPassword
68125>>>>>            Get Decrypt of oDataCrypter sEncryptPassword sBinary to sPlainText
68126>>>>>        End
68126>>>>>>
68126>>>>>        
68126>>>>>        Function_Return sPlainText
68127>>>>>    End_Function
68128>>>>>End_Class
68129>>>
68129>>>Object oLoginEncryption is a cLoginEncryption
68131>>>
68131>>>    // this must be created in your appsrc directory and must contain an encryption
68131>>>    // key that is set to psEncryptPassword. It will look something like this
68131>>>    //
68131>>>    // Set psEncryptPassword to "JchUAo7W@r.b{<Yk~OONi0nq=sMi[*Rn[A-`Vo)q"
68131>>>    //  
Including file: LoginEncryptionKey.inc    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\LoginEncryptionKey.inc)
68131>>>>// Studio generated login encryption key
68131>>>>Set psEncryptPassword to "rHn+igXUe(,,M<?dkNtebWQJ$w>FT\9<FI)(MsQz"
68132>>>>
68132>>>    
68132>>>    // use this to register this object to your cConnection Object. This object
68132>>>    // must be created after the cConnection object
68132>>>    Move Self to ghoLoginEncryption
68133>>>End_Object
68134>        Use DatabaseLoginDialog.dg
Including file: DatabaseLoginDialog.dg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\DatabaseLoginDialog.dg)
68134>>>
68134>>>Use Windows.pkg
68134>>>Use cConnection.pkg
68134>>>Use dfLine.pkg
68134>>>
68134>>>Object oDatabaseLoginDialog is a ModalPanel
68136>>>    Set Label to "Database Login"
68137>>>    Set Location to 2 2
68138>>>    Set Size to 110 211
68139>>>    
68139>>>    Property String psId
68141>>>    Property Boolean pbOk False
68143>>>    Property Boolean pbChanged False
68145>>>    Property Boolean pbAllowRemember True
68147>>>    
68147>>>    // this registers this object with the cConnection object.
68147>>>    Move Self to ghoLoginConnectDialog
68148>>>    
68148>>>    Object oUserIDForm is a Form
68150>>>        Set Label to "User Name"
68151>>>        Set Size to 12 85
68152>>>        Set Location to 34 79
68153>>>        Set Label_Col_Offset to 64
68154>>>        Set peAnchors to anTopLeftRight
68155>>>    End_Object
68156>>>    
68156>>>    Object oPwdForm is a Form
68158>>>        Set Size to 12 85
68159>>>        Set Location to 49 79
68160>>>        Set Label_Col_Offset to 64
68161>>>        Set Password_State to True
68162>>>        Set peAnchors to anTopLeftRight
68163>>>        Set Label to "Password"
68164>>>    End_Object
68165>>>    
68165>>>    Object oTrustedConnection is a CheckBox
68167>>>        Set Size to 10 50
68168>>>        Set Location to 65 79
68169>>>        Set Label to "Trusted Connection"
68170>>>    End_Object
68171>>>    
68171>>>    Object oRemember is a CheckBox
68173>>>        Set Size to 10 50
68174>>>        Set Location to 79 14
68175>>>        Set Label to "Remember and don't ask again"
68176>>>        Set Checked_State to True
68177>>>    End_Object
68178>>>    
68178>>>    Object oLogin_btn is a Button
68180>>>        Set Label to "&Login"
68181>>>        Set Location to 92 102
68182>>>        Set peAnchors to anBottomRight
68183>>>        Set Default_State to True
68184>>>        
68184>>>        Procedure OnClick
68187>>>            Boolean bTrust
68187>>>            String sUser sPwd sConn sErr sId
68187>>>            Integer iError
68187>>>            Get psId to sId
68188>>>            Get Value of oUserIDForm to sUser
68189>>>            Get Value of oPwdForm to sPwd
68190>>>            Get Checked_State of oTrustedConnection to bTrust
68191>>>            
68191>>>            Get LoginConnectIdNewCredentials of ghoConnection sId sUser sPwd bTrust to iError
68192>>>            If (iError=0) Begin
68194>>>                Set pbOk to True
68195>>>                Set pbChanged to True
68196>>>                Send Close_Panel
68197>>>            End
68197>>>>
68197>>>            Else Begin
68198>>>                Get psErrorText of ghoConnection to sErr
68199>>>                Send UserError sErr "Login Error"
68200>>>            End
68200>>>>
68200>>>        End_Procedure
68201>>>    End_Object
68202>>>    
68202>>>    Object oCancel_btn is a Button
68204>>>        Set Label to "&Cancel"
68205>>>        Set Location to 92 157
68206>>>        Set peAnchors to anBottomRight
68207>>>        
68207>>>        Procedure OnClick
68210>>>            Send Close_Panel
68211>>>        End_Procedure
68212>>>    End_Object
68213>>>    
68213>>>    Object oConnectionIdInfo is a TextBox
68215>>>        Set Size to 10 50
68216>>>        Set Location to 4 14
68217>>>        Set Label to 'Connection Id='
68218>>>    End_Object
68219>>>    
68219>>>    Object oConnectionServerInfo is a TextBox
68221>>>        Set Size to 10 50
68222>>>        Set Location to 16 14
68223>>>        Set Label to 'Server'
68224>>>    End_Object
68225>>>    
68225>>>    Object oLineControl1 is a LineControl
68227>>>        Set Size to 2 202
68228>>>        Set Location to 29 5
68229>>>    End_Object
68230>>>    
68230>>>    Function LoginConnectIdDialog String sId Returns Boolean
68233>>>        Boolean bOk bChanged bTrusted bAllowRemember bRemember
68233>>>        String sUser sPwd sDescription
68233>>>        tConnection Connect
68233>>>        tConnection Connect
68233>>>        
68233>>>        Get pbAllowRemember to bAllowRemember
68234>>>        
68234>>>        
68234>>>        If not bAllowRemember Begin
68236>>>            Set Enabled_State of oRemember to bRemember
68237>>>            Set Visible_State of oRemember to bRemember
68238>>>        End
68238>>>>
68238>>>        
68238>>>        Get ConnectionIdInfo of ghoConnection sId to Connect
68239>>>        Set Value of oConnectionIdInfo to ("Connection ID="+Connect.sId)
68240>>>        Set Value of oConnectionServerInfo to Connect.sString
68241>>>        
68241>>>        Set psId to sId
68242>>>        Set pbOk to False
68243>>>        Set pbChanged to False
68244>>>        Set Value of oUserIDForm to Connect.sUID
68245>>>        Set Value of oPwdForm to ""
68246>>>        
68246>>>        Send Popup
68247>>>        
68247>>>        Get pbOk to bOk
68248>>>        Get pbChanged to bChanged
68249>>>        If (bChanged and bOk) Begin
68251>>>            If bAllowRemember Begin
68253>>>                Get Checked_State of oRemember to bRemember
68254>>>                If bRemember Begin
68256>>>                    Get Checked_State of oTrustedConnection to bTrusted
68257>>>                    If not (bTrusted) Begin
68259>>>                        Get Value of oUserIDForm to sUser
68260>>>                        Get Value of oPwdForm to sPwd
68261>>>                    End
68261>>>>
68261>>>                    Get StoreConnectionIdCredentials of ghoConnection sId sUser sPwd bTrusted to bOk
68262>>>                End
68262>>>>
68262>>>            End
68262>>>>
68262>>>        End
68262>>>>
68262>>>        Function_Return bOk
68263>>>    End_Function
68264>>>    
68264>>>    
68264>>>    On_Key Key_Alt+Key_O Send KeyAction of oLogin_btn
68265>>>    On_Key Key_Alt+Key_L Send KeyAction of oCancel_btn
68266>>>End_Object
68267>>>
68267>    End_Object
68268>
68268>End_Object
68269>
68269>Object oToolTipController is a cToolTipController
68271>    Move Self to ghoToolTipController
68272>End_Object
68273>
68273>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\oEditContextMenu.pkg)
68273>>>Use cCJStandardMenuItemClasses.pkg
68273>>>
68273>>>Object oEditContextMenu is a cCJContextMenu
68275>>>    
68275>>>    Move Self to Default_Form_Floating_Menu_ID
68276>>>    
68276>>>    Object oUndoMenuItem is a cCJUndoMenuItem
68278>>>    End_Object
68279>>>    
68279>>>    Object oCutMenuItem is a cCJCutMenuItem
68281>>>        Set pbControlBeginGroup to True
68282>>>    End_Object
68283>>>    
68283>>>    Object oCopyMenuItem is a cCJCopyMenuItem
68285>>>    End_Object
68286>>>
68286>>>    Object oPasteMenuItem is a cCJPasteMenuItem
68288>>>    End_Object
68289>>>
68289>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
68291>>>    End_Object
68292>>>
68292>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
68294>>>        Set pbControlBeginGroup to True
68295>>>    End_Object
68296>>>
68296>>>End_Object
68297>>>
68297>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\oDEOEditContextMenu17.pkg)
68297>>>Use Windows.pkg
68297>>>Use cCJStandardMenuItemClasses.pkg
68297>>>Use cCJDeoMenuItemClasses.pkg
68297>>>
68297>>>
68297>>>Object oDEOEditContextMenu17 is a cCJContextMenu
68299>>>    
68299>>>    Move Self to Default_dbFloating_Menu_ID
68300>>>    
68300>>>    Object oUndoMenuItem is a cCJUndoMenuItem
68302>>>    End_Object
68303>>>    
68303>>>    Object oCutMenuItem is a cCJCutMenuItem
68305>>>        Set pbControlBeginGroup to True
68306>>>    End_Object
68307>>>    
68307>>>    Object oCopyMenuItem is a cCJCopyMenuItem
68309>>>    End_Object
68310>>>
68310>>>    Object oPasteMenuItem is a cCJPasteMenuItem
68312>>>    End_Object
68313>>>
68313>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
68315>>>    End_Object
68316>>>
68316>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
68318>>>        Set pbControlBeginGroup to True
68319>>>    End_Object
68320>>>
68320>>>    Object oPromptMenuItem is a cCJPromptMenuItem
68322>>>        Set pbControlBeginGroup to True
68323>>>    End_Object
68324>>>
68324>>>    Object oFindNextMenu is a cCJFindNextMenuItem
68326>>>        Set pbControlBeginGroup to True
68327>>>    End_Object
68328>>>
68328>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
68330>>>    End_Object
68331>>>
68331>>>    Object oClearMenuItem is a cCJClearMenuItem
68333>>>        Set pbControlBeginGroup to True
68334>>>    End_Object
68335>>>
68335>>>    Object oClearAllMenu is a cCJClearAllMenuItem
68337>>>    End_Object
68338>>>
68338>>>    Object oSaveMenu is a cCJSaveMenuItem
68340>>>    End_Object
68341>>>    
68341>>>    Object oDeleteMenu is a cCJDeleteMenuItem
68343>>>    End_Object
68344>>>
68344>>>    Object oRememberitem is a cCJRememberFieldMenuItem
68346>>>        Set pbControlBeginGroup to True
68347>>>    End_Object
68348>>>
68348>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
68350>>>    End_Object
68351>>>
68351>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
68353>>>    End_Object
68354>>>
68354>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
68356>>>    End_Object
68357>>>
68357>>>End_Object
68358>
68358>Object oMain is a Panel
68360>    Set Label To "My Project"
68361>    Set Location to 4 3
68362>    Set Size to 300 450
68363>
68363>    Object oCommandBarSystem is a cCJCommandBarSystem
68365>        Set pbTimerUpdate to True
68366>        Set peVisualTheme to xtpThemeOffice2013Outlook
68367>        Set pbAutoResizeIcons to True
68368>
68368>        Procedure OnCreateCommandBars
68371>            Handle hoOptions
68371>            Get OptionsObject to hoOptions
68372>            Forward Send OnCreateCommandBars
68374>        End_Procedure
68375>
68375>        Object oMenuBar is a cCJMenuBar
68377>
68377>            Object oFileMenu is a cCJMenuItem
68379>                Set peControlType to xtpControlPopup          
68380>                Set psCaption   to "&File"
68381>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
68382>                Set psCategory to "Menus"
68383>
68383>                Object oClearMenuItem is a cCJClearMenuItem
68385>                    Set pbAddToDesignerMenu to True
68386>                End_Object
68387>
68387>                Object oClearAllMenu is a cCJClearAllMenuItem
68389>                    Set pbAddToDesignerMenu to True
68390>                End_Object
68391>
68391>                Object oPromptMenuItem is a cCJPromptMenuItem
68393>                    Set pbAddToDesignerMenu to True
68394>                    Set pbControlBeginGroup to True
68395>                End_Object
68396>
68396>                Object oFindMenuItem is a cCJFindMenuItem
68398>                    Set pbAddToDesignerMenu to True
68399>                    Set pbControlBeginGroup to True
68400>                End_Object
68401>
68401>                Object oFindNextMenu is a cCJFindNextMenuItem
68403>                    Set pbAddToDesignerMenu to True
68404>                End_Object
68405>
68405>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
68407>                    Set pbAddToDesignerMenu to True
68408>                End_Object
68409>
68409>                Object oFindFirstMenu is a cCJFindFirstMenuItem
68411>                    Set pbAddToDesignerMenu to True
68412>                End_Object
68413>
68413>                Object oFindLastMenu is a cCJFindLastMenuItem
68415>                    Set pbAddToDesignerMenu to True
68416>                End_Object
68417>
68417>                Object oSaveMenuItem is a cCJSaveMenuItem
68419>                    Set pbAddToDesignerMenu to True
68420>                    Set pbControlBeginGroup to True
68421>                End_Object
68422>
68422>                Object oDeleteMenuItem is a cCJDeleteMenuItem
68424>                    Set pbAddToDesignerMenu to True
68425>                End_Object
68426>
68426>                Object oExitMenu is a cCJExitMenuItem
68428>                    Set pbControlBeginGroup to True
68429>                End_Object
68430>
68430>            End_Object
68431>
68431>            Object oViewMenu is a cCJMenuItem
68433>                Set peControlType to xtpControlPopup
68434>                Set psCaption to "&View"
68435>                Set psToolTip to "View"
68436>                Set psDescription to "Available Views"
68437>
68437>                Object oEmpEntryMenuItem is a cCJMenuItem
68439>                    Set psCaption to "EmpEntry"
68440>                    Set psTooltip to "EmpEntry"
68441>                
68441>                    Procedure OnExecute Variant vCommandBarControl
68444>                        Handle hoClient
68444>                        Get Client_Id to hoClient
68445>                        Send Activate_oEmpEntry of hoClient
68446>                    End_Procedure
68447>                End_Object
68448>
68448>                Object oLineEntryMenuItem is a cCJMenuItem
68450>                    Set psCaption to "LineEntry"
68451>                    Set psTooltip to "LineEntry"
68452>                
68452>                    Procedure OnExecute Variant vCommandBarControl
68455>                        Handle hoClient
68455>                        Get Client_Id to hoClient
68456>                        Send Activate_oLineEntry of hoClient
68457>                    End_Procedure
68458>                End_Object
68459>
68459>                Object oPageHeaderEntryMenuItem is a cCJMenuItem
68461>                    Set psCaption to "PageHeaderEntry"
68462>                    Set psTooltip to "PageHeaderEntry"
68463>                
68463>                    Procedure OnExecute Variant vCommandBarControl
68466>                        Handle hoClient
68466>                        Get Client_Id to hoClient
68467>                        Send Activate_oPageHeaderEntry of hoClient
68468>                    End_Procedure
68469>                End_Object
68470>
68470>                Object oShoeEntryMenuItem is a cCJMenuItem
68472>                    Set psCaption to "ShoeEntry"
68473>                    Set psTooltip to "ShoeEntry"
68474>                
68474>                    Procedure OnExecute Variant vCommandBarControl
68477>                        Handle hoClient
68477>                        Get Client_Id to hoClient
68478>                        Send Activate_oShoeEntry of hoClient
68479>                    End_Procedure
68480>                End_Object
68481>
68481>                Object oPageFooterEntry4MenuItem is a cCJMenuItem
68483>                    Set psCaption to "PageFooterEntry4"
68484>                    Set psTooltip to "PageFooterEntry4"
68485>                
68485>                    Procedure OnExecute Variant vCommandBarControl
68488>                        Handle hoClient
68488>                        Get Client_Id to hoClient
68489>                        Send Activate_oPageFooterEntry4 of hoClient
68490>                    End_Procedure
68491>                End_Object
68492>            End_Object
68493>            
68493>            Object oReportMenu is a cCJMenuItem
68495>                Set peControlType to xtpControlPopup
68496>                Set psCaption to "&Report"
68497>                Set psToolTip to "Report"
68498>                Set psDescription to "Available Reports"
68499>
68499>                Object oReportView2MenuItem is a cCJMenuItem
68501>                    Set psCaption to "ReportView2"
68502>                    Set psTooltip to "ReportView2"
68503>                
68503>                    Procedure OnExecute Variant vCommandBarControl
68506>                        Handle hoClient
68506>                        Get Client_Id to hoClient
68507>                        Send Activate_oReportView2 of hoClient
68508>                    End_Procedure
68509>                End_Object
68510>            End_Object
68511>
68511>            Object oNavigateMenu is a cCJMenuItem
68513>                Set peControlType to xtpControlPopup      
68514>                Set psCaption to "&Navigate"    
68515>                Set psTooltip to "Navigate"    
68516>                Set psDescription to "Move to different areas of the application"
68517>
68517>                Object oNextAreaMenu is a cCJNextAreaMenu
68519>                End_Object
68520>
68520>                Object oPriorAreaMenu is a cCJPriorAreaMenu
68522>                End_Object
68523>
68523>                Object oNextViewMenu is a cCJNextViewMenu
68525>                End_Object
68526>
68526>                Object oPriorViewMenu is a cCJPriorViewMenu
68528>                End_Object
68529>
68529>                Object oPromptMenu is a cCJPromptMenuItem
68531>                    Set pbControlBeginGroup to True
68532>                End_Object
68533>
68533>                Object oZoomMenu is a cCJZoomMenuItem
68535>                End_Object
68536>
68536>            End_Object
68537>
68537>            Object oWindowMenu is a cCJMDIWindowsMenuItem
68539>                Set peControlType to xtpControlPopup
68540>                Set psCaption to "&Window"
68541>                Set psToolTip to "Window"
68542>                Set psDescription to "Display Current Views and set other display options."    
68543>
68543>                // These are the static windows items. More will be created in onInitPopup 
68543>                Object oDisplayOptionsMenu is a cCJMenuItem
68545>                    Set peControlType to xtpControlPopup          
68546>                    Set psCaption to "&Display Options"
68547>                    Set psToolTip to "Display Options"
68548>                    Set psDescription to "Set display options"
68549>
68549>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
68551>                    End_Object
68552>
68552>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
68554>                    End_Object
68555>
68555>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
68557>                        Set pbControlBeginGroup to True
68558>                    End_Object
68559>
68559>                End_Object
68560>
68560>                Object oCascadeMenu is a cCJCascadeMenuItem
68562>                    Set pbControlBeginGroup to True
68563>                End_Object
68564>
68564>                Object oHorizTile is a cCJTileHorizontally
68566>                End_Object
68567>
68567>                Object oVertTile is a cCJTileVertically
68569>                End_Object
68570>
68570>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
68572>                    Set pbControlBeginGroup to True
68573>                End_Object
68574>
68574>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
68576>                End_Object
68577>
68577>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
68579>                    Set pbControlBeginGroup to True
68580>                End_Object
68581>
68581>            End_Object
68582>
68582>            Object oHelpMenu is a cCJMenuItem
68584>                Set peControlType to xtpControlPopup    
68585>                Set psCaption to "&Help"
68586>                Set psDescription to "Access Information for learning and using this DataFlex application."
68587>                Set psToolTip to "Help"
68588>
68588>                Object oHelpMenuItem is a cCJHelpMenuItem 
68590>                End_Object
68591>
68591>                Object oAboutMenuItem is a cCJAboutMenuItem
68593>                End_Object
68594>
68594>            End_Object
68595>
68595>        End_Object
68596>
68596>        Object oFindToolBar is a cCJToolbar
68598>            Set psTitle to "Finding Toolbar"
68599>
68599>            Object oFindFirstTool is a cCJFindFirstMenuItem
68601>            End_Object
68602>
68602>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
68604>            End_Object
68605>
68605>            Object oFindMenuTool is a cCJFindMenuItem
68607>            End_Object
68608>
68608>            Object oFindNextTool is a cCJFindNextMenuItem
68610>            End_Object
68611>
68611>            Object oFindLastTool is a cCJFindLastMenuItem
68613>            End_Object
68614>
68614>            Object oPromptToolItem is a cCJPromptMenuItem
68616>                Set pbControlBeginGroup to True
68617>            End_Object
68618>
68618>        End_Object
68619>
68619>        Object oFileToolBar is a cCJToolbar
68621>            Set psTitle to "Data Entry Toolbar"
68622>
68622>            Object oClearToolItem is a cCJClearMenuItem
68624>                Set peControlStyle to xtpButtonIconAndCaption
68625>            End_Object
68626>
68626>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
68628>                Set peControlStyle to xtpButtonIconAndCaption
68629>            End_Object
68630>
68630>            Object oSaveToolItem is a cCJSaveMenuItem
68632>                Set peControlStyle to xtpButtonIconAndCaption
68633>                Set pbControlBeginGroup to True
68634>            End_Object
68635>
68635>            Object oDeleteToolItem is a cCJDeleteMenuItem
68637>                Set peControlStyle to xtpButtonIconAndCaption
68638>            End_Object
68639>
68639>        End_Object
68640>
68640>        Object oEditToolBar is a cCJToolbar
68642>            Set psTitle to "Edit Toolbar"
68643>
68643>            Object oCutToolbarItem is a cCJCutMenuItem
68645>            End_Object
68646>
68646>            Object oCopyToolbarItem is a cCJCopyMenuItem
68648>            End_Object
68649>
68649>            Object oPasteToolbarItem is a cCJPasteMenuItem
68651>            End_Object
68652>
68652>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
68654>                Set pbControlBeginGroup to True
68655>            End_Object
68656>
68656>        End_Object
68657>
68657>        Object oRememberToolbar is a cCJToolbar
68659>            Set psTitle to C_$Remember
68660>
68660>            Object oRememberItems is a cCJMenuItem
68662>
68662>                Set peControlType to xtpControlPopup
68663>                Set peControlStyle to xtpButtonCaption
68664>                Set psCaption to C_$Remember
68665>                
68665>                Object oMenuItem is a cCJRememberFieldMenuItem
68667>                    Set peControlStyle to xtpButtonIconAndCaption
68668>                End_Object
68669>                
68669>                Object oMenuItem is a cCJRememberLastFieldMenuItem
68671>                    Set peControlStyle to xtpButtonIconAndCaption
68672>                End_Object
68673>                
68673>                Object oMenuItem is a cCJUnRememberFieldMenuItem
68675>                    Set peControlStyle to xtpButtonIconAndCaption
68676>                End_Object
68677>                
68677>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
68679>                    Set peControlStyle to xtpButtonIconAndCaption
68680>                End_Object
68681>
68681>            End_Object
68682>            
68682>        End_Object
68683>        
68683>        Object oStatusBar is a cCJStatusBar
68685>
68685>            Object oStatusPane1 is a cCJStatusBarPane
68687>                Set piID to sbpIDIdlePane
68688>                Set pbStyleStretch to True
68689>            End_Object
68690>
68690>            Object oStatusPane2 is a cCJStatusBarPane
68692>                Set phoViewPane to Self
68693>                Set pbStyleStretch to True
68694>            End_Object
68695>
68695>        End_Object
68696>
68696>    End_Object
68697>
68697>    Object oClientArea is a ClientArea
68699>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\StdAbout.pkg)
68699>>>// This provides a quick and simple way to create an about package for a program.
68699>>>// You need to create a message inside you client area called Activate_About.
68699>>>// Within this message you should send the message DoAbout passing needed
68699>>>// string information.
68699>>>//
68699>>>//       Procedure Activate_About
68699>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
68699>>>//       End_Procedure
68699>>>//    where: sTitle =     Name of application. If none provided, uses caption
68699>>>//                        bar title
68699>>>//           sVersion   = Version Line. If none provided, will be blank
68699>>>//           sCopyRight = Copyright Line. If none provided, will be blank
68699>>>//           sAuthor    = Author name, blank if none provided
68699>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
68699>>>//                        is used.
68699>>>// It is expected that you will place this in your own object package. For
68699>>>// example an order about package may look like this:
68699>>>//
68699>>>//   // OrderAbout.pkg
68699>>>//   Use StdAbout.pkg
68699>>>//   Procedure Activate_About
68699>>>//      String sTitle sCopyright sVersion sAuthor
68699>>>//      Move "My Order Entry System" to sTitle
68699>>>//      Move "Version 2.1" to sVersion
68699>>>//      Move "Copyright xxxx, Super Software Inc." to sCopyright
68699>>>//      Move "John Smith"  to sAuthor
68699>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
68699>>>//   end_procedure
68699>>>//   // end of file.
68699>>>
68699>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Dfabout.pkg)
68699>>>>>Use LanguageText.pkg
68699>>>>>Use Windows.pkg
68699>>>>>Use DFbitmap.pkg
68699>>>>>Use GlobalFunctionsProcedures.pkg
68699>>>>>Use cTextEdit.pkg
68699>>>>>Use tWinStructs.pkg
68699>>>>>
68699>>>>>Use cli.pkg
68699>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 19.1\Pkg\DFBTRDRV.PKG)
68699>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
68699>>>>>>>// Notice      : This package contains constants and commands, used to call
68699>>>>>>>//               specific functions in the DFBTRDRV.
68699>>>>>>>Use Ui
68699>>>>>>>//
68699>>>>>>>// Driver Indentification
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>// Driver attributes
68699>>>>>>>//
68699>>>>>>>// Call_Driver functions ID's
68699>>>>>>>//
68699>>>>>>>//
68699>>>>>>>// DFBTRFN_CONVERT_FILE options
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// DFBTRFN_SET_OWNER options
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to create all vars which may be needed
68699>>>>>>>// in other commands.
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to set the owner of a Btrieve file.
68699>>>>>>>// File must have been opened.
68699>>>>>>>// Filenumber needs to be passed.
68699>>>>>>>// To clear set the owner to "".
68699>>>>>>>// Examples:
68699>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
68699>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
68699>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
68699>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
68699>>>>>>>// To clear:
68699>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to parse DFBTR_SET_OWNVER
68699>>>>>>>// options.
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to parse for Callback
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to clear the owner of a Btrieve file.
68699>>>>>>>// File must have been opened.
68699>>>>>>>// Filenumber needs to be passed.
68699>>>>>>>// Examples:
68699>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to add a owner name to the internal list of ownernames
68699>>>>>>>// which will be tries when opening files.
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to remove all owners from the internal list of ownernames
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to set the owner name to be used when opening the DDF files.
68699>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
68699>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
68699>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to change the transaction type.
68699>>>>>>>// Valid types are:
68699>>>>>>>//     DFBTRTT_NONE
68699>>>>>>>//     DFBTRTT_EXCLUSIVE
68699>>>>>>>//     DFBTRTT_CONCURRENT
68699>>>>>>>//
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to get the current transaction type.
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to set explicit_locking
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to get explicit locking
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>//
68699>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
68699>>>>>>>//
68699>>>>>>>
68699>>>>>>>// Purpose: An instance of this class can be used as a broker object to
68699>>>>>>>//          call several Dfbtrdrv releated methods.
68699>>>>>>>
68699>>>>>>>Class cDFBtrDrvHandler is an Array
68700>>>>>>>    
68700>>>>>>>    Procedure Construct_Object Integer iImage
68702>>>>>>>        Forward Send Construct_object iImage
68704>>>>>>>        
68704>>>>>>>        Property String  psDriverID "DFBTRDRV"
68705>>>>>>>    End_Procedure
68706>>>>>>>    
68706>>>>>>>    //  The revsion of a Dfbtrdrv Connectivity Kit
68706>>>>>>>    //
68706>>>>>>>    
68706>>>>>>>    Function CKRevision Returns String
68708>>>>>>>        String  sDriverID
68708>>>>>>>        String  sRevision
68708>>>>>>>        String  sVoid
68708>>>>>>>        Integer iRetval
68708>>>>>>>        
68708>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68708>>>>>>>        // This error would otherwise be raised when we have an older
68708>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68708>>>>>>>        Send Ignore_error to Error_object_Id 20491
68709>>>>>>>        Get psDriverID to sDriverID
68710>>>>>>>        Move (Repeat(" ", 255)) to sRevision
68711>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
68716>>>>>>>        Send Trap_Error to Error_object_Id 20491
68717>>>>>>>        If (Trim(sRevision) = "") Begin
68719>>>>>>>            // Unable to get the revision. return all zeroes.
68719>>>>>>>            Move "0.0.0.0" to sRevision
68720>>>>>>>        End
68720>>>>>>>>
68720>>>>>>>        Function_Return sRevision
68721>>>>>>>    End_Function
68722>>>>>>>    
68722>>>>>>>    Function CkUsesUri Returns Integer
68724>>>>>>>        String  sDriverID
68724>>>>>>>        String  sVoid1
68724>>>>>>>        String  sVoid2
68724>>>>>>>        Integer iRetval
68724>>>>>>>        
68724>>>>>>>        Get psDriverID to sDriverID
68725>>>>>>>        
68725>>>>>>>        Move 0 to iRetval
68726>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68726>>>>>>>        // This error would otherwise be raised when we have an older
68726>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
68726>>>>>>>        Send Ignore_error to Error_object_Id 20491
68727>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
68732>>>>>>>        Send Trap_Error to Error_object_Id 20491
68733>>>>>>>        
68733>>>>>>>        Function_Return iRetval
68734>>>>>>>    End_Function
68735>>>>>>>    
68735>>>>>>>    
68735>>>>>>>    
68735>>>>>>>    // Extract the Nth part of a a.b.c.d revsion string.
68735>>>>>>>    //
68735>>>>>>>    // Returns : The part version number or -1 if there is no such part number.
68735>>>>>>>    //
68735>>>>>>>    
68735>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
68737>>>>>>>        Integer iPartRev
68737>>>>>>>        Integer iCurrentPart
68737>>>>>>>        Integer iSeparatorPos
68737>>>>>>>        
68737>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
68740>>>>>>>        
68740>>>>>>>        Move 0 to iCurrentPart
68741>>>>>>>        Repeat
68741>>>>>>>>
68741>>>>>>>            Move (Pos(".", sRevision)) to iSeparatorPos
68742>>>>>>>            If (iSeparatorPos > 0) Begin
68744>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) to iPartRev
68745>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) to sRevision
68746>>>>>>>                Increment iCurrentPart
68747>>>>>>>            End
68747>>>>>>>>
68747>>>>>>>            Else If (sRevision <> "") Begin
68750>>>>>>>                Move sRevision to iPartRev
68751>>>>>>>                Move "" to sRevision
68752>>>>>>>                Increment iCurrentPart
68753>>>>>>>            End
68753>>>>>>>>
68753>>>>>>>            Else ;                Move -1 to iPartRev
68755>>>>>>>        Until (iCurrentPart >= iPartNum or iPartRev = -1)
68757>>>>>>>        
68757>>>>>>>        Function_Return iPartRev
68758>>>>>>>    End_Function
68759>>>>>>>    
68759>>>>>>>    
68759>>>>>>>    
68759>>>>>>>    //
68759>>>>>>>    //  Returns the major revision of the CK
68759>>>>>>>    //
68759>>>>>>>    
68759>>>>>>>    Function CKMajorRevision Returns Integer
68761>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
68762>>>>>>>    End_Function
68763>>>>>>>    
68763>>>>>>>    
68763>>>>>>>    
68763>>>>>>>    //  Returns the minor revision of the CK
68763>>>>>>>    //
68763>>>>>>>    
68763>>>>>>>    Function CKMinorRevision Returns Integer
68765>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
68766>>>>>>>    End_Function
68767>>>>>>>    
68767>>>>>>>    
68767>>>>>>>    //  Returns the release revision of the CK
68767>>>>>>>    //
68767>>>>>>>    
68767>>>>>>>    Function CKReleaseRevision Returns Integer
68769>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
68770>>>>>>>    End_Function
68771>>>>>>>    
68771>>>>>>>    
68771>>>>>>>    //  Returns the major revision of the CK
68771>>>>>>>    //
68771>>>>>>>    
68771>>>>>>>    Function CKBuildRevision Returns Integer
68773>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
68774>>>>>>>    End_Function
68775>>>>>>>    
68775>>>>>>>    
68775>>>>>>>    //  Determines if the CK conforms to a passed minimal revsion.
68775>>>>>>>    //
68775>>>>>>>    
68775>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
68777>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_Return (True)
68780>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
68783>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_Return (True)
68786>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
68789>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_Return (True)
68792>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) and iBuild <= CKBuildRevision(Current_object)) ;                    Function_Return (True)
68796>>>>>>>            End
68796>>>>>>>>
68796>>>>>>>        End
68796>>>>>>>>
68796>>>>>>>        
68796>>>>>>>        Function_Return (False)
68797>>>>>>>    End_Function
68798>>>>>>>    
68798>>>>>>>    //   Functions to query the Pervasive.SQL version:
68798>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
68798>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
68798>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
68798>>>>>>>    //
68798>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
68798>>>>>>>    //   in the following format:
68798>>>>>>>    //       <version>.<revision>.<type>
68798>>>>>>>    //   possible values for <type>:
68798>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
68798>>>>>>>    //         server using Workgroup authentication mode
68798>>>>>>>    //       C for client cache engine
68798>>>>>>>    //       D for DOS workstation
68798>>>>>>>    //       N for client Requester
68798>>>>>>>    //       S for NetWare server
68798>>>>>>>    //       T for 32-bit Windows server engine
68798>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
68798>>>>>>>    //
68798>>>>>>>    //   example:
68798>>>>>>>    //       8.50.T
68798>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
68798>>>>>>>    //   32-bits Windows server.
68798>>>>>>>    //
68798>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
68798>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
68798>>>>>>>    //
68798>>>>>>>    //   If the version information is not available or can not be obtained
68798>>>>>>>    //   the functions will return "0.0.0"
68798>>>>>>>    
68798>>>>>>>    //  Returns the version information of the
68798>>>>>>>    //           Pervasive.SQL Client requester.
68798>>>>>>>    
68798>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
68800>>>>>>>        
68800>>>>>>>        String  sDriverID
68800>>>>>>>        String  sVersion
68800>>>>>>>        String  sVoid
68800>>>>>>>        Integer iRetval
68800>>>>>>>        
68800>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68800>>>>>>>        // This error would otherwise be raised when we have an older
68800>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68800>>>>>>>        Send Ignore_error to Error_object_Id 20491
68801>>>>>>>        Get psDriverID to sDriverID
68802>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68803>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68808>>>>>>>        Send Trap_Error to Error_object_Id 20491
68809>>>>>>>        If (Trim(sVersion) = "") Begin
68811>>>>>>>            // Unable to get the revision. return all zeroes.
68811>>>>>>>            Move "0.0.0" to sVersion
68812>>>>>>>        End
68812>>>>>>>>
68812>>>>>>>        Function_Return sVersion
68813>>>>>>>    End_Function
68814>>>>>>>    
68814>>>>>>>    //           Pervasive.SQL Engine
68814>>>>>>>    
68814>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
68816>>>>>>>        
68816>>>>>>>        String  sDriverID
68816>>>>>>>        String  sVersion
68816>>>>>>>        String  sVoid
68816>>>>>>>        Integer iRetval
68816>>>>>>>        
68816>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68816>>>>>>>        // This error would otherwise be raised when we have an older
68816>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68816>>>>>>>        Send Ignore_error to Error_object_Id 20491
68817>>>>>>>        Get psDriverID to sDriverID
68818>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68819>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68824>>>>>>>        Send Trap_Error to Error_object_Id 20491
68825>>>>>>>        If (Trim(sVersion) = "") Begin
68827>>>>>>>            // Unable to get the revision. return all zeroes.
68827>>>>>>>            Move "0.0.0" to sVersion
68828>>>>>>>        End
68828>>>>>>>>
68828>>>>>>>        Function_Return sVersion
68829>>>>>>>    End_Function
68830>>>>>>>    
68830>>>>>>>    //  Returns the version information of the
68830>>>>>>>    //           Pervasive.SQL Server Engine
68830>>>>>>>    
68830>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
68832>>>>>>>        
68832>>>>>>>        String  sDriverID
68832>>>>>>>        String  sVersion
68832>>>>>>>        String  sVoid
68832>>>>>>>        Integer iRetval
68832>>>>>>>        
68832>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68832>>>>>>>        // This error would otherwise be raised when we have an older
68832>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68832>>>>>>>        Send Ignore_error to Error_object_Id 20491
68833>>>>>>>        Get psDriverID to sDriverID
68834>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68835>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68840>>>>>>>        Send Trap_Error to Error_object_Id 20491
68841>>>>>>>        If (Trim(sVersion) = "") Begin
68843>>>>>>>            // Unable to get the revision. return all zeroes.
68843>>>>>>>            Move "0.0.0" to sVersion
68844>>>>>>>        End
68844>>>>>>>>
68844>>>>>>>        Function_Return sVersion
68845>>>>>>>    End_Function
68846>>>>>>>    
68846>>>>>>>End_Class
68847>>>>>>>
68847>>>>>>>
68847>>>>>Use MSSqldrv.pkg
Including file: MSSqldrv.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\MSSqldrv.pkg)
68847>>>>>>>//     Package that declares MS SQL driver constants and functions.
68847>>>>>>>//     This package can be used by developers who want to add Data Access
68847>>>>>>>//     MS SQL Client specific code to a DataFlex application.
68847>>>>>>>
68847>>>>>>>Use Cli.pkg
68847>>>>>>>Use SQL.pkg
68847>>>>>>>
68847>>>>>>>//   Driver Indentification
68847>>>>>>>
68847>>>>>>>//   Error number constants
68847>>>>>>>
68847>>>>>>>
68847>>>>>>>//   Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
68847>>>>>>>
68847>>>>>>>
68847>>>>>>>
68847>>>>>>>
68847>>>>>>>
68847>>>>>>>
68847>>>>>>>// SQL Server spcific types.
68847>>>>>>>Define SQL_SS_TIMESTAMPOFFSET   for   (-155) //SQL server datetimeoffset type */
68847>>>>>>>Define SQL_SS_TIME2             for   (-154) //SQL server time type */
68847>>>>>>>Define SQL_SS_XML               for   (-152) //SQL server xml type */
68847>>>>>>>Define SQL_SS_VARIANT           for   (-150) //SQL server variant type */
68847>>>>>>>
68847>>>>>>>// SQL Server spcific types.
68847>>>>>>>Define SQL_TYPE_TIMESTAMP2      for   (-200) //SQL server datetime2 type */
68847>>>>>>>Define SQL_VARCHARMAX           for   (-201) //SQL server varchar(max) type */
68847>>>>>>>Define SQL_WVARCHARMAX          for   (-202) //SQL server wvarchar(max) type */
68847>>>>>>>Define SQL_VARBINARYMAX         for   (-203) //SQL server varbinary(max) type */
68847>>>>>>>Define SQL_TYPE_MONEY           for   (-204) //SQL server money type */
68847>>>>>>>Define SQL_TYPE_SMALLMONEY      for   (-205) //SQL server smallmoney type */
68847>>>>>>>Define SQL_TYPE_SMALLDATETIME   for   (-206) //SQL server smalldatetype type */
68847>>>>>>>
68847>>>>>>>
68847>>>>>>>//   MSSQL_SetConstraint <FileNum> <ConstraintText>
68847>>>>>>>//
68847>>>>>>>//     Setup a constraint for a file.
68847>>>>>>>
68847>>>>>>>
68847>>>>>>>Class cMSSQLHandler is a cCLIHandler
68848>>>>>>>    
68848>>>>>>>    Procedure Construct_Object
68850>>>>>>>        Forward Send Construct_Object
68852>>>>>>>        
68852>>>>>>>        Set psDriverID to MSSQLDRV_ID
68853>>>>>>>    End_Procedure
68854>>>>>>>    
68854>>>>>>>    
68854>>>>>>>    
68854>>>>>>>    //   Extract the list from the out connect string.
68854>>>>>>>    Function ExtractList String sOutConnStr Integer hoStore Returns Integer
68856>>>>>>>        String  sItem
68856>>>>>>>        Integer iStart
68856>>>>>>>        Integer iEnd
68856>>>>>>>        
68856>>>>>>>        If (hoStore = 0) ;            Move Current_object to hoStore
68859>>>>>>>        
68859>>>>>>>        Send Delete_Data to hoStore
68860>>>>>>>        Move (Pos("{", sOutConnStr)) to iStart
68861>>>>>>>        While (iStart > 0)
68865>>>>>>>            Move (Right(sOutConnStr, Length(sOutConnStr) - iStart)) to sOutConnStr
68866>>>>>>>            If (Left(sOutConnStr, 1) = "}") ;                Move 0 to iStart
68869>>>>>>>            Else Begin
68870>>>>>>>                Move (Pos(",", sOutConnStr)) to iStart
68871>>>>>>>                Move (Pos("}", sOutConnStr)) to iEnd
68872>>>>>>>                If ((iStart = 0) or (iEnd < iStart)) ;                    Move iEnd to iStart
68875>>>>>>>                
68875>>>>>>>                If (iStart > 0) ;                    Set Value of hoStore  (Item_Count(Current_Object)) to (Left(sOutConnStr, iStart - 1))
68878>>>>>>>                
68878>>>>>>>                If (iStart = iEnd) ;                    Move 0 to iStart
68881>>>>>>>            End
68881>>>>>>>>
68881>>>>>>>        Loop
68882>>>>>>>>
68882>>>>>>>        
68882>>>>>>>        Function_Return (Item_Count(hoStore))
68883>>>>>>>    End_Function
68884>>>>>>>    
68884>>>>>>>    
68884>>>>>>>    
68884>>>>>>>    //   Call the driver's browse connect function
68884>>>>>>>    Function BrowseConnect String sInConnStr Returns String
68886>>>>>>>        String  sDriver
68886>>>>>>>        String  sOutConnStr
68886>>>>>>>        Integer iArg
68886>>>>>>>        Integer iRetval
68886>>>>>>>        
68886>>>>>>>        Get psDriverID to sDriver
68887>>>>>>>        If (sDriver <> "") Begin
68889>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
68890>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
68895>>>>>>>        End
68895>>>>>>>>
68895>>>>>>>        
68895>>>>>>>        Function_Return sOutConnStr
68896>>>>>>>    End_Function// BrowseConnect
68897>>>>>>>    
68897>>>>>>>    
68897>>>>>>>    Function BrowseConnectLocal String sInConnStr Returns String
68899>>>>>>>        String  sDriver
68899>>>>>>>        String  sOutConnStr
68899>>>>>>>        Integer iArg
68899>>>>>>>        Integer iRetval
68899>>>>>>>        
68899>>>>>>>        Move 1 to iArg // Browses only local
68900>>>>>>>        
68900>>>>>>>        Get psDriverID to sDriver
68901>>>>>>>        If (sDriver <> "") Begin
68903>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
68904>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
68909>>>>>>>        End
68909>>>>>>>>
68909>>>>>>>        
68909>>>>>>>        Function_Return sOutConnStr
68910>>>>>>>    End_Function// BrowseConnect
68911>>>>>>>    
68911>>>>>>>    
68911>>>>>>>    Function EnumerateServersNetworkOrLocal Integer iNetworkLocal  Returns Integer
68913>>>>>>>        
68913>>>>>>>        String  sServerList
68913>>>>>>>        Integer iNumServers
68913>>>>>>>        Integer iDriver
68913>>>>>>>        Integer iClientVersion
68913>>>>>>>        String  sDriver
68913>>>>>>>        
68913>>>>>>>        Get DriverIndex MSSQLDRV_ID to iDriver
68914>>>>>>>        
68914>>>>>>>        If (iDriver) Begin
68916>>>>>>>            
68916>>>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iDriver to iClientVersion
68919>>>>>>>            
68919>>>>>>>            Get SqlServerClientDriverName iClientVersion to sDriver
68920>>>>>>>            
68920>>>>>>>            Move ("DRIVER={" + sDriver + "};") to sDriver
68921>>>>>>>            If (iNetworkLocal = 0) Begin
68923>>>>>>>                Get BrowseConnect sDriver to sServerList
68924>>>>>>>            End
68924>>>>>>>>
68924>>>>>>>            Else Begin
68925>>>>>>>                Get BrowseConnectLocal sDriver to sServerList
68926>>>>>>>            End
68926>>>>>>>>
68926>>>>>>>            Get ExtractList sServerList Current_object to iNumServers
68927>>>>>>>        End
68927>>>>>>>>
68927>>>>>>>        
68927>>>>>>>        Function_Return iNumServers
68928>>>>>>>        
68928>>>>>>>    End_Function
68929>>>>>>>    
68929>>>>>>>    //   Enumerate the available SQL Server database servers
68929>>>>>>>    //   This function will return all SQL Server instances on the network.
68929>>>>>>>    //   This may take a long time.
68929>>>>>>>    //   To enumerate only local SQL Server instances use EnumerateServersLocal
68929>>>>>>>    Function EnumerateServers Returns Integer
68931>>>>>>>        
68931>>>>>>>        Integer iNumServers
68931>>>>>>>        Integer iNetworkLocal
68931>>>>>>>        
68931>>>>>>>        Move 0 to iNetworkLocal // 0 = enumerate network servers
68932>>>>>>>        
68932>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
68933>>>>>>>        
68933>>>>>>>        Function_Return iNumServers
68934>>>>>>>        
68934>>>>>>>    End_Function
68935>>>>>>>    
68935>>>>>>>    
68935>>>>>>>    //   Enumerate the available SQL Server database servers
68935>>>>>>>    //   This function will return only return SQL Server instance on the local machine
68935>>>>>>>    //   To enumerate all SQL Server instances in a network use EnumerateServers
68935>>>>>>>    Function EnumerateServersLocal Returns Integer
68937>>>>>>>        
68937>>>>>>>        Integer iNumServers
68937>>>>>>>        Integer iNetworkLocal
68937>>>>>>>        
68937>>>>>>>        Move 1 to iNetworkLocal // 1 = enumerate local servers
68938>>>>>>>        
68938>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
68939>>>>>>>        
68939>>>>>>>        Function_Return iNumServers
68940>>>>>>>        
68940>>>>>>>    End_Function
68941>>>>>>>    
68941>>>>>>>    
68941>>>>>>>    
68941>>>>>>>    //   Enumerate database in a given server.
68941>>>>>>>    Function EnumerateDatabases String sServer String sUser String sPassWord Returns Integer
68943>>>>>>>        Integer hoSQL
68943>>>>>>>        String  sConnect
68943>>>>>>>        String  sDatabase
68943>>>>>>>        Integer hdbc
68943>>>>>>>        Integer hstmt
68943>>>>>>>        Integer iFetchResult
68943>>>>>>>        
68943>>>>>>>        If (Num_Arguments < 3) ;            Move "" to sPassWord
68946>>>>>>>        If (Num_Arguments < 2) ;            Move "" to sUser
68949>>>>>>>        
68949>>>>>>>        If (sUser <> "") ;            Move ("SERVER=" + Trim(sServer) + ";UID=" + Trim(sUser) + ";PWD=" + Trim(sPassword) + ";") to sConnect
68952>>>>>>>        Else ;            Move ("SERVER=" + Trim(sServer) + ";Trusted_Connection=yes") to sConnect
68954>>>>>>>        
68954>>>>>>>        Object oEnumDBSQLmanager is a cSQLHandleManager
68956>>>>>>>            Move Current_Object to hoSQL
68957>>>>>>>        End_Object
68958>>>>>>>        
68958>>>>>>>        If (hoSQL <> 0) Begin
68960>>>>>>>            Get SQLConnect of hoSQL "MSSQLDRV" sConnect to hdbc
68961>>>>>>>            If (hdbc <> 0) Begin
68963>>>>>>>                Get SQLOpen of hdbc to hstmt
68964>>>>>>>                If (hstmt <> 0) Begin
68966>>>>>>>                    //   We could do a direct select on the sysdatabases table but we use
68966>>>>>>>                    //   the stored procedure sp_database instead. SQL Server recommends this
68966>>>>>>>                    //   approach in case meta data might change, the stored procedure will
68966>>>>>>>                    //   stay the same.
68966>>>>>>>                    Send SQLSetProcedureName to hstmt "sp_databases"
68967>>>>>>>                    Send SQLCall to hstmt
68968>>>>>>>                    Repeat
68968>>>>>>>>
68968>>>>>>>                        Get SQLFetch of hstmt to iFetchResult
68969>>>>>>>                        If (iFetchResult <> 0) Begin
68971>>>>>>>                            Get SQLColumnValue of hstmt 1 to sDatabase
68972>>>>>>>                            Set Value  (Item_Count(Current_Object)) to sDatabase
68973>>>>>>>                        End
68973>>>>>>>>
68973>>>>>>>                    Until (iFetchResult = 0)
68975>>>>>>>                    
68975>>>>>>>                    Send SQLClose to hstmt
68976>>>>>>>                End
68976>>>>>>>>
68976>>>>>>>                Send SQLDisconnect to hdbc
68977>>>>>>>            End
68977>>>>>>>>
68977>>>>>>>        End
68977>>>>>>>>
68977>>>>>>>        Send Destroy_Object to hoSQL
68978>>>>>>>        
68978>>>>>>>        Function_Return (Item_Count(Current_Object))
68979>>>>>>>    End_Function
68980>>>>>>>    
68980>>>>>>>    
68980>>>>>>>    Function SqlServerClientVersionName Integer iClientVersion  Returns String
68982>>>>>>>        
68982>>>>>>>        String  sSqlServerClientVersionName
68982>>>>>>>        
68982>>>>>>>        
68982>>>>>>>        Case Begin
68982>>>>>>>            
68982>>>>>>>            Case (iClientVersion = SQLSERVER2017CLIENT)
68984>>>>>>>                Move SQLSERVER2017CLIENTNAME to sSqlServerClientVersionName
68985>>>>>>>                Case Break
68986>>>>>>>                
68986>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
68989>>>>>>>                Move SQLSERVER2016CLIENTNAME to sSqlServerClientVersionName
68990>>>>>>>                Case Break
68991>>>>>>>            
68991>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
68994>>>>>>>                Move SQLSERVER2014CLIENTNAME to sSqlServerClientVersionName
68995>>>>>>>                Case Break
68996>>>>>>>            
68996>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
68999>>>>>>>                Move SQLSERVER2012CLIENTNAME to sSqlServerClientVersionName
69000>>>>>>>                Case Break
69001>>>>>>>            
69001>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
69004>>>>>>>                Move SQLSERVER2008CLIENTNAME to sSqlServerClientVersionName
69005>>>>>>>                Case Break
69006>>>>>>>            
69006>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
69009>>>>>>>                Move SQLSERVER2005CLIENTNAME to sSqlServerClientVersionName
69010>>>>>>>                Case Break
69011>>>>>>>            
69011>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
69014>>>>>>>                Move SQLSERVER2000CLIENTNAME to sSqlServerClientVersionName
69015>>>>>>>                Case Break
69016>>>>>>>            
69016>>>>>>>            Case Else
69016>>>>>>>                Move SQLSERVERUNKNOWNCLIENTNAME to sSqlServerClientVersionName
69017>>>>>>>                
69017>>>>>>>        Case End
69017>>>>>>>        
69017>>>>>>>        
69017>>>>>>>        Function_Return sSqlServerClientVersionName
69018>>>>>>>        
69018>>>>>>>    End_Function
69019>>>>>>>
69019>>>>>>>
69019>>>>>>>    Function SqlServerClientDriverName Integer iClientVersion  Returns String
69021>>>>>>>        
69021>>>>>>>        String  sSqlServerClientDriverName
69021>>>>>>>        
69021>>>>>>>        Case Begin
69021>>>>>>>            
69021>>>>>>>            Case (iClientVersion = SQLSERVER2017CLIENT)
69023>>>>>>>                Move SQLSERVER2017DRVRSTR to sSqlServerClientDriverName
69024>>>>>>>                Case Break
69025>>>>>>>                
69025>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
69028>>>>>>>                Move SQLSERVER2016DRVRSTR to sSqlServerClientDriverName
69029>>>>>>>                Case Break
69030>>>>>>>            
69030>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
69033>>>>>>>                Move SQLSERVER2014DRVRSTR to sSqlServerClientDriverName
69034>>>>>>>                Case Break
69035>>>>>>>            
69035>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
69038>>>>>>>                Move SQLSERVER2012DRVRSTR to sSqlServerClientDriverName
69039>>>>>>>                Case Break
69040>>>>>>>            
69040>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
69043>>>>>>>                Move SQLSERVER2008DRVRSTR to sSqlServerClientDriverName
69044>>>>>>>                Case Break
69045>>>>>>>            
69045>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
69048>>>>>>>                Move SQLSERVER2005DRVRSTR to sSqlServerClientDriverName
69049>>>>>>>                Case Break
69050>>>>>>>            
69050>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
69053>>>>>>>                Move SQLSERVER2000DRVRSTR to sSqlServerClientDriverName
69054>>>>>>>                Case Break
69055>>>>>>>            
69055>>>>>>>            Case Else
69055>>>>>>>                Move SQLSERVER2000DRVRSTR to sSqlServerClientDriverName
69056>>>>>>>                
69056>>>>>>>        Case End
69056>>>>>>>        
69056>>>>>>>        
69056>>>>>>>        Function_Return sSqlServerClientDriverName
69057>>>>>>>        
69057>>>>>>>    End_Function
69058>>>>>>>    
69058>>>>>>>    
69058>>>>>>>End_Class
69059>>>>>>>
69059>>>>>>>
69059>>>>>
69059>>>>>
69059>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
69060>>>>>
69060>>>>>Register_Function phoWorkspace Returns Handle
69060>>>>>Register_Function Help_filename Returns String
69060>>>>>Register_Function GetHelpFile Returns String
69060>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
69060>>>>>
69060>>>>>//    This function reads the current username Of windows and returns that
69060>>>>>//    name or an text unknown user
69060>>>>>Function Network_User_Name for cDesktop Returns String
69062>>>>>    String sName
69062>>>>>    Integer iRetval iLength
69062>>>>>    
69062>>>>>    Move 0 to iLength
69063>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
69064>>>>>    Move (ZeroString(iLength)) to sName
69065>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
69066>>>>>    
69066>>>>>    If (iRetval = NO_ERROR) Begin
69068>>>>>        Function_Return (CString (sName))
69069>>>>>    End
69069>>>>>>
69069>>>>>    
69069>>>>>    Function_Return "User Unknown"
69070>>>>>End_Function
69071>>>>>
69071>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
69072>>>>>
69072>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
69073>>>>>
69073>>>>>Class SysinfoDisplay is a cTextEdit
69074>>>>>    Procedure Construct_Object
69076>>>>>        Forward Send Construct_Object
69078>>>>>        
69078>>>>>        Set Location to 6 6
69079>>>>>        Set Size to 110 255
69080>>>>>        Set Read_Only_State to True
69081>>>>>        Set pbWrap to False
69082>>>>>    End_Procedure
69083>>>>>    
69083>>>>>    //    This method will show the name Of the current directory in the system
69083>>>>>    //    information box
69083>>>>>    Procedure Show_Current_Directory
69085>>>>>        String sDir
69085>>>>>        
69085>>>>>        Get_Current_Directory to sDir
69086>>>>>        
69086>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
69087>>>>>    End_Procedure
69088>>>>>    
69088>>>>>    Procedure Show_Windows_Directory
69090>>>>>        String sWindir
69090>>>>>        
69090>>>>>        Get_Windows_Directory to sWindir
69091>>>>>        
69091>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
69092>>>>>    End_Procedure
69093>>>>>    
69093>>>>>    Procedure Show_Current_User
69095>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
69096>>>>>    End_Procedure
69097>>>>>    
69097>>>>>    Procedure Show_Number_Format
69099>>>>>        Integer iFormat
69099>>>>>        String sFormatText
69099>>>>>        
69099>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
69102>>>>>        Move (Character (iFormat)) to sFormatText
69103>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
69104>>>>>        
69104>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
69107>>>>>        Move (Character (iFormat)) to sFormatText
69108>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
69109>>>>>    End_Procedure
69110>>>>>    
69110>>>>>    Procedure Show_Filelist_Name
69112>>>>>        String sFilename
69112>>>>>        
69112>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
69115>>>>>        
69115>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
69116>>>>>        Send AppendTextLn ""
69117>>>>>    End_Procedure
69118>>>>>    
69118>>>>>    Procedure Show_Lock_Delay
69120>>>>>        Integer iLockdelay
69120>>>>>        
69120>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
69123>>>>>        
69123>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
69124>>>>>    End_Procedure
69125>>>>>    
69125>>>>>    Procedure Show_Lock_Timeout
69127>>>>>        Integer iLockTimeout
69127>>>>>        
69127>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
69130>>>>>        
69130>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
69131>>>>>    End_Procedure
69132>>>>>    
69132>>>>>    Procedure Show_Screen_Size
69134>>>>>        Integer iYscreensize iXscreensize
69134>>>>>        
69134>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) to iXscreensize
69135>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) to iYscreensize
69136>>>>>        
69136>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
69137>>>>>    End_Procedure
69138>>>>>    
69138>>>>>    Procedure Show_Page_Size
69140>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
69141>>>>>    End_Procedure
69142>>>>>    
69142>>>>>    Procedure Show_Date
69144>>>>>        Date dToday
69144>>>>>        
69144>>>>>        Move (CurrentDateTime()) to  dToday
69145>>>>>        
69145>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
69146>>>>>    End_Procedure
69147>>>>>    
69147>>>>>    Procedure Show_Date_Format
69149>>>>>        Integer iDateFormat
69149>>>>>        String sDateFormat
69149>>>>>        
69149>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
69152>>>>>        Case Begin
69152>>>>>            Case (iDateFormat = DF_DATE_USA)
69154>>>>>                Move C_$USA to sDateFormat
69155>>>>>                Case Break
69156>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
69159>>>>>                Move C_$European to sDateFormat
69160>>>>>                Case Break
69161>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
69164>>>>>                Move C_$Military to sDateFormat
69165>>>>>                Case Break
69166>>>>>            Case Else
69166>>>>>                Move C_$UnknownDateType to sDateFormat
69167>>>>>                Case Break
69168>>>>>        Case End
69168>>>>>        
69168>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
69169>>>>>    End_Procedure
69170>>>>>    
69170>>>>>    Procedure Show_Systemresources
69172>>>>>        tWinMemoryStatusEx MemoryStatusInfo
69172>>>>>        tWinMemoryStatusEx MemoryStatusInfo
69172>>>>>        Integer iRetval
69172>>>>>        
69172>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
69173>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
69174>>>>>        If (iRetval = 0) Begin
69176>>>>>            Move (ShowLastError ()) to iRetval
69177>>>>>        End
69177>>>>>>
69177>>>>>        
69177>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
69178>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
69179>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Integer ( Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0)))
69180>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Integer ( Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0)))
69181>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Integer ( Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0)))
69182>>>>>    End_Procedure
69183>>>>>    
69183>>>>>    Procedure Show_Registration
69185>>>>>        String sRegName
69185>>>>>        Integer iSN iMaxUsers
69185>>>>>        
69185>>>>>        Registration sRegName iSN
69186>>>>>>
69186>>>>>        
69186>>>>>        Get_Licensed_Max_Users to iMaxUsers
69187>>>>>        
69187>>>>>        Send AppendTextLn ""
69188>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
69189>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
69190>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
69191>>>>>    End_Procedure
69192>>>>>    
69192>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
69192>>>>>    // To the workspace object passing the an object and message To send back
69192>>>>>    // To this object. It is expected that the workspace object will send this
69192>>>>>    // message for every line Of information it wants displayed (passing the
69192>>>>>    // information To be displayed
69192>>>>>    Register_Procedure EnumerateWorkspaceData Handle hObjId Handle hmMessId
69192>>>>>    
69192>>>>>    Procedure Show_ServicePack
69194>>>>>        String sKey sVersionDescription sVersion
69194>>>>>        Handle hoRegistry
69194>>>>>        Boolean bExists bOpened
69194>>>>>        
69194>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
69195>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
69196>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
69197>>>>>        
69197>>>>>        Move C_DFVersionRegistryRoot to sKey
69198>>>>>        Get KeyExists of hoRegistry sKey to bExists
69199>>>>>        If (bExists) Begin
69201>>>>>            Get OpenKey of hoRegistry sKey to bOpened
69202>>>>>            If (bOpened) Begin
69204>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
69205>>>>>                If (bExists) Begin
69207>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
69208>>>>>                End
69208>>>>>>
69208>>>>>                
69208>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
69209>>>>>                If (bExists) Begin
69211>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
69212>>>>>                End
69212>>>>>>
69212>>>>>                Send CloseKey of hoRegistry
69213>>>>>            End
69213>>>>>>
69213>>>>>        End
69213>>>>>>
69213>>>>>        Send Destroy of hoRegistry
69214>>>>>        
69214>>>>>        If (sVersionDescription <> "") Begin
69216>>>>>            Send AppendTextLn (sVersionDescription * "-" * sVersion)
69217>>>>>            Send AppendTextLn ""
69218>>>>>        End
69218>>>>>>
69218>>>>>    End_Procedure
69219>>>>>    
69219>>>>>    
69219>>>>>    Procedure Show_WorkspaceInformation
69221>>>>>        Integer hoWorkspace
69221>>>>>        
69221>>>>>        If (ghoApplication <> 0) Begin
69223>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
69224>>>>>            If (hoWorkspace <> 0) Begin
69226>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
69227>>>>>                Send AppendTextLn ""
69228>>>>>            End
69228>>>>>>
69228>>>>>        End
69228>>>>>>
69228>>>>>    End_Procedure
69229>>>>>    
69229>>>>>    // If connection ids are used, we will send the message EnumerateConnections
69229>>>>>    // to the connection manager object passing the an object and message to send
69229>>>>>    // back to this object. It is expected that the connection manager object will
69229>>>>>    // send this message for every line Of information it wants displayed (passing
69229>>>>>    // the information To be displayed
69229>>>>>    Register_Procedure EnumerateConnections Integer hObjId Integer hmMessId
69229>>>>>    
69229>>>>>    Procedure Show_ConnectionIdInformation
69231>>>>>        If (ghoConnection > 0) Begin
69233>>>>>            Send AppendTextLn ""
69234>>>>>            Send EnumerateConnections of ghoConnection Self (RefProc(AppendTextLn))
69235>>>>>        End
69235>>>>>>
69235>>>>>    End_Procedure
69236>>>>>    
69236>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
69238>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
69239>>>>>    End_Function
69240>>>>>    
69240>>>>>    Procedure Show_Versions
69242>>>>>        Integer iVersion iRevision iBuild
69242>>>>>        
69242>>>>>        Version_Information iVersion iRevision iBuild
69244>>>>>        
69244>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
69245>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
69246>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
69247>>>>>    End_Procedure
69248>>>>>    
69248>>>>>    Function CKRevisionNumber String sDriverID Returns String
69250>>>>>        Handle hoCLIHandler
69250>>>>>        Handle hoDFBtrDrvHandler
69250>>>>>        String sCKRevision
69250>>>>>        
69250>>>>>        
69250>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
69252>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
69253>>>>>            Set psDriverID of hoCLIHandler to sDriverID
69254>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
69255>>>>>            Send Destroy of hoCLIHandler
69256>>>>>        End
69256>>>>>>
69256>>>>>        Else Begin
69257>>>>>            If (sDriverID = "DFBTRDRV") Begin
69259>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
69260>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
69261>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
69262>>>>>                Send Destroy of hoDFBtrDrvHandler
69263>>>>>            End
69263>>>>>>
69263>>>>>        End
69263>>>>>>
69263>>>>>        
69263>>>>>        Function_Return sCKRevision
69264>>>>>    End_Function
69265>>>>>    
69265>>>>>    
69265>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
69267>>>>>        
69267>>>>>        If (sDriverID = "DATAFLEX") Begin
69269>>>>>            Function_Return False
69270>>>>>        End
69270>>>>>>
69270>>>>>        
69270>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
69271>>>>>    End_Function
69272>>>>>    
69272>>>>>    
69272>>>>>    Procedure Show_Drivers
69274>>>>>        String sCurrentDriver sRevNumber
69274>>>>>        String sLoadedDrivers sClientDriver
69274>>>>>        Integer iNumberOfDrivers iCount iClientVersion iMSSQLIndex
69274>>>>>        Boolean bOK
69274>>>>>        Handle hoMsqlDrv
69274>>>>>        
69274>>>>>        Move "" to sLoadedDrivers
69275>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
69278>>>>>        For iCount from 1 to iNumberOfDrivers
69284>>>>>>
69284>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
69287>>>>>            If (sLoadedDrivers <> "") Begin
69289>>>>>                Move (Append (sLoadedDrivers, ", ")) to sLoadedDrivers
69290>>>>>            End
69290>>>>>>
69290>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
69291>>>>>            If (bOK) Begin
69293>>>>>                If (sCurrentDriver = "MSSQLDRV") Begin
69295>>>>>                    Move iCount to iMSSQLIndex
69296>>>>>                End
69296>>>>>>
69296>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
69297>>>>>                // if mssqldrv, show the client number
69297>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
69298>>>>>            End
69298>>>>>>
69298>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) to sLoadedDrivers
69299>>>>>        Loop
69300>>>>>>
69300>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
69301>>>>>        If (iMSSQLIndex>0) Begin
69303>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iMSSQLIndex to iClientVersion
69306>>>>>            Get Create (RefClass(cMSSQLHandler)) to hoMsqlDrv
69307>>>>>            Get SqlServerClientVersionName of hoMsqlDrv iClientVersion to sClientDriver
69308>>>>>            Send Destroy of hoMsqlDrv
69309>>>>>            Send AppendTextLn (SFormat("MSSQLDRV Client Version: %1", sClientDriver))
69310>>>>>        End
69310>>>>>>
69310>>>>>    End_Procedure
69311>>>>>    
69311>>>>>    Procedure Show_HelpFile
69313>>>>>        String sHelpFile
69313>>>>>        Integer eHelpType
69313>>>>>        
69313>>>>>        If (ghoApplication <> 0) Begin
69315>>>>>            Get peHelpType of ghoApplication to eHelpType
69316>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
69318>>>>>                Get GetHelpFile of ghoHtmlHelp to sHelpFile
69319>>>>>            End
69319>>>>>>
69319>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
69322>>>>>                Get Help_filename of Help_object_id to sHelpFile
69323>>>>>            End
69323>>>>>>
69323>>>>>            Else Begin
69324>>>>>                Move C_$ThereIsNoHelpfileDefined to sHelpFile
69325>>>>>            End
69325>>>>>>
69325>>>>>            
69325>>>>>            Send AppendTextLn ""
69326>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
69327>>>>>        End
69327>>>>>>
69327>>>>>    End_Procedure
69328>>>>>    
69328>>>>>    Procedure Show_EnterAsTab
69330>>>>>        Boolean bEnterKeyAsTabKey
69330>>>>>        String sText
69330>>>>>        
69330>>>>>        If (ghoApplication <> 0) Begin
69332>>>>>            Get pbEnterKeyAsTabKey of ghoApplication to bEnterKeyAsTabKey
69333>>>>>            If (bEnterKeyAsTabKey) Begin
69335>>>>>                Move "True" to sText
69336>>>>>            End
69336>>>>>>
69336>>>>>            Else Begin
69337>>>>>                Move "False" to sText
69338>>>>>            End
69338>>>>>>
69338>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
69339>>>>>        End
69339>>>>>>
69339>>>>>    End_Procedure
69340>>>>>    
69340>>>>>    //    During activation we will remove the old information and add the newly
69340>>>>>    //    found systeminformation
69340>>>>>    Procedure Add_Focus Integer hoRoot
69342>>>>>        Forward Send Add_Focus hoRoot
69344>>>>>        
69344>>>>>        Send Delete_Data
69345>>>>>        
69345>>>>>        Set Changed_State to False
69346>>>>>        Set Read_Only_State to True
69347>>>>>        
69347>>>>>        Send Show_ServicePack
69348>>>>>        Send Show_Versions
69349>>>>>        Send Show_Drivers
69350>>>>>        If (ghoConnection <> 0) Begin
69352>>>>>            Send Show_ConnectionIdInformation
69353>>>>>        End
69353>>>>>>
69353>>>>>        Send Show_HelpFile
69354>>>>>        Send Show_Current_Directory
69355>>>>>        Send Show_Filelist_Name
69356>>>>>        If (ghoApplication <> 0) Begin
69358>>>>>            Send Show_WorkSpaceInformation // added To show WS info
69359>>>>>        End
69359>>>>>>
69359>>>>>        Send Show_Current_User
69360>>>>>        Send Show_Windows_Directory
69361>>>>>        Send Show_Screen_Size
69362>>>>>        Send Show_Page_Size
69363>>>>>        Send Show_EnterAsTab
69364>>>>>        Send Show_Number_Format
69365>>>>>        Send Show_Date_Format
69366>>>>>        Send Show_Lock_Delay
69367>>>>>        Send Show_Lock_Timeout
69368>>>>>        Send Show_Date
69369>>>>>        Send Show_Systemresources
69370>>>>>        Send Show_Registration
69371>>>>>        Send Beginning_of_Data
69372>>>>>        
69372>>>>>        Set Icon to 'default.ico'
69373>>>>>    End_Procedure
69374>>>>>End_Class
69375>>>>>
69375>>>>>Class SysInfoDialog is a ModalPanel
69376>>>>>    Procedure Construct_Object
69378>>>>>        Forward Send Construct_Object
69380>>>>>        
69380>>>>>        Set Label to C_$SystemInformation
69381>>>>>        Set Size to 140 267
69382>>>>>        Set piMinSize to 140 267
69383>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69384>>>>>        Set Border_Style to Border_Thick
69385>>>>>        
69385>>>>>        Object oSysinfoDisplay is a SysInfoDisplay
69387>>>>>            Set peAnchors to anAll
69388>>>>>        End_Object
69389>>>>>        
69389>>>>>        Object oCloseButton is a Button
69391>>>>>            Set Label to C_$Close
69392>>>>>            Set Location to 120 210
69393>>>>>            Set Message 0 to (Refproc (Close_Panel))
69394>>>>>            Set Default_State to True
69395>>>>>            Set peAnchors to anBottomRight
69396>>>>>        End_Object
69397>>>>>        
69397>>>>>        On_Key kCancel Send Close_Panel
69398>>>>>    End_Procedure
69399>>>>>End_Class
69400>>>>>
69400>>>>>Class AboutDialog is a ModalPanel
69401>>>>>    Procedure Construct_Object
69403>>>>>        String sVdfRootDir
69403>>>>>        
69403>>>>>        Forward Send Construct_Object
69405>>>>>        
69405>>>>>        Set Label to C_$About
69406>>>>>        Set Size to 89 212
69407>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69408>>>>>        
69408>>>>>        Object oSysInfoDialog is a SysInfoDialog
69410>>>>>        End_Object
69411>>>>>        
69411>>>>>        Object oBox is a Container3d
69413>>>>>            Set Border_Style to Border_StaticEdge
69414>>>>>            Set Size to 63 202
69415>>>>>            Set Location to 4 5
69416>>>>>            
69416>>>>>            Object oAboutGraphic is a BitmapContainer
69418>>>>>                Set Border_Style to Border_None
69419>>>>>                Set Bitmap_Style to Bitmap_Center
69420>>>>>                Set Size to 48 48
69421>>>>>                Set Location to 7 2
69422>>>>>            End_Object
69423>>>>>            
69423>>>>>            Object oProductName is a TextBox
69425>>>>>                Set Label to C_$ProductName
69426>>>>>                Set Size to 10 45
69427>>>>>                Set Location to 8 53
69428>>>>>            End_Object
69429>>>>>            
69429>>>>>            Object oVersion is a TextBox
69431>>>>>                Set Label to C_$Version
69432>>>>>                Set Size to 10 25
69433>>>>>                Set Location to 21 53
69434>>>>>            End_Object
69435>>>>>            
69435>>>>>            Object oCopyright is a TextBox
69437>>>>>                Set Label to C_$Copyright
69438>>>>>                Set Size to 10 31
69439>>>>>                Set Location to 34 53
69440>>>>>            End_Object
69441>>>>>            
69441>>>>>            Object oAuthor is a TextBox
69443>>>>>                Set Label to C_$Author
69444>>>>>                Set Size to 10 22
69445>>>>>                Set Location to 46 53
69446>>>>>            End_Object
69447>>>>>        End_Object
69448>>>>>        
69448>>>>>        Object oOKButton is a Button
69450>>>>>            On_Item C_$OK Send Close_Panel
69451>>>>>            Set Size to 14 50
69452>>>>>            Set Location to 71 157
69453>>>>>        End_Object
69454>>>>>        
69454>>>>>        Object oSysInfoButton is a Button
69456>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
69457>>>>>            Set Size to 14 50
69458>>>>>            Set Location to 71 101
69459>>>>>        End_Object
69460>>>>>        
69460>>>>>        On_Key Kcancel Send KeyAction of oOKButton
69461>>>>>        
69461>>>>>        Set Logo to "DacAbout.bmp"  // square bitmaps Of 42x42 work best
69462>>>>>    End_Procedure
69463>>>>>    
69463>>>>>    Procedure Set ProductName String sProductName
69465>>>>>        Set Label of oProductName to sProductName
69466>>>>>    End_Procedure
69467>>>>>    
69467>>>>>    Procedure Set Version String sVersion
69469>>>>>        Set Label of oVersion to sVersion
69470>>>>>    End_Procedure
69471>>>>>    
69471>>>>>    Procedure Set Copyright String sCopyright
69473>>>>>        Set Label of oCopyright to sCopyright
69474>>>>>    End_Procedure
69475>>>>>    
69475>>>>>    Procedure Set Author String sAuthor
69477>>>>>        Set Label of oAuthor to sAuthor
69478>>>>>    End_Procedure
69479>>>>>    
69479>>>>>    Procedure Set Logo String sLogo
69481>>>>>        // square bitmaps Of 42x42 work best
69481>>>>>        Set Bitmap of oAboutGraphic to sLogo
69482>>>>>    End_Procedure
69483>>>>>    
69483>>>>>    Procedure Show_Sysinfo
69485>>>>>        Send Popup_Modal of oSysinfoDialog
69486>>>>>    End_Procedure
69487>>>>>    
69487>>>>>    Procedure End_Construct_Object
69489>>>>>        Handle hoVersionInfo
69489>>>>>        Boolean bIncluded
69489>>>>>        Integer iMajor iMinor iRelease iBuild
69489>>>>>        String sLabel
69489>>>>>        
69489>>>>>        Get Label of oVersion to sLabel
69490>>>>>        If (sLabel = C_$VERSION) Begin
69492>>>>>            // set it To the version info Of the program, if available
69492>>>>>            If (ghoApplication <> 0) Begin
69494>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
69495>>>>>                If (hoVersionInfo <> 0) Begin
69497>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
69498>>>>>                    If (bIncluded) Begin
69500>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
69501>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
69502>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
69503>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
69504>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
69505>>>>>                        Set Version to sLabel
69506>>>>>                    End
69506>>>>>>
69506>>>>>                End
69506>>>>>>
69506>>>>>            End
69506>>>>>>
69506>>>>>        End
69506>>>>>>
69506>>>>>        
69506>>>>>        Forward Send End_Construct_Object
69508>>>>>    End_Procedure
69509>>>>>End_Class
69510>>>
69510>>>//  This is the default message. It is expected that you will
69510>>>//  create your own message to override this
69510>>>Procedure Activate_About
69513>>>    Send DoAbout "" "" "" "" ""
69514>>>End_Procedure
69515>>>
69515>>>//  It is expected that you will send this message (most
69515>>>//  likely from Activate_About. This creates an about object, activates it
69515>>>//  and destroys it when done. It is not exepected that you will augment this.
69515>>>Procedure DoAbout String sTitle String sVersion String sCopyRight String sAuthor String sBitmap
69518>>>    Integer hoObj hoMain
69518>>>    
69518>>>    // create object
69518>>>    Object About is an AboutDialog
69520>>>        // if no title passed use the label of the main panel
69520>>>        // (if a main panel exists).
69520>>>        If (sTitle = "") Begin
69522>>>            Get Main_Window of desktop to hoMain
69523>>>            If hoMain ;                Get Label of hoMain to sTitle
69526>>>        End
69526>>>>
69526>>>        Set productname to sTitle
69527>>>        Set version     to sVersion
69528>>>        Set copyright   to sCopyRight
69529>>>        Set author      to sAuthor
69530>>>        If (sBitmap <> '') ;            Set logo to sBitMap // square bitmaps of 42x42 work best
69533>>>        Move Self to hoObj // object Id
69534>>>    End_Object
69535>>>    Send Popup   of hoObj    // popup the about object
69536>>>    Send Destroy of hoObj // when done, it will be destroyed
69537>>>End_Procedure
69538>>>
69538>        Use EmpEntry.vw
Including file: EmpEntry.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\EmpEntry.vw)
69538>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\EmpEntry.vw
69538>>>// EmpEntry
69538>>>//
69538>>>
69538>>>Use DFClient.pkg
69538>>>Use DFEntry.pkg
69538>>>
69538>>>Use cEmployeeDataDictionary.dd
Including file: cEmployeeDataDictionary.dd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\cEmployeeDataDictionary.dd)
69538>>>>>Use DataDict.pkg
69538>>>>>
69538>>>>>Open Employee
Including file: Employee.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\Employee.fd)
69540>>>>>Open PageHeader
Including file: PageHeader.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\PageHeader.fd)
69542>>>>>Open system
Including file: system.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\system.fd)
69544>>>>>
69544>>>>>Register_Object Employee_sl
69544>>>>>
69544>>>>>Class cEmployeeDataDictionary is a DataDictionary
69545>>>>>    
69545>>>>>    Procedure Construct_Object
69547>>>>>        Forward Send Construct_Object
69549>>>>>        Set Main_File to Employee.File_Number
69550>>>>>
69550>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69551>>>>>
69551>>>>>        Set Add_Client_File to PageHeader.File_Number
69552>>>>>
69552>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69553>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69554>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69555>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69556>>>>>
69556>>>>>        Set Field_Auto_Increment Field Employee.id to File_Field system.employee_id
69557>>>>>        Set Field_Prompt_Object Field Employee.id to Employee_sl
69558>>>>>
69558>>>>>    End_Procedure
69559>>>>>
69559>>>>>End_Class
69560>>>>>
69560>>>>>Use Employee.sl
Including file: Employee.sl    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\Employee.sl)
69560>>>>>>>// Employee.sl
69560>>>>>>>// Employee Lookup List
69560>>>>>>>
69560>>>>>>>Use DFClient.pkg
69560>>>>>>>Use cDbCJGridPromptList.pkg
69560>>>>>>>Use cDbCJGridColumn.pkg
69560>>>>>>>Use Windows.pkg
69560>>>>>>>
69560>>>>>>>Use cEmployeeDataDictionary.dd
69560>>>>>>>
69560>>>>>>>CD_Popup_Object Employee_sl is a dbModalPanel
69578>>>>>>>>
69578>>>>>>>    Set Location to 5 5
69579>>>>>>>    Set Size to 134 288
69580>>>>>>>    Set Label To "Employee Lookup List"
69581>>>>>>>    Set Border_Style to Border_Thick
69582>>>>>>>    Set Minimize_Icon to False
69583>>>>>>>
69583>>>>>>>
69583>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
69585>>>>>>>    End_Object 
69586>>>>>>>
69586>>>>>>>    Set Main_DD To oEmployee_DD
69587>>>>>>>    Set Server  To oEmployee_DD
69588>>>>>>>
69588>>>>>>>
69588>>>>>>>
69588>>>>>>>    Object oSelList is a cDbCJGridPromptList
69590>>>>>>>        Set Size to 105 278
69591>>>>>>>        Set Location to 5 5
69592>>>>>>>        Set peAnchors to anAll
69593>>>>>>>        Set psLayoutSection to "Employee_sl_oSelList"
69594>>>>>>>        Set Ordering to 1
69595>>>>>>>        Set pbAutoServer to True
69596>>>>>>>
69596>>>>>>>        Object oEmployee_id is a cDbCJGridColumn
69598>>>>>>>            Entry_Item Employee.id
69599>>>>>>>            Set piWidth to 46
69600>>>>>>>            Set psCaption to "id"
69601>>>>>>>        End_Object 
69602>>>>>>>
69602>>>>>>>        Object oEmployee_name is a cDbCJGridColumn
69604>>>>>>>            Entry_Item Employee.name
69605>>>>>>>            Set piWidth to 250
69606>>>>>>>            Set psCaption to "name"
69607>>>>>>>        End_Object 
69608>>>>>>>
69608>>>>>>>        Object oEmployee_id_card is a cDbCJGridColumn
69610>>>>>>>            Entry_Item Employee.id_card
69611>>>>>>>            Set piWidth to 150
69612>>>>>>>            Set psCaption to "id card"
69613>>>>>>>        End_Object 
69614>>>>>>>
69614>>>>>>>
69614>>>>>>>    End_Object 
69615>>>>>>>
69615>>>>>>>    Object oOk_bn is a Button
69617>>>>>>>        Set Label to "&Ok"
69618>>>>>>>        Set Location to 115 125
69619>>>>>>>        Set peAnchors to anBottomRight
69620>>>>>>>
69620>>>>>>>        Procedure OnClick
69623>>>>>>>            Send OK of oSelList
69624>>>>>>>        End_Procedure
69625>>>>>>>
69625>>>>>>>    End_Object 
69626>>>>>>>
69626>>>>>>>    Object oCancel_bn is a Button
69628>>>>>>>        Set Label to "&Cancel"
69629>>>>>>>        Set Location to 115 179
69630>>>>>>>        Set peAnchors to anBottomRight
69631>>>>>>>
69631>>>>>>>        Procedure OnClick
69634>>>>>>>            Send Cancel of oSelList
69635>>>>>>>        End_Procedure
69636>>>>>>>
69636>>>>>>>    End_Object 
69637>>>>>>>
69637>>>>>>>    Object oSearch_bn is a Button
69639>>>>>>>        Set Label to "&Search..."
69640>>>>>>>        Set Location to 115 233
69641>>>>>>>        Set peAnchors to anBottomRight
69642>>>>>>>
69642>>>>>>>        Procedure OnClick
69645>>>>>>>            Send Search of oSelList
69646>>>>>>>        End_Procedure
69647>>>>>>>
69647>>>>>>>    End_Object 
69648>>>>>>>
69648>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
69649>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
69650>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
69651>>>>>>>
69651>>>>>>>
69651>>>>>>>CD_End_Object // Employee_sl
69653>>>>>>>>
69653>>>
69653>>>ACTIVATE_VIEW Activate_oEmpEntry FOR oEmpEntry
69663>>>>
69663>>>Object oEmpEntry is a dbView
69665>>>    Set Location to 5 5
69666>>>    Set Size to 240 452
69667>>>    Set Label To "EmpEntry"
69668>>>    Set Border_Style to Border_Thick
69669>>>
69669>>>
69669>>>    Object oEmployee_DD is a cEmployeeDataDictionary
69671>>>    End_Object 
69672>>>
69672>>>    Set Main_DD To oEmployee_DD
69673>>>    Set Server  To oEmployee_DD
69674>>>
69674>>>
69674>>>
69674>>>    Object oEmployeeid is a dbForm
69676>>>        Entry_Item Employee.id
69677>>>        Set Size to 12 34
69678>>>        Set Location to 5 13
69679>>>        Set peAnchors to anTopLeftRight
69680>>>        Set Label to "id"
69681>>>        Set Label_Justification_mode to jMode_Left
69682>>>        Set Label_Col_Offset to 8
69683>>>        Set Label_row_Offset to 0
69684>>>    End_Object 
69685>>>
69685>>>    Object oEmployeename is a dbForm
69687>>>        Entry_Item Employee.name
69688>>>        Set Size to 12 250
69689>>>        Set Location to 5 72
69690>>>        Set peAnchors to anTopRight
69691>>>        Set Label to "name"
69692>>>        Set Label_Justification_mode to jMode_Left
69693>>>        Set Label_Col_Offset to 20
69694>>>        Set Label_row_Offset to 0
69695>>>    End_Object 
69696>>>
69696>>>    Object oEmployeeid_card is a dbForm
69698>>>        Entry_Item Employee.id_card
69699>>>        Set Size to 12 96
69700>>>        Set Location to 5 351
69701>>>        Set peAnchors to anTopRight
69702>>>        Set Label to "id card"
69703>>>        Set Label_Justification_mode to jMode_Left
69704>>>        Set Label_Col_Offset to 24
69705>>>        Set Label_row_Offset to 0
69706>>>    End_Object
69707>>>    
69707>>>    Object oDetailGrid is a cDbCJGrid
69709>>>        Set Size to 447 348
69710>>>        Set Location to 73 5
69711>>>        Set Server to oEmployee_DD
69712>>>        Set Ordering to 1
69713>>>        Set peAnchors to anAll
69714>>>        Set psLayoutSection to "oEmployeeEntry_oDetailGrid"
69715>>>        Set pbAllowInsertRow to False
69716>>>        Set pbHeaderPrompts to True
69717>>>        
69717>>>        
69717>>>        
69717>>>        Object oEmployeeId is a cDbCJGridColumn
69719>>>        Entry_Item Employee.id
69720>>>        Set piWidth to 78
69721>>>        Set psCaption to "Azonosito"
69722>>>        End_Object
69723>>>        
69723>>>        
69723>>>        
69723>>>        Object oEmployeeName is a cDbCJGridColumn
69725>>>        Entry_Item Employee.name
69726>>>        Set piWidth to 115
69727>>>        Set psCaption to "Nv"
69728>>>        End_Object
69729>>>        
69729>>>        
69729>>>        
69729>>>        Object oEmployeeIdCard is a cDbCJGridColumn
69731>>>        Entry_Item Employee.id_card
69732>>>        Set piWidth to 387
69733>>>        Set psCaption to "Szemlyig."
69734>>>        End_Object
69735>>>
69735>>>
69735>>>
69735>>>    End_Object
69736>>>    
69736>>>End_Object 
69737>        Use LineEntry.vw
Including file: LineEntry.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\LineEntry.vw)
69737>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\LineEntry.vw
69737>>>// LineEntry
69737>>>//
69737>>>
69737>>>Use DFClient.pkg
69737>>>Use DFEntry.pkg
69737>>>
69737>>>Use cLineDataDictionary.dd
Including file: cLineDataDictionary.dd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\cLineDataDictionary.dd)
69737>>>>>Use DataDict.pkg
69737>>>>>
69737>>>>>Open Line
Including file: Line.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\Line.fd)
69739>>>>>Open PageHeader
69741>>>>>Open system
69743>>>>>
69743>>>>>Object oTypeValid is a DescriptionValidationTable
69745>>>>>    Procedure Fill_List
69748>>>>>        Forward Send Fill_List
69750>>>>>        Send Add_Table_Value "Type A" "Type A"
69751>>>>>        Send Add_Table_Value "Type B" "Type B"
69752>>>>>        Send Add_Table_Value "Type C" "Type C"
69753>>>>>        Send Add_Table_Value "Type D" "Type D"
69754>>>>>        Send Add_Table_Value "Type E" "Type E"
69755>>>>>    End_Procedure
69756>>>>>End_Object
69757>>>>>
69757>>>>>Register_Object Line_sl
69757>>>>>
69757>>>>>Class cLineDataDictionary is a DataDictionary
69758>>>>>    
69758>>>>>    Procedure Construct_Object
69760>>>>>        Forward Send Construct_Object
69762>>>>>        Set Main_File to Line.File_Number
69763>>>>>
69763>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69764>>>>>
69764>>>>>        Set Add_Client_File to PageHeader.File_Number
69765>>>>>
69765>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69766>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69767>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69768>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69769>>>>>
69769>>>>>        Set Field_Auto_Increment Field Line.id to File_Field system.line_id
69770>>>>>        Set Field_Prompt_Object Field Line.id to Line_sl
69771>>>>>
69771>>>>>        Set Field_Value_Table Field Line.type to oTypeValid
69772>>>>>
69772>>>>>    End_Procedure
69773>>>>>
69773>>>>>End_Class
69774>>>>>
69774>>>>>Use Line.sl
Including file: Line.sl    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\Line.sl)
69774>>>>>>>// Line.sl
69774>>>>>>>// Line Lookup List
69774>>>>>>>
69774>>>>>>>Use DFClient.pkg
69774>>>>>>>Use cDbCJGridPromptList.pkg
69774>>>>>>>Use cDbCJGridColumn.pkg
69774>>>>>>>Use Windows.pkg
69774>>>>>>>
69774>>>>>>>Use cLineDataDictionary.dd
69774>>>>>>>
69774>>>>>>>CD_Popup_Object Line_sl is a dbModalPanel
69792>>>>>>>>
69792>>>>>>>    Set Location to 5 5
69793>>>>>>>    Set Size to 134 72
69794>>>>>>>    Set Label To "Line Lookup List"
69795>>>>>>>    Set Border_Style to Border_Thick
69796>>>>>>>    Set Minimize_Icon to False
69797>>>>>>>
69797>>>>>>>
69797>>>>>>>    Object oLine_DD is a cLineDataDictionary
69799>>>>>>>    End_Object 
69800>>>>>>>
69800>>>>>>>    Set Main_DD To oLine_DD
69801>>>>>>>    Set Server  To oLine_DD
69802>>>>>>>
69802>>>>>>>
69802>>>>>>>
69802>>>>>>>    Object oSelList is a cDbCJGridPromptList
69804>>>>>>>        Set Size to 105 62
69805>>>>>>>        Set Location to 5 5
69806>>>>>>>        Set peAnchors to anAll
69807>>>>>>>        Set psLayoutSection to "Line_sl_oSelList"
69808>>>>>>>        Set Ordering to 1
69809>>>>>>>        Set pbAutoServer to True
69810>>>>>>>
69810>>>>>>>        Object oLine_id is a cDbCJGridColumn
69812>>>>>>>            Entry_Item Line.id
69813>>>>>>>            Set piWidth to 46
69814>>>>>>>            Set psCaption to "id"
69815>>>>>>>        End_Object 
69816>>>>>>>
69816>>>>>>>        Object oLine_type is a cDbCJGridColumn
69818>>>>>>>            Entry_Item Line.type
69819>>>>>>>            Set piWidth to 40
69820>>>>>>>            Set psCaption to "type"
69821>>>>>>>        End_Object 
69822>>>>>>>
69822>>>>>>>
69822>>>>>>>    End_Object 
69823>>>>>>>
69823>>>>>>>    Object oOk_bn is a Button
69825>>>>>>>        Set Label to "&Ok"
69826>>>>>>>        Set Location to 115 -91
69827>>>>>>>        Set peAnchors to anBottomRight
69828>>>>>>>
69828>>>>>>>        Procedure OnClick
69831>>>>>>>            Send OK of oSelList
69832>>>>>>>        End_Procedure
69833>>>>>>>
69833>>>>>>>    End_Object 
69834>>>>>>>
69834>>>>>>>    Object oCancel_bn is a Button
69836>>>>>>>        Set Label to "&Cancel"
69837>>>>>>>        Set Location to 115 -37
69838>>>>>>>        Set peAnchors to anBottomRight
69839>>>>>>>
69839>>>>>>>        Procedure OnClick
69842>>>>>>>            Send Cancel of oSelList
69843>>>>>>>        End_Procedure
69844>>>>>>>
69844>>>>>>>    End_Object 
69845>>>>>>>
69845>>>>>>>    Object oSearch_bn is a Button
69847>>>>>>>        Set Label to "&Search..."
69848>>>>>>>        Set Location to 115 17
69849>>>>>>>        Set peAnchors to anBottomRight
69850>>>>>>>
69850>>>>>>>        Procedure OnClick
69853>>>>>>>            Send Search of oSelList
69854>>>>>>>        End_Procedure
69855>>>>>>>
69855>>>>>>>    End_Object 
69856>>>>>>>
69856>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
69857>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
69858>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
69859>>>>>>>
69859>>>>>>>
69859>>>>>>>CD_End_Object // Line_sl
69861>>>>>>>>
69861>>>
69861>>>ACTIVATE_VIEW Activate_oLineEntry FOR oLineEntry
69871>>>>
69871>>>Object oLineEntry is a dbView
69873>>>    Set Location to 5 5
69874>>>    Set Size to 22 138
69875>>>    Set Label To "LineEntry"
69876>>>    Set Border_Style to Border_Thick
69877>>>
69877>>>
69877>>>    Object oLine_DD is a cLineDataDictionary
69879>>>    End_Object 
69880>>>
69880>>>    Set Main_DD To oLine_DD
69881>>>    Set Server  To oLine_DD
69882>>>
69882>>>
69882>>>
69882>>>    Object oLineid is a dbForm
69884>>>        Entry_Item Line.id
69885>>>        Set Size to 12 55
69886>>>        Set Location to 5 13
69887>>>        Set peAnchors to anTopLeftRight
69888>>>        Set Label to "id"
69889>>>        Set Label_Justification_mode to jMode_Left
69890>>>        Set Label_Col_Offset to 8
69891>>>        Set Label_row_Offset to 0
69892>>>    End_Object 
69893>>>
69893>>>    Object oLinetype is a dbForm
69895>>>        Entry_Item Line.type
69896>>>        Set Size to 12 44
69897>>>        Set Location to 5 88
69898>>>        Set peAnchors to anTopRight
69899>>>        Set Label to "type"
69900>>>        Set Label_Justification_mode to jMode_Left
69901>>>        Set Label_Col_Offset to 16
69902>>>        Set Label_row_Offset to 0
69903>>>    End_Object 
69904>>>
69904>>>
69904>>>End_Object 
69905>        Use PageHeaderEntry.vw
Including file: PageHeaderEntry.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageHeaderEntry.vw)
69905>>>// C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageHeaderEntry.vw
69905>>>// PageHeaderEntry
69905>>>//
69905>>>
69905>>>Use DFClient.pkg
69905>>>Use DFEntry.pkg
69905>>>Use DfTabDlg.pkg
69905>>>
69905>>>Use cEmployeeDataDictionary.dd
69905>>>Use cLineDataDictionary.dd
69905>>>Use cPageHeaderDataDictionary.dd
Including file: cPageHeaderDataDictionary.dd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\cPageHeaderDataDictionary.dd)
69905>>>>>Use DataDict.pkg
69905>>>>>
69905>>>>>Open PageHeader
69907>>>>>Open Employee
69909>>>>>Open Line
69911>>>>>Open system
69913>>>>>Open PageFooter
Including file: PageFooter.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\PageFooter.fd)
69915>>>>>
69915>>>>>Register_Object PageHeader_sl
69915>>>>>
69915>>>>>Class cPageHeaderDataDictionary is a DataDictionary
69916>>>>>    
69916>>>>>    Procedure Construct_Object
69918>>>>>        Forward Send Construct_Object
69920>>>>>        Set Main_File to PageHeader.File_Number
69921>>>>>
69921>>>>>        Set Add_Client_File to PageFooter.File_Number
69922>>>>>
69922>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69923>>>>>
69923>>>>>        Set Add_Server_File to Employee.File_Number
69924>>>>>        Set Add_Server_File to Line.File_Number
69925>>>>>
69925>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69926>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69927>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69928>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69929>>>>>
69929>>>>>        Set Field_Auto_Increment Field PageHeader.id to File_Field system.page_header_id
69930>>>>>        Set Field_Prompt_Object Field PageHeader.id to PageHeader_sl
69931>>>>>
69931>>>>>    End_Procedure
69932>>>>>    
69932>>>>>    Procedure OnConstrain
69934>>>>>        Constrain PageHeader.Date Between "2020/1/1" and "2023/1/1"
69938>>>>>    End_Procedure
69939>>>>>
69939>>>>>End_Class
69940>>>>>
69940>>>>>Use PageHeader.sl
Including file: PageHeader.sl    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageHeader.sl)
69940>>>>>>>// PageHeader.sl
69940>>>>>>>// PageHeader Lookup List
69940>>>>>>>
69940>>>>>>>Use DFClient.pkg
69940>>>>>>>Use cDbCJGridPromptList.pkg
69940>>>>>>>Use cDbCJGridColumn.pkg
69940>>>>>>>Use Windows.pkg
69940>>>>>>>
69940>>>>>>>Use cEmployeeDataDictionary.dd
69940>>>>>>>Use cLineDataDictionary.dd
69940>>>>>>>Use cPageHeaderDataDictionary.dd
69940>>>>>>>
69940>>>>>>>CD_Popup_Object PageHeader_sl is a dbModalPanel
69958>>>>>>>>
69958>>>>>>>    Set Location to 5 5
69959>>>>>>>    Set Size to 134 126
69960>>>>>>>    Set Label To "PageHeader Lookup List"
69961>>>>>>>    Set Border_Style to Border_Thick
69962>>>>>>>    Set Minimize_Icon to False
69963>>>>>>>
69963>>>>>>>
69963>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
69965>>>>>>>    End_Object 
69966>>>>>>>
69966>>>>>>>    Object oLine_DD is a cLineDataDictionary
69968>>>>>>>    End_Object 
69969>>>>>>>
69969>>>>>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
69971>>>>>>>        Set DDO_Server To oEmployee_DD
69972>>>>>>>        Set DDO_Server To oLine_DD
69973>>>>>>>    End_Object 
69974>>>>>>>
69974>>>>>>>    Set Main_DD To oPageHeader_DD
69975>>>>>>>    Set Server  To oPageHeader_DD
69976>>>>>>>
69976>>>>>>>
69976>>>>>>>
69976>>>>>>>    Object oSelList is a cDbCJGridPromptList
69978>>>>>>>        Set Size to 105 116
69979>>>>>>>        Set Location to 5 5
69980>>>>>>>        Set peAnchors to anAll
69981>>>>>>>        Set psLayoutSection to "PageHeader_sl_oSelList"
69982>>>>>>>        Set Ordering to 1
69983>>>>>>>        Set pbAutoServer to True
69984>>>>>>>
69984>>>>>>>        Object oPageHeader_id is a cDbCJGridColumn
69986>>>>>>>            Entry_Item PageHeader.id
69987>>>>>>>            Set piWidth to 46
69988>>>>>>>            Set psCaption to "id"
69989>>>>>>>        End_Object 
69990>>>>>>>
69990>>>>>>>        Object oEmployee_id is a cDbCJGridColumn
69992>>>>>>>            Entry_Item Employee.id
69993>>>>>>>            Set piWidth to 81
69994>>>>>>>            Set psCaption to "employee id"
69995>>>>>>>        End_Object 
69996>>>>>>>
69996>>>>>>>        Object oLine_id is a cDbCJGridColumn
69998>>>>>>>            Entry_Item Line.id
69999>>>>>>>            Set piWidth to 48
70000>>>>>>>            Set psCaption to "line id"
70001>>>>>>>        End_Object 
70002>>>>>>>
70002>>>>>>>
70002>>>>>>>    End_Object 
70003>>>>>>>
70003>>>>>>>    Object oOk_bn is a Button
70005>>>>>>>        Set Label to "&Ok"
70006>>>>>>>        Set Location to 115 -37
70007>>>>>>>        Set peAnchors to anBottomRight
70008>>>>>>>
70008>>>>>>>        Procedure OnClick
70011>>>>>>>            Send OK of oSelList
70012>>>>>>>        End_Procedure
70013>>>>>>>
70013>>>>>>>    End_Object 
70014>>>>>>>
70014>>>>>>>    Object oCancel_bn is a Button
70016>>>>>>>        Set Label to "&Cancel"
70017>>>>>>>        Set Location to 115 17
70018>>>>>>>        Set peAnchors to anBottomRight
70019>>>>>>>
70019>>>>>>>        Procedure OnClick
70022>>>>>>>            Send Cancel of oSelList
70023>>>>>>>        End_Procedure
70024>>>>>>>
70024>>>>>>>    End_Object 
70025>>>>>>>
70025>>>>>>>    Object oSearch_bn is a Button
70027>>>>>>>        Set Label to "&Search..."
70028>>>>>>>        Set Location to 115 71
70029>>>>>>>        Set peAnchors to anBottomRight
70030>>>>>>>
70030>>>>>>>        Procedure OnClick
70033>>>>>>>            Send Search of oSelList
70034>>>>>>>        End_Procedure
70035>>>>>>>
70035>>>>>>>    End_Object 
70036>>>>>>>
70036>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
70037>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
70038>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
70039>>>>>>>
70039>>>>>>>
70039>>>>>>>CD_End_Object // PageHeader_sl
70041>>>>>>>>
70041>>>Use MonthCalendarPrompt.dg
Including file: MonthCalendarPrompt.dg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\MonthCalendarPrompt.dg)
70041>>>>>// Month Calendar Prompt dialog
70041>>>>>Use cMonthCalendarPrompt.pkg
Including file: cMonthCalendarPrompt.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cMonthCalendarPrompt.pkg)
70041>>>>>>>Use cMonthCalendar.pkg
Including file: cMonthCalendar.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cMonthCalendar.pkg)
70041>>>>>>>>>Use Windows.pkg
70041>>>>>>>>>Use Commctrl.pkg
70041>>>>>>>>>Use tWinStructs.pkg
70041>>>>>>>>>Use cWinControlEx.pkg
Including file: cWinControlEx.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cWinControlEx.pkg)
70041>>>>>>>>>>>Use cWinControl.pkg
Including file: cWinControl.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cWinControl.pkg)
70041>>>>>>>>>>>>>Use Windows.pkg
70041>>>>>>>>>>>>>
70041>>>>>>>>>>>>>// Key State Masks for Mouse Messages
70041>>>>>>>>>>>>>
70041>>>>>>>>>>>>>Define MK_LBUTTON  for |CI$0001
70041>>>>>>>>>>>>>Define MK_RBUTTON  for |CI$0002
70041>>>>>>>>>>>>>Define MK_SHIFT    for |CI$0004
70041>>>>>>>>>>>>>Define MK_CONTROL  for |CI$0008
70041>>>>>>>>>>>>>Define MK_MBUTTON  for |CI$0010
70041>>>>>>>>>>>>>Define MK_XBUTTON1 for |CI$0020
70041>>>>>>>>>>>>>Define MK_XBUTTON2 for |CI$0040
70041>>>>>>>>>>>>>
70041>>>>>>>>>>>>>Enum_List // Mouse Key Flags
70041>>>>>>>>>>>>>    Define mkLeft    for MK_LBUTTON
70041>>>>>>>>>>>>>    Define mkMiddle  for MK_MBUTTON
70041>>>>>>>>>>>>>    Define mkRight   for MK_RBUTTON
70041>>>>>>>>>>>>>    Define mkX1      for MK_XBUTTON1
70041>>>>>>>>>>>>>    Define mkX2      for MK_XBUTTON2
70041>>>>>>>>>>>>>    Define mkShift   for MK_SHIFT
70041>>>>>>>>>>>>>    Define mkControl for MK_CONTROL
70041>>>>>>>>>>>>>End_Enum_List
70041>>>>>>>>>>>>>
70041>>>>>>>>>>>>>Enum_List // Mouse Buttons. Used in OnMouseXXX messages
70041>>>>>>>>>>>>>    Define mbLeft
70041>>>>>>>>>>>>>    Define mbMiddle
70041>>>>>>>>>>>>>    Define mbRight
70041>>>>>>>>>>>>>    Define mbX1
70041>>>>>>>>>>>>>    Define mbX2
70041>>>>>>>>>>>>>End_Enum_List
70041>>>>>>>>>>>>>
70041>>>>>>>>>>>>>Class cWinControl is a DfBaseControl
70042>>>>>>>>>>>>>    Procedure Construct_Object
70044>>>>>>>>>>>>>        Forward Send Construct_Object
70046>>>>>>>>>>>>>        Property Integer private_pbEnabled True
70047>>>>>>>>>>>>>        Property Integer private_pbVisible True
70048>>>>>>>>>>>>>    End_Procedure
70049>>>>>>>>>>>>>    
70049>>>>>>>>>>>>>    Procedure End_Construct_Object
70051>>>>>>>>>>>>>        Forward Send End_Construct_Object
70053>>>>>>>>>>>>>        
70053>>>>>>>>>>>>>        Set External_Message WM_LBUTTONDOWN   to msg_OnWmLButtonDown
70054>>>>>>>>>>>>>        Set External_Message WM_MBUTTONDOWN   to msg_OnWmMButtonDown
70055>>>>>>>>>>>>>        Set External_Message WM_RBUTTONDOWN   to msg_OnWmRButtonDown
70056>>>>>>>>>>>>>        Set External_Message WM_LBUTTONUP     to msg_OnWmLButtonUp
70057>>>>>>>>>>>>>        Set External_Message WM_MBUTTONUP     to msg_OnWmMButtonUp
70058>>>>>>>>>>>>>        Set External_Message WM_RBUTTONUP     to msg_OnWmRButtonUp
70059>>>>>>>>>>>>>        Set External_Message WM_LBUTTONDBLCLK to msg_OnWmLButtonDblClk
70060>>>>>>>>>>>>>        Set External_Message WM_MBUTTONDBLCLK to msg_OnWmMButtonDblClk
70061>>>>>>>>>>>>>        Set External_Message WM_RBUTTONDBLCLK to msg_OnWmRButtonDblClk
70062>>>>>>>>>>>>>        Set External_Message WM_MOUSEMOVE     to msg_OnWmMouseMove
70063>>>>>>>>>>>>>    End_Procedure
70064>>>>>>>>>>>>>    
70064>>>>>>>>>>>>>    Procedure Notify Longptr wParam Longptr lParam
70066>>>>>>>>>>>>>        //Intentionally cancelled
70066>>>>>>>>>>>>>    End_Procedure
70067>>>>>>>>>>>>>    
70067>>>>>>>>>>>>>    Procedure Command Integer wParam Integer lParam
70069>>>>>>>>>>>>>        //Intentionally cancelled
70069>>>>>>>>>>>>>    End_Procedure
70070>>>>>>>>>>>>>    
70070>>>>>>>>>>>>>    Procedure DoRecreateWindow
70072>>>>>>>>>>>>>        // Recreates the window
70072>>>>>>>>>>>>>        If (Window_Handle(Self)) Begin
70074>>>>>>>>>>>>>            // attempt to do this without disturbing the focus tree.
70074>>>>>>>>>>>>>            Send Page_delete // prior to 8.3 this was Send Page_Object 0
70075>>>>>>>>>>>>>            Send Page 1      //                       Send Page_Object 1
70076>>>>>>>>>>>>>        End
70076>>>>>>>>>>>>>>
70076>>>>>>>>>>>>>    End_Procedure
70077>>>>>>>>>>>>>    
70077>>>>>>>>>>>>>    Procedure DoUpdateWindow
70079>>>>>>>>>>>>>        // Forces windows to update the window by bypassing WM_PAINT
70079>>>>>>>>>>>>>        Handle hWnd
70079>>>>>>>>>>>>>        
70079>>>>>>>>>>>>>        Get Window_Handle to hWnd
70080>>>>>>>>>>>>>        If hWnd ;            Move (UpdateWindow(hWnd)) to hWnd
70083>>>>>>>>>>>>>    End_Procedure
70084>>>>>>>>>>>>>    
70084>>>>>>>>>>>>>    Procedure Page Integer iState
70086>>>>>>>>>>>>>        Set Window_Style to WS_DISABLED (private_pbEnabled(Self) =False)
70087>>>>>>>>>>>>>        Set Window_Style to WS_VISIBLE (private_pbVisible(Self))
70088>>>>>>>>>>>>>        Forward Send Page iState
70090>>>>>>>>>>>>>    End_Procedure
70091>>>>>>>>>>>>>    
70091>>>>>>>>>>>>>    Procedure OnWmLButtonUp Integer wParam Integer lParam
70093>>>>>>>>>>>>>        Integer x y eButton
70093>>>>>>>>>>>>>        
70093>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70094>>>>>>>>>>>>>        Move (Low(lParam)) to x
70095>>>>>>>>>>>>>        
70095>>>>>>>>>>>>>        Send OnMouseUp mbLeft x y wParam
70096>>>>>>>>>>>>>    End_Procedure
70097>>>>>>>>>>>>>    
70097>>>>>>>>>>>>>    Procedure OnWmMButtonUp Integer wParam Integer lParam
70099>>>>>>>>>>>>>        Integer x y eButton
70099>>>>>>>>>>>>>        
70099>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70100>>>>>>>>>>>>>        Move (Low(lParam)) to x
70101>>>>>>>>>>>>>        
70101>>>>>>>>>>>>>        Send OnMouseUp mbMiddle x y wParam
70102>>>>>>>>>>>>>    End_Procedure
70103>>>>>>>>>>>>>    
70103>>>>>>>>>>>>>    Procedure OnWmRButtonUp Integer wParam Integer lParam
70105>>>>>>>>>>>>>        Integer x y eButton
70105>>>>>>>>>>>>>        
70105>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70106>>>>>>>>>>>>>        Move (Low(lParam)) to x
70107>>>>>>>>>>>>>        
70107>>>>>>>>>>>>>        Send OnMouseUp mbRight x y wParam
70108>>>>>>>>>>>>>    End_Procedure
70109>>>>>>>>>>>>>    
70109>>>>>>>>>>>>>    Procedure OnWmLButtonDown Integer wParam Integer lParam
70111>>>>>>>>>>>>>        Integer x y eButton fKeys
70111>>>>>>>>>>>>>        
70111>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70112>>>>>>>>>>>>>        Move (Low(lParam)) to x
70113>>>>>>>>>>>>>        
70113>>>>>>>>>>>>>        Send OnMouseDown mbLeft x y wParam
70114>>>>>>>>>>>>>    End_Procedure
70115>>>>>>>>>>>>>    Procedure OnWmMButtonDown Integer wParam Integer lParam
70117>>>>>>>>>>>>>        Integer x y eButton
70117>>>>>>>>>>>>>        
70117>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70118>>>>>>>>>>>>>        Move (Low(lParam)) to x
70119>>>>>>>>>>>>>        
70119>>>>>>>>>>>>>        Send OnMouseDown mbMiddle x y wParam
70120>>>>>>>>>>>>>    End_Procedure
70121>>>>>>>>>>>>>    Procedure OnWmRButtonDown Integer wParam Integer lParam
70123>>>>>>>>>>>>>        Integer x y eButton
70123>>>>>>>>>>>>>        
70123>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70124>>>>>>>>>>>>>        Move (Low(lParam)) to x
70125>>>>>>>>>>>>>        
70125>>>>>>>>>>>>>        Send OnMouseDown mbRight x y wParam
70126>>>>>>>>>>>>>    End_Procedure
70127>>>>>>>>>>>>>    
70127>>>>>>>>>>>>>    Procedure OnWmLButtonDblClk Integer wParam Integer lParam
70129>>>>>>>>>>>>>        Integer x y eButton
70129>>>>>>>>>>>>>        
70129>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70130>>>>>>>>>>>>>        Move (Low(lParam)) to x
70131>>>>>>>>>>>>>        
70131>>>>>>>>>>>>>        Send OnMouseDoubleClick mbLeft x y wParam
70132>>>>>>>>>>>>>    End_Procedure
70133>>>>>>>>>>>>>    Procedure OnWmMButtonDblClk Integer wParam Integer lParam
70135>>>>>>>>>>>>>        Integer x y eButton
70135>>>>>>>>>>>>>        
70135>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70136>>>>>>>>>>>>>        Move (Low(lParam)) to x
70137>>>>>>>>>>>>>        
70137>>>>>>>>>>>>>        Send OnMouseDoubleClick mbMiddle x y wParam
70138>>>>>>>>>>>>>    End_Procedure
70139>>>>>>>>>>>>>    Procedure OnWmRButtonDblClk Integer wParam Integer lParam
70141>>>>>>>>>>>>>        Integer x y eButton
70141>>>>>>>>>>>>>        
70141>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70142>>>>>>>>>>>>>        Move (Low(lParam)) to x
70143>>>>>>>>>>>>>        
70143>>>>>>>>>>>>>        Send OnMouseDoubleClick mbRight x y wParam
70144>>>>>>>>>>>>>    End_Procedure
70145>>>>>>>>>>>>>    
70145>>>>>>>>>>>>>    Procedure OnWmMouseMove Integer wParam Integer lParam
70147>>>>>>>>>>>>>        Integer x y eButton
70147>>>>>>>>>>>>>        
70147>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70148>>>>>>>>>>>>>        Move (Low(lParam)) to x
70149>>>>>>>>>>>>>        
70149>>>>>>>>>>>>>        Send OnMouseMove x y wParam
70150>>>>>>>>>>>>>    End_Procedure
70151>>>>>>>>>>>>>    
70151>>>>>>>>>>>>>    Procedure OnMouseDown Integer eButton Integer x Integer y Integer fKeys
70153>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70153>>>>>>>>>>>>>        //String sButton
70153>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70153>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70153>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70153>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70153>>>>>>>>>>>>>        
70153>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
70153>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
70153>>>>>>>>>>>>>        //Showln 'OnMouseDown ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70153>>>>>>>>>>>>>    End_Procedure
70154>>>>>>>>>>>>>    
70154>>>>>>>>>>>>>    Procedure OnMouseUp Integer eButton Integer x Integer y Integer fKeys
70156>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70156>>>>>>>>>>>>>        //String sButton
70156>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70156>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70156>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70156>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70156>>>>>>>>>>>>>        
70156>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
70156>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
70156>>>>>>>>>>>>>        //Showln 'OnMouseUp ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70156>>>>>>>>>>>>>    End_Procedure
70157>>>>>>>>>>>>>    
70157>>>>>>>>>>>>>    Procedure OnMouseDoubleClick Integer eButton Integer x Integer y Integer fKeys
70159>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70159>>>>>>>>>>>>>        //String sButton
70159>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70159>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70159>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70159>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70159>>>>>>>>>>>>>        
70159>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
70159>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
70159>>>>>>>>>>>>>        //Showln 'OnMouseDblClk ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70159>>>>>>>>>>>>>    End_Procedure
70160>>>>>>>>>>>>>    
70160>>>>>>>>>>>>>    Procedure OnMouseMove Integer x Integer y Integer fKeys
70162>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70162>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70162>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70162>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70162>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70162>>>>>>>>>>>>>        
70162>>>>>>>>>>>>>        //Showln 'OnMouseMove ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70162>>>>>>>>>>>>>    End_Procedure
70163>>>>>>>>>>>>>    
70163>>>>>>>>>>>>>    Procedure Set pbEnabled Boolean bEnabled
70165>>>>>>>>>>>>>        Handle hWnd
70165>>>>>>>>>>>>>        
70165>>>>>>>>>>>>>        If (bEnabled <> private_pbEnabled(Self)) Begin
70167>>>>>>>>>>>>>            Set private_pbEnabled to bEnabled
70168>>>>>>>>>>>>>            Get Window_Handle to hWnd
70169>>>>>>>>>>>>>            If hWnd ;                Move (EnableWindow(hWnd, bEnabled)) to hWnd
70172>>>>>>>>>>>>>        End
70172>>>>>>>>>>>>>>
70172>>>>>>>>>>>>>    End_Procedure
70173>>>>>>>>>>>>>    Function pbEnabled Returns Boolean
70175>>>>>>>>>>>>>        Function_Return (private_pbEnabled(Self))
70176>>>>>>>>>>>>>    End_Function
70177>>>>>>>>>>>>>    
70177>>>>>>>>>>>>>    Procedure Set pbVisible Boolean bVisible
70179>>>>>>>>>>>>>        Handle  hWnd
70179>>>>>>>>>>>>>        Integer iVoid
70179>>>>>>>>>>>>>        
70179>>>>>>>>>>>>>        If (bVisible <> private_pbVisible(Self)) Begin
70181>>>>>>>>>>>>>            Set private_pbVisible to bVisible
70182>>>>>>>>>>>>>            Get Window_Handle to hWnd
70183>>>>>>>>>>>>>            If hWnd ;                Move (ShowWindow(hWnd, If (bVisible, SW_SHOWNA, SW_HIDE))) to iVoid
70186>>>>>>>>>>>>>        End
70186>>>>>>>>>>>>>>
70186>>>>>>>>>>>>>    End_Procedure
70187>>>>>>>>>>>>>    Function pbVisible Returns Boolean
70189>>>>>>>>>>>>>        Function_Return (private_pbVisible(Self))
70190>>>>>>>>>>>>>    End_Function
70191>>>>>>>>>>>>>    
70191>>>>>>>>>>>>>End_Class
70192>>>>>>>>>>>// This adds proper navigation and default button support for
70192>>>>>>>>>>>// external classes
70192>>>>>>>>>>>
70192>>>>>>>>>>>Class cWinControlEx is a cWinControl
70193>>>>>>>>>>>    Import_Class_Protocol Standard_Form_Mixin
70194>>>>>>>>>>>    Procedure Construct_Object
70196>>>>>>>>>>>        Forward Send Construct_Object
70198>>>>>>>>>>>        Send define_standard_Form_Mixin
70199>>>>>>>>>>>    End_Procedure
70200>>>>>>>>>>>    
70200>>>>>>>>>>>    Function item_count Integer iItem Returns Integer
70202>>>>>>>>>>>        Function_Return 1
70203>>>>>>>>>>>    End_Function
70204>>>>>>>>>>>    
70204>>>>>>>>>>>    Procedure External_SetFocus
70206>>>>>>>>>>>        Send notify_focus_change 1
70207>>>>>>>>>>>    End_Procedure
70208>>>>>>>>>>>    
70208>>>>>>>>>>>    Procedure External_KillFocus
70210>>>>>>>>>>>        Send notify_focus_change 0
70211>>>>>>>>>>>    End_Procedure
70212>>>>>>>>>>>    
70212>>>>>>>>>>>    Procedure End_Construct_Object
70214>>>>>>>>>>>        Forward Send End_Construct_Object
70216>>>>>>>>>>>        Set External_Message WM_SETFOCUS  to External_SetFocus
70217>>>>>>>>>>>        Set External_Message WM_KILLFOCUS to External_KillFocus
70218>>>>>>>>>>>    End_Procedure
70219>>>>>>>>>>>    
70219>>>>>>>>>>>End_Class
70220>>>>>>>>>>>
70220>>>>>>>>>
70220>>>>>>>>>Class cMonthCalendar is a cWinControlEx
70221>>>>>>>>>    Procedure Construct_Object
70223>>>>>>>>>        Integer iResult
70223>>>>>>>>>        tWinInitCommonControlsEX InitCC
70223>>>>>>>>>        tWinInitCommonControlsEX InitCC
70223>>>>>>>>>        
70223>>>>>>>>>        Forward Send Construct_Object
70225>>>>>>>>>        
70225>>>>>>>>>        Move (SizeOfType (tWinInitCommonControlsEX)) to InitCC.dwSize
70226>>>>>>>>>        Move ICC_DATE_CLASSES to InitCC.dwICC
70227>>>>>>>>>        Move (InitCommonControlsEx(AddressOf(InitCC))) to iResult
70228>>>>>>>>>        
70228>>>>>>>>>        Set External_Class_Name 'cMonthCalendar' to 'SysMonthCal32'
70229>>>>>>>>>        Set External_Message WM_LBUTTONDBLCLK to msg_OnLButtonDblClick
70230>>>>>>>>>        
70230>>>>>>>>>        Set Border_Style to Border_Normal
70231>>>>>>>>>        
70231>>>>>>>>>        Property Boolean pbNoToday False
70232>>>>>>>>>        Property Boolean pbNoTodayCircle False
70233>>>>>>>>>        Property Boolean pbMultiSelect False
70234>>>>>>>>>        Property Boolean pbWeekNumbers False
70235>>>>>>>>>        Property Integer piMaxSelectedCount 90
70236>>>>>>>>>        
70236>>>>>>>>>        // this is minimum Dialog units required for a single picker rectangle
70236>>>>>>>>>        Property Integer piMinWidth 0
70237>>>>>>>>>        Property Integer piMinHeight 0
70238>>>>>>>>>        
70238>>>>>>>>>        // stores initial date before control is activated
70238>>>>>>>>>        Property Date pdPrivateDate
70239>>>>>>>>>        // if multi-select, this is the end range
70239>>>>>>>>>        Property Date pdPrivateDate2
70240>>>>>>>>>        
70240>>>>>>>>>    End_Procedure
70241>>>>>>>>>    
70241>>>>>>>>>    // returns control's value when single select
70241>>>>>>>>>    Function SelectedDate Returns Date
70243>>>>>>>>>        tWinSystemTime CurrentSystemTime
70243>>>>>>>>>        tWinSystemTime CurrentSystemTime
70243>>>>>>>>>        Integer iRetval
70243>>>>>>>>>        DateTime dtSel
70243>>>>>>>>>        Handle hWnd
70243>>>>>>>>>        Get Window_Handle to hWnd
70244>>>>>>>>>        If (hWnd) Begin
70246>>>>>>>>>            Move (WindowsMessage (MCM_GETCURSEL, 0, AddressOf (CurrentSystemTime))) to iRetval
70247>>>>>>>>>            Move (DateSetDay(dtSel,CurrentSystemTime.wDay)) to dtSel
70248>>>>>>>>>            Move (DateSetMonth(dtSel,CurrentSystemTime.wMonth)) to dtSel
70249>>>>>>>>>            Move (DateSetYear(dtSel,CurrentSystemTime.wYear)) to dtSel
70250>>>>>>>>>        End
70250>>>>>>>>>>
70250>>>>>>>>>        Else Begin
70251>>>>>>>>>            Get pdPrivateDate to dtSel
70252>>>>>>>>>        End
70252>>>>>>>>>>
70252>>>>>>>>>        Function_Return (Date(dtSel))
70253>>>>>>>>>    End_Function
70254>>>>>>>>>    
70254>>>>>>>>>    // returns control's values when multi select
70254>>>>>>>>>    Function SelectedDateRange Returns Date[]
70256>>>>>>>>>        tWinSystemTime[2] CurrentSystemTime
70256>>>>>>>>>        tWinSystemTime[2] CurrentSystemTime
70257>>>>>>>>>        Integer iRetval
70257>>>>>>>>>        DateTime dtSel1 dtsel2
70257>>>>>>>>>        Date[] dtSel
70258>>>>>>>>>        Handle hWnd
70258>>>>>>>>>        Get Window_Handle to hWnd
70259>>>>>>>>>        If (hWnd) Begin
70261>>>>>>>>>            Move (WindowsMessage (MCM_GETSELRANGE, 0, AddressOf (CurrentSystemTime))) to iRetval
70262>>>>>>>>>            
70262>>>>>>>>>            Move (DateSetDay(dtSel1,CurrentSystemTime[0].wDay)) to dtSel1
70263>>>>>>>>>            Move (DateSetMonth(dtSel1,CurrentSystemTime[0].wMonth)) to dtSel1
70264>>>>>>>>>            Move (DateSetYear(dtSel1,CurrentSystemTime[0].wYear)) to dtSel1
70265>>>>>>>>>            
70265>>>>>>>>>            Move (DateSetDay(dtSel2,CurrentSystemTime[1].wDay)) to dtSel2
70266>>>>>>>>>            Move (DateSetMonth(dtSel2,CurrentSystemTime[1].wMonth)) to dtSel2
70267>>>>>>>>>            Move (DateSetYear(dtSel2,CurrentSystemTime[1].wYear)) to dtSel2
70268>>>>>>>>>            
70268>>>>>>>>>            Move dtSel1 to dtSel[0]
70269>>>>>>>>>            Move dtsel2 to dtSel[1]
70270>>>>>>>>>        End
70270>>>>>>>>>>
70270>>>>>>>>>        Else Begin
70271>>>>>>>>>            Get pdPrivateDate to dtSel[0]
70272>>>>>>>>>            Get pdPrivateDate2 to dtSel[1]
70273>>>>>>>>>        End
70273>>>>>>>>>>
70273>>>>>>>>>        Function_Return dtSel
70274>>>>>>>>>    End_Function
70275>>>>>>>>>    
70275>>>>>>>>>    // Set control's value when single select
70275>>>>>>>>>    Procedure SetSelectedDate Date dDate
70277>>>>>>>>>        tWinSystemTime CurrentSystemTime
70277>>>>>>>>>        tWinSystemTime CurrentSystemTime
70277>>>>>>>>>        Integer iRetval
70277>>>>>>>>>        Handle hWnd
70277>>>>>>>>>        
70277>>>>>>>>>        Get Window_Handle to hWnd
70278>>>>>>>>>        Set pdPrivateDate to dDate
70279>>>>>>>>>        If (hWnd) Begin
70281>>>>>>>>>            Move (DateGetDay(dDate)) to CurrentSystemTime.wDay
70282>>>>>>>>>            Move (DateGetMonth(dDate)) to CurrentSystemTime.wMonth
70283>>>>>>>>>            Move (DateGetYear(dDate)) to CurrentSystemTime.wYear
70284>>>>>>>>>            
70284>>>>>>>>>            Move (WindowsMessage (MCM_SETCURSEL, 0, AddressOf (CurrentSystemTime))) to iRetval
70285>>>>>>>>>        End
70285>>>>>>>>>>
70285>>>>>>>>>    End_Procedure
70286>>>>>>>>>    
70286>>>>>>>>>    // Set control's values when multi select
70286>>>>>>>>>    Procedure SetSelectedDateRange Date dDate Date dDate2
70288>>>>>>>>>        tWinSystemTime[] CurrentSystemTime
70288>>>>>>>>>        tWinSystemTime[] CurrentSystemTime
70289>>>>>>>>>        Integer iRetval
70289>>>>>>>>>        Handle hWnd
70289>>>>>>>>>        
70289>>>>>>>>>        Get Window_Handle to hWnd
70290>>>>>>>>>        Set pdPrivateDate to dDate
70291>>>>>>>>>        Set pdPrivateDate2 to dDate2
70292>>>>>>>>>        If (hWnd) Begin
70294>>>>>>>>>            Move (DateGetDay(dDate)) to CurrentSystemTime[0].wDay
70295>>>>>>>>>            Move (DateGetMonth(dDate)) to CurrentSystemTime[0].wMonth
70296>>>>>>>>>            Move (DateGetYear(dDate)) to CurrentSystemTime[0].wYear
70297>>>>>>>>>            
70297>>>>>>>>>            Move (DateGetDay(dDate2)) to CurrentSystemTime[1].wDay
70298>>>>>>>>>            Move (DateGetMonth(dDate2)) to CurrentSystemTime[1].wMonth
70299>>>>>>>>>            Move (DateGetYear(dDate2)) to CurrentSystemTime[1].wYear
70300>>>>>>>>>            
70300>>>>>>>>>            Move (WindowsMessage (MCM_SETSELRANGE, 0, AddressOf (CurrentSystemTime))) to iRetval
70301>>>>>>>>>        End
70301>>>>>>>>>>
70301>>>>>>>>>    End_Procedure
70302>>>>>>>>>    
70302>>>>>>>>>    // augment to set dates from control, so they can be accessed after the control is closed
70302>>>>>>>>>    Procedure Remove_Object
70304>>>>>>>>>        Date[] SelDate
70305>>>>>>>>>        If (pbMultiSelect(Self)) Begin
70307>>>>>>>>>            Get SelectedDateRange to SelDate
70308>>>>>>>>>            Set pdPrivateDate2 to SelDate[1]
70309>>>>>>>>>        End
70309>>>>>>>>>>
70309>>>>>>>>>        Else Begin
70310>>>>>>>>>            Get SelectedDate to SelDate[0]
70311>>>>>>>>>        End
70311>>>>>>>>>>
70311>>>>>>>>>        Set pdPrivateDate to SelDate[0]
70312>>>>>>>>>        Forward Send Remove_Object
70314>>>>>>>>>    End_Procedure
70315>>>>>>>>>    
70315>>>>>>>>>    Procedure Page Integer iState
70317>>>>>>>>>        Integer iRetval iSize iHeight iWidth
70317>>>>>>>>>        tWinRect WindowRect
70317>>>>>>>>>        tWinRect WindowRect
70317>>>>>>>>>        Date dDate dDate2
70317>>>>>>>>>        Handle hWnd
70317>>>>>>>>>        Integer  iMaxSelectedCount
70317>>>>>>>>>        Boolean bNoToday bWeekNumbers bMultiSelect bNoTodayCircle
70317>>>>>>>>>        
70317>>>>>>>>>        If (iState<>1) Begin
70319>>>>>>>>>            Forward Send Page iState
70321>>>>>>>>>            Procedure_Return
70322>>>>>>>>>        End
70322>>>>>>>>>>
70322>>>>>>>>>        
70322>>>>>>>>>        Set Icon to 'ActionCalendar.ico'
70323>>>>>>>>>        
70323>>>>>>>>>        Get pbNoToday to bNoToday
70324>>>>>>>>>        Get pbNoTodayCircle to bNoTodayCircle
70325>>>>>>>>>        Get pbMultiSelect to bMultiSelect
70326>>>>>>>>>        Get pbWeekNumbers to bWeekNumbers
70327>>>>>>>>>        Get piMaxSelectedCount to iMaxSelectedCount
70328>>>>>>>>>        
70328>>>>>>>>>        Set Window_Style MCS_MULTISELECT to bMultiSelect
70329>>>>>>>>>        Set Window_Style MCS_NOTODAY to bNoToday
70330>>>>>>>>>        Set Window_Style MCS_NOTODAYCIRCLE to bNoTodayCircle
70331>>>>>>>>>        Set Window_Style MCS_WEEKNUMBERS to bWeekNumbers
70332>>>>>>>>>        Forward Send Page iState
70334>>>>>>>>>        
70334>>>>>>>>>        Get Window_Handle to hWnd
70335>>>>>>>>>        // support double click
70335>>>>>>>>>        Move (SetClassLongPtr(hWnd,GCL_STYLE,CS_DBLCLKS ior CS_GLOBALCLASS)) to iRetval
70336>>>>>>>>>        // set range when multi select
70336>>>>>>>>>        Move (WindowsMessage(MCM_SETMAXSELCOUNT,iMaxSelectedCount,0)) to iRetval
70337>>>>>>>>>        
70337>>>>>>>>>        // store minimum size for calendar control and set the size to this by default
70337>>>>>>>>>        Move (WindowsMessage (MCM_GETMINREQRECT, 0, AddressOf(WindowRect))) to iRetval
70338>>>>>>>>>        Get GuiToDialog WindowRect.bottom WindowRect.right to iSize
70339>>>>>>>>>        Move (Hi(iSize)) to iHeight
70340>>>>>>>>>        Move (Low(iSize)) to iWidth
70341>>>>>>>>>        Set piMinWidth to iWidth
70342>>>>>>>>>        Set piMinHeight to iHeight
70343>>>>>>>>>        Set Size to iHeight iWidth
70344>>>>>>>>>        
70344>>>>>>>>>        // now that we are activated set starting date or date range
70344>>>>>>>>>        Get pdPrivateDate to dDate
70345>>>>>>>>>        If (pbMultiSelect(Self)) Begin
70347>>>>>>>>>            Get pdPrivateDate2 to dDate2
70348>>>>>>>>>            Send SetSelectedDateRange dDate dDate2
70349>>>>>>>>>        End
70349>>>>>>>>>>
70349>>>>>>>>>        Else Begin
70350>>>>>>>>>            Send SetSelectedDate dDate
70351>>>>>>>>>        End
70351>>>>>>>>>>
70351>>>>>>>>>    End_Procedure
70352>>>>>>>>>    
70352>>>>>>>>>    Procedure Notify Longptr wParam Longptr lParam
70354>>>>>>>>>        Integer iRetval
70354>>>>>>>>>        DateTime dtSel dtSel2
70354>>>>>>>>>        tWintagNMSelChange CalenderInfo
70354>>>>>>>>>        tWintagNMSelChange CalenderInfo
70354>>>>>>>>>        Boolean bMulti
70354>>>>>>>>>        
70354>>>>>>>>>        Move (MemCopy (AddressOf (CalenderInfo), lParam, SizeOfType (tWintagNMSelChange))) to iRetval
70355>>>>>>>>>        If (CalenderInfo.nmHdr.code = MCN_SELCHANGE) Begin
70357>>>>>>>>>            Get pbMultiSelect to bMulti
70358>>>>>>>>>            Move (DateSetDay(dtSel,CalenderInfo.stSelStart.wDay)) to dtSel
70359>>>>>>>>>            Move (DateSetMonth(dtSel,CalenderInfo.stSelStart.wMonth)) to dtSel
70360>>>>>>>>>            Move (DateSetYear(dtSel,CalenderInfo.stSelStart.wYear)) to dtSel
70361>>>>>>>>>            If bMulti Begin
70363>>>>>>>>>                Move (DateSetDay(dtSel,CalenderInfo.stSelEnd.wDay)) to dtSel2
70364>>>>>>>>>                Move (DateSetMonth(dtSel,CalenderInfo.stSelEnd.wMonth)) to dtSel2
70365>>>>>>>>>                Move (DateSetYear(dtSel,CalenderInfo.stSelEnd.wYear)) to dtSel2
70366>>>>>>>>>            End
70366>>>>>>>>>>
70366>>>>>>>>>            Send OnChange (Date(dtSel)) (Date(dtSel2))
70367>>>>>>>>>        End
70367>>>>>>>>>>
70367>>>>>>>>>    End_Procedure
70368>>>>>>>>>    
70368>>>>>>>>>    // sent whenever there is a selection change within the calendar
70368>>>>>>>>>    Procedure OnChange Date dDate Date dDate2
70370>>>>>>>>>    End_Procedure
70371>>>>>>>>>    
70371>>>>>>>>>    // sent when a click occurs in the calendar
70371>>>>>>>>>    Procedure OnClick
70373>>>>>>>>>    End_Procedure
70374>>>>>>>>>    
70374>>>>>>>>>    // sent when a double click occurs in the calendar
70374>>>>>>>>>    Procedure OnDoubleClick
70376>>>>>>>>>    End_Procedure
70377>>>>>>>>>    
70377>>>>>>>>>    // sends OnClick if the double click is on a calendar day
70377>>>>>>>>>    Procedure OnLButtonDblClick Integer wParam Integer lParam
70379>>>>>>>>>        Boolean bDayHit
70379>>>>>>>>>        Get MonthDayHit to bDayHit
70380>>>>>>>>>        If bDayHit Begin
70382>>>>>>>>>            Send OnDoubleClick
70383>>>>>>>>>        End
70383>>>>>>>>>>
70383>>>>>>>>>    End_Procedure
70384>>>>>>>>>    
70384>>>>>>>>>    // sends OnClick if the click is on a calendar day
70384>>>>>>>>>    Procedure OnWmLButtonUp Integer wParam Integer lParam
70386>>>>>>>>>        Boolean bDayHit
70386>>>>>>>>>        Get MonthDayHit to bDayHit
70387>>>>>>>>>        If bDayHit Begin
70389>>>>>>>>>            Send OnClick
70390>>>>>>>>>        End
70390>>>>>>>>>>
70390>>>>>>>>>    End_Procedure
70391>>>>>>>>>    
70391>>>>>>>>>    // returns true if the month calander is up and the mouse is over a day
70391>>>>>>>>>    Function MonthDayHit Returns Boolean
70393>>>>>>>>>        UInteger iRet
70393>>>>>>>>>        Move (WindowsMessage( MCM_GETCURRENTVIEW, 0, 0)) to iRet
70394>>>>>>>>>        If (iRet=MCMV_MONTH) Begin
70396>>>>>>>>>            Get HitTest to iRet
70397>>>>>>>>>            Function_Return (iRet=MCHT_CALENDARDATE)
70398>>>>>>>>>        End
70398>>>>>>>>>>
70398>>>>>>>>>        Function_Return False
70399>>>>>>>>>    End_Function
70400>>>>>>>>>    
70400>>>>>>>>>    // return what was hit in the control
70400>>>>>>>>>    Function HitTest Returns UInteger
70402>>>>>>>>>        tWinMCHitTestInfo HitInfo
70402>>>>>>>>>        tWinMCHitTestInfo HitInfo
70402>>>>>>>>>        Handle hWnd iRet
70402>>>>>>>>>        Integer iVoid
70402>>>>>>>>>        Pointer lpPt
70402>>>>>>>>>        tWinPoint Pt
70402>>>>>>>>>        tWinPoint Pt
70402>>>>>>>>>        Get Window_Handle to hWnd
70403>>>>>>>>>        Move (AddressOf(Pt)) to lpPt
70404>>>>>>>>>        Move (GetCursorPos(lpPt)) to iVoid
70405>>>>>>>>>        Move (ScreenToClient(hWnd, lpPt)) to iVoid
70406>>>>>>>>>        Move Pt to HitInfo.Pt
70407>>>>>>>>>        Move (SizeOfType(tWinMCHitTestInfo)) to HitInfo.cbSize
70408>>>>>>>>>        Move (WindowsMessage(MCM_HITTEST, 0, AddressOf(HitInfo))) to iRet
70409>>>>>>>>>        Function_Return HitInfo.uHit
70410>>>>>>>>>    End_Function
70411>>>>>>>>>    
70411>>>>>>>>>End_Class
70412>>>>>>>
70412>>>>>>>// peMouseSelectOk choices
70412>>>>>>>Enum_List
70412>>>>>>>    Define msoClick
70412>>>>>>>    Define msoDblClick
70412>>>>>>>    Define msoNone
70412>>>>>>>End_Enum_List
70412>>>>>>>
70412>>>>>>>// It is expected that this class will only be used inside of ModalPanel and
70412>>>>>>>// will be used as a prompt object component in a framework style application.
70412>>>>>>>// If you wish to Use a month calendar in some other non prompt situation,
70412>>>>>>>// use cMonthCalendar
70412>>>>>>>
70412>>>>>>>Class cMonthCalendarPrompt is a cMonthCalendar
70413>>>>>>>    
70413>>>>>>>    Procedure Construct_Object
70415>>>>>>>        
70415>>>>>>>        Forward Send Construct_Object
70417>>>>>>>        
70417>>>>>>>        Property Integer peUpdateMode umPromptValue
70418>>>>>>>        
70418>>>>>>>        Property Integer peMouseSelectOk msoClick
70419>>>>>>>        
70419>>>>>>>        Property Date pdSeedValue
70420>>>>>>>        
70420>>>>>>>        // if multi-select, this is the end range
70420>>>>>>>        Property Date pdSeedValue2
70421>>>>>>>        
70421>>>>>>>        Property Handle phmPromptUpdateCallback 0
70422>>>>>>>        
70422>>>>>>>        Property Integer phoInvokingObject
70423>>>>>>>        
70423>>>>>>>        Property Integer peStoredUpdateMode
70424>>>>>>>        Property Handle  phmStoredPromptUpdateCallback
70425>>>>>>>        Property Boolean pbStoredWeekNumbers
70426>>>>>>>        Property Boolean pbStoredNoToday
70427>>>>>>>        Property Boolean pbStoredNoTodayCircle
70428>>>>>>>        Property Boolean pbStoredMultiSelect
70429>>>>>>>        Property Integer piStoredMaxSelectedCount
70430>>>>>>>        Property Integer peStoredpeMouseSelectOk
70431>>>>>>>        
70431>>>>>>>        // internally set by list
70431>>>>>>>        // these must be set upon closing the list and can be used for manual list updates
70431>>>>>>>        Property Boolean pbCanceled
70432>>>>>>>        
70432>>>>>>>    End_Procedure
70433>>>>>>>    
70433>>>>>>>    Procedure OnStoreDefaults
70435>>>>>>>        Integer iVal
70435>>>>>>>        Boolean bVal
70435>>>>>>>        
70435>>>>>>>        Get peUpdateMode to iVal
70436>>>>>>>        Set peStoredUpdateMode to iVal
70437>>>>>>>        
70437>>>>>>>        Get phmPromptUpdateCallback to iVal
70438>>>>>>>        Set phmStoredPromptUpdateCallback to iVal
70439>>>>>>>        
70439>>>>>>>        Get pbMultiSelect to bVal
70440>>>>>>>        Set pbStoredMultiSelect to bVal
70441>>>>>>>        
70441>>>>>>>        Get pbNoToday to bVal
70442>>>>>>>        Set pbStoredNoToday to bVal
70443>>>>>>>        
70443>>>>>>>        Get pbNoTodayCircle to bVal
70444>>>>>>>        Set pbStoredNoTodayCircle to bVal
70445>>>>>>>        
70445>>>>>>>        Get pbWeekNumbers to bVal
70446>>>>>>>        Set pbStoredWeekNumbers to bVal
70447>>>>>>>        
70447>>>>>>>        Get piMaxSelectedCount to iVal
70448>>>>>>>        Set piStoredMaxSelectedCount to iVal
70449>>>>>>>        
70449>>>>>>>        Get peMouseSelectOk to iVal
70450>>>>>>>        Set peStoredpeMouseSelectOk to iVal
70451>>>>>>>        
70451>>>>>>>    End_Procedure
70452>>>>>>>    
70452>>>>>>>    Procedure OnRestoreDefaults
70454>>>>>>>        Integer iVal
70454>>>>>>>        Boolean bVal
70454>>>>>>>        
70454>>>>>>>        Get peStoredUpdateMode to iVal
70455>>>>>>>        Set peUpdateMode to iVal
70456>>>>>>>        
70456>>>>>>>        Get phmStoredPromptUpdateCallback to iVal
70457>>>>>>>        Set phmPromptUpdateCallback to iVal
70458>>>>>>>        
70458>>>>>>>        Get pbStoredMultiSelect to bVal
70459>>>>>>>        Set pbMultiSelect to bVal
70460>>>>>>>        
70460>>>>>>>        Get pbStoredNoToday to bVal
70461>>>>>>>        Set pbNoToday to bVal
70462>>>>>>>        
70462>>>>>>>        Get pbStoredNoTodayCircle to bVal
70463>>>>>>>        Set pbNoTodayCircle to bVal
70464>>>>>>>        
70464>>>>>>>        Get pbStoredWeekNumbers to bVal
70465>>>>>>>        Set pbWeekNumbers to bVal
70466>>>>>>>        
70466>>>>>>>        Get piStoredMaxSelectedCount to iVal
70467>>>>>>>        Set piMaxSelectedCount to iVal
70468>>>>>>>        
70468>>>>>>>        Get peStoredpeMouseSelectOk to iVal
70469>>>>>>>        Set peMouseSelectOk to iVal
70470>>>>>>>        
70470>>>>>>>    End_Procedure
70471>>>>>>>    
70471>>>>>>>    Procedure Add_Focus Handle hoParent Returns Integer
70473>>>>>>>        Integer eMode
70473>>>>>>>        Set pbCanceled to True // assume cancel unless changed
70474>>>>>>>        Get peUpdateMode to eMode
70475>>>>>>>        If (eMode<>umPromptNonInvoking) Begin
70477>>>>>>>            Send OnStoreDefaults
70478>>>>>>>        End
70478>>>>>>>>
70478>>>>>>>        Send InitializePrompt
70479>>>>>>>        Forward Send Add_Focus hoParent
70481>>>>>>>    End_Procedure
70482>>>>>>>    
70482>>>>>>>    // augment to send OnRestoreDefaults.
70482>>>>>>>    Procedure Release_Focus
70484>>>>>>>        Integer eUpdateMode
70484>>>>>>>        Get peUpdateMode to eUpdateMode
70485>>>>>>>        Forward Send Release_Focus
70487>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70489>>>>>>>            Send OnRestoreDefaults
70490>>>>>>>        End
70490>>>>>>>>
70490>>>>>>>    End_Procedure
70491>>>>>>>    
70491>>>>>>>    // This is only called in a successful close
70491>>>>>>>    Procedure ClosePrompt
70493>>>>>>>        Handle hoInvokingObject
70493>>>>>>>        Handle hmCallBack
70493>>>>>>>        Integer eUpdateMode
70493>>>>>>>        Date[] dDates
70494>>>>>>>        
70494>>>>>>>        Set pbCanceled to False
70495>>>>>>>        
70495>>>>>>>        Get peUpdateMode to eUpdateMode
70496>>>>>>>        // if non-invoking there is by definition, no move value out
70496>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70498>>>>>>>            
70498>>>>>>>            If (eUpdateMode=umPromptValue) Begin
70500>>>>>>>                Send OnMoveValueOutByValue
70501>>>>>>>            End
70501>>>>>>>>
70501>>>>>>>            Else If (eUpdateMode=umPromptCustom) Begin
70504>>>>>>>                Send OnMoveValueOutByCustom
70505>>>>>>>            End
70505>>>>>>>>
70505>>>>>>>            Get phmPromptUpdateCallback to hmCallBack
70506>>>>>>>            If hmCallBack Begin
70508>>>>>>>                Get phoInvokingObject to hoInvokingObject
70509>>>>>>>                If (pbMultiSelect(Self)) Begin
70511>>>>>>>                    Get SelectedDateRange to dDates
70512>>>>>>>                    Send hmCallBack of hoInvokingObject Self dDates[0] dDates[1]
70513>>>>>>>                    
70513>>>>>>>                End
70513>>>>>>>>
70513>>>>>>>                Else Begin
70514>>>>>>>                    Get SelectedDate to dDates[0]
70515>>>>>>>                    Send hmCallBack of hoInvokingObject Self dDates[0]
70516>>>>>>>                End
70516>>>>>>>>
70516>>>>>>>            End
70516>>>>>>>>
70516>>>>>>>        End
70516>>>>>>>>
70516>>>>>>>        
70516>>>>>>>        Send Close_Panel
70517>>>>>>>    End_Procedure
70518>>>>>>>    
70518>>>>>>>    Procedure OnMoveValueOutByValue
70520>>>>>>>        Handle hoInvokingObject
70520>>>>>>>        Date dSelDate
70520>>>>>>>        Boolean bMulti
70520>>>>>>>        // we can only do an automatic move value out with
70520>>>>>>>        // single select. If multi-select you will probably want to
70520>>>>>>>        // use a callback method (hmCallBack) to update the values.
70520>>>>>>>        Get pbMultiSelect to bMulti
70521>>>>>>>        If (not(bMulti)) Begin
70523>>>>>>>            Get SelectedDate to dSelDate
70524>>>>>>>            Get phoInvokingObject to hoInvokingObject
70525>>>>>>>            Set Value of hoInvokingObject to dSelDate
70526>>>>>>>            Set Item_Changed_State of hoInvokingObject to True
70527>>>>>>>        End
70527>>>>>>>>
70527>>>>>>>    End_Procedure
70528>>>>>>>    
70528>>>>>>>    Procedure OnMoveValueOutByCustom
70530>>>>>>>    End_Procedure
70531>>>>>>>    
70531>>>>>>>    // called before the list is activated.
70531>>>>>>>    Procedure InitializePrompt
70533>>>>>>>        Handle hoInvokingObject
70533>>>>>>>        Integer eUpdateMode
70533>>>>>>>        Boolean bMulti
70533>>>>>>>        Date dValue
70533>>>>>>>        
70533>>>>>>>        Get peUpdateMode to eUpdateMode
70534>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70536>>>>>>>            
70536>>>>>>>            Get Focus of Desktop to hoInvokingObject
70537>>>>>>>            If (hoInvokingObject<=Desktop) Begin
70539>>>>>>>                Error DFERR_PROGRAM "Calendar Prompt has no invoking object"
70540>>>>>>>>
70540>>>>>>>                Procedure_Return
70541>>>>>>>            End
70541>>>>>>>>
70541>>>>>>>            
70541>>>>>>>            Set phoInvokingObject to hoInvokingObject
70542>>>>>>>            Send Prompt_Callback to hoInvokingObject Self
70543>>>>>>>            Get peUpdateMode to eUpdateMode
70544>>>>>>>        End
70544>>>>>>>>
70544>>>>>>>        
70544>>>>>>>        Get pdSeedValue to dValue
70545>>>>>>>        Get pbMultiSelect to bMulti
70546>>>>>>>        If (not(bMulti) and eUpdateMode=umPromptValue and dValue=0) Begin
70548>>>>>>>            Get Value of hoInvokingObject to dValue
70549>>>>>>>            Set pdSeedValue to dValue
70550>>>>>>>        End
70550>>>>>>>>
70550>>>>>>>        Send OnSeedData
70551>>>>>>>        Set pdSeedValue to 0
70552>>>>>>>        Set pdSeedValue2 to 0
70553>>>>>>>    End_Procedure
70554>>>>>>>    
70554>>>>>>>    Procedure OnSeedData
70556>>>>>>>        Boolean bMulti
70556>>>>>>>        Date dValue dValue2
70556>>>>>>>        Integer iMax iRange
70556>>>>>>>        DateTime dt1 dt2
70556>>>>>>>        Get pbMultiSelect to bMulti
70557>>>>>>>        Get pdSeedValue to dValue
70558>>>>>>>        If (not(bMulti)) Begin
70560>>>>>>>            // if no date, use current date
70560>>>>>>>            If (dValue=0) Begin
70562>>>>>>>                Move (CurrentDateTime()) to dValue
70563>>>>>>>            End
70563>>>>>>>>
70563>>>>>>>            Send SetSelectedDate dValue
70564>>>>>>>        End
70564>>>>>>>>
70564>>>>>>>        Else Begin
70565>>>>>>>            Get pdSeedValue2 to dValue2
70566>>>>>>>            // if no dates, use current date
70566>>>>>>>            If (dValue=0 and dValue2=0) Begin
70568>>>>>>>                Move (CurrentDateTime()) to dValue
70569>>>>>>>            End
70569>>>>>>>>
70569>>>>>>>            // if only one date, make that the range
70569>>>>>>>            If (dValue=0) Begin
70571>>>>>>>                Move dValue2 to dValue
70572>>>>>>>            End
70572>>>>>>>>
70572>>>>>>>            Else If (dValue2=0) Begin
70575>>>>>>>                Move dValue to dValue2
70576>>>>>>>            End
70576>>>>>>>>
70576>>>>>>>            
70576>>>>>>>            // test for valid range
70576>>>>>>>            Get piMaxSelectedCount to iMax
70577>>>>>>>            Move dValue to dt1
70578>>>>>>>            Move dValue2 to dt2
70579>>>>>>>            Move (SpanTotalDays(dt1 - dt2)) to iRange
70580>>>>>>>            If (iRange>iMax) Begin
70582>>>>>>>                Error DFERR_OPERATOR (SFormat(C_$DateRangeExceeded,iMax))
70583>>>>>>>>
70583>>>>>>>                Move dValue to dValue2
70584>>>>>>>            End
70584>>>>>>>>
70584>>>>>>>            
70584>>>>>>>            Send SetSelectedDateRange dValue dValue2
70585>>>>>>>        End
70585>>>>>>>>
70585>>>>>>>    End_Procedure
70586>>>>>>>    
70586>>>>>>>    Procedure OnDoubleClick
70588>>>>>>>        Integer eSelectOn
70588>>>>>>>        Get peMouseSelectOk to eSelectOn
70589>>>>>>>        If (eSelectOn=msoDblClick) Begin
70591>>>>>>>            Send Ok
70592>>>>>>>        End
70592>>>>>>>>
70592>>>>>>>    End_Procedure
70593>>>>>>>    
70593>>>>>>>    Procedure OnClick
70595>>>>>>>        Integer eSelectOn
70595>>>>>>>        Get peMouseSelectOk to eSelectOn
70596>>>>>>>        If (eSelectOn=msoClick) Begin
70598>>>>>>>            Send Ok
70599>>>>>>>        End
70599>>>>>>>>
70599>>>>>>>    End_Procedure
70600>>>>>>>    
70600>>>>>>>    Procedure Ok Returns Integer
70602>>>>>>>        Send ClosePrompt
70603>>>>>>>    End_Procedure
70604>>>>>>>    
70604>>>>>>>    Procedure Cancel Returns Integer
70606>>>>>>>        Send Close_Panel
70607>>>>>>>    End_Procedure
70608>>>>>>>    
70608>>>>>>>End_Class
70609>>>>>Use Dfclient.pkg
70609>>>>>
70609>>>>>Cd_Popup_Object oMonthCalendarPrompt is a ModalPanel
70627>>>>>>
70627>>>>>    Set Location to 10 10
70628>>>>>    Set Size to 145 145
70629>>>>>    // resizable
70629>>>>>    Set Border_Style to Border_Thick
70630>>>>>    
70630>>>>>    Set Label to C_$DateSelector
70631>>>>>    
70631>>>>>    Set piMinSize to 0 0 // set this dynamically // 145 145
70632>>>>>    Set piMaxSize to 310 460
70633>>>>>    
70633>>>>>    // tells us if this been activated and sized yet
70633>>>>>    Property Boolean pbSizeInited False
70635>>>>>    
70635>>>>>    Object oCalendar is a cMonthCalendarPrompt
70637>>>>>        Set Size to 120 135 // not real size, will be assigned
70638>>>>>        Set Location to 5 5
70639>>>>>        Set Border_Style to Border_None
70640>>>>>    End_Object
70641>>>>>    
70641>>>>>    Object oOKButton is a Button
70643>>>>>        Set Label to C_$OK
70644>>>>>        Set Default_State to True
70645>>>>>        Set Location to 129 34
70646>>>>>        Set peAnchors to anBottomRight
70647>>>>>        
70647>>>>>        Procedure OnClick
70650>>>>>            Send Ok of oCalendar
70651>>>>>        End_Procedure
70652>>>>>    End_Object
70653>>>>>    
70653>>>>>    Object oCancelButton is a Button
70655>>>>>        Set Label to C_$Cancel
70656>>>>>        Set Location to 129 89
70657>>>>>        Set peAnchors to anBottomRight
70658>>>>>        
70658>>>>>        Procedure OnClick
70661>>>>>            Send Cancel of oCalendar
70662>>>>>        End_Procedure
70663>>>>>    End_Object
70664>>>>>    
70664>>>>>    Procedure OnResize
70667>>>>>        Integer iSize iHeight iWidth iMinSize
70667>>>>>        Boolean bInited
70667>>>>>        
70667>>>>>        Get piMinHeight of oCalendar to iHeight
70668>>>>>        // when 0, the control has not yet been created. Nothing to do.
70668>>>>>        If (iHeight=0) Begin
70670>>>>>            Procedure_Return
70671>>>>>        End
70671>>>>>>
70671>>>>>        
70671>>>>>        Get pbSizeInited to bInited
70672>>>>>        
70672>>>>>        Get piMinWidth of oCalendar to iWidth
70673>>>>>        Get piMinSize to iMinSize
70674>>>>>        // Minumum size of panel - add 1 to each to each for wiggle room
70674>>>>>        Move (iHeight+25+1) to iHeight
70675>>>>>        Move (iWidth+10+1) to iWidth
70676>>>>>        
70676>>>>>        Set piMinSize to iHeight iWidth
70677>>>>>        
70677>>>>>        If (not(bInited))  Begin
70679>>>>>            Set Size to iHeight iWidth
70680>>>>>            Set pbSizeInited to True
70681>>>>>        End
70681>>>>>>
70681>>>>>        Else Begin
70682>>>>>            Send Adjust_Logicals
70683>>>>>            Get Size to iSize
70684>>>>>            If (Hi(iSize)<iHeight or Low(iSize)<iWidth) Begin
70686>>>>>                Set Size to (iHeight max Hi(iSize)) (iWidth max Low(iSize))
70687>>>>>                Get Size to iSize
70688>>>>>            End
70688>>>>>>
70688>>>>>            Set Size of oCalendar to (Hi(iSize) - 25) (Low(iSize) - 10)
70689>>>>>        End
70689>>>>>>
70689>>>>>        
70689>>>>>    End_Procedure
70690>>>>>    
70690>>>>>    Procedure Add_Focus Handle hoParent Returns Integer
70693>>>>>        Forward Send Add_Focus hoParent
70695>>>>>        Send OnResize
70696>>>>>    End_Procedure
70697>>>>>    
70697>>>>>    On_Key kCancel Send KeyAction to oCancelButton
70698>>>>>    
70698>>>>>Cd_End_Object
70700>>>>>>
70700>>>>>
70700>>>
70700>>>ACTIVATE_VIEW Activate_oPageHeaderEntry FOR oPageHeaderEntry
70710>>>>
70710>>>Object oPageHeaderEntry is a dbView
70712>>>    Set Location to 5 5
70713>>>    Set Size to 107 420
70714>>>    Set Label To "PageHeaderEntry"
70715>>>    Set Border_Style to Border_Thick
70716>>>
70716>>>
70716>>>    Object oEmployee_DD is a cEmployeeDataDictionary
70718>>>    End_Object 
70719>>>
70719>>>    Object oLine_DD is a cLineDataDictionary
70721>>>    End_Object 
70722>>>
70722>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
70724>>>        Set DDO_Server To oEmployee_DD
70725>>>        Set DDO_Server To oLine_DD
70726>>>    End_Object 
70727>>>
70727>>>    Set Main_DD To oPageHeader_DD
70728>>>    Set Server  To oPageHeader_DD
70729>>>
70729>>>
70729>>>
70729>>>    Object oPageHeaderid is a dbForm
70731>>>        Entry_Item PageHeader.id
70732>>>        Set Size to 12 34
70733>>>        Set Location to 5 21
70734>>>        Set peAnchors to anTopLeftRight
70735>>>        Set Label to "id"
70736>>>        Set Label_Justification_mode to jMode_Left
70737>>>        Set Label_Col_Offset to 16
70738>>>        Set Label_row_Offset to 0
70739>>>    End_Object 
70740>>>
70740>>>    Object oEmployeeid is a dbForm
70742>>>        Entry_Item Employee.id
70743>>>        Set Size to 12 34
70744>>>        Set Location to 5 101
70745>>>        Set peAnchors to anTopRight
70746>>>        Set Label to "employee id"
70747>>>        Set Label_Justification_mode to jMode_Left
70748>>>        Set Label_Col_Offset to 41
70749>>>        Set Label_row_Offset to 0
70750>>>    End_Object 
70751>>>
70751>>>    Object oLineid is a dbForm
70753>>>        Entry_Item Line.id
70754>>>        Set Size to 12 34
70755>>>        Set Location to 5 161
70756>>>        Set peAnchors to anTopRight
70757>>>        Set Label to "line id"
70758>>>        Set Label_Justification_mode to jMode_Left
70759>>>        Set Label_Col_Offset to 21
70760>>>        Set Label_row_Offset to 0
70761>>>    End_Object 
70762>>>
70762>>>    Object oPageHeaderdate is a dbForm
70764>>>        Entry_Item PageHeader.date
70765>>>        Set Size to 12 66
70766>>>        Set Location to 19 21
70767>>>        Set peAnchors to anTopLeftRight
70768>>>        Set Label to "date"
70769>>>        Set Label_Justification_mode to jMode_Left
70770>>>        Set Label_Col_Offset to 16
70771>>>        Set Label_row_Offset to 0
70772>>>        Constrain PageHeader.Date Between "1/1/2020" and "12/31/2022"
70776>>>        Set Prompt_Object to oMonthCalendarPrompt
70777>>>        Set Prompt_Button_Mode to PB_PromptOn
70778>>>        Procedure OnExitObject
70781>>>            Date dDateSelected
70781>>>            
70781>>>            Get File_Field_Current_Value of oPageHeader_DD File_Field PageHeader.Date to dDateSelected
70782>>>            
70782>>>            If (dDateSelected < "1/1/2020" or dDateSelected > "12/31/2022" ) Begin
70784>>>                Send Info_Box "Date must be between 1/1/2020 and 12/31/2022"
70785>>>            End
70785>>>>
70785>>>            
70785>>>        End_Procedure
70786>>>    End_Object 
70787>>>
70787>>>    Object oPageHeaderhours is a dbForm
70789>>>        Entry_Item PageHeader.hours
70790>>>        Set Size to 12 34
70791>>>        Set Location to 19 112
70792>>>        Set peAnchors to anTopRight
70793>>>        Set Label to "hours"
70794>>>        Set Label_Justification_mode to jMode_Left
70795>>>        Set Label_Col_Offset to 20
70796>>>        Set Label_row_Offset to 0
70797>>>    End_Object 
70798>>>
70798>>>    Object oTabDialog is a dbTabDialog
70800>>>        Set Size to 61 410
70801>>>        Set Location to 41 5
70802>>>        Set peAnchors to anTopLeftRight
70803>>>
70803>>>        Object oTabPage1 is a dbTabPage
70805>>>            Set Label to "Tab Page Label"
70806>>>
70806>>>            Object oLinetype is a dbForm
70808>>>                Entry_Item Line.type
70809>>>                Set Size to 12 250
70810>>>                Set Location to 10 25
70811>>>                Set peAnchors to anTopLeftRight
70812>>>                Set Label to "type"
70813>>>                Set Label_Justification_mode to jMode_Left
70814>>>                Set Label_Col_Offset to 20
70815>>>                Set Label_row_Offset to 0
70816>>>            End_Object 
70817>>>
70817>>>            Object oEmployeename is a dbForm
70819>>>                Entry_Item Employee.name
70820>>>                Set Size to 12 250
70821>>>                Set Location to 24 25
70822>>>                Set peAnchors to anTopLeftRight
70823>>>                Set Label to "name"
70824>>>                Set Label_Justification_mode to jMode_Left
70825>>>                Set Label_Col_Offset to 20
70826>>>                Set Label_row_Offset to 0
70827>>>            End_Object 
70828>>>
70828>>>            Object oEmployeeid_card is a dbForm
70830>>>                Entry_Item Employee.id_card
70831>>>                Set Size to 12 96
70832>>>                Set Location to 24 304
70833>>>                Set peAnchors to anTopRight
70834>>>                Set Label to "id card"
70835>>>                Set Label_Justification_mode to jMode_Left
70836>>>                Set Label_Col_Offset to 24
70837>>>                Set Label_row_Offset to 0
70838>>>            End_Object 
70839>>>
70839>>>        End_Object 
70840>>>
70840>>>    End_Object 
70841>>>
70841>>>
70841>>>End_Object 
70842>        Use ShoeEntry.vw
Including file: ShoeEntry.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\ShoeEntry.vw)
70842>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\ShoeEntry.vw
70842>>>// ShoeEntry
70842>>>//
70842>>>
70842>>>Use DFClient.pkg
70842>>>Use DFEntry.pkg
70842>>>
70842>>>Use cShoeDataDictionary.dd
Including file: cShoeDataDictionary.dd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\cShoeDataDictionary.dd)
70842>>>>>Use DataDict.pkg
70842>>>>>
70842>>>>>Open Shoe
Including file: Shoe.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\Shoe.fd)
70844>>>>>Open system
70846>>>>>Open PageFooter
70848>>>>>
70848>>>>>Register_Object Shoe_sl
70848>>>>>
70848>>>>>Class cShoeDataDictionary is a DataDictionary
70849>>>>>    
70849>>>>>    Procedure Construct_Object
70851>>>>>        Forward Send Construct_Object
70853>>>>>        Set Main_File to Shoe.File_Number
70854>>>>>
70854>>>>>        Set Add_Client_File to PageFooter.File_Number
70855>>>>>
70855>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
70856>>>>>
70856>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
70857>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
70858>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
70859>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
70860>>>>>
70860>>>>>        Set Field_Auto_Increment Field Shoe.id to File_Field system.shoe_id
70861>>>>>        Set Field_Prompt_Object Field Shoe.id to Shoe_sl
70862>>>>>
70862>>>>>        Set Field_Prompt_Object Field Shoe.name to Shoe_sl
70863>>>>>
70863>>>>>        Set Field_Prompt_Object Field Shoe.price to Shoe_sl
70864>>>>>
70864>>>>>    End_Procedure
70865>>>>>
70865>>>>>End_Class
70866>>>>>
70866>>>>>Use Shoe.sl
Including file: Shoe.sl    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\Shoe.sl)
70866>>>>>>>// Shoe.sl
70866>>>>>>>// Shoe Lookup List
70866>>>>>>>
70866>>>>>>>Use DFClient.pkg
70866>>>>>>>Use cDbCJGridPromptList.pkg
70866>>>>>>>Use cDbCJGridColumn.pkg
70866>>>>>>>Use Windows.pkg
70866>>>>>>>
70866>>>>>>>Use cShoeDataDictionary.dd
70866>>>>>>>
70866>>>>>>>CD_Popup_Object Shoe_sl is a dbModalPanel
70884>>>>>>>>
70884>>>>>>>    Set Location to 5 5
70885>>>>>>>    Set Size to 134 272
70886>>>>>>>    Set Label To "Shoe Lookup List"
70887>>>>>>>    Set Border_Style to Border_Thick
70888>>>>>>>    Set Minimize_Icon to False
70889>>>>>>>
70889>>>>>>>
70889>>>>>>>    Object oShoe_DD is a cShoeDataDictionary
70891>>>>>>>    End_Object 
70892>>>>>>>
70892>>>>>>>    Set Main_DD To oShoe_DD
70893>>>>>>>    Set Server  To oShoe_DD
70894>>>>>>>
70894>>>>>>>
70894>>>>>>>
70894>>>>>>>    Object oSelList is a cDbCJGridPromptList
70896>>>>>>>        Set Size to 105 262
70897>>>>>>>        Set Location to 5 5
70898>>>>>>>        Set peAnchors to anAll
70899>>>>>>>        Set psLayoutSection to "Shoe_sl_oSelList"
70900>>>>>>>        Set Ordering to 1
70901>>>>>>>        Set pbAutoServer to True
70902>>>>>>>
70902>>>>>>>        Object oShoe_id is a cDbCJGridColumn
70904>>>>>>>            Entry_Item Shoe.id
70905>>>>>>>            Set piWidth to 60
70906>>>>>>>            Set psCaption to "id"
70907>>>>>>>        End_Object 
70908>>>>>>>
70908>>>>>>>        Object oShoe_name is a cDbCJGridColumn
70910>>>>>>>            Entry_Item Shoe.name
70911>>>>>>>            Set piWidth to 250
70912>>>>>>>            Set psCaption to "name"
70913>>>>>>>        End_Object 
70914>>>>>>>
70914>>>>>>>        Object oShoe_price is a cDbCJGridColumn
70916>>>>>>>            Entry_Item Shoe.price
70917>>>>>>>            Set piWidth to 110
70918>>>>>>>            Set psCaption to "price"
70919>>>>>>>        End_Object 
70920>>>>>>>
70920>>>>>>>
70920>>>>>>>    End_Object 
70921>>>>>>>
70921>>>>>>>    Object oOk_bn is a Button
70923>>>>>>>        Set Label to "&Ok"
70924>>>>>>>        Set Location to 115 109
70925>>>>>>>        Set peAnchors to anBottomRight
70926>>>>>>>
70926>>>>>>>        Procedure OnClick
70929>>>>>>>            Send OK of oSelList
70930>>>>>>>        End_Procedure
70931>>>>>>>
70931>>>>>>>    End_Object 
70932>>>>>>>
70932>>>>>>>    Object oCancel_bn is a Button
70934>>>>>>>        Set Label to "&Cancel"
70935>>>>>>>        Set Location to 115 163
70936>>>>>>>        Set peAnchors to anBottomRight
70937>>>>>>>
70937>>>>>>>        Procedure OnClick
70940>>>>>>>            Send Cancel of oSelList
70941>>>>>>>        End_Procedure
70942>>>>>>>
70942>>>>>>>    End_Object 
70943>>>>>>>
70943>>>>>>>    Object oSearch_bn is a Button
70945>>>>>>>        Set Label to "&Search..."
70946>>>>>>>        Set Location to 115 217
70947>>>>>>>        Set peAnchors to anBottomRight
70948>>>>>>>
70948>>>>>>>        Procedure OnClick
70951>>>>>>>            Send Search of oSelList
70952>>>>>>>        End_Procedure
70953>>>>>>>
70953>>>>>>>    End_Object 
70954>>>>>>>
70954>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
70955>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
70956>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
70957>>>>>>>
70957>>>>>>>
70957>>>>>>>CD_End_Object // Shoe_sl
70959>>>>>>>>
70959>>>
70959>>>ACTIVATE_VIEW Activate_oShoeEntry FOR oShoeEntry
70969>>>>
70969>>>Object oShoeEntry is a dbView
70971>>>    Set Location to 5 5
70972>>>    Set Size to 22 430
70973>>>    Set Label To "ShoeEntry"
70974>>>    Set Border_Style to Border_Thick
70975>>>
70975>>>
70975>>>    Object oShoe_DD is a cShoeDataDictionary
70977>>>    End_Object 
70978>>>
70978>>>    Set Main_DD To oShoe_DD
70979>>>    Set Server  To oShoe_DD
70980>>>
70980>>>
70980>>>
70980>>>    Object oShoeid is a dbForm
70982>>>        Entry_Item Shoe.id
70983>>>        Set Size to 12 42
70984>>>        Set Location to 5 13
70985>>>        Set peAnchors to anTopLeftRight
70986>>>        Set Label to "id"
70987>>>        Set Label_Justification_mode to jMode_Left
70988>>>        Set Label_Col_Offset to 8
70989>>>        Set Label_row_Offset to 0
70990>>>    End_Object 
70991>>>
70991>>>    Object oShoename is a dbForm
70993>>>        Entry_Item Shoe.name
70994>>>        Set Size to 12 250
70995>>>        Set Location to 5 80
70996>>>        Set peAnchors to anTopRight
70997>>>        Set Label to "name"
70998>>>        Set Label_Justification_mode to jMode_Left
70999>>>        Set Label_Col_Offset to 20
71000>>>        Set Label_row_Offset to 0
71001>>>    End_Object 
71002>>>
71002>>>    Object oShoeprice is a dbForm
71004>>>        Entry_Item Shoe.price
71005>>>        Set Size to 12 72
71006>>>        Set Location to 5 353
71007>>>        Set peAnchors to anTopRight
71008>>>        Set Label to "price"
71009>>>        Set Label_Justification_mode to jMode_Left
71010>>>        Set Label_Col_Offset to 18
71011>>>        Set Label_row_Offset to 0
71012>>>    End_Object 
71013>>>
71013>>>
71013>>>End_Object 
71014>        Use PageFooterEntry4.vw
Including file: PageFooterEntry4.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageFooterEntry4.vw)
71014>>>// C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageFooterEntry4.vw
71014>>>// PageFooterEntry4
71014>>>//
71014>>>
71014>>>Use DFClient.pkg
71014>>>Use DFEntry.pkg
71014>>>Use cDbCJGrid.pkg
71014>>>Use cDbCJGridColumn.pkg
71014>>>
71014>>>Use cEmployeeDataDictionary.dd
71014>>>Use cLineDataDictionary.dd
71014>>>Use cPageHeaderDataDictionary.dd
71014>>>Use cShoeDataDictionary.dd
71014>>>Use cPageFooterDataDictionary.dd
Including file: cPageFooterDataDictionary.dd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\cPageFooterDataDictionary.dd)
71014>>>>>Use DataDict.pkg
71014>>>>>
71014>>>>>Open PageFooter
71016>>>>>Open PageHeader
71018>>>>>Open Shoe
71020>>>>>Open system
71022>>>>>
71022>>>>>Register_Object PageFooter_sl
71022>>>>>
71022>>>>>Class cPageFooterDataDictionary is a DataDictionary
71023>>>>>    
71023>>>>>    Procedure Construct_Object
71025>>>>>        Forward Send Construct_Object
71027>>>>>        Set Main_File to PageFooter.File_Number
71028>>>>>
71028>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
71029>>>>>
71029>>>>>        Set Add_Server_File to PageHeader.File_Number
71030>>>>>        Set Add_Server_File to Shoe.File_Number
71031>>>>>
71031>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
71032>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
71033>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
71034>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
71035>>>>>
71035>>>>>        Set Field_Auto_Increment Field PageFooter.id to File_Field system.page_footer_id
71036>>>>>        Set Field_Prompt_Object Field PageFooter.id to PageFooter_sl
71037>>>>>
71037>>>>>        Set Field_Option Field PageFooter.price DD_DISPLAYONLY to True
71038>>>>>
71038>>>>>    End_Procedure
71039>>>>>
71039>>>>>End_Class
71040>>>>>
71040>>>>>Use PageFooter.sl
Including file: PageFooter.sl    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageFooter.sl)
71040>>>>>>>// PageFooter.sl
71040>>>>>>>// PageFooter Lookup List
71040>>>>>>>
71040>>>>>>>Use DFClient.pkg
71040>>>>>>>Use cDbCJGridPromptList.pkg
71040>>>>>>>Use cDbCJGridColumn.pkg
71040>>>>>>>Use Windows.pkg
71040>>>>>>>
71040>>>>>>>Use cEmployeeDataDictionary.dd
71040>>>>>>>Use cLineDataDictionary.dd
71040>>>>>>>Use cPageHeaderDataDictionary.dd
71040>>>>>>>Use cShoeDataDictionary.dd
71040>>>>>>>Use cPageFooterDataDictionary.dd
71040>>>>>>>
71040>>>>>>>CD_Popup_Object PageFooter_sl is a dbModalPanel
71058>>>>>>>>
71058>>>>>>>    Set Location to 5 5
71059>>>>>>>    Set Size to 134 141
71060>>>>>>>    Set Label To "PageFooter Lookup List"
71061>>>>>>>    Set Border_Style to Border_Thick
71062>>>>>>>    Set Minimize_Icon to False
71063>>>>>>>
71063>>>>>>>
71063>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
71065>>>>>>>    End_Object 
71066>>>>>>>
71066>>>>>>>    Object oLine_DD is a cLineDataDictionary
71068>>>>>>>    End_Object 
71069>>>>>>>
71069>>>>>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
71071>>>>>>>        Set DDO_Server To oEmployee_DD
71072>>>>>>>        Set DDO_Server To oLine_DD
71073>>>>>>>    End_Object 
71074>>>>>>>
71074>>>>>>>    Object oShoe_DD is a cShoeDataDictionary
71076>>>>>>>    End_Object 
71077>>>>>>>
71077>>>>>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
71079>>>>>>>        Set DDO_Server To oPageHeader_DD
71080>>>>>>>        Set DDO_Server To oShoe_DD
71081>>>>>>>    End_Object 
71082>>>>>>>
71082>>>>>>>    Set Main_DD To oPageFooter_DD
71083>>>>>>>    Set Server  To oPageFooter_DD
71084>>>>>>>
71084>>>>>>>
71084>>>>>>>
71084>>>>>>>    Object oSelList is a cDbCJGridPromptList
71086>>>>>>>        Set Size to 105 131
71087>>>>>>>        Set Location to 5 5
71088>>>>>>>        Set peAnchors to anAll
71089>>>>>>>        Set psLayoutSection to "PageFooter_sl_oSelList"
71090>>>>>>>        Set Ordering to 1
71091>>>>>>>        Set pbAutoServer to True
71092>>>>>>>
71092>>>>>>>        Object oPageFooter_id is a cDbCJGridColumn
71094>>>>>>>            Entry_Item PageFooter.id
71095>>>>>>>            Set piWidth to 46
71096>>>>>>>            Set psCaption to "id"
71097>>>>>>>        End_Object 
71098>>>>>>>
71098>>>>>>>        Object oPageHeader_id is a cDbCJGridColumn
71100>>>>>>>            Entry_Item PageHeader.id
71101>>>>>>>            Set piWidth to 95
71102>>>>>>>            Set psCaption to "page header id"
71103>>>>>>>        End_Object 
71104>>>>>>>
71104>>>>>>>        Object oShoe_id is a cDbCJGridColumn
71106>>>>>>>            Entry_Item Shoe.id
71107>>>>>>>            Set piWidth to 60
71108>>>>>>>            Set psCaption to "shoe id"
71109>>>>>>>        End_Object 
71110>>>>>>>
71110>>>>>>>
71110>>>>>>>    End_Object 
71111>>>>>>>
71111>>>>>>>    Object oOk_bn is a Button
71113>>>>>>>        Set Label to "&Ok"
71114>>>>>>>        Set Location to 115 -22
71115>>>>>>>        Set peAnchors to anBottomRight
71116>>>>>>>
71116>>>>>>>        Procedure OnClick
71119>>>>>>>            Send OK of oSelList
71120>>>>>>>        End_Procedure
71121>>>>>>>
71121>>>>>>>    End_Object 
71122>>>>>>>
71122>>>>>>>    Object oCancel_bn is a Button
71124>>>>>>>        Set Label to "&Cancel"
71125>>>>>>>        Set Location to 115 32
71126>>>>>>>        Set peAnchors to anBottomRight
71127>>>>>>>
71127>>>>>>>        Procedure OnClick
71130>>>>>>>            Send Cancel of oSelList
71131>>>>>>>        End_Procedure
71132>>>>>>>
71132>>>>>>>    End_Object 
71133>>>>>>>
71133>>>>>>>    Object oSearch_bn is a Button
71135>>>>>>>        Set Label to "&Search..."
71136>>>>>>>        Set Location to 115 86
71137>>>>>>>        Set peAnchors to anBottomRight
71138>>>>>>>
71138>>>>>>>        Procedure OnClick
71141>>>>>>>            Send Search of oSelList
71142>>>>>>>        End_Procedure
71143>>>>>>>
71143>>>>>>>    End_Object 
71144>>>>>>>
71144>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
71145>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
71146>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
71147>>>>>>>
71147>>>>>>>
71147>>>>>>>CD_End_Object // PageFooter_sl
71149>>>>>>>>
71149>>>
71149>>>ACTIVATE_VIEW Activate_oPageFooterEntry4 FOR oPageFooterEntry4
71159>>>>
71159>>>Object oPageFooterEntry4 is a dbView
71161>>>    Set Location to 5 5
71162>>>    Set Size to 112 200
71163>>>    Set Label To "PageFooterEntry4"
71164>>>    Set Border_Style to Border_Thick
71165>>>
71165>>>
71165>>>    Object oEmployee_DD is a cEmployeeDataDictionary
71167>>>    End_Object 
71168>>>
71168>>>    Object oLine_DD is a cLineDataDictionary
71170>>>    End_Object 
71171>>>
71171>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
71173>>>        Set DDO_Server To oEmployee_DD
71174>>>        Set DDO_Server To oLine_DD
71175>>>        // this lets you save a new parent DD from within child DD
71175>>>        Set Allow_Foreign_New_Save_State to True
71176>>>    End_Object 
71177>>>
71177>>>    Object oShoe_DD is a cShoeDataDictionary
71179>>>    End_Object 
71180>>>
71180>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
71182>>>        Set DDO_Server To oPageHeader_DD
71183>>>        Set DDO_Server To oShoe_DD
71184>>>        Set Constrain_File To PageHeader.File_Number
71185>>>    End_Object 
71186>>>
71186>>>    Set Main_DD To oPageHeader_DD
71187>>>    Set Server  To oPageHeader_DD
71188>>>
71188>>>
71188>>>
71188>>>    Object oPageHeaderid is a dbForm
71190>>>        Entry_Item PageHeader.id
71191>>>        Set Size to 12 34
71192>>>        Set Location to 5 21
71193>>>        Set peAnchors to anTopLeftRight
71194>>>        Set Label to "id"
71195>>>        Set Label_Justification_mode to jMode_Left
71196>>>        Set Label_Col_Offset to 16
71197>>>        Set Label_row_Offset to 0
71198>>>    End_Object 
71199>>>
71199>>>    Object oEmployeeid is a dbForm
71201>>>        Entry_Item Employee.id
71202>>>        Set Size to 12 34
71203>>>        Set Location to 5 101
71204>>>        Set peAnchors to anTopRight
71205>>>        Set Label to "employee id"
71206>>>        Set Label_Justification_mode to jMode_Left
71207>>>        Set Label_Col_Offset to 41
71208>>>        Set Label_row_Offset to 0
71209>>>    End_Object 
71210>>>
71210>>>    Object oLineid is a dbForm
71212>>>        Entry_Item Line.id
71213>>>        Set Size to 12 34
71214>>>        Set Location to 5 161
71215>>>        Set peAnchors to anTopRight
71216>>>        Set Label to "line id"
71217>>>        Set Label_Justification_mode to jMode_Left
71218>>>        Set Label_Col_Offset to 21
71219>>>        Set Label_row_Offset to 0
71220>>>    End_Object 
71221>>>
71221>>>    Object oPageHeaderdate is a dbForm
71223>>>        Entry_Item PageHeader.date
71224>>>        Set Size to 12 66
71225>>>        Set Location to 19 21
71226>>>        Set peAnchors to anTopLeftRight
71227>>>        Set Label to "date"
71228>>>        Set Label_Justification_mode to jMode_Left
71229>>>        Set Label_Col_Offset to 16
71230>>>        Set Label_row_Offset to 0
71231>>>    End_Object 
71232>>>
71232>>>    Object oPageHeaderhours is a dbForm
71234>>>        Entry_Item PageHeader.hours
71235>>>        Set Size to 12 34
71236>>>        Set Location to 19 112
71237>>>        Set peAnchors to anTopRight
71238>>>        Set Label to "hours"
71239>>>        Set Label_Justification_mode to jMode_Left
71240>>>        Set Label_Col_Offset to 20
71241>>>        Set Label_row_Offset to 0
71242>>>    End_Object 
71243>>>
71243>>>    Object oDetailGrid is a cDbCJGrid
71245>>>        Set Size to 66 148
71246>>>        Set Location to 41 5
71247>>>        Set Server to oPageFooter_DD
71248>>>        Set Ordering to 2
71249>>>        Set peAnchors to anAll
71250>>>        Set psLayoutSection to "oPageFooterEntry4_oDetailGrid"
71251>>>        Set pbAllowInsertRow to False
71252>>>        Set pbHeaderPrompts to True
71253>>>
71253>>>        Object oShoe_id is a cDbCJGridColumn
71255>>>            Entry_Item Shoe.id
71256>>>            Set piWidth to 60
71257>>>            Set psCaption to "shoe id"
71258>>>        End_Object
71259>>>        
71259>>>        Object oShoe_price is a cDbCJGridColumn
71261>>>            Entry_Item Shoe.name
71262>>>            Set piWidth to 110
71263>>>            Set psCaption to "name"
71264>>>        End_Object 
71265>>>
71265>>>        Object oShoe_price is a cDbCJGridColumn
71267>>>            Entry_Item Shoe.price
71268>>>            Set piWidth to 110
71269>>>            Set psCaption to "price"
71270>>>        End_Object 
71271>>>
71271>>>        Object oPageFooter_quantity is a cDbCJGridColumn
71273>>>            Entry_Item PageFooter.quantity
71274>>>            Set piWidth to 60
71275>>>            Set psCaption to "quantity"
71276>>>        End_Object 
71277>>>
71277>>>    End_Object 
71278>>>
71278>>>    //-----------------------------------------------------------------------
71278>>>    // Create custom confirmation messages for save and delete
71278>>>    // We must create the new functions and assign verify messages
71278>>>    // to them.
71278>>>    //-----------------------------------------------------------------------
71278>>>
71278>>>    Function ConfirmDeleteHeader Returns Boolean
71281>>>        Boolean bFail
71281>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
71282>>>        Function_Return bFail
71283>>>    End_Function 
71284>>>
71284>>>    // Only confirm on the saving of new records
71284>>>    Function ConfirmSaveHeader Returns Boolean
71287>>>        Boolean bNoSave bHasRecord
71287>>>        Handle  hoSrvr
71287>>>        Get Server to hoSrvr
71288>>>        Get HasRecord of hoSrvr to bHasRecord
71289>>>        If not bHasRecord Begin
71291>>>            Get Confirm "Save this NEW header?" to bNoSave
71292>>>        End
71292>>>>
71292>>>        Function_Return bNoSave
71293>>>    End_Function 
71294>>>
71294>>>    // Define alternate confirmation Messages
71294>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
71295>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
71296>>>    // Saves in header should not clear the view
71296>>>    Set Auto_Clear_Deo_State to False
71297>>>
71297>>>
71297>>>End_Object 
71298>        Use ReportView2.rv
Including file: ReportView2.rv    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\ReportView2.rv)
71298>>>// ReportView2.rv
71298>>>// ReportView2
71298>>>Register_Object oReport
71298>>>
71298>>>Use DFRptVw.pkg
71298>>>Use cWinReport2.pkg
Including file: cWinReport2.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cWinReport2.pkg)
71298>>>>>// defines support for Winprint2 cWinReport2 class
71298>>>>>
71298>>>>>
71298>>>>>Use DFRpt.pkg              // BasicReport RO Class for VDF
71298>>>>>Use WinPrint2.pkg          // WinPrint2 engine
Including file: Winprint2.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Winprint2.pkg)
71298>>>>>>>Use windows.pkg
71298>>>>>>>Use LanguageText.pkg
71298>>>>>>>Use DLL.pkg
71298>>>>>>>Use WinPrint2_Api.pkg
Including file: WinPrint2_API.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\WinPrint2_API.pkg)
71298>>>>>>>>>Use DLL.pkg
71298>>>>>>>>>
71298>>>>>>>>>External_Function WP_IsPrinterValid "IsPrinterValid" WinPrint.dll ;    Returns Boolean // True if the the current printer is a valid one. False, otherwise.
71299>>>>>>>>>
71299>>>>>>>>>External_Function WP_ArePrintersInstalled "ArePrintersInstalled" WinPrint.dll ; // determines whether at least one printer is installed    Returns Boolean // True, if a printer is installed, False if it is not.
71300>>>>>>>>>
71300>>>>>>>>>External_Function WP_ExecutePrinterSetupDialog "ExecutePrinterSetupDialog" WinPrint.dll ; // displays the "printer setup" dialog    Handle hWndParent; // window handle of the parent window    Returns Boolean // True if the OK button pressed; False, otherwise.
71301>>>>>>>>>
71301>>>>>>>>>External_Function WP_ExecutePrintDialog "ExecutePrintDialog" WinPrint.dll ; // displays the "Print" dialog    Handle hWndParent; // window handle of the parent window    Returns Boolean // True if the OK button pressed; False, otherwise.
71302>>>>>>>>>
71302>>>>>>>>>External_Function WP_GetCurrentDevice "GetCurrentDevice" WinPrint.dll ; // retrieves the name of the current printer device    Address aDevice ; // address of the string (255 chars) that will hold the device name upon return    Returns Boolean // True, if success; False if error occurred
71303>>>>>>>>>
71303>>>>>>>>>External_Function WP_GetPrintDialogFlags "GetPrintDialogFlags" WinPrint.dll ; // retrieves the current print options    Returns UInteger // array of flags representing print-related options that are currently set
71304>>>>>>>>>
71304>>>>>>>>>External_Function WP_GetUserDefinedPapersize "GetUserDefinedPapersize" WinPrint.dll ;  // gets the size of user-defined paper    Returns UInteger // // hi-word=length; lo-word=width
71305>>>>>>>>>
71305>>>>>>>>>External_Function WP_IsPrintDialogFlagSet "IsPrintDialogFlagSet" WinPrint.dll ; // determines whether a specific print-flag is set    UInteger iFlag ; // the printer flag    Returns Boolean // True, if the flag is set; False, if it isn't
71306>>>>>>>>>
71306>>>>>>>>>External_Function WP_SelectPrinter "SelectPrinter" WinPrint.dll ; // selects a printer programatically    String sDevice; // the name of the printer    Returns Boolean // True, if success; False, if error (such as an invalid printer name)
71307>>>>>>>>>
71307>>>>>>>>>External_Function WP_SetFirstPagePaperSource "SetFirstPagePaperSource"  WinPrint.dll ;    Integer iBin ; // the bim constant    Returns Boolean // True if success, false if error
71308>>>>>>>>>
71308>>>>>>>>>External_Function WP_SetNumberOfPrintCopies "SetNumberOfPrintCopies" WinPrint.dll ; // sets the number of copies to print    UInteger iNumCopies; // number of copies to make    Returns Boolean // Always True
71309>>>>>>>>>
71309>>>>>>>>>External_Function WP_SetSpecificPrintDialogFlag "SetSpecificPrintDialogFlag" WinPrint.dll; // Sets/unsets one printer flag    UInteger fFlag; // printer flag    Returns Boolean // True, if success; False if error occurred
71310>>>>>>>>>
71310>>>>>>>>>External_Function WP_SetPrintDialogFlags "SetPrintDialogFlags" WinPrint.dll; // Sets/unsets all printer flags in one call    UInteger fFlags; // printer flags    Returns Boolean // True, if success; False if error occurred
71311>>>>>>>>>
71311>>>>>>>>>External_Function WP_SetUserDefinedPapersize "SetUserDefinedPapersize" WinPrint.dll ;  // sets the size of user-defined paper    UInteger iPaperSize ; // hi-word=length; lo-word=width    Returns Boolean // True, if success; False if error occurred
71312>>>>>>>>>
71312>>>>>>>>>External_Function WP_SetFontStyle "SetFontStyle" WinPrint.dll ; // sets multiple font attributes    Integer iStyles ; // series of flags    Returns Boolean // always True
71313>>>>>>>>>
71313>>>>>>>>>External_Function WP_SetFontBold "SetFontBold" WinPrint.dll ; // toggles the bold attribute of the current font    Boolean bBold ; // True to switch bold attribute on; False to switch it off    Returns Boolean // always True
71314>>>>>>>>>
71314>>>>>>>>>External_Function WP_SetFontItalic "SetFontItalic" WinPrint.dll ; // toggles the italic attribute of the current font    Boolean bItalic ; // True to switch italic attribute on; False to switch it off    Returns Boolean  // always True
71315>>>>>>>>>
71315>>>>>>>>>External_Function WP_SetFontUnderline "SetFontUnderline" WinPrint.dll ; // toggles the underline attribute of the current font    Boolean bUnderline ; // True to switch underline attribute on; False to switch it off    Returns Boolean  // always True
71316>>>>>>>>>
71316>>>>>>>>>External_Function WP_SetFontStrikeout "SetFontStrikeout" WinPrint.dll ; // toggles the strikeout attribute of the current font    Boolean bStrikeout ; // True to switch strikeout attribute on; False to switch it off    Returns Boolean  // always True
71317>>>>>>>>>
71317>>>>>>>>>External_Function WP_SetFontColor "SetFontColor" WinPrint.dll ; // sets the color of the current font    Integer iColor ; // color of the font    Returns Boolean  // always True
71318>>>>>>>>>
71318>>>>>>>>>External_Function WP_SetFontHeight "SetFontHeight" WinPrint.dll ; // sets the height of the font    UInteger iHeight ; // height of the font in points (multiplied by 100. Eg 12.5 point should be sent as 1250)    Returns Boolean  // always True
71319>>>>>>>>>
71319>>>>>>>>>External_Function WP_SetFontName "SetFontName" WinPrint.dll ; // Sets the name of the font to use    String sFontName ; // name of the font to use    Returns Boolean  // always True
71320>>>>>>>>>
71320>>>>>>>>>External_Function WP_DrawBitmap "DrawBitmap" WinPrint.dll ; // Draws a bitmap (BMP, JPG)    String  sBitmap;                 // Name of the bitmap    Integer iLeft;                   // distance from left edge to draw bitmap    Integer iTop;                    // distance from top edge to draw bitmap    Integer iWidth;                  // width of the bitmap    Integer iHeight;                 // height of the bitmap    Boolean bUpdateCurrentPosition;  // after drawing, should the current position be updated?    Returns Boolean // True, if OK; False, if an error occurred.
71321>>>>>>>>>
71321>>>>>>>>>External_Function WP_DrawEllipse "DrawEllipse" WinPrint.dll ; // draws an elipse within a bounding rectangle    Integer iLeft;                   // distance from left edge to draw the ellipse    Integer iTop;                    // distance from top edge to draw the ellipse    Integer iWidth;                  // width of the bounding rectangle    Integer iHeight;                 // height of the bounding rectangle    Integer iBorderColor;            // color of the ellipse's edge    Integer iFillColor;              // internal color of the ellipse    Boolean  bFill;                  // should the ellipse be filled? (False=transparent)    UInteger iThickness;             // thickness of the elipse    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the ellipse be drawn on future soft-page breaks?    Returns Boolean // True, if OK; False, if an error occurred.
71322>>>>>>>>>
71322>>>>>>>>>External_Function WP_DrawLine "DrawLine" WinPrint.dll ; // draws a line from the current position    Integer iLeft;                   // distance from left edge to draw the line    Integer iTop;                    // distance from top edge to draw the line    Integer iLength;                 // length of the line    Boolean  bHorizontal;            // draw horizontal? (False=vertical)    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Returns Boolean // True, if OK; False, if an error occurred.
71323>>>>>>>>>
71323>>>>>>>>>External_Function WP_DrawRectangle "DrawRectangle" WinPrint.dll ; // draws a rectangle    Integer iLeft;                   // distance from left edge to draw the rectangle    Integer iTop;                    // distance from top edge to draw the rectangle    Integer iWidth;                  // width of the rectangle    Integer iHeight;                 // height of the rectangle    Integer iBorderColor;            // color of the rectangle's border    Integer iFillColor;              // internal color of the rectangle    Boolean  bFill;                  // should the rectangle be filled? (False=transparent)    UInteger iThickness;             // thickness of the rectangle's border    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the rectangle be drawn on future soft-page breaks?    Returns Boolean // True, if OK; False, if an error occurred.
71324>>>>>>>>>
71324>>>>>>>>>External_Function WP_DrawXYLine "DrawXYLine" WinPrint.dll ; // draws a line between two points    Integer iLeftStart;              // distance from left edge to draw from    Integer iTopStart;               // distance from top edge to draw from    Integer iLeftEnd;                // distance from left edge to draw to    Integer iTopEnd;                 // distance from top edge to draw to    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the line be drawn on future soft-page breaks?    Returns Boolean // True, if OK; False, if an error occurred.
71325>>>>>>>>>
71325>>>>>>>>>External_Function WP_SetAbsoluteMargins "SetAbsoluteMargins" WinPrint.dll ; // modifies the top/bottom non-printable margin    UInteger iTop;      // the top margin offset    UInteger iBottom;   // the bottom margin offset    Boolean  bAllPages; // should all pages be affected? True=AllPages; False=first page only    Returns Boolean // always True
71326>>>>>>>>>
71326>>>>>>>>>External_Function WP_SetMargins "SetMargins" WinPrint.dll ; // Sets the user-margins    UInteger iLeft;   // the left margin    UInteger iTop;    // the top margin    UInteger iRight;  // the right margin    UInteger iBottom; // the bottom margin    Returns Boolean // always True
71327>>>>>>>>>
71327>>>>>>>>>External_Function WP_CreateDiagram "CreateDiagram" WinPrint.dll ; // Creates a new diagram    UInteger eType;       // type of diagram (Bar, Line, Pie)    UInteger eEffect;     // how it is drawn (2d or 3d, etc)    UInteger iWidth;      // width of the diagram    UInteger iHeight;     // height of the diagram    Boolean  bDrawXyAxis; // draw the xy-axis (for bar charts only)?    Returns Handle // unique id for the diagram used in other diagram funtions
71328>>>>>>>>>
71328>>>>>>>>>External_Function WP_AddDiagramEntry "AddDiagramEntry" WinPrint.dll ; // Adds an item into a diagram    Handle   hDiagram;          // diagram handle returned by CreateDiagram()    String   sValueDescription; // description of the item    String   sValue;            // value of the item    Integer iBorderColor;       // color of the item's border    Integer iFillColor;         // color of the item's interior    Boolean  bFilled;           // should the item be drawn filled (with iFillColor), or transparent?    UInteger iNumDecimals;      // Number of decimals in the sValue argument    UInteger eValueOrPercent;   // How the value should be displayed (as value or percentage, etc)    Boolean  bExploded;         // should the value be "pulled out" (pie charts only)    Returns Boolean // True, if success; False, if error
71329>>>>>>>>>
71329>>>>>>>>>External_Function WP_DrawDiagram "DrawDiagram" WinPrint.dll ; // draws a diagram    Handle   hDiagram;               // diagram handle returned by CreateDiagram()    UInteger iLeft;                  // x-coordinate to draw the diagram    UInteger iTop;                   // y-coordinate to draw the diagram    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Returns Boolean // True, if success; False, if error
71330>>>>>>>>>
71330>>>>>>>>>External_Function WP_LockDiagram "LockDiagram" WinPrint.dll ; // Locks a diagram so that no more entries can be added    Handle hDiagram; // diagram handle returned by CreateDiagram()    Returns Boolean // True, if success; False, if error
71331>>>>>>>>>
71331>>>>>>>>>External_Function WP_SetDiagramCaption "SetDiagramCaption" WinPrint.dll ; // Sets the caption of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sCaption; // the diagram's caption    Returns Boolean // True, if success; False, if error
71332>>>>>>>>>
71332>>>>>>>>>External_Function WP_SetDiagramXText "SetDiagramXText" WinPrint.dll ; // Sets the horizontal label of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sText;    // the diagram's horizonal label    Returns Boolean // True, if success; False, if error
71333>>>>>>>>>
71333>>>>>>>>>External_Function WP_SetDiagramYText "SetDiagramYText" WinPrint.dll ; // Sets the vertical label of a diagram    Handle  hDiagram;      // diagram handle returned by CreateDiagram()    String  sText;         // the diagram's vertical label    Boolean bVerticalText; // should the text be drawn vertically (False=horizontally)    Returns Boolean // True, if success; False, if error
71334>>>>>>>>>
71334>>>>>>>>>External_Function WP_BeginHeader "BeginHeader" WinPrint.dll ; // creates a new header    UInteger iHeaderType; // the type of header    UInteger iSubHeaderNum; // for subheaders, then number (1-0)    Returns Boolean // always True
71335>>>>>>>>>
71335>>>>>>>>>External_Function WP_EndHeader "EndHeader" WinPrint.dll ; // declares the end of the current header    Returns Boolean // always True
71336>>>>>>>>>
71336>>>>>>>>>External_Function WP_SetExtraLineCheck "SetExtraLineCheck" WinPrint.dll ; // forces a soft page break if header plus number of lines don't fit on page    UInteger iNumLines; // number of lines in addition to header required before forcing a soft page-break    Returns Boolean; // always True    
71337>>>>>>>>>External_Function WP_SetHeaderFrame "SetHeaderFrame" WinPrint.dll ; // sets the style, color and frame of a header    UInteger eFrame;     // style of frame (margin-to-margin, etc)    Integer iColor;      // color of the frame's edge    UInteger iThickness; // thickness of the frame    Integer iFillCol;    // the internal color of the frame (only used if bBilled=True)    Boolean  bFilled;    // True, if the frame should be filled with the iFillColor (False=Transparent)    Returns Boolean // Always True
71338>>>>>>>>>
71338>>>>>>>>>External_Function WP_SetHeaderMargin "SetHeaderMargin" WinPrint.dll ; // Sets a margin of space on the inside and outside of the current header    UInteger eType;      // Specifies which margin areas is being set.    Integer  iSize;      // Size of the margin setting in the current report metrics    Returns Boolean  // False if document is not started
71339>>>>>>>>>
71339>>>>>>>>>External_Function WP_SetHeaderPlacement "SetHeaderPlacement" WinPrint.dll ; // placement (left, center or right) of the header    UInteger ePlacement; // placed left, center or right    Returns Boolean //always True
71340>>>>>>>>>
71340>>>>>>>>>External_Function WP_SetHeaderWrap "SetHeaderWrap" WinPrint.dll ; // determines whether the current header is drawn on soft page-breaks    Boolean bWrap; // True, to wrap onto following pages; False, for current page only    Returns Boolean // always True
71341>>>>>>>>>
71341>>>>>>>>>External_Function WP_WriteHeader "WriteHeader" WinPrint.dll ; // writes a header to the current page    UInteger eHeaderType;   // type of header    UInteger iSubHeaderNum; // for subheaders, the number (1-9)    Returns Boolean // True, if success; False, if error
71342>>>>>>>>>
71342>>>>>>>>>External_Function WP_RGBToDFPrintColor "RGBToDFPrintColor" WinPrint.dll ; // converts R, G, and B values into a composite color that WinPrint expects    UInteger iRed;   // red component (1-255)    UInteger iGreen; // green component (1-255)    UInteger iBlue;  // blue component (1-255)    Returns Integer // composite color
71343>>>>>>>>>
71343>>>>>>>>>External_Function WP_GetMetrics "GetMetrics" WinPrint.dll ; // gets the current unit of measurement    Returns UInteger // unit of measurement (Inch or CM)
71344>>>>>>>>>
71344>>>>>>>>>External_Function WP_SetMetrics "SetMetrics" WinPrint.dll ; // sets the unit of measurement    UInteger eMetrics; // Inch or CM    Returns Boolean // always True
71345>>>>>>>>>
71345>>>>>>>>>External_Function WP_ClearDocument "ClearDocument" WinPrint.dll ; // clears the resources of the document from memory    Returns Boolean // always True
71346>>>>>>>>>
71346>>>>>>>>>External_Function WP_NewDocument "NewDocument" WinPrint.dll ; // starts a new document, but preserves the printer settings    Boolean bAutoPreview ; // Should the Previewer be displayed immediately    Returns Boolean // True, if success; False, if an error occurred
71347>>>>>>>>>
71347>>>>>>>>>External_Function WP_EndDocument "EndDocument" WinPrint.dll ; // Indicates that the document is finished    Returns Boolean // always True
71348>>>>>>>>>
71348>>>>>>>>>External_Function WP_ClearPrinter "ClearPrinter" WinPrint.dll ; // clears all printer and document resources    Returns Boolean // True, if success; False, if an error occurred
71349>>>>>>>>>
71349>>>>>>>>>External_Function WP_ConfirmLines "ConfirmLines" WinPrint.dll ; // ensures that a specified number of lines will fit on the page; if not, a soft page-break is performed automatically    UInteger iNumLines; // number of lines that must fit on the page    Returns Boolean // True, if success; False, if an error occurred
71350>>>>>>>>>
71350>>>>>>>>>External_Function WP_CreatePage "CreatePage" WinPrint.dll ; // creates a new page of specified columns    UInteger iNumColumns; // number of columns (zero= no columns)    Returns UInteger; // page number that was created    
71351>>>>>>>>>External_Function WP_PreviewDocument "PreviewDocument" WinPrint.dll ; // previews the current document    Boolean bPrintDialog; // Determines whether the Print Dialog (range, etc) is displayed when the "print" button is clicked in the preview window.    Boolean bPrintSetup;  // Determines whether the Print Setup button is enabled (allows to change orientation, etc)    Boolean bPrint;       // Determines whether the Print button is enabled    Returns Handle // non-zero = hViewerProcess; zero= error
71352>>>>>>>>>
71352>>>>>>>>>External_Function WP_ClosePreview "ClosePreview" WinPrint.dll ; // closes the preview window    Returns Boolean // True, if closed; False, if an error occurred (such as it not being already open)
71353>>>>>>>>>
71353>>>>>>>>>External_Function WP_PrintDocument "PrintDocument" WinPrint.dll ; // prints the current document    Handle hWndParent; // window handle of object to use for any modal output    Returns Boolean // True, if success; False, if an error occurred
71354>>>>>>>>>
71354>>>>>>>>>External_Function WP_SetAlign "SetAlign" WinPrint.dll ; // align future text    UInteger eAlign; // left, center or right    Returns Boolean // always True
71355>>>>>>>>>
71355>>>>>>>>>External_Function WP_WriteText "WriteText" WinPrint.dll ; // write text to the current position or column    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iColumnNum;        // number of the column to write to (zero=no column, use current position)    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncating    Returns Boolean // True, if success; False, if an error occurred
71356>>>>>>>>>
71356>>>>>>>>>External_Function WP_WriteTextAtPosition "WriteTextAtPosition" WinPrint.dll ; // writes text to a specific position    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iPosition;         // horizontal position to write the text    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncating    Returns Boolean // True, if success; False, if an error occurred
71357>>>>>>>>>
71357>>>>>>>>>External_Function WP_SetProgressCaption "SetProgressCaption" WinPrint.dll ;    String sProgressCaption ;    Returns Boolean
71358>>>>>>>>>
71358>>>>>>>>>External_Function WP_SetReportTitle     "SetReportTitle"     WinPrint.dll ;    String sCaption ;    Returns Boolean
71359>>>>>>>>>
71359>>>>>>>>>External_Function WP_ViewerWantsToClose "ViewerWantsToClose" WinPrint.dll ;    Returns Integer
71360>>>>>>>>>
71360>>>>>>>>>External_Function WP_DisplayMessageBox  "DisplayMessageBox"  WinPrint.dll ;    String sCaption String sText ;    Returns Integer
71361>>>>>>>>>
71361>>>>>>>>>External_Function WP_GetViewerWindow "GetViewerWindow" Winprint.dll ;    Returns Handle
71362>>>>>>>>>
71362>>>>>>>>>External_Function WP_GetDocumentStatus "GetDocumentStatus" Winprint.dll ;    Returns Integer // returns dsNotStarted, dsStarted, or dsFinished
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>Use WinPrint_Constants.pkg
Including file: Winprint_Constants.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Winprint_Constants.pkg)
71363>>>>>>>>>// Constants used by Winprint1 and Winprint 2
71363>>>>>>>>>
71363>>>>>>>>>// Define Winprint Constants
71363>>>>>>>>>
71363>>>>>>>>>Enum_List // Metrics
71363>>>>>>>>>    Define WPM_CM
71363>>>>>>>>>    Define WPM_INCH
71363>>>>>>>>>End_Enum_List
71363>>>>>>>>>
71363>>>>>>>>>// values returns by GetDocumentStatus
71363>>>>>>>>>Enum_List
71363>>>>>>>>>    Define dsNotStarted for 0 // The document is cleared or has never started
71363>>>>>>>>>    Define dsStarted    for 1 // The document has been created, but is not finished.
71363>>>>>>>>>    Define dsFinished   for 2 // The document is completed, and is currently valid
71363>>>>>>>>>End_Enum_List
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>// Fonts/Align
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>// Header position on page
71363>>>>>>>>>
71363>>>>>>>>>// Header frame types
71363>>>>>>>>>
71363>>>>>>>>>// Header Margin
71363>>>>>>>>>
71363>>>>>>>>>// Header page breake/wrap
71363>>>>>>>>>
71363>>>>>>>>>// Headers
71363>>>>>>>>>
71363>>>>>>>>>// RGB colors for WinPrint
71363>>>>>>>>>// If you want to define more colors, use the function DFGetDFColor.
71363>>>>>>>>>// Default
71363>>>>>>>>>// Dark
71363>>>>>>>>>// Same as magenta, i will leav them becauce they exist in ver 1.0
71363>>>>>>>>>
71363>>>>>>>>>// Graphics
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>// PD flags for print setup/dialog
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>>>
71363>>>>>>>Use Rgb.pkg
71363>>>>>>>Use GlobalFunctionsProcedures.pkg
71363>>>>>>>
71363>>>>>>>Define INFINITE for -1
71363>>>>>>>Define WAIT_TIMEOUT for |CI$00000102
71363>>>>>>>
71363>>>>>>>
71363>>>>>>>Define QS_KEY            for |CI$0001
71363>>>>>>>Define QS_MOUSEMOVE      for |CI$0002
71363>>>>>>>Define QS_MOUSEBUTTON    for |CI$0004
71363>>>>>>>Define QS_POSTMESSAGE    for |CI$0008
71363>>>>>>>Define QS_TIMER          for |CI$0010
71363>>>>>>>Define QS_PAINT          for |CI$0020
71363>>>>>>>Define QS_SENDMESSAGE    for |CI$0040
71363>>>>>>>Define QS_HOTKEY         for |CI$0080
71363>>>>>>>Define QS_ALLPOSTMESSAGE for |CI$0100
71363>>>>>>>Define QS_MOUSE          for (QS_MOUSEMOVE ior QS_MOUSEBUTTON)
71363>>>>>>>Define QS_INPUT          for (QS_MOUSE ior QS_KEY)
71363>>>>>>>Define QS_ALLEVENTS      for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY)
71363>>>>>>>Define QS_ALLINPUT       for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY ior QS_SENDMESSAGE)
71363>>>>>>>
71363>>>>>>>External_Function WaitForSingleObject "WaitForSingleObject" Kernel32.dll Handle hHandle DWord dwMilliseconds Returns DWord
71364>>>>>>>External_Function GetCurrentProcessId "GetCurrentProcessId" Kernel32.dll Returns DWord
71365>>>>>>>External_Function GetCurrentProcess "GetCurrentProcess" Kernel32.dll Returns Handle
71366>>>>>>>
71366>>>>>>>External_Function MsgWaitForMultipleObjects "MsgWaitForMultipleObjects" User32.dll ;    DWord nCount;             // number of handles in the object handle array    Address pHandles;     // pointer to the object-handle array    Boolean fWaitAll;     // wait for all or wait for one    DWord dwMilliseconds; // time-out interval in milliseconds    DWord dwWakeMask;     // type of input events to wait for    Returns DWord
71367>>>>>>>
71367>>>>>>>Use GlobalFunctionsProcedures.pkg
71367>>>>>>>
71367>>>>>>>Class cWinPrint2 is a cObject
71368>>>>>>>    Procedure Construct_Object
71370>>>>>>>        Forward Send construct_object
71372>>>>>>>        
71372>>>>>>>        // internal properties
71372>>>>>>>        Property Integer DFCurrent_Color       0
71373>>>>>>>        Property String  DFCurrent_OutPut      "WinPrint"
71374>>>>>>>        Property Integer DFCurrent_Diagram     0
71375>>>>>>>        Property Integer DFCurrent_HeaderType  0
71376>>>>>>>        Property Integer DFCurrent_HeaderNr    0
71377>>>>>>>        Property Number  DFCurrent_FontSize    10
71378>>>>>>>        Property String  DFCurrent_Font        "Arial"
71379>>>>>>>        
71379>>>>>>>        // Default values for margins 2.53 CM = 1 inch
71379>>>>>>>        Property Number  DFLeft_Margin    2.53
71380>>>>>>>        Property Number  DFTop_Margin     2.53
71381>>>>>>>        Property Number  DFright_Margin   2.53
71382>>>>>>>        Property Number  DFBottom_Margin  2.53
71383>>>>>>>        
71383>>>>>>>        // If WP1 this defaults to false. In 2, it is true which means that the print job
71383>>>>>>>        // dialog appears when you hitprint in previewer.
71383>>>>>>>        Property Integer PrintDlgInPreview   1
71384>>>>>>>        // This does nothing in Wp2 (because you can't to this anyway)
71384>>>>>>>        Property Integer EnablePrintSetupFromPreview  True
71385>>>>>>>        Property Integer EnablePrintFromPreview  1
71386>>>>>>>        
71386>>>>>>>        // is the GUI Suspended. This is privately maintained and is used
71386>>>>>>>        // to figure out if a preview panel is up or not
71386>>>>>>>        Property Integer pbIsSuspended False
71387>>>>>>>        
71387>>>>>>>        Object oDFColorArray is an Array
71389>>>>>>>            //Moved into array
71389>>>>>>>            Set Value  0  to RGB_WHITE
71390>>>>>>>            Set Value  1  to RGB_RED
71391>>>>>>>            Set Value  2  to RGB_BLUE
71392>>>>>>>            Set Value  3  to RGB_GREEN
71393>>>>>>>            Set Value  4  to RGB_YELLOW
71394>>>>>>>            Set Value  5  to RGB_GREY
71395>>>>>>>            Set Value  6  to RGB_CYAN
71396>>>>>>>            Set Value  7  to RGB_MAGENTA
71397>>>>>>>            Set Value  8  to RGB_DRED
71398>>>>>>>            Set Value  9  to RGB_DBLUE
71399>>>>>>>            Set Value  10 to RGB_DGREEN
71400>>>>>>>            Set Value  11 to RGB_DYELLOW
71401>>>>>>>            Set Value  12 to RGB_DGREY
71402>>>>>>>            Set Value  13 to RGB_DCYAN
71403>>>>>>>            Set Value  14 to RGB_DMAGENTA
71404>>>>>>>            Set Value  15 to RGB_BLACK
71405>>>>>>>        End_Object
71406>>>>>>>        
71406>>>>>>>        Object oDiagramArray is an Array
71408>>>>>>>        End_Object
71409>>>>>>>        
71409>>>>>>>    End_Procedure
71410>>>>>>>    
71410>>>>>>>    Function ViewerWantsToClose Returns Boolean
71412>>>>>>>        Function_Return (WP_ViewerWantsToClose())
71413>>>>>>>    End_Function
71414>>>>>>>    
71414>>>>>>>    Function IsViewerActive Returns Boolean
71416>>>>>>>        Function_Return (WP_GetViewerWindow()<>0)
71417>>>>>>>    End_Function
71418>>>>>>>    
71418>>>>>>>    Function IsPrinterValid Returns Boolean
71420>>>>>>>        Function_Return (WP_IsPrinterValid()<>0)
71421>>>>>>>    End_Function
71422>>>>>>>    
71422>>>>>>>    Function ArePrintersInstalled Returns Boolean
71424>>>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
71425>>>>>>>    End_Function
71426>>>>>>>    
71426>>>>>>>    
71426>>>>>>>    // returns docucument state: dsNotStarted, dsStarted, dsFinished
71426>>>>>>>    Function DocumentStatus Returns Integer
71428>>>>>>>        Function_Return (WP_GetDocumentStatus())
71429>>>>>>>    End_Function
71430>>>>>>>    
71430>>>>>>>    // Might still be called from report class. Leave dummy stub
71430>>>>>>>    Procedure DFZeroCounters
71432>>>>>>>    End_Procedure
71433>>>>>>>    
71433>>>>>>>    //
71433>>>>>>>    Function DFNewPage Integer Columns Returns Integer
71435>>>>>>>        Integer iPageNum
71435>>>>>>>        // This returns a page number used in report object....(this may change)
71435>>>>>>>        Move (WP_CreatePage(Columns)) to iPageNum
71436>>>>>>>        If (iPageNum=0) Begin
71438>>>>>>>            Error DFERR_WINPRINT DFPrintError900
71439>>>>>>>>
71439>>>>>>>        End
71439>>>>>>>>
71439>>>>>>>        Function_Return iPageNum
71440>>>>>>>    End_Function
71441>>>>>>>    
71441>>>>>>>    //Return handle to use for winprint dialog. If main_window
71441>>>>>>>    //   exists, use it. Else, get object's handle
71441>>>>>>>    Function Report_Window_Handle Returns Handle
71443>>>>>>>        Handle hWnd
71443>>>>>>>        Handle hoObj
71443>>>>>>>        Get Focus of desktop to hoObj // start with the focus
71444>>>>>>>        Move (gOwnerWindowHandle(hoObj)) to hWnd // global function finds the right handle for us
71445>>>>>>>        Function_Return hWnd
71446>>>>>>>    End_Function
71447>>>>>>>    
71447>>>>>>>    
71447>>>>>>>    //
71447>>>>>>>    Function DFPrintDialog Returns Boolean
71449>>>>>>>        Handle hwnd
71449>>>>>>>        Boolean bOk
71449>>>>>>>        
71449>>>>>>>        Get Report_Window_Handle to hWnd
71450>>>>>>>        Move (WP_ExecutePrintDialog(hwnd)) to bOk
71451>>>>>>>        
71451>>>>>>>        Function_Return bOk
71452>>>>>>>    End_Function
71453>>>>>>>    
71453>>>>>>>    
71453>>>>>>>    // You can only invoke the print setup if the report is cleared. If you try to to do this in
71453>>>>>>>    //    the wrong state you will get an error.
71453>>>>>>>    Function DFPrintSetupDialog Returns Boolean
71455>>>>>>>        Handle hwnd
71455>>>>>>>        Boolean bOk
71455>>>>>>>        Integer iStatus
71455>>>>>>>        Get ArePrintersInstalled to bOk
71456>>>>>>>        If not bOk Begin
71458>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
71459>>>>>>>>
71459>>>>>>>        End
71459>>>>>>>>
71459>>>>>>>        Else Begin
71460>>>>>>>            Get DocumentStatus to iStatus
71461>>>>>>>            
71461>>>>>>>            If (iStatus=dsNotStarted) Begin
71463>>>>>>>                Get Report_Window_Handle to hWnd
71464>>>>>>>                Move (WP_ExecutePrinterSetupDialog(hwnd)) to bOk
71465>>>>>>>                
71465>>>>>>>                // test that the selected printer is valid....
71465>>>>>>>                If bOK Begin
71467>>>>>>>                    Get IsPrinterValid to bOk // if printer not valid, it's not ok
71468>>>>>>>                    If not bOk Begin
71470>>>>>>>                        Error DFERR_WINPRINT DFPrintError936  // could not select a valid printer
71471>>>>>>>>
71471>>>>>>>                    End
71471>>>>>>>>
71471>>>>>>>                End
71471>>>>>>>>
71471>>>>>>>            End
71471>>>>>>>>
71471>>>>>>>            Else Begin
71472>>>>>>>                Error DFERR_WINPRINT DFPrintError966      // cannot change printer when report is active
71473>>>>>>>>
71473>>>>>>>            End
71473>>>>>>>>
71473>>>>>>>        End
71473>>>>>>>>
71473>>>>>>>        Function_Return bOk
71474>>>>>>>    End_Function
71475>>>>>>>    
71475>>>>>>>    
71475>>>>>>>    // Provided for backwards compatibility. DFPrintSetupDialog is more flexible because it returns a
71475>>>>>>>    //    false if cancel was selected.
71475>>>>>>>    Procedure DFPrintSetup
71477>>>>>>>        Boolean bOk
71477>>>>>>>        Get DFPrintSetupDialog to bOk
71478>>>>>>>    End_Procedure
71479>>>>>>>    
71479>>>>>>>    // This invokes the print job dialog, prints the report, then clears the report document.
71479>>>>>>>    //    This should be called after the report is complete.
71479>>>>>>>    Procedure DFPrint
71481>>>>>>>        Integer bOk
71481>>>>>>>        Get DFPrintDialog to bOk
71482>>>>>>>        If bOk Begin
71484>>>>>>>            Send DFPrintDoc
71485>>>>>>>            Send DFClearDoc
71486>>>>>>>        End
71486>>>>>>>>
71486>>>>>>>    End_Procedure
71487>>>>>>>    
71487>>>>>>>    Procedure DFSuspendGui Boolean bSuspend
71489>>>>>>>        If (bSuspend<>pbIsSuspended(Self)) Begin
71491>>>>>>>            Send SuspendGui of Desktop bSuspend
71492>>>>>>>            Set pbIsSuspended to bSuspend
71493>>>>>>>        End
71493>>>>>>>>
71493>>>>>>>    End_Procedure
71494>>>>>>>    
71494>>>>>>>    // this is protected so that the queue is only pumped if the
71494>>>>>>>    // gui is suspended.
71494>>>>>>>    Procedure PumpMsgQueue
71496>>>>>>>        If (pbIsSuspended(Self)) Begin
71498>>>>>>>            Send PumpMsgQueue of desktop // permit painting
71499>>>>>>>        End
71499>>>>>>>>
71499>>>>>>>    End_Procedure
71500>>>>>>>    
71500>>>>>>>    
71500>>>>>>>    // This does a modeless preview. This is what you'd want during
71500>>>>>>>    //    report generation and it may be what you want for report viewing.
71500>>>>>>>    Procedure DFPreviewNoWait
71502>>>>>>>        Boolean bOk
71502>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
71502>>>>>>>        Integer iStatus
71502>>>>>>>        Get PrintDlgInPreview to bPrntDlg
71503>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
71504>>>>>>>        Get EnablePrintFromPreview to bPrint
71505>>>>>>>        Get DocumentStatus to iStatus
71506>>>>>>>        If (iStatus=dsStarted) Begin
71508>>>>>>>            Send DfSuspendGui True
71509>>>>>>>        End
71509>>>>>>>>
71509>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) to bOk
71510>>>>>>>        If not bOk Begin
71512>>>>>>>            Error DFERR_WINPRINT DFPrintError901
71513>>>>>>>>
71513>>>>>>>            Send DfSuspendGui False
71514>>>>>>>        End
71514>>>>>>>>
71514>>>>>>>    End_Procedure
71515>>>>>>>    
71515>>>>>>>    
71515>>>>>>>    // This does a modal preview. You might want this for report
71515>>>>>>>    //    viewing as the program knows when the viewer is closed
71515>>>>>>>    // Note that this is a private message and it was never intended that this
71515>>>>>>>    // should be used. We expect winprint reports to use modeless viewers.
71515>>>>>>>    Procedure DFPreviewWait
71517>>>>>>>        Handle hViewerProcess
71517>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
71517>>>>>>>        Integer iRetVal
71517>>>>>>>        Handle hwMain hMain
71517>>>>>>>        
71517>>>>>>>        Get PrintDlgInPreview to bPrntDlg
71518>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
71519>>>>>>>        Get EnablePrintFromPreview to bPrint
71520>>>>>>>        
71520>>>>>>>        Send DfSuspendGui True
71521>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) to hViewerProcess
71522>>>>>>>        
71522>>>>>>>        If (hViewerProcess = 0) Begin
71524>>>>>>>            Error DFERR_WINPRINT DFPrintError901
71525>>>>>>>>
71525>>>>>>>        End
71525>>>>>>>>
71525>>>>>>>        Else Begin
71526>>>>>>>            // We need to wait for either the Viewer to close, or a WM_PAINT message in the thread's queue...
71526>>>>>>>            Repeat
71526>>>>>>>>
71526>>>>>>>                Move (MsgWaitForMultipleObjects(1, AddressOf(hViewerProcess), False, INFINITE, QS_PAINT)) to iRetVal
71527>>>>>>>                Send PumpMsgQueue // permit painting
71528>>>>>>>            Until (iRetVal = 0) // 0 means that the viewer process terminated
71530>>>>>>>        End
71530>>>>>>>>
71530>>>>>>>        Send DfSuspendGui False
71531>>>>>>>        
71531>>>>>>>        // Do what we can to force VDF application to the top.
71531>>>>>>>        // As 12.0 dfSuspendGUI actually properly disables the underlying windows. When the viewer
71531>>>>>>>        // is closed it cannot give the focus back to this so it goes elsewhere. This will force it
71531>>>>>>>        // back.
71531>>>>>>>        
71531>>>>>>>        Get main_window of desktop to hMain
71532>>>>>>>        If hMain Begin
71534>>>>>>>            Get window_handle of hMain to hwMain
71535>>>>>>>            If hwMain Begin
71537>>>>>>>                If (GetForegroundWindow()<>hwMain) Begin
71539>>>>>>>                    Move (SetForegroundWindow(hwMain)) to hwMain
71540>>>>>>>                End
71540>>>>>>>>
71540>>>>>>>            End
71540>>>>>>>>
71540>>>>>>>        End
71540>>>>>>>>
71540>>>>>>>        
71540>>>>>>>    End_Procedure
71541>>>>>>>    
71541>>>>>>>    Procedure DfPreview
71543>>>>>>>        Send DfPreviewNoWait
71544>>>>>>>    End_Procedure
71545>>>>>>>    
71545>>>>>>>    
71545>>>>>>>    //
71545>>>>>>>    Procedure DFPrintDoc
71547>>>>>>>        Handle hwnd
71547>>>>>>>        Boolean bOk
71547>>>>>>>        Get Report_Window_Handle to hWnd
71548>>>>>>>        Move (WP_PrintDocument(hwnd)) to bOk
71549>>>>>>>        
71549>>>>>>>        If not bOk Begin
71551>>>>>>>            Error DFERR_WINPRINT DFPrintError902
71552>>>>>>>>
71552>>>>>>>        End
71552>>>>>>>>
71552>>>>>>>    End_Procedure
71553>>>>>>>    
71553>>>>>>>    
71553>>>>>>>    //
71553>>>>>>>    Procedure DFClearDoc
71555>>>>>>>        Boolean bOk
71555>>>>>>>        Get ArePrintersInstalled to bOk
71556>>>>>>>        If bOk Begin
71558>>>>>>>            Move (WP_ClearDocument()) to bOk
71559>>>>>>>            Send DFSuspendGUI False
71560>>>>>>>            If not bOk Begin
71562>>>>>>>                Error DFERR_WINPRINT DFPrintError903 // error number right?
71563>>>>>>>>
71563>>>>>>>            End
71563>>>>>>>>
71563>>>>>>>        End
71563>>>>>>>>
71563>>>>>>>    End_Procedure
71564>>>>>>>    
71564>>>>>>>    Procedure DFNewDoc Boolean bAutoPreview
71566>>>>>>>        Boolean bOk
71566>>>>>>>        // this is the most likely place we will encounter when we start a report. Check for
71566>>>>>>>        // printers and return an explicit error to make it easy to identify the error
71566>>>>>>>        Get ArePrintersInstalled to bOk
71567>>>>>>>        If not bOk Begin
71569>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
71570>>>>>>>>
71570>>>>>>>        End
71570>>>>>>>>
71570>>>>>>>        Else Begin
71571>>>>>>>            Send DfClearDoc // a new doc should always start with a clear
71572>>>>>>>            If bAutoPreview ;                Send DFSuspendGUI True
71575>>>>>>>            Move (WP_NewDocument(bAutoPreview)) to bOk
71576>>>>>>>            
71576>>>>>>>            If not bOk Begin
71578>>>>>>>                Error DFERR_WINPRINT DFPrintError902  // could not print document
71579>>>>>>>>
71579>>>>>>>                Send DFSuspendGUI False
71580>>>>>>>            End
71580>>>>>>>>
71580>>>>>>>        End
71580>>>>>>>>
71580>>>>>>>    End_Procedure
71581>>>>>>>    
71581>>>>>>>    //
71581>>>>>>>    Procedure DFSetFont String sFontName
71583>>>>>>>        Boolean bOk
71583>>>>>>>        Move (WP_SetFontName(sFontName)) to bOk
71584>>>>>>>        
71584>>>>>>>        If not bOK Begin
71586>>>>>>>            Error DFERR_WINPRINT DFPrintError904
71587>>>>>>>>
71587>>>>>>>        End
71587>>>>>>>>
71587>>>>>>>    End_Procedure
71588>>>>>>>    
71588>>>>>>>    
71588>>>>>>>    //
71588>>>>>>>    Procedure DFSetFontSize Integer iHeight Integer iWidth
71590>>>>>>>        Boolean bOk
71590>>>>>>>        // note that width is ignored in new implementation
71590>>>>>>>        Move (WP_SetFontHeight(iHeight)) to bOk
71591>>>>>>>        
71591>>>>>>>        If not bOK Begin
71593>>>>>>>            Error DFERR_WINPRINT  DFPrintError905
71594>>>>>>>>
71594>>>>>>>        End
71594>>>>>>>>
71594>>>>>>>    End_Procedure
71595>>>>>>>    
71595>>>>>>>    
71595>>>>>>>    //
71595>>>>>>>    Procedure DFSetFontStyle DWord dwStyle
71597>>>>>>>        Boolean bOk
71597>>>>>>>        Move (WP_SetFontStyle(dwStyle)) to bOk
71598>>>>>>>        
71598>>>>>>>        If not bOK Begin
71600>>>>>>>            Error DFERR_WINPRINT DFPrintError906
71601>>>>>>>>
71601>>>>>>>        End
71601>>>>>>>>
71601>>>>>>>    End_Procedure
71602>>>>>>>    
71602>>>>>>>    
71602>>>>>>>    //
71602>>>>>>>    Procedure DFSetUnderline Boolean bUnderline
71604>>>>>>>        Boolean bOk
71604>>>>>>>        
71604>>>>>>>        Move (WP_SetFontUnderline(bUnderline)) to bOk
71605>>>>>>>        
71605>>>>>>>        If not bOK Begin
71607>>>>>>>            Error DFERR_WINPRINT DFPrintError907
71608>>>>>>>>
71608>>>>>>>        End
71608>>>>>>>>
71608>>>>>>>    End_Procedure
71609>>>>>>>    
71609>>>>>>>    
71609>>>>>>>    //
71609>>>>>>>    Procedure DFSetBold Boolean bBold
71611>>>>>>>        Boolean bOk
71611>>>>>>>        
71611>>>>>>>        Move (WP_SetFontBold(bBold)) to bOk
71612>>>>>>>        
71612>>>>>>>        If not bOK Begin
71614>>>>>>>            Error DFERR_WINPRINT DFPrintError908
71615>>>>>>>>
71615>>>>>>>        End
71615>>>>>>>>
71615>>>>>>>    End_Procedure
71616>>>>>>>    
71616>>>>>>>    
71616>>>>>>>    //
71616>>>>>>>    Procedure DFSetItalic Boolean bItalic
71618>>>>>>>        Boolean bOk
71618>>>>>>>        
71618>>>>>>>        Move (WP_SetFontItalic(bItalic)) to bOk
71619>>>>>>>        
71619>>>>>>>        If not bOK Begin
71621>>>>>>>            Error DFERR_WINPRINT DFPrintError909
71622>>>>>>>>
71622>>>>>>>        End
71622>>>>>>>>
71622>>>>>>>    End_Procedure
71623>>>>>>>    
71623>>>>>>>    
71623>>>>>>>    //
71623>>>>>>>    Procedure DFSetStrikeout Boolean bStrikeout
71625>>>>>>>        Boolean bOk
71625>>>>>>>        
71625>>>>>>>        Move (WP_SetFontStrikeout(bStrikeout)) to bOk
71626>>>>>>>        
71626>>>>>>>        If not bOK Begin
71628>>>>>>>            Error DFERR_WINPRINT DFPrintError910
71629>>>>>>>>
71629>>>>>>>        End
71629>>>>>>>>
71629>>>>>>>    End_Procedure
71630>>>>>>>    
71630>>>>>>>    
71630>>>>>>>    //
71630>>>>>>>    Procedure DFSetMargins Number nLeft Number nTop Number nRight Number nBottom
71632>>>>>>>        Boolean bOk
71632>>>>>>>        Integer iLeft iRight iTop iBottom
71632>>>>>>>        
71632>>>>>>>        Move (nLeft   * 100) to iLeft
71633>>>>>>>        Move (nRight  * 100) to iRight
71634>>>>>>>        Move (nTop    * 100) to iTop
71635>>>>>>>        Move (nBottom * 100) to iBottom
71636>>>>>>>        
71636>>>>>>>        Move (WP_SetMargins(iLeft,iTop,iRight,iBottom)) to bOk
71637>>>>>>>        
71637>>>>>>>        If bOk Begin
71639>>>>>>>            Set DFLeft_Margin   to nLeft
71640>>>>>>>            Set DFTop_Margin    to nTop
71641>>>>>>>            Set DFRight_Margin  to nRight
71642>>>>>>>            Set DFBottom_Margin to nBottom
71643>>>>>>>        End
71643>>>>>>>>
71643>>>>>>>        Else Begin
71644>>>>>>>            Error DFERR_WINPRINT DFPrintError911
71645>>>>>>>>
71645>>>>>>>        End
71645>>>>>>>>
71645>>>>>>>    End_Procedure
71646>>>>>>>    
71646>>>>>>>    
71646>>>>>>>    //
71646>>>>>>>    Procedure DFSetLeftMargin Number nLeft
71648>>>>>>>        Number  nTop nRight nBottom
71648>>>>>>>        Get DFTop_Margin    to nTop
71649>>>>>>>        Get DFRight_Margin  to nRight
71650>>>>>>>        Get DFBottom_Margin to nBottom
71651>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
71652>>>>>>>    End_Procedure
71653>>>>>>>    
71653>>>>>>>    
71653>>>>>>>    //
71653>>>>>>>    Procedure DFSetRightMargin Number nRight
71655>>>>>>>        Number  nLeft nTop nBottom
71655>>>>>>>        Get DFLeft_Margin   to nLeft
71656>>>>>>>        Get DFTop_Margin    to nTop
71657>>>>>>>        Get DFBottom_Margin to nBottom
71658>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
71659>>>>>>>    End_Procedure
71660>>>>>>>    
71660>>>>>>>    
71660>>>>>>>    //
71660>>>>>>>    Procedure DFSetTopMargin Number nTop
71662>>>>>>>        Number  nLeft nRight nBottom
71662>>>>>>>        Get DFLeft_Margin   to nLeft
71663>>>>>>>        Get DFRight_Margin  to nRight
71664>>>>>>>        Get DFBottom_Margin to nBottom
71665>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
71666>>>>>>>    End_Procedure
71667>>>>>>>    
71667>>>>>>>    
71667>>>>>>>    //
71667>>>>>>>    Procedure DFSetBottomMargin Number nBottom
71669>>>>>>>        Number  nLeft nTop nRight
71669>>>>>>>        Get DFLeft_Margin   to nLeft
71670>>>>>>>        Get DFTop_Margin    to nTop
71671>>>>>>>        Get DFRight_Margin  to nRight
71672>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
71673>>>>>>>    End_Procedure
71674>>>>>>>    
71674>>>>>>>    
71674>>>>>>>    //
71674>>>>>>>    Procedure DFWriteText String sText Integer iStyle Integer iColumn Integer iDecimal Boolean bNewLineAfterPrint
71676>>>>>>>        Boolean bOk
71676>>>>>>>        
71676>>>>>>>        Send DFSetFontStyle iStyle
71677>>>>>>>        Move (ToAnsi(sText)) to sText
71678>>>>>>>        Move (WP_WriteText(sText,bNewLineAfterPrint,iColumn,iDecimal,0)) to bOk
71679>>>>>>>        If not bOk Begin
71681>>>>>>>            Error DFERR_WINPRINT DFPrintError918
71682>>>>>>>>
71682>>>>>>>        End
71682>>>>>>>>
71682>>>>>>>        Send PumpMsgQueue // permit painting
71683>>>>>>>    End_Procedure
71684>>>>>>>    
71684>>>>>>>    //
71684>>>>>>>    Procedure DFWrite String sText DWord iStyle Integer iColumn Integer iDecimal Boolean bTrim
71686>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
71688>>>>>>>            Move (Rtrim(sText)) to sText
71689>>>>>>>        End
71689>>>>>>>>
71689>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal False
71690>>>>>>>    End_Procedure
71691>>>>>>>    
71691>>>>>>>    //
71691>>>>>>>    Procedure DFWriteLn String sText DWord iStyle Integer iColumn Integer iDecimal Boolean bTrim
71693>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
71695>>>>>>>            Move (Rtrim(sText)) to sText
71696>>>>>>>        End
71696>>>>>>>>
71696>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal True
71697>>>>>>>    End_Procedure
71698>>>>>>>    
71698>>>>>>>    
71698>>>>>>>    //
71698>>>>>>>    Procedure DFWriteTextAtPosition String sText Integer iStyle Number nPosition Integer iDecimal ;            Number nMaxLength Boolean bNewLineAfterPrint
71700>>>>>>>        Boolean bOk
71700>>>>>>>        Integer iPosition iMaxLength
71700>>>>>>>        Send DFSetFontStyle iStyle
71701>>>>>>>        Move (ToAnsi(sText)) to sText
71702>>>>>>>        Move (nPosition * 100) to iPosition
71703>>>>>>>        Move (nMaxLength * 100) to iMaxLength
71704>>>>>>>        Move (WP_WriteTextAtPosition(sText,bNewLineAfterPrint,iPosition,iDecimal,iMaxLength)) to bOk
71705>>>>>>>        If not bOk Begin
71707>>>>>>>            Error DFERR_WINPRINT DFPrintError922
71708>>>>>>>>
71708>>>>>>>        End
71708>>>>>>>>
71708>>>>>>>        Send PumpMsgQueue // permit painting
71709>>>>>>>    End_Procedure
71710>>>>>>>    
71710>>>>>>>    //
71710>>>>>>>    Procedure DFWritePos String sText Integer iStyle Number nPosition Integer iDecimal Number nMaxLength Boolean bTrim
71712>>>>>>>        Number nMax
71712>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
71714>>>>>>>            Move (Rtrim(sText)) to sText
71715>>>>>>>        End
71715>>>>>>>>
71715>>>>>>>        
71715>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
71718>>>>>>>        Else ;            Move nMaxLength to nMax
71720>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax False
71721>>>>>>>    End_Procedure
71722>>>>>>>    
71722>>>>>>>    //
71722>>>>>>>    Procedure DFWriteLnPos String sText Integer iStyle Number nPosition Integer iDecimal Number nMaxLength Boolean bTrim
71724>>>>>>>        Number nMax
71724>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
71726>>>>>>>            Move (Rtrim(sText)) to sText
71727>>>>>>>        End
71727>>>>>>>>
71727>>>>>>>        
71727>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
71730>>>>>>>        Else ;            Move nMaxLength to nMax
71732>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax True
71733>>>>>>>    End_Procedure
71734>>>>>>>    
71734>>>>>>>    Procedure DFSetMetrics String sMetrics
71736>>>>>>>        Integer eMetrics
71736>>>>>>>        // for backwards compatibility support both string names and integer enumerations
71736>>>>>>>        // it is better to use the enumeration value
71736>>>>>>>        If (sMetrics="INCH" or sMetrics="CM") Begin
71738>>>>>>>            Set DFCurrent_Metrics to sMetrics
71739>>>>>>>        End
71739>>>>>>>>
71739>>>>>>>        Else Begin
71740>>>>>>>            Move sMetrics to eMetrics
71741>>>>>>>            Move (WP_SetMetrics(eMetrics)) to eMetrics
71742>>>>>>>        End
71742>>>>>>>>
71742>>>>>>>    End_Procedure
71743>>>>>>>    
71743>>>>>>>    Function DFGetMetrics Returns Integer
71745>>>>>>>        Integer eMetrics
71745>>>>>>>        Move (WP_GetMetrics()) to eMetrics
71746>>>>>>>        Function_Return eMetrics
71747>>>>>>>    End_Function
71748>>>>>>>    
71748>>>>>>>    
71748>>>>>>>    // Properties Maintained for compatibility with old Winprint (obsolete)
71748>>>>>>>    Function DFCurrent_Metrics Returns String
71750>>>>>>>        Integer eMetrics
71750>>>>>>>        Get DFGetMetrics to eMetrics
71751>>>>>>>        Function_Return (If(eMetrics=WPM_INCH,"INCH","CM"))
71752>>>>>>>    End_Function
71753>>>>>>>    
71753>>>>>>>    Procedure Set DFCurrent_Metrics String sCMorINCH
71755>>>>>>>        Send DFSetMetrics (If(sCMorINCH="INCH", WPM_INCH, WPM_CM))
71756>>>>>>>    End_Procedure
71757>>>>>>>    
71757>>>>>>>    
71757>>>>>>>    
71757>>>>>>>    
71757>>>>>>>    
71757>>>>>>>    //
71757>>>>>>>    Procedure DFBeginHeaderType Integer iHeaderNr Integer eHeaderType
71759>>>>>>>        Boolean bOk
71759>>>>>>>        
71759>>>>>>>        If (eHeaderType=DFSubHeader or eHeaderType=DFSubTotal) Begin
71761>>>>>>>            // Do nothing for the moment
71761>>>>>>>        End
71761>>>>>>>>
71761>>>>>>>        Else ;            Move 0 to iHeaderNr // If the user made a mistake
71763>>>>>>>        
71763>>>>>>>        Set DFCurrent_HeaderType to eHeaderType
71764>>>>>>>        Set DFCurrent_HeaderNr   to iHeaderNr
71765>>>>>>>        
71765>>>>>>>        Move (WP_BeginHeader(eHeaderType, iHeaderNr)) to bOk
71766>>>>>>>        
71766>>>>>>>        If not bOk Begin
71768>>>>>>>            Error DFERR_WINPRINT DFPrintError925
71769>>>>>>>>
71769>>>>>>>        End
71769>>>>>>>>
71769>>>>>>>    End_Procedure
71770>>>>>>>    
71770>>>>>>>    
71770>>>>>>>    //
71770>>>>>>>    Procedure DFEndHeaderType
71772>>>>>>>        Boolean bOk
71772>>>>>>>        
71772>>>>>>>        Move (WP_EndHeader()) to bOk
71773>>>>>>>        
71773>>>>>>>        If not bOk Begin
71775>>>>>>>            Error DFERR_WINPRINT DFPrintError926
71776>>>>>>>>
71776>>>>>>>        End
71776>>>>>>>>
71776>>>>>>>    End_Procedure
71777>>>>>>>    
71777>>>>>>>    
71777>>>>>>>    //
71777>>>>>>>    Procedure DFWriteHeaderType Integer iHeaderNr Integer eHeaderType
71779>>>>>>>        Boolean bOk
71779>>>>>>>        Move (WP_WriteHeader(eHeaderType, iHeaderNr)) to bOk
71780>>>>>>>        If not bOk Begin
71782>>>>>>>            Error DFERR_WINPRINT DFPrintError927
71783>>>>>>>>
71783>>>>>>>        End
71783>>>>>>>>
71783>>>>>>>    End_Procedure
71784>>>>>>>    
71784>>>>>>>    
71784>>>>>>>    //
71784>>>>>>>    Procedure DFHeaderPosition Integer ePlace
71786>>>>>>>        Boolean bOk
71786>>>>>>>        
71786>>>>>>>        Move (WP_SetHeaderPlacement(ePlace)) to bOk
71787>>>>>>>        
71787>>>>>>>        If not bOk Begin
71789>>>>>>>            Error DFERR_WINPRINT DFPrintError929
71790>>>>>>>>
71790>>>>>>>        End
71790>>>>>>>>
71790>>>>>>>    End_Procedure
71791>>>>>>>    
71791>>>>>>>    
71791>>>>>>>    //
71791>>>>>>>    Procedure DFHeaderFrameType Integer eFrame Integer iColor Number nWeight;            Integer iFillColor Boolean bFillFrame
71793>>>>>>>        Integer iWeight
71793>>>>>>>        Boolean bOk
71793>>>>>>>        
71793>>>>>>>        Move (nWeight*100) to iWeight
71794>>>>>>>        
71794>>>>>>>        Move (WP_SetHeaderFrame(eFrame,iColor,iWeight,iFillColor,bFillFrame)) to bOk
71795>>>>>>>        
71795>>>>>>>        If not bOk Begin
71797>>>>>>>            Error DFERR_WINPRINT DFPrintError930
71798>>>>>>>>
71798>>>>>>>        End
71798>>>>>>>>
71798>>>>>>>    End_Procedure
71799>>>>>>>    
71799>>>>>>>    Procedure DFHeaderMargin Integer eType Number nSize
71801>>>>>>>        Boolean bOk
71801>>>>>>>        Integer iSize
71801>>>>>>>        
71801>>>>>>>        Move (nSize * 100) to iSize
71802>>>>>>>        
71802>>>>>>>        Move (WP_SetHeaderMargin(eType, iSize)) to bOk
71803>>>>>>>        
71803>>>>>>>        If not bOk Begin
71805>>>>>>>            Error DFERR_WINPRINT DFPrintError930
71806>>>>>>>>
71806>>>>>>>        End
71806>>>>>>>>
71806>>>>>>>    End_Procedure
71807>>>>>>>    
71807>>>>>>>    
71807>>>>>>>    //
71807>>>>>>>    Procedure DFHeaderWrap Integer eOnOff
71809>>>>>>>        Boolean bOk
71809>>>>>>>        
71809>>>>>>>        Move (WP_SetHeaderWrap(eOnOff)) to bOk
71810>>>>>>>        
71810>>>>>>>        If not bOk Begin
71812>>>>>>>            Error DFERR_WINPRINT DFPrintError931
71813>>>>>>>>
71813>>>>>>>        End
71813>>>>>>>>
71813>>>>>>>    End_Procedure
71814>>>>>>>    
71814>>>>>>>    //
71814>>>>>>>    Procedure DFWriteBMP String sFileName Number nStartX Number nStartY Number nHeight Number nWidth Boolean bUCp
71816>>>>>>>        Boolean bOk
71816>>>>>>>        Integer iStartX iStartY iHeight iWidth
71816>>>>>>>        
71816>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            Move nStartX to iStartX
71819>>>>>>>        Else ;            Move (nStartX*100) to iStartX
71821>>>>>>>        
71821>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            Move nStartY to iStartY
71824>>>>>>>        Else ;            Move (nStartY*100) to iStartY
71826>>>>>>>        
71826>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            Move nWidth to iWidth
71829>>>>>>>        Else ;            Move (nWidth*100) to iWidth
71831>>>>>>>        
71831>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            Move nHeight to iHeight
71834>>>>>>>        Else ;            Move (nHeight*100) to iHeight
71836>>>>>>>        
71836>>>>>>>        Get_File_Path sFileName to sFileName
71837>>>>>>>        Move (WP_DrawBitmap(sFileName,iStartX,iStartY,iWidth,iHeight,bUCp)) to bOk
71838>>>>>>>        
71838>>>>>>>        If not bOk Begin
71840>>>>>>>            Error DFERR_WINPRINT DFPrintError932
71841>>>>>>>>
71841>>>>>>>        End
71841>>>>>>>>
71841>>>>>>>    End_Procedure
71842>>>>>>>    
71842>>>>>>>    
71842>>>>>>>    //
71842>>>>>>>    Procedure DFHeaderLineCheck Integer iLines
71844>>>>>>>        Boolean bOk
71844>>>>>>>        
71844>>>>>>>        Move (WP_SetExtraLineCheck(iLines)) to bOk
71845>>>>>>>        
71845>>>>>>>        If not bOk Begin
71847>>>>>>>            Error DFERR_WINPRINT DFPrintError934
71848>>>>>>>>
71848>>>>>>>        End
71848>>>>>>>>
71848>>>>>>>    End_Procedure
71849>>>>>>>    
71849>>>>>>>    
71849>>>>>>>    //
71849>>>>>>>    Procedure DFPrintFlags Integer Flags
71851>>>>>>>        Boolean bOk
71851>>>>>>>        
71851>>>>>>>        Move (WP_SetPrintDialogFlags(Flags)) to bOk
71852>>>>>>>        
71852>>>>>>>        If not bOk Begin
71854>>>>>>>            Error DFERR_WINPRINT DFPrintError935
71855>>>>>>>>
71855>>>>>>>        End
71855>>>>>>>>
71855>>>>>>>    End_Procedure
71856>>>>>>>    
71856>>>>>>>    
71856>>>>>>>    // obsolete and maintained for winprint-I backwards compatibility (maybe should be removed)
71856>>>>>>>    //
71856>>>>>>>    Procedure DFSelectPrinter String sDriver String sDevice String sPort Boolean bUpdate
71858>>>>>>>        Send DFSetDevice sDevice
71859>>>>>>>    End_Procedure
71860>>>>>>>    
71860>>>>>>>    // Preferred usage for WinprintII
71860>>>>>>>    Procedure DFSetDevice String sDevice
71862>>>>>>>        Boolean bOk
71862>>>>>>>        
71862>>>>>>>        Move (WP_SelectPrinter(sDevice)) to bOk
71863>>>>>>>        
71863>>>>>>>        If not bOk Begin
71865>>>>>>>            Error DFERR_WINPRINT DFPrintError936
71866>>>>>>>>
71866>>>>>>>        End
71866>>>>>>>>
71866>>>>>>>    End_Procedure
71867>>>>>>>    
71867>>>>>>>    Procedure DFPrinterBinFirstPage Integer eBin
71869>>>>>>>        Boolean bOk
71869>>>>>>>        
71869>>>>>>>        Move (WP_SetFirstPagePaperSource(eBin)) to bOk
71870>>>>>>>        
71870>>>>>>>        If not bOk Begin
71872>>>>>>>            Error DFERR_WINPRINT DFPrintError937
71873>>>>>>>>
71873>>>>>>>        End
71873>>>>>>>>
71873>>>>>>>    End_Procedure
71874>>>>>>>    
71874>>>>>>>    
71874>>>>>>>    //
71874>>>>>>>    Function DFGetDFColor Integer iRed Integer iGreen Integer iBlue Returns Integer
71876>>>>>>>        Integer iColor
71876>>>>>>>        
71876>>>>>>>        Move (WP_RGBToDFPrintColor(iRed,iGreen,iBlue)) to iColor
71877>>>>>>>        
71877>>>>>>>        If (iColor=0) Begin
71879>>>>>>>            Error DFERR_WINPRINT DFPrintError938
71880>>>>>>>>
71880>>>>>>>        End
71880>>>>>>>>
71880>>>>>>>        Function_Return iColor
71881>>>>>>>    End_Function
71882>>>>>>>    
71882>>>>>>>    
71882>>>>>>>    //
71882>>>>>>>    Procedure DFSetDFColor DWord dwColor
71884>>>>>>>        Integer bOk
71884>>>>>>>        
71884>>>>>>>        Move (WP_SetFontColor(dwColor)) to bOk
71885>>>>>>>        
71885>>>>>>>        If not bOk Begin
71887>>>>>>>            Error DFERR_WINPRINT DFPrintError939
71888>>>>>>>>
71888>>>>>>>        End
71888>>>>>>>>
71888>>>>>>>    End_Procedure
71889>>>>>>>    
71889>>>>>>>    
71889>>>>>>>    //
71889>>>>>>>    Procedure DFSetTopBottom Number nTop Number nBottom Boolean bAllPages
71891>>>>>>>        Boolean bOk
71891>>>>>>>        Integer iTop iBottom
71891>>>>>>>        
71891>>>>>>>        Move (nTop*100)    to iTop
71892>>>>>>>        Move (nBottom*100) to iBottom
71893>>>>>>>        
71893>>>>>>>        Move (WP_SetAbsoluteMargins(iTop,iBottom,bAllPages)) to bOk
71894>>>>>>>        
71894>>>>>>>        If not bOk Begin
71896>>>>>>>            Error DFERR_WINPRINT DFPrintError940
71897>>>>>>>>
71897>>>>>>>        End
71897>>>>>>>>
71897>>>>>>>    End_Procedure
71898>>>>>>>    
71898>>>>>>>    
71898>>>>>>>    //
71898>>>>>>>    Procedure DFSetJMode Integer eAlign
71900>>>>>>>        Boolean bOk
71900>>>>>>>        
71900>>>>>>>        Move (WP_SetAlign(eAlign)) to bOk
71901>>>>>>>        
71901>>>>>>>        If not bOk Begin
71903>>>>>>>            Error DFERR_WINPRINT DFPrintError941
71904>>>>>>>>
71904>>>>>>>        End
71904>>>>>>>>
71904>>>>>>>    End_Procedure
71905>>>>>>>    
71905>>>>>>>    
71905>>>>>>>    //
71905>>>>>>>    Procedure DFWriteEllip Number nStartX Number nStartY Number nHeight Number nWidth ;            DWord dwBColor DWord dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
71907>>>>>>>        
71907>>>>>>>        Boolean bOk
71907>>>>>>>        Integer iWeight
71907>>>>>>>        Integer iStartX iStartY iHeight iWidth
71907>>>>>>>        
71907>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            Move nStartX to iStartX
71910>>>>>>>        Else ;            Move (nStartX*100) to iStartX
71912>>>>>>>        
71912>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            Move nStartY to iStartY
71915>>>>>>>        Else ;            Move (nStartY*100) to iStartY
71917>>>>>>>        
71917>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            Move nWidth to iWidth
71920>>>>>>>        Else ;            Move (nWidth*100) to iWidth
71922>>>>>>>        
71922>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            Move nHeight to iHeight
71925>>>>>>>        Else ;            Move (nHeight*100) to iHeight
71927>>>>>>>        
71927>>>>>>>        Move (nWeight*100) to iWeight
71928>>>>>>>        
71928>>>>>>>        
71928>>>>>>>        Move (WP_DrawEllipse(iStartX,iStartY,iWidth,iHeight,;            dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) to bOk
71929>>>>>>>        
71929>>>>>>>        If not bOk Begin
71931>>>>>>>            Error DFERR_WINPRINT DFPrintError942
71932>>>>>>>>
71932>>>>>>>        End
71932>>>>>>>>
71932>>>>>>>    End_Procedure
71933>>>>>>>    
71933>>>>>>>    
71933>>>>>>>    
71933>>>>>>>    
71933>>>>>>>    //
71933>>>>>>>    Procedure DFWriteRect Number nStartX Number nStartY Number nHeight Number nWidth;            DWord dwBColor DWord dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
71935>>>>>>>        
71935>>>>>>>        Boolean bOk
71935>>>>>>>        Integer iWeight
71935>>>>>>>        Integer iStartX iStartY iHeight iWidth
71935>>>>>>>        
71935>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            Move nStartX to iStartX
71938>>>>>>>        Else ;            Move (nStartX*100) to iStartX
71940>>>>>>>        
71940>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            Move nStartY to iStartY
71943>>>>>>>        Else ;            Move (nStartY*100) to iStartY
71945>>>>>>>        
71945>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            Move nWidth to iWidth
71948>>>>>>>        Else ;            Move (nWidth*100) to iWidth
71950>>>>>>>        
71950>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            Move nHeight to iHeight
71953>>>>>>>        Else ;            Move (nHeight*100) to iHeight
71955>>>>>>>        
71955>>>>>>>        Move (nWeight*100) to iWeight
71956>>>>>>>        
71956>>>>>>>        Move (WP_DrawRectangle(iStartX,iStartY,iWidth,iHeight,;            dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) to bOk
71957>>>>>>>        
71957>>>>>>>        If not bOk Begin
71959>>>>>>>            Error DFERR_WINPRINT DFPrintError944
71960>>>>>>>>
71960>>>>>>>        End
71960>>>>>>>>
71960>>>>>>>    End_Procedure
71961>>>>>>>    
71961>>>>>>>    
71961>>>>>>>    
71961>>>>>>>    
71961>>>>>>>    //
71961>>>>>>>    Procedure DFLineCheck Integer iLines
71963>>>>>>>        Boolean bOk
71963>>>>>>>        
71963>>>>>>>        Move (WP_ConfirmLines(iLines)) to bOk
71964>>>>>>>        
71964>>>>>>>        If not bOk Begin
71966>>>>>>>            Error DFERR_WINPRINT DFPrintError946
71967>>>>>>>>
71967>>>>>>>        End
71967>>>>>>>>
71967>>>>>>>    End_Procedure
71968>>>>>>>    
71968>>>>>>>    
71968>>>>>>>    //
71968>>>>>>>    Procedure DFCreateDiagram Integer eType Integer eFx Number nHeight Number nWidth Integer bXyAxis
71970>>>>>>>        Handle hDiagram
71970>>>>>>>        Integer iWidth iHeight
71970>>>>>>>        
71970>>>>>>>        Move (nHeight*100) to iHeight
71971>>>>>>>        Move (nWidth*100)  to iWidth
71972>>>>>>>        
71972>>>>>>>        Set DFCurrent_Color to 0
71973>>>>>>>        
71973>>>>>>>        Move (WP_CreateDiagram(eType,eFx,iWidth,iHeight,bXyAxis)) to hDiagram
71974>>>>>>>        
71974>>>>>>>        If (hDiagram) Begin
71976>>>>>>>            Error DFERR_WINPRINT DFPrintError947
71977>>>>>>>>
71977>>>>>>>        End
71977>>>>>>>>
71977>>>>>>>        Else Begin
71978>>>>>>>            Set DFCurrent_Diagram to hDiagram
71979>>>>>>>        End
71979>>>>>>>>
71979>>>>>>>    End_Procedure
71980>>>>>>>    
71980>>>>>>>    
71980>>>>>>>    //
71980>>>>>>>    Procedure DFDiagram_Item Handle hDiagram String sLabel Number nValue;            DWord dwBColor DWord dwFColor Integer eFill;            Integer iDec Integer eValueOrPercent Integer eExt
71982>>>>>>>        
71982>>>>>>>        Boolean bOk
71982>>>>>>>        Integer iCurrColor iValue
71982>>>>>>>        
71982>>>>>>>        If (dwFColor = -1) Begin
71984>>>>>>>            Get DFCurrent_Color to iCurrColor
71985>>>>>>>            Increment iCurrColor
71986>>>>>>>            If (iCurrColor>15) ;                Move 1 to iCurrColor
71989>>>>>>>            Set DFCurrent_Color to iCurrColor
71990>>>>>>>            Get DFGetColor iCurrColor to dwFColor
71991>>>>>>>        End
71991>>>>>>>>
71991>>>>>>>        
71991>>>>>>>        Move (nValue *100) to iValue
71992>>>>>>>        
71992>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
71993>>>>>>>        
71993>>>>>>>        Move (WP_AddDiagramEntry(hDiagram,sLabel,iValue,dwBColor,dwFColor,eFill,iDec,eValueorPercent,eExt)) to bOk
71994>>>>>>>        
71994>>>>>>>        If not bOk Begin
71996>>>>>>>            Error DFERR_WINPRINT DFPrintError948
71997>>>>>>>>
71997>>>>>>>        End
71997>>>>>>>>
71997>>>>>>>    End_Procedure
71998>>>>>>>    
71998>>>>>>>    
71998>>>>>>>    //
71998>>>>>>>    Procedure DFLockDiagram Handle hDiagram
72000>>>>>>>        Boolean bOk
72000>>>>>>>        
72000>>>>>>>        Move (WP_LockDiagram(hDiagram)) to bOk
72001>>>>>>>        
72001>>>>>>>        If not bOk Begin
72003>>>>>>>            Error DFERR_WINPRINT DFPrintError949
72004>>>>>>>>
72004>>>>>>>        End
72004>>>>>>>>
72004>>>>>>>    End_Procedure
72005>>>>>>>    
72005>>>>>>>    
72005>>>>>>>    
72005>>>>>>>    //
72005>>>>>>>    Procedure DFDrawDiagram Handle hDiagram Number nYPos Number nXPos Boolean bUCp
72007>>>>>>>        Boolean bOk
72007>>>>>>>        Integer iXPos
72007>>>>>>>        Integer iYPos
72007>>>>>>>        
72007>>>>>>>        Move (nXPos*100) to iXPos
72008>>>>>>>        Move (nYPos*100) to iYPos
72009>>>>>>>        
72009>>>>>>>        If (nYPos = -999) ;            Move -999 to iYPos
72012>>>>>>>        
72012>>>>>>>        Move (WP_DrawDiagram(hDiagram,iXPos,iYPos,bUCp)) to bOk
72013>>>>>>>        
72013>>>>>>>        If not bOk Begin
72015>>>>>>>            Error DFERR_WINPRINT DFPrintError950
72016>>>>>>>>
72016>>>>>>>        End
72016>>>>>>>>
72016>>>>>>>    End_Procedure
72017>>>>>>>    
72017>>>>>>>    
72017>>>>>>>    
72017>>>>>>>    //
72017>>>>>>>    Procedure DFDiagramLabel Handle hDiagram String sLabel
72019>>>>>>>        Boolean bOk
72019>>>>>>>        Integer iLabelLen
72019>>>>>>>        
72019>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
72020>>>>>>>        
72020>>>>>>>        Move (WP_SetDiagramCaption(hDiagram,sLabel)) to bOk
72021>>>>>>>        
72021>>>>>>>        If not bOk Begin
72023>>>>>>>            Error DFERR_WINPRINT DFPrintError952
72024>>>>>>>>
72024>>>>>>>        End
72024>>>>>>>>
72024>>>>>>>    End_Procedure
72025>>>>>>>    
72025>>>>>>>    
72025>>>>>>>    //
72025>>>>>>>    Procedure DFDiagramXLabel Handle hDiagram String sLabel
72027>>>>>>>        Boolean bOk
72027>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
72028>>>>>>>        
72028>>>>>>>        Move (WP_SetDiagramXText(hDiagram,sLabel)) to bOk
72029>>>>>>>        
72029>>>>>>>        If not bOk Begin
72031>>>>>>>            Error DFERR_WINPRINT DFPrintError953
72032>>>>>>>>
72032>>>>>>>        End
72032>>>>>>>>
72032>>>>>>>    End_Procedure
72033>>>>>>>    
72033>>>>>>>    
72033>>>>>>>    //
72033>>>>>>>    Procedure DFDiagramYLabel Handle hDiagram String sLabel Boolean bVertical
72035>>>>>>>        Boolean bOk
72035>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
72036>>>>>>>        
72036>>>>>>>        Move (WP_SetDiagramYText(hDiagram,sLabel,bVertical)) to bOk
72037>>>>>>>        
72037>>>>>>>        If not bOk Begin
72039>>>>>>>            Error DFERR_WINPRINT DFPrintError954
72040>>>>>>>>
72040>>>>>>>        End
72040>>>>>>>>
72040>>>>>>>    End_Procedure
72041>>>>>>>    
72041>>>>>>>    
72041>>>>>>>    //
72041>>>>>>>    Procedure DFWriteXYLine Number nStartX Number nStartY Number nStopX Number nStopY;            DWord dwColor Number nWeight Boolean bWrap Boolean bUCp
72043>>>>>>>        
72043>>>>>>>        Boolean bOk
72043>>>>>>>        Integer iStartX iStartY iStopX iStopY
72043>>>>>>>        Integer iWeight
72043>>>>>>>        
72043>>>>>>>        Move (nStartX*100)  to iStartX
72044>>>>>>>        Move (nStartY*100)  to iStartY
72045>>>>>>>        Move (nStopX*100)   to iStopX
72046>>>>>>>        Move (nStopY*100)   to iStopY
72047>>>>>>>        
72047>>>>>>>        Move (nWeight*100) to iWeight
72048>>>>>>>        
72048>>>>>>>        If (nStopY  = -998) ;            Move -998 to iStopY
72051>>>>>>>        If (nStopX  = -998) ;            Move -998 to iStopX
72054>>>>>>>        
72054>>>>>>>        If (nStartY  = -999) ;            Move -999 to iStartY
72057>>>>>>>        If (nStartX  = -999) ;            Move -999 to iStartX
72060>>>>>>>        
72060>>>>>>>        Move (WP_DrawXYLine(iStartX,iStartY,iStopX,iStopY,dwColor,iWeight,bUCp,bWrap)) to bOk
72061>>>>>>>        
72061>>>>>>>        If not bOk Begin
72063>>>>>>>            Error DFERR_WINPRINT DFPrintError955
72064>>>>>>>>
72064>>>>>>>        End
72064>>>>>>>>
72064>>>>>>>    End_Procedure
72065>>>>>>>    
72065>>>>>>>    
72065>>>>>>>    //
72065>>>>>>>    Procedure DFWriteLine Number nStartX Number nStartY Number nLength;            Boolean bHorizontal DWord dwColor Number nWeight Boolean bUCp
72067>>>>>>>        
72067>>>>>>>        Boolean bOk
72067>>>>>>>        Integer iStartX iStartY iLength
72067>>>>>>>        Integer iWeight
72067>>>>>>>        
72067>>>>>>>        Move (nStartX*100)  to iStartX
72068>>>>>>>        Move (nStartY*100)  to iStartY
72069>>>>>>>        Move (nLength*100)  to iLength
72070>>>>>>>        Move (nWeight*100)  to iWeight
72071>>>>>>>        
72071>>>>>>>        If (nStartY = -999) ;            Move -999 to iStartY
72074>>>>>>>        If (nStartX = -999) ;            Move -999 to iStartX
72077>>>>>>>        If (nLength = -998) ;            Move -998 to iLength
72080>>>>>>>        
72080>>>>>>>        Move (WP_DrawLine(iSTartX,iStartY,iLength,bHorizontal,dwColor,iWeight,bUCp)) to bOk
72081>>>>>>>        
72081>>>>>>>        If not bOk Begin
72083>>>>>>>            Error DFERR_WINPRINT DFPrintError956
72084>>>>>>>>
72084>>>>>>>        End
72084>>>>>>>>
72084>>>>>>>    End_Procedure
72085>>>>>>>    
72085>>>>>>>    
72085>>>>>>>    //
72085>>>>>>>    Procedure DFClearPrinter
72087>>>>>>>        Boolean bOk
72087>>>>>>>        
72087>>>>>>>        Move (WP_ClearPrinter()) to bOk
72088>>>>>>>        
72088>>>>>>>        If not bOk Begin
72090>>>>>>>            Error DFERR_WINPRINT DFPrintError957
72091>>>>>>>>
72091>>>>>>>        End
72091>>>>>>>>
72091>>>>>>>    End_Procedure
72092>>>>>>>    
72092>>>>>>>    
72092>>>>>>>    
72092>>>>>>>    //
72092>>>>>>>    Function DFGetCurrentDevice Returns String
72094>>>>>>>        Boolean bOk
72094>>>>>>>        String  sDFStr
72094>>>>>>>        Address pDFStr
72094>>>>>>>        
72094>>>>>>>        Move (Repeat( Character(0), 255 )) to sDFStr
72095>>>>>>>        Move (AddressOf(sDFStr)) to pDFStr
72096>>>>>>>        
72096>>>>>>>        Move (WP_GetCurrentDevice(pDFStr)) to bOk
72097>>>>>>>        
72097>>>>>>>        If not bOk Begin
72099>>>>>>>            Error DFERR_WINPRINT DFPrintError959
72100>>>>>>>>
72100>>>>>>>        End
72100>>>>>>>>
72100>>>>>>>        
72100>>>>>>>        Move (CString(sDFStr)) to sDFStr
72101>>>>>>>        Function_Return sDFStr
72102>>>>>>>    End_Function
72103>>>>>>>    
72103>>>>>>>    
72103>>>>>>>    // Note: DfGetCurrentPort and DFGetCurrentDriver do not exist in winprint2. Trying to
72103>>>>>>>    //       use these will result in a runtime error (which is good - don't use them)
72103>>>>>>>    
72103>>>>>>>    
72103>>>>>>>    //
72103>>>>>>>    Function DFGetPrintDialogFlags Returns DWord
72105>>>>>>>        DWord dwRetVal
72105>>>>>>>        
72105>>>>>>>        Move (WP_GetPrintDialogFlags()) to dwRetVal
72106>>>>>>>        
72106>>>>>>>        Function_Return dwRetVal
72107>>>>>>>    End_Function
72108>>>>>>>    
72108>>>>>>>    
72108>>>>>>>    //
72108>>>>>>>    // Returns PRN_TRUE=  if the flag is set     (1)
72108>>>>>>>    // Returns PRN_FALSE= If the flag not is set (0)
72108>>>>>>>    //
72108>>>>>>>    Function DFCheckPrintDialogFlag DWord dwPDFlag Returns Boolean
72110>>>>>>>        Boolean bIsSet
72110>>>>>>>        
72110>>>>>>>        Move (WP_IsPrintDialogFlagSet(dwPDFlag)) to bIsSet
72111>>>>>>>        
72111>>>>>>>        Function_Return bIsSet
72112>>>>>>>    End_Function
72113>>>>>>>    
72113>>>>>>>    
72113>>>>>>>    //
72113>>>>>>>    Procedure DFSetSpecPrintFlag DWord dwPDFlag
72115>>>>>>>        Boolean bOk
72115>>>>>>>        
72115>>>>>>>        Move (WP_SetSpecificPrintDialogFlag(dwPDFlag)) to bOk
72116>>>>>>>        
72116>>>>>>>        If not bOk Begin
72118>>>>>>>            Error DFERR_WINPRINT DFPrintError961
72119>>>>>>>>
72119>>>>>>>        End
72119>>>>>>>>
72119>>>>>>>    End_Procedure
72120>>>>>>>    
72120>>>>>>>    
72120>>>>>>>    //
72120>>>>>>>    Function DFGetUserDefinedLength Returns Number
72122>>>>>>>        Integer iRetVal
72122>>>>>>>        Number  nRetVal
72122>>>>>>>        
72122>>>>>>>        Move (WP_GetUserDefinedPapersize()) to iRetVal
72123>>>>>>>        
72123>>>>>>>        If (iRetVal=0) Begin
72125>>>>>>>            Error DFERR_WINPRINT DFPrintError962
72126>>>>>>>>
72126>>>>>>>            Function_Return 0
72127>>>>>>>        End
72127>>>>>>>>
72127>>>>>>>        
72127>>>>>>>        Move (Hi(iRetVal)) to nRetVal
72128>>>>>>>        Move (nRetVal/100) to nRetVal //Returns CM
72129>>>>>>>        
72129>>>>>>>        Function_Return nRetVal
72130>>>>>>>    End_Function
72131>>>>>>>    
72131>>>>>>>    
72131>>>>>>>    //
72131>>>>>>>    Function DFGetUserDefinedWidth Returns Number
72133>>>>>>>        Integer iRetVal
72133>>>>>>>        Number  nRetVal
72133>>>>>>>        
72133>>>>>>>        Move (WP_GetUserDefinedPapersize()) to iRetVal
72134>>>>>>>        
72134>>>>>>>        If (iRetVal=0) Begin
72136>>>>>>>            Error DFERR_WINPRINT DFPrintError963
72137>>>>>>>>
72137>>>>>>>            Function_Return 0
72138>>>>>>>        End
72138>>>>>>>>
72138>>>>>>>        
72138>>>>>>>        Move (Low(iRetVal)) to nRetVal
72139>>>>>>>        Move (nRetVal/100) to nRetVal //Returns CM
72140>>>>>>>        
72140>>>>>>>        Function_Return nRetVal
72141>>>>>>>    End_Function
72142>>>>>>>    
72142>>>>>>>    
72142>>>>>>>    // To be set in CM
72142>>>>>>>    Procedure DFSetUserDefinedPapersize Number nLength Number nWidth
72144>>>>>>>        Integer bOk
72144>>>>>>>        Integer iLength iWidth iSize
72144>>>>>>>        
72144>>>>>>>        Move (nLength*100) to iLength
72145>>>>>>>        Move (nWidth*100)  to iWidth
72146>>>>>>>        Move ((iLength*65536)+iWidth) to iSize
72147>>>>>>>        
72147>>>>>>>        Move (WP_SetUserDefinedPapersize(iSize)) to bOk
72148>>>>>>>        
72148>>>>>>>        If not bOk Begin
72150>>>>>>>            Error DFERR_WINPRINT DFPrintError964
72151>>>>>>>>
72151>>>>>>>        End
72151>>>>>>>>
72151>>>>>>>    End_Procedure
72152>>>>>>>    
72152>>>>>>>    Procedure DFSetNumberOfCopies Integer iNrOfCopies
72154>>>>>>>        Boolean bOk
72154>>>>>>>        
72154>>>>>>>        Move (WP_SetNumberOfPrintCopies(iNrOfCopies)) to bOk
72155>>>>>>>        
72155>>>>>>>        If not bOk Begin
72157>>>>>>>            Error DFERR_WINPRINT DFPrintError965
72158>>>>>>>>
72158>>>>>>>        End
72158>>>>>>>>
72158>>>>>>>    End_Procedure
72159>>>>>>>    
72159>>>>>>>    
72159>>>>>>>    
72159>>>>>>>    
72159>>>>>>>    // This procedures and functions are used when building 
72159>>>>>>>    // complex graphics when you need to change value of the
72159>>>>>>>    // current diagram, so you can mix diagrams within each 
72159>>>>>>>    // other.                                               
72159>>>>>>>    
72159>>>>>>>    
72159>>>>>>>    Function DFGetCurrentDiagram Returns Integer
72161>>>>>>>        Integer iRetVal
72161>>>>>>>        Get DFCurrent_Diagram to iRetVal
72162>>>>>>>        Function_Return iRetVal
72163>>>>>>>    End_Function
72164>>>>>>>    
72164>>>>>>>    Procedure DFSetCurrentDiagram Integer iDiagram
72166>>>>>>>        Set DFCurrent_Diagram to iDiagram
72167>>>>>>>    End_Procedure
72168>>>>>>>    
72168>>>>>>>    Procedure DFSetDiagramList Integer iItem Integer iDiagram
72170>>>>>>>        Set Value of oDiagramArray iItem to iDiagram
72171>>>>>>>    End_Procedure
72172>>>>>>>    
72172>>>>>>>    Function DFGetDiagramList Integer iItem Returns Integer
72174>>>>>>>        Integer iRetVal
72174>>>>>>>        Get Value of oDiagramArray iItem to iRetVal
72175>>>>>>>        Function_Return iRetVal
72176>>>>>>>    End_Function
72177>>>>>>>    
72177>>>>>>>    Procedure DFClearDiagramList
72179>>>>>>>        Send Delete_Data to oDiagramArray
72180>>>>>>>    End_Procedure
72181>>>>>>>    
72181>>>>>>>    
72181>>>>>>>    Function DFGetColor Integer iColor Returns DWord
72183>>>>>>>        DWord   dwRetVal
72183>>>>>>>        Get Value of oDFColorArray iColor to dwRetVal
72184>>>>>>>        Function_Return dwRetVal
72185>>>>>>>    End_Function
72186>>>>>>>    
72186>>>>>>>    Function DFGetCurrentColor Returns DWord
72188>>>>>>>        DWord   dwRetVal
72188>>>>>>>        Integer iCurrColor
72188>>>>>>>        
72188>>>>>>>        Get DFCurrent_Color to iCurrColor
72189>>>>>>>        Get DFGetColor iCurrColor to dwRetVal
72190>>>>>>>        
72190>>>>>>>        Function_Return dwRetVal
72191>>>>>>>    End_Function
72192>>>>>>>    
72192>>>>>>>    Procedure DFEndDocument
72194>>>>>>>        Integer iVoid
72194>>>>>>>        Move (WP_EndDocument()) to iVoid
72195>>>>>>>        Send DfSuspendGui False
72196>>>>>>>    End_Procedure
72197>>>>>>>    
72197>>>>>>>    Procedure DFClosePreview
72199>>>>>>>        Integer iVoid
72199>>>>>>>        Move (WP_ClosePreview()) to iVoid
72200>>>>>>>        Send DfSuspendGui False
72201>>>>>>>    End_Procedure
72202>>>>>>>    
72202>>>>>>>    Procedure SetProgressCaption String sCaption
72204>>>>>>>        Integer iVoid
72204>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
72205>>>>>>>        Move (WP_SetProgressCaption(sCaption)) to iVoid
72206>>>>>>>    End_Procedure
72207>>>>>>>    
72207>>>>>>>    Procedure SetReportTitle String sTitle
72209>>>>>>>        Integer iVoid
72209>>>>>>>        Move (ToAnsi(sTitle)) to sTitle
72210>>>>>>>        Move (WP_SetReportTitle(sTitle)) to iVoid
72211>>>>>>>    End_Procedure
72212>>>>>>>    
72212>>>>>>>    Function PreviewYesNoBox String sCaption String sText Returns Integer
72214>>>>>>>        Integer eResult
72214>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
72215>>>>>>>        Move (ToAnsi(sText))    to sText
72216>>>>>>>        Move (WP_DisplayMessageBox(sCaption, sText)) to eResult
72217>>>>>>>        Function_Return eResult
72218>>>>>>>    End_Function
72219>>>>>>>    
72219>>>>>>>    // internal function, used to extract different printer flags ranges based on
72219>>>>>>>    // the print flag integer. These flags use a decimal style of packing information
72219>>>>>>>    // where different printer options (paper, bin, etc) use different ranges and
72219>>>>>>>    // different steps. Everything above iTopVal is removed and everything that is not
72219>>>>>>>    // within the iStep range is removed.
72219>>>>>>>    Function PrintFlagRange Integer iTopVal Integer iStep Returns Integer
72221>>>>>>>        Integer iFgs iFg
72221>>>>>>>        Get DFGetPrintDialogFlags to iFg
72222>>>>>>>        Move (mod(iFg,iTopVal) / iStep * iStep ) to iFg
72223>>>>>>>        Function_Return iFg
72224>>>>>>>    End_Function
72225>>>>>>>    
72225>>>>>>>    Procedure DFSetPrinterPaper Integer ePaperType
72227>>>>>>>        Send DFSetSpecPrintFlag ePaperType
72228>>>>>>>    End_Procedure
72229>>>>>>>    
72229>>>>>>>    Function DFGetPrinterPaper Returns Integer //ePaperType
72231>>>>>>>        Integer ePaperType
72231>>>>>>>        Get PrintFlagRange 500 10 to ePaperType // 10-490 in steps of 10
72232>>>>>>>        Function_Return ePaperType
72233>>>>>>>    End_Function
72234>>>>>>>    
72234>>>>>>>    
72234>>>>>>>    Procedure DFSetPrinterBin Integer eBinType
72236>>>>>>>        Send DFSetSpecPrintFlag eBinType
72237>>>>>>>    End_Procedure
72238>>>>>>>    
72238>>>>>>>    Function DFGetPrinterBin Returns Integer //eBinType
72240>>>>>>>        Integer eBinType
72240>>>>>>>        Get PrintFlagRange 10000 500 to eBinType // 1000-9000 steps 500
72241>>>>>>>        Function_Return eBinType
72242>>>>>>>    End_Function
72243>>>>>>>    
72243>>>>>>>    
72243>>>>>>>    Procedure DFSetPrinterResolution Integer eResType
72245>>>>>>>        Send DFSetSpecPrintFlag eResType
72246>>>>>>>    End_Procedure
72247>>>>>>>    
72247>>>>>>>    Function DFGetPrinterResolution Returns Integer //eResType
72249>>>>>>>        Integer eResType
72249>>>>>>>        Get PrintFlagRange 50000 10000 to eResType // 10000-500000 steps 10000
72250>>>>>>>        Function_Return eResType
72251>>>>>>>    End_Function
72252>>>>>>>    
72252>>>>>>>    
72252>>>>>>>    Procedure DFSetLandscape Boolean bIsLandscape
72254>>>>>>>        Send DFSetSpecPrintFlag (If(bIsLandscape,DF_Landscape,DF_Portrait))
72255>>>>>>>    End_Procedure
72256>>>>>>>    
72256>>>>>>>    Function DFGetLandscape Returns Boolean // bIsLandscape
72258>>>>>>>        Boolean bIsLandscape
72258>>>>>>>        Get DFCheckPrintDialogFlag DF_Landscape to bIsLandscape
72259>>>>>>>        Function_Return bIsLandscape
72260>>>>>>>    End_Function
72261>>>>>>>    
72261>>>>>>>    Function RGBToWPColor Integer iRgb Returns Integer
72263>>>>>>>        Integer iRed iGreen iBlue
72263>>>>>>>        Integer iWPColor
72263>>>>>>>        Move (R_from_rgb(iRGB)) to iRed
72264>>>>>>>        Move (G_from_rgb(iRGB)) to iGreen
72265>>>>>>>        Move (B_from_rgb(iRGB)) to iBlue
72266>>>>>>>        Get DfGetDfColor iRed iGreen iBlue to iWPColor
72267>>>>>>>        Function_Return iWPColor
72268>>>>>>>    End_Function
72269>>>>>>>    
72269>>>>>>>    
72269>>>>>>>    
72269>>>>>>>End_Class
72270>>>>>>>
72270>>>>>>>Global_Variable Integer ghoWinPrint2
72270>>>>>>>
72270>>>>>>>Get Create of desktop U_cWinPrint2 to ghoWinPrint2
72271>>>>>Use Winprint_Commands.pkg  // commands used by this class
Including file: Winprint_Commands.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Winprint_Commands.pkg)
72271>>>>>>>// Commands used by Winprint (old and new).
72271>>>>>>>Global_Variable Integer WinPrintId  // Provide simple access to global object //JT
72271>>>>>>>Move 0 to WinPrintId
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// With the DFWRITE/LN commands you can use 1-3 arguments
72272>>>>>>>// 1. Not Required = Text
72272>>>>>>>// 2. Not Req. = FonstStyle
72272>>>>>>>// 3. Not Req. = Number of decimals
72272>>>>>>>//    !!! If you want to set decimals you MUST use all 3 arguments
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// With the WRITECOL/LN commands you can use 2-4 arguments
72272>>>>>>>// 1. Required = Text
72272>>>>>>>// 2. Required = Column to write to
72272>>>>>>>// 3. Not Req. = FonstStyle
72272>>>>>>>// 4. Not Req. = Number of decimals
72272>>>>>>>//    !!! If you want to set decimals you MUST use all 4 arguments
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// With the WWRITEPOS/LN commands you can use 2-4 arguments
72272>>>>>>>// 1. Required = Text
72272>>>>>>>// 2. Required = Position to start at from left margin. Depending
72272>>>>>>>//    on if DFCurrent_Metrics is set to CM or INCH
72272>>>>>>>// 3. Not Req. = FonstStyle
72272>>>>>>>// 4. Not Req. = Number of decimals
72272>>>>>>>//    !!! If you want to set decimals you MUST use all 4 arguments
72272>>>>>>>// 5. Max length (0 means no max)
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// Following command sets the font and remains active until
72272>>>>>>>// you change to another font
72272>>>>>>>// 1. Required = A valid Windows font
72272>>>>>>>//
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// With the WFontsize command you can use 1-2 arguments
72272>>>>>>>// 1. Required = Hi
72272>>>>>>>// 2. Not Req. = Wi
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// Following commands sets the margins of your document
72272>>>>>>>// 1. Required = Margin in CM or INCH depending in metrics
72272>>>>>>>//
72272>>>>>>>// You can also use the procedure DFSetMargins to set all
72272>>>>>>>// margins at the same time.
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFBeginHeader creates a headertype of your choise
72272>>>>>>>// 1. Required = HeaderType
72272>>>>>>>// 2. Not Req. = Headernumber
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFEndHeader endns a header section. And prints the header.
72272>>>>>>>// Headers can NOT be nested
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFHeaderPos
72272>>>>>>>// 1. Required = Header position
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFHeaderFrame
72272>>>>>>>// 1. Required = Header frame type
72272>>>>>>>// 2. Not Req. = Weight of line
72272>>>>>>>// 3. Not Req. = line color        //RGB_??
72272>>>>>>>// 4. Not Reg. = Fill color        //RGB_??
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>// DFHeaderMargin (JvH)
72272>>>>>>>// 1. Required = Margin type
72272>>>>>>>//   HM_TOPOUTER    = 0   // margin above the top of the header's frame
72272>>>>>>>//   HM_TOPINNER    = 1   // margin below the top of the header's frame
72272>>>>>>>//   HM_BOTTOMINNER = 2   // margin above the bottom of the header's frame
72272>>>>>>>//   HM_BOTTOMOUTER = 3   // margin below the bottom of the header's frame
72272>>>>>>>// 2. Required = Size of margin
72272>>>>>>>//
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFHeaderWrap
72272>>>>>>>// 1. Required = On/Off
72272>>>>>>>// HDR_NOWRAP = 0
72272>>>>>>>// HDR_WRAP   = 1
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFHeaderLineCheck
72272>>>>>>>// 1. Required = Number of lines to check. Using last settings of font
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>// DFWriteBMP
72272>>>>>>>// 1. Required = Filename and path
72272>>>>>>>// 2. Required = Vertical start
72272>>>>>>>// 3. Required = Horizontal start
72272>>>>>>>// 4. Required = Height
72272>>>>>>>// 5. Required = Width
72272>>>>>>>// 6. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFWriteEllip
72272>>>>>>>// 1. Required = Vertical start
72272>>>>>>>// 2. Required = Horizontal start
72272>>>>>>>// 3. Required = Height
72272>>>>>>>// 4. Required = Width
72272>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72272>>>>>>>// 6. Not Req. = Weight of line
72272>>>>>>>// 7. Not Req. = Wrap to next page     //DFGR_NOWRAP,DFGR_WRAP
72272>>>>>>>// 8. Not Req. = Fill color            //RGB_??
72272>>>>>>>// 9. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFWriteRect
72272>>>>>>>// 1. Required = Vertical start
72272>>>>>>>// 2. Required = Horizontal start
72272>>>>>>>// 3. Required = Height
72272>>>>>>>// 4. Required = Width
72272>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72272>>>>>>>// 6. Not Req. = Weight of line
72272>>>>>>>// 7. Not Req. = Wrap to next page     //DFGR_NOWRAP,DFGR_WRAP
72272>>>>>>>// 8. Not Req. = Fill color            //RGB_??
72272>>>>>>>// 9. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFLineCheck
72272>>>>>>>// 1. Required = Number of lines to check. Using last settings of font
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFCreateDiagram
72272>>>>>>>// 1. Required = Type of diagram //DFGR_??
72272>>>>>>>// 2. Required = Type of effect  //DFGR_??
72272>>>>>>>// 3. Required = Height
72272>>>>>>>// 4. Required = Width
72272>>>>>>>// 5. Optional = Display XY Axis (true/false), valid ONLY for bar charts
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFWriteDiagram
72272>>>>>>>// 1. Required = Y-Position using current metrics //Constant can be used !!
72272>>>>>>>// 2. Required = X-Position using current metrics
72272>>>>>>>// 3. Optional = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFBeginDiagram
72272>>>>>>>// 1. Required = Type of diagram //DFGR_??
72272>>>>>>>// 2. Required = Type of effect  //DFGR_??
72272>>>>>>>// 3. Required = Y-Position using current metrics //Constant can be used !!
72272>>>>>>>// 4. Required = X-Position using current metrics
72272>>>>>>>// 5. Required = Height
72272>>>>>>>// 6. Required = Width
72272>>>>>>>// 7. Optional = Display XY Axis (true/false), valid ONLY for bar charts
72272>>>>>>>// 8. Optional = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFDiagram_Item
72272>>>>>>>// 1. Required = Value
72272>>>>>>>// 2. Required = Label
72272>>>>>>>// 3. Not Req. = No value, Value or percent DFGR_NOVAL,DFGR_VAL,DFGR_PER
72272>>>>>>>// 4. Not Req. = Number of decimals
72272>>>>>>>// 5. Not Req. = Move slice in pie     //DFGR_IN, DFGR_OUT
72272>>>>>>>// 6. Not Reg. = Fill color            //RGB_??
72272>>>>>>>// 8. Not Req. = Boarder color         //RGB_??
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFEndDiagram
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFDiagramLabel
72272>>>>>>>// 1. Required = Label text (top)
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFDiagramXLabel
72272>>>>>>>// 1. Required = Label text (top)
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFDiagramYLabel
72272>>>>>>>// 1. Required    = Label text (top)
72272>>>>>>>// 2. Orientation = Vertical/Horizontal
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFWriteXYLine
72272>>>>>>>// 1. Required = Vertical start
72272>>>>>>>// 2. Required = Horizontal start
72272>>>>>>>// 3. Required = Vertical stopp
72272>>>>>>>// 4. Required = Horizontal stopp
72272>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72272>>>>>>>// 6. Not Req. = Weight of line
72272>>>>>>>// 7. Not Req. = Wrap to next page     //DFGR_NOWRAP,DFGR_WRAP
72272>>>>>>>// 8. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFWriteLine
72272>>>>>>>// 1. Required = Vertical start
72272>>>>>>>// 2. Required = Horizontal start
72272>>>>>>>// 3. Required = Length
72272>>>>>>>// 4. Not Req. = Horizontal/Vertical   //RGB_HORI RGB_VERT
72272>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72272>>>>>>>// 6. Not Req. = Weight of line
72272>>>>>>>// 7. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>>>// DFSetNumberOfCopies
72272>>>>>>>// 1. Required = Number of copies
72272>>>>>>>//
72272>>>>>>>
72272>>>>>>>
72272>>>>>
72272>>>>>Class cWinReport2 is a BasicReport
72273>>>>>    
72273>>>>>    Procedure Construct_Object
72275>>>>>        Forward Send construct_object
72277>>>>>        
72277>>>>>        Date Today
72277>>>>>        Sysdate Today
72278>>>>>        
72278>>>>>        // should use built in DF function CurrentDateTime()
72278>>>>>        Property Date  RptToday    Today
72279>>>>>        
72279>>>>>        Object RptTotal is an Array
72281>>>>>        End_Object
72282>>>>>        
72282>>>>>        // If true, report is output upon completion. Either preview
72282>>>>>        // or printer depending on output_device_mode
72282>>>>>        Property Boolean AutoOutput_State True
72283>>>>>        
72283>>>>>        // When a new page is created (DFNew_Page) and the number
72283>>>>>        // of columns is not passed, this is used.
72283>>>>>        Property Integer Print_Columns 0
72284>>>>>        
72284>>>>>        // This determines if a DFNew_Page should be executed when the
72284>>>>>        // report starts. In some rare cases, you would not want this to
72284>>>>>        // occur until a subheader
72284>>>>>        Property Boolean AutoNew_Page_State True
72285>>>>>        
72285>>>>>        // Output device (print or preview). Normally this is delegated to
72285>>>>>        // the report view.
72285>>>>>        //
72285>>>>>        
72285>>>>>        Property Integer Private.Output_Device_Mode PRINT_TO_UNDEFINED
72286>>>>>        
72286>>>>>        Property Handle phoWinPrint  ghoWinPrint2 // the report engine to use.
72287>>>>>        
72287>>>>>        // For now this is for testing.
72287>>>>>        Property Boolean pbModalViewer False
72288>>>>>        
72288>>>>>        Property Boolean pbMultiReports False
72289>>>>>        
72289>>>>>        Property Boolean pbFirstPagePrinted False
72290>>>>>        
72290>>>>>    End_Procedure
72291>>>>>    
72291>>>>>    // returns the current status of Winprint Document object. dsNotStarted, dsStarted, dsFinished
72291>>>>>    // note that the status can reflect a status from a different report. The winprint object is global.
72291>>>>>    Function DocumentStatus Returns Boolean
72293>>>>>        Integer iStatus
72293>>>>>        Get DocumentStatus of (phoWinprint(Self)) to iStatus
72294>>>>>        Function_Return iStatus
72295>>>>>    End_Function
72296>>>>>    
72296>>>>>    Function IsViewerActive Returns Boolean
72298>>>>>        Boolean bIsActive
72298>>>>>        Get IsViewerActive of (phoWinPrint(Self)) to bIsActive
72299>>>>>        Function_Return bIsActive
72300>>>>>    End_Function
72301>>>>>    
72301>>>>>    Function IsPrinterValid Returns Boolean
72303>>>>>        Function_Return (WP_IsPrinterValid()<>0)
72304>>>>>    End_Function
72305>>>>>    
72305>>>>>    Function ArePrintersInstalled Returns Boolean
72307>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
72308>>>>>    End_Function
72309>>>>>    
72309>>>>>    
72309>>>>>    // All subtotal commands use the outer main report. This makes it easier to keep
72309>>>>>    // track of these numbers
72309>>>>>    
72309>>>>>    Procedure Add_SubTotal Integer iCounter Number nData
72311>>>>>        Number nValue
72311>>>>>        Integer iObj
72311>>>>>        Move (RptTotal(Main_Report_Id(Self))) to iObj
72312>>>>>        Get Number_Value of iObj iCounter to nValue
72313>>>>>        Add nData to nValue
72314>>>>>        Set Array_Value of iObj iCounter to nValue
72315>>>>>    End_Procedure
72316>>>>>    
72316>>>>>    Procedure Clr_SubTotal Integer iCounter
72318>>>>>        Set Array_Value of (RptTotal(Main_Report_Id(Self))) iCounter to 0
72319>>>>>    End_Procedure
72320>>>>>    
72320>>>>>    Procedure Clr_AllSubTotals
72322>>>>>        Send Delete_Data of (RptTotal(Main_Report_Id(Self)))
72323>>>>>    End_Procedure
72324>>>>>    
72324>>>>>    Function Sum_SubTotal Integer iTotal Returns Number
72326>>>>>        Number nRetVal
72326>>>>>        Get Number_Value of (RptTotal(Main_Report_Id(Self))) iTotal to nRetVal
72327>>>>>        Function_Return nRetVal
72328>>>>>    End_Function
72329>>>>>    
72329>>>>>    //Return sub-total and clear accumulator
72329>>>>>    //
72329>>>>>    Function SubTotal Integer iTotal Returns Number
72331>>>>>        Number nRetVal
72331>>>>>        Get Sum_SubTotal  iTotal to nRetVal
72332>>>>>        Send Clr_SubTotal iTotal
72333>>>>>        Function_Return nRetVal
72334>>>>>    End_Function
72335>>>>>    
72335>>>>>    
72335>>>>>    // Note: Cols is optional. If no argument is passed it will use
72335>>>>>    //       the object's property Print_Columns (0 by default)
72335>>>>>    //
72335>>>>>    Procedure DFNew_Page Integer Cols
72337>>>>>        Integer PageNumber Columns
72337>>>>>        Boolean bFirstPagePrinted
72337>>>>>        // If no args passed used default setting
72337>>>>>        If (Num_Arguments=0) ;            Move (Print_Columns(Main_Report_id(Self))) to Columns
72340>>>>>        Else ;            Move Cols to Columns
72342>>>>>        Set Page_Feed   to -2   // No FormFeed
72343>>>>>        If (Child_Rpt_State(Self)) ;            Send DFNew_Page of (Main_Report_Id(Self)) Columns
72346>>>>>        Else Begin
72347>>>>>            // we only want to print report_header once. When report starts
72347>>>>>            // this is set true, after the first print it is false. You can set
72347>>>>>            // this to true before and explicit dfNew_page to force a header
72347>>>>>            Get pbFirstPagePrinted to bFirstPagePrinted
72348>>>>>            Get  DFNewPage of (phoWinPrint(Self)) Columns to PageNumber
72349>>>>>            If (PageNumber<>0) Begin // if 0, it failed
72351>>>>>                Set No_PageCheck_State to True
72352>>>>>                
72352>>>>>                //Top section
72352>>>>>                Send Page_Top
72353>>>>>                If not bFirstPagePrinted ;                    Send Report_Header
72356>>>>>                Send Page_Header
72357>>>>>                Send Page_Title
72358>>>>>                
72358>>>>>                Set New_Page_State to False
72359>>>>>                Set Page_End_State to False
72360>>>>>                Set No_PageCheck_State to False        // No longer Paging
72361>>>>>                Set pbFirstPagePrinted to True
72362>>>>>            End
72362>>>>>>
72362>>>>>        End
72362>>>>>>
72362>>>>>        
72362>>>>>        // Footer section
72362>>>>>        //
72362>>>>>        // DO NOT CHANGE THE ORDER OF BOTTOM SECTIONS !!!!!
72362>>>>>        //
72362>>>>>        
72362>>>>>        Send Page_Bottom
72363>>>>>        
72363>>>>>        // in WinPrint it is not possible to replace Page_Footer
72363>>>>>        // with Report_Footer. If you use Report_Footer you will
72363>>>>>        // have both Page_Footer and Report_Footer
72363>>>>>        //
72363>>>>>        //If LastTime eq 0 Send Page_Footer
72363>>>>>        //else             Send Report_Footer
72363>>>>>        
72363>>>>>        Send Page_Footer
72364>>>>>        Send Page_Total
72365>>>>>    End_Procedure
72366>>>>>    
72366>>>>>    Procedure Ending_Main_Report
72368>>>>>        Boolean bCancel bMultiReports
72368>>>>>        
72368>>>>>        Get Cancelled_state to bCancel
72369>>>>>        Get pbMultiReports to bMultiReports
72370>>>>>        
72370>>>>>        Forward Send Ending_Main_Report
72372>>>>>        
72372>>>>>        If bCancel Begin
72374>>>>>            Send DFEndDocument
72375>>>>>            Send DFClearDoc // this will also close the previewer
72376>>>>>        End
72376>>>>>>
72376>>>>>        Else Begin
72377>>>>>            Send Report_Footer
72378>>>>>            
72378>>>>>            // if multi-reports, we don't do an end of report yet. The programmer must
72378>>>>>            // manually end the report by sending EndMultiReport
72378>>>>>            If (not(bMultiReports)) Begin
72380>>>>>                Send EndWinPrintReport
72381>>>>>            End
72381>>>>>>
72381>>>>>            
72381>>>>>        End
72381>>>>>>
72381>>>>>        
72381>>>>>    End_Procedure
72382>>>>>    
72382>>>>>    // This must get called when you are running multiple reports (pbMultiReport).
72382>>>>>    // Send this when the last report is complete.
72382>>>>>    Procedure EndMultiReport
72384>>>>>        Send EndWinPrintReport
72385>>>>>    End_Procedure
72386>>>>>    
72386>>>>>    
72386>>>>>    Procedure EndWinPrintReport
72388>>>>>        Boolean bAutoOutput
72388>>>>>        Integer iStatus eMode
72388>>>>>        Get DocumentStatus to iStatus
72389>>>>>        If (iStatus<>dsStarted) ;            Procedure_Return
72392>>>>>        
72392>>>>>        // this tells winprint that the report is complete
72392>>>>>        Send DFEndDocument
72393>>>>>        // if auto-output we print or display automatically.
72393>>>>>        // for winprint2, if in preview mode you must do this so the previewer can enter
72393>>>>>        // a modal state (which it may or may not need to do).
72393>>>>>        Get AutoOutput_state to bAutoOutput
72394>>>>>        Get Output_device_mode to eMode
72395>>>>>        If (bAutoOutput or eMode=PRINT_TO_WINDOW) Begin
72397>>>>>            Send PrintReport
72398>>>>>            // if auto output, we assume that you are done when it is all over
72398>>>>>            // we only can do this with the modal viewer
72398>>>>>            If (bAutoOutput and pbModalViewer(Self)) Begin
72400>>>>>                Send DFClearDoc
72401>>>>>            End
72401>>>>>>
72401>>>>>        End
72401>>>>>>
72401>>>>>        
72401>>>>>    End_Procedure
72402>>>>>    
72402>>>>>    
72402>>>>>    Function Setup_Report Returns Integer
72404>>>>>        Integer iErr iStatus eMode
72404>>>>>        Boolean bActiveViewer bChildReport bMultiReports bOk
72404>>>>>        
72404>>>>>        Get Child_rpt_state to bChildReport
72405>>>>>        
72405>>>>>        If not bChildReport Begin
72407>>>>>            
72407>>>>>            // This makes sure that we are pointing to the new winprint2 engine object.
72407>>>>>            // normally this will be the new winprint, but it can be redirected
72407>>>>>            Get phoWinPrint to WinPrintID
72408>>>>>            
72408>>>>>            // winprint must have installed printer. If not installed, generate error and stop the report
72408>>>>>            Get ArePrintersInstalled to bOk
72409>>>>>            If not bOk Begin
72411>>>>>                Error DFERR_WINPRINT C_$NoInstalledPrinters
72412>>>>>>
72412>>>>>                Function_Return 1
72413>>>>>            End
72413>>>>>>
72413>>>>>            
72413>>>>>            // check if selected printer is valid. If not, generate error and stop the report
72413>>>>>            Get IsPrinterValid to bOk
72414>>>>>            If not bOk Begin
72416>>>>>                Error DFERR_WINPRINT DFPrintError936    // Could not select a valid printer
72417>>>>>>
72417>>>>>                Function_Return 1
72418>>>>>            End
72418>>>>>>
72418>>>>>            
72418>>>>>            // make sure it is ok to start a new report but try to be smart about it.
72418>>>>>            // if a report is active (dsstarted or dsFinished) check to see if it is
72418>>>>>            // finished w/ no viewer. If so, assume the user closed the report and is done
72418>>>>>            // so just clear the report. If a viewer is present, declare an error.
72418>>>>>            Get DocumentStatus to iStatus
72419>>>>>            Get pbMultiReports to bMultiReports
72420>>>>>            // multi-report only in-progress is multi and it is started
72420>>>>>            Move (bMultiReports and iStatus=dsStarted) to bMultiReports
72421>>>>>            If not bMultiReports Begin
72423>>>>>                If (iStatus<>dsNotStarted) Begin
72425>>>>>                    Get IsViewerActive to bActiveViewer
72426>>>>>                    If (iStatus=dsFinished and not(bActiveViewer)) Begin
72428>>>>>                        Send DfClearDoc
72429>>>>>                    End
72429>>>>>>
72429>>>>>                    Else Begin
72430>>>>>                        Error DFERR_WINPRINT DFPrintError967
72431>>>>>>
72431>>>>>                        Function_Return 1
72432>>>>>                    End
72432>>>>>>
72432>>>>>                End
72432>>>>>>
72432>>>>>                
72432>>>>>                // all new reports by default allow printing from viewer and they have the print job set up when you select print
72432>>>>>                // if you need to change these defaults, you can change these inside of Starting_main_report
72432>>>>>                // We only do this with non-multi-reports.
72432>>>>>                Send DFSetPrintDlgInPreview      True
72433>>>>>                Send DFSetEnablePrintFromPreview True
72434>>>>>                
72434>>>>>            End
72434>>>>>>
72434>>>>>            
72434>>>>>            // In the new winprint, this message is not needed and is a stub. For
72434>>>>>            // now it is in here for compatibility purposes
72434>>>>>            //You MUST always start a new report with this procedure
72434>>>>>            Send DFZeroCounters of (phoWinPrint(Self))
72435>>>>>            Send Clr_AllSubTotals
72436>>>>>            
72436>>>>>        End
72436>>>>>>
72436>>>>>        
72436>>>>>        Forward Get Setup_report to iErr
72438>>>>>        
72438>>>>>        If (iErr=0) Begin
72440>>>>>            If not bChildReport Begin
72442>>>>>                // if part of a multi-report we don't do a new doc
72442>>>>>                If not bMultiReports Begin
72444>>>>>                    Get Output_Device_Mode to eMode
72445>>>>>                    Send DFNewDoc of (phoWinPrint(Self))  (eMode = PRINT_TO_WINDOW) // pass True of display while printing
72446>>>>>                End
72446>>>>>>
72446>>>>>                // Do new page if not part of a multi-report and we say don't do a new page
72446>>>>>                If (not(bMultiReports) or AutoNew_Page_State(Self)) Begin
72448>>>>>                    Set pbFirstPagePrinted to False // tells new page that this is the first time for this report
72449>>>>>                    Send DFNew_page
72450>>>>>                End
72450>>>>>>
72450>>>>>            End
72450>>>>>>
72450>>>>>        End
72450>>>>>>
72450>>>>>        Function_Return iErr
72451>>>>>    End_Function
72452>>>>>    
72452>>>>>    
72452>>>>>    
72452>>>>>    // Cancel RO behavior - there is no device to close
72452>>>>>    //
72452>>>>>    Procedure Close_Output_Device
72454>>>>>    End_Procedure
72455>>>>>    
72455>>>>>    // Cancel RO Behavior
72455>>>>>    //
72455>>>>>    Procedure Initialize_Output_Device
72457>>>>>    End_Procedure
72458>>>>>    
72458>>>>>    
72458>>>>>    Function Output_Device_Mode Returns Integer
72460>>>>>        Integer hoId
72460>>>>>        String DevMode
72460>>>>>        Get Private.Output_Device_Mode to DevMode
72461>>>>>        If (DevMode=PRINT_TO_UNDEFINED) Begin
72463>>>>>            Get Report_View_Id to hoId
72464>>>>>            If hoID ;                Get OutPut_Device_Mode of hoID to DevMode
72467>>>>>            If (DevMode=PRINT_TO_UNDEFINED) ;                Move PRINT_TO_WINDOW to DevMode
72470>>>>>        End
72470>>>>>>
72470>>>>>        Function_Return DevMode
72471>>>>>    End_Function
72472>>>>>    
72472>>>>>    Procedure Set Output_Device_Mode Integer DevMode
72474>>>>>        Set Private.Output_Device_Mode to DevMode
72475>>>>>    End_Procedure
72476>>>>>    
72476>>>>>    // displays a metric ruler in .5 increments. This can be
72476>>>>>    // sent to make it easy to see how fields and labels should
72476>>>>>    // be moved for alignment.
72476>>>>>    //
72476>>>>>    Procedure ShowRuler
72478>>>>>        Integer i
72478>>>>>        Number n
72478>>>>>        For i from 0 to 30
72484>>>>>>
72484>>>>>            Send DFWritePos of (phoWinPrint(Self)) (String(i)) FONT_DEFAULT i -1 0
72485>>>>>            Move (i+.5) to n
72486>>>>>            Send DFWritePos of (phoWinPrint(Self)) "." FONT_DEFAULT n -1 0
72487>>>>>        Loop
72488>>>>>>
72488>>>>>        Send DFWriteLn of (phoWinPrint(Self)) ''  FONT_DEFAULT FONT_DEFAULT -1
72489>>>>>    End_Procedure
72490>>>>>    
72490>>>>>    // status panel related agumentations to handle the auto-previewer
72490>>>>>    
72490>>>>>    Procedure Update_Status String sVal
72492>>>>>        Integer eMode
72492>>>>>        Get Output_device_mode to eMode
72493>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72495>>>>>            Send SetProgressCaption  of (phoWinPrint(Self)) sVal
72496>>>>>        End
72496>>>>>>
72496>>>>>        Else Begin
72497>>>>>            Forward Send Update_Status sVal
72499>>>>>        End
72499>>>>>>
72499>>>>>    End_Procedure
72500>>>>>    
72500>>>>>    Procedure Start_Status
72502>>>>>        Integer eMode
72502>>>>>        String sTitle sCaption
72502>>>>>        Get Output_device_mode to eMode
72503>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72505>>>>>            Get Report_Caption to sCaption
72506>>>>>            Get Report_Title to sTitle
72507>>>>>            If (sTitle<>"" and sCaption<>"") Begin
72509>>>>>                Move ( sCaption- ":" * sTitle) to sTitle
72510>>>>>            End
72510>>>>>>
72510>>>>>            Else Begin
72511>>>>>                Move (sCaption - sTitle) to sTitle
72512>>>>>            End
72512>>>>>>
72512>>>>>            Send SetReportTitle of (phoWinPrint(Self)) sTitle
72513>>>>>        End
72513>>>>>>
72513>>>>>        Else Begin
72514>>>>>            Forward Send Start_status
72516>>>>>        End
72516>>>>>>
72516>>>>>    End_Procedure
72517>>>>>    
72517>>>>>    Procedure Resume_Status
72519>>>>>        Integer eMode
72519>>>>>        Get Output_device_mode to eMode
72520>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72522>>>>>            Send DfPreviewNoWait of (phoWinPrint(Self))
72523>>>>>        End
72523>>>>>>
72523>>>>>        Else Begin
72524>>>>>            Forward Send Resume_Status
72526>>>>>        End
72526>>>>>>
72526>>>>>    End_Procedure
72527>>>>>    
72527>>>>>    Procedure End_Status
72529>>>>>        Integer eMode
72529>>>>>        Get Output_device_mode to eMode
72530>>>>>        If (error_processing_state(Self)) Begin
72532>>>>>            Send DFClosePreview
72533>>>>>        End
72533>>>>>>
72533>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72535>>>>>        End
72535>>>>>>
72535>>>>>        Else Begin
72536>>>>>            Forward Send End_Status
72538>>>>>        End
72538>>>>>>
72538>>>>>    End_Procedure
72539>>>>>    
72539>>>>>    Function Report_Interrupt Returns Integer
72541>>>>>        Integer eStat
72541>>>>>        String sMess
72541>>>>>        Boolean bActiveViewer
72541>>>>>        Get IsViewerActive to bActiveViewer
72542>>>>>        If (Error_Check_State(Self)) Begin
72544>>>>>            Move C_$AnErrorWishToCancel to sMess
72545>>>>>        End
72545>>>>>>
72545>>>>>        Else Begin
72546>>>>>            Move  C_$CancelThisReport to sMess
72547>>>>>        End
72547>>>>>>
72547>>>>>        If bActiveViewer Begin
72549>>>>>            Get PreviewYesNoBox of (phoWinPrint(Self)) C_$ReportInterrupt sMess to eStat
72550>>>>>        End
72550>>>>>>
72550>>>>>        Else Begin
72551>>>>>            Move (YesNo_Box(sMess, C_$ReportInterrupt, MB_DEFBUTTON1)) to eStat
72552>>>>>        End
72552>>>>>>
72552>>>>>        
72552>>>>>        Function_Return (eStat=MBR_YES)
72553>>>>>        
72553>>>>>    End_Function
72554>>>>>    
72554>>>>>    Function Test_KeyPressed Returns Integer
72556>>>>>        Boolean bStop bError bActiveViewer
72556>>>>>        Integer eMode
72556>>>>>        // winreport will do this also, but this makes sure that this gets called
72556>>>>>        // for each body loop -- even if the body loop prints nothing
72556>>>>>        Send PumpMsgQueue of (phoWinPrint(Self)) // permit painting
72557>>>>>        Get IsViewerActive to bActiveViewer
72558>>>>>        Get Output_device_mode to eMode
72559>>>>>        If bActiveViewer Begin
72561>>>>>            Get ViewerWantsToClose of (phoWinPrint(Self)) to bStop
72562>>>>>            Get Error_Check_State to bError
72563>>>>>            If (bStop or bError) Begin
72565>>>>>                Get Report_Interrupt to bStop
72566>>>>>            End
72566>>>>>>
72566>>>>>        End
72566>>>>>>
72566>>>>>        Else Begin
72567>>>>>            Forward Get Test_KeyPressed to bStop
72569>>>>>            If (eMode=PRINT_TO_WINDOW and not(bStop)) Begin
72571>>>>>                Send DfPreviewNoWait
72572>>>>>            End
72572>>>>>>
72572>>>>>        End
72572>>>>>>
72572>>>>>        
72572>>>>>        Function_Return bStop
72573>>>>>    End_Function
72574>>>>>    
72574>>>>>    Procedure OnClosingView
72576>>>>>        Send DFClearDoc
72577>>>>>    End_Procedure
72578>>>>>    
72578>>>>>    
72578>>>>>    // Attempt to make this as intuitive as possible. You cannot invoke this when a
72578>>>>>    // report is active. If a report is not finished, you cannot do this.
72578>>>>>    // If a report is finsihed it may or may not have a viewer present.
72578>>>>>    // If a viewer is not present, we will clear the exising report (making the assumption
72578>>>>>    // that a modeless viewer was closed and the report will not be invoked again). If a viewer
72578>>>>>    // is active, we will pass this through to the winprint object which will show an error
72578>>>>>    
72578>>>>>    Function DFPrintSetupDialog Returns Boolean// invoke printer setup dialog
72580>>>>>        Integer iStatus
72580>>>>>        Boolean bActiveViewer bOk
72580>>>>>        // we must have printers installed for this to work
72580>>>>>        Get ArePrintersInstalled to bOk
72581>>>>>        If not bOk Begin
72583>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
72584>>>>>>
72584>>>>>        End
72584>>>>>>
72584>>>>>        Else Begin
72585>>>>>            Get DocumentStatus to iStatus
72586>>>>>            If (iStatus=dsFinished) Begin
72588>>>>>                Get IsViewerActive to bActiveViewer
72589>>>>>                If not bActiveViewer Begin
72591>>>>>                    Send DfClearDoc
72592>>>>>                End
72592>>>>>>
72592>>>>>            End
72592>>>>>>
72592>>>>>            // the winprint object will generate an error if the status is not dsNotStarted.
72592>>>>>            // we want those errors
72592>>>>>            Get DFPrintSetupDialog of (phoWinPrint(Self)) to bOk
72593>>>>>        End
72593>>>>>>
72593>>>>>        Function_Return bOk
72594>>>>>    End_Function
72595>>>>>    
72595>>>>>    // It is better to use DFPrintSetupDialog which tells you if the dialog was canceled
72595>>>>>    Procedure DFPrintSetup // invoke printer setup dialog
72597>>>>>        Boolean bOk
72597>>>>>        Get DFPrintSetupDialog to bOk
72598>>>>>    End_Procedure
72599>>>>>    
72599>>>>>    Procedure DFClearDoc // clear document, remove viewer
72601>>>>>        Send DFClearDoc of (phoWinPrint(Self))
72602>>>>>    End_Procedure
72603>>>>>    
72603>>>>>    Procedure DFEndDocument // tell winprint that the report is complete
72605>>>>>        Send DfEndDocument of (phoWinPrint(Self))
72606>>>>>    End_Procedure
72607>>>>>    
72607>>>>>    Procedure DFClosePreview //close the previewer, does not clear the document
72609>>>>>        Send DfClosePreview of (phoWinPrint(Self))
72610>>>>>    End_Procedure
72611>>>>>    
72611>>>>>    Procedure DFPrintDialog // popup print job dialog
72613>>>>>        Send DFPrintDialog of (phoWinPrint(Self))
72614>>>>>    End_Procedure
72615>>>>>    
72615>>>>>    Procedure DFPrint // print with printer dialog
72617>>>>>        Send DFPrint of (phoWinPrint(Self))
72618>>>>>    End_Procedure
72619>>>>>    
72619>>>>>    Procedure DFPrintDoc // print without printer dialog
72621>>>>>        Send DFPrintDoc of (phoWinPrint(Self))
72622>>>>>    End_Procedure
72623>>>>>    
72623>>>>>    Procedure DFPreviewWait // invoke previewer in modal mode
72625>>>>>        Send DFPreviewWait of (phoWinPrint(Self))
72626>>>>>    End_Procedure
72627>>>>>    
72627>>>>>    Procedure DFPreviewNoWait // invoke previwer in modeless mode
72629>>>>>        Send DFPreviewNoWait of (phoWinPrint(Self))
72630>>>>>    End_Procedure
72631>>>>>    
72631>>>>>    Procedure DFPreview // invokde previewer based on pbModalViewer property
72633>>>>>        Boolean bModalViewer
72633>>>>>        Get pbModalViewer to bModalViewer
72634>>>>>        If bModalViewer Begin
72636>>>>>            Send DFPreviewWait
72637>>>>>        End
72637>>>>>>
72637>>>>>        Else Begin
72638>>>>>            Send DFPreviewNoWait
72639>>>>>        End
72639>>>>>>
72639>>>>>    End_Procedure
72640>>>>>    
72640>>>>>    // Print report to appropriate device (printer, preview) based
72640>>>>>    // on output_device_mode
72640>>>>>    //
72640>>>>>    Procedure PrintReport
72642>>>>>        Integer eMode
72642>>>>>        Get OutPut_Device_Mode to eMode
72643>>>>>        If ((eMode=PRINT_TO_WINDOW) or (eMode=DEFERRED_PRINT_TO_WINDOW)) Begin
72645>>>>>            Send DFPreview
72646>>>>>        End
72646>>>>>>
72646>>>>>        Else If (eMode=PRINT_TO_PRINTER_NO_DIALOG) Begin
72649>>>>>            Send DFPrintDoc // print, no print job dialog
72650>>>>>        End
72650>>>>>>
72650>>>>>        Else Begin // (eMode=PRINT_TO_PRINTER)
72651>>>>>            Send DFPrint // print with print job dialog
72652>>>>>        End
72652>>>>>>
72652>>>>>    End_Procedure
72653>>>>>    
72653>>>>>    
72653>>>>>    Procedure DFSetPrinterPaper Integer ePaperType
72655>>>>>        Send DFSetPrinterPaper of (phoWinPrint(Self)) ePaperType
72656>>>>>    End_Procedure
72657>>>>>    
72657>>>>>    Function DFGetPrinterPaper Returns Integer //ePaperType
72659>>>>>        Integer ePaperType
72659>>>>>        Get DFGetPrinterPaper of (phoWinPrint(Self)) to ePaperType
72660>>>>>        Function_Return ePaperType
72661>>>>>    End_Function
72662>>>>>    
72662>>>>>    
72662>>>>>    Procedure DFSetPrinterBin Integer eBinType
72664>>>>>        Send DFSetPrinterBin of (phoWinPrint(Self)) eBinType
72665>>>>>    End_Procedure
72666>>>>>    
72666>>>>>    Function DFGetPrinterBin Returns Integer //eBinType
72668>>>>>        Integer eBinType
72668>>>>>        Get DFGetPrinterBin of (phoWinPrint(Self)) to eBinType
72669>>>>>        Function_Return eBinType
72670>>>>>    End_Function
72671>>>>>    
72671>>>>>    
72671>>>>>    Procedure DFSetPrinterResolution Integer eResType
72673>>>>>        Send DFSetPrinterResolution of (phoWinPrint(Self)) eResType
72674>>>>>    End_Procedure
72675>>>>>    
72675>>>>>    Function DFGetPrinterResolution Returns Integer //eResType
72677>>>>>        Boolean eResType
72677>>>>>        Get DFGetPrinterResolution of (phoWinPrint(Self)) to eResType
72678>>>>>        Function_Return eResType
72679>>>>>    End_Function
72680>>>>>    
72680>>>>>    
72680>>>>>    Procedure DFSetLandscape Boolean bIsLandscape
72682>>>>>        Send DFSetLandscape of (phoWinPrint(Self)) bIsLandscape
72683>>>>>    End_Procedure
72684>>>>>    
72684>>>>>    Function DFGetLandscape Returns Boolean // bIsLandscape
72686>>>>>        Boolean bIsLandscape
72686>>>>>        Get DFGetLandscape of (phoWinPrint(Self)) to bIsLandscape
72687>>>>>        Function_Return bIsLandscape
72688>>>>>    End_Function
72689>>>>>    
72689>>>>>    Procedure DFSetMetrics Integer eType
72691>>>>>        Send DFSetMetrics of (phoWinPrint(Self)) eType
72692>>>>>    End_Procedure
72693>>>>>    
72693>>>>>    Function DFGetMetrics Returns Integer
72695>>>>>        Integer eType
72695>>>>>        Get DFGetMetrics of (phoWinPrint(Self)) to eType
72696>>>>>        Function_Return eType
72697>>>>>    End_Function
72698>>>>>    
72698>>>>>    
72698>>>>>    Procedure DFSetPrintDlgInPreview Boolean bShowDialog
72700>>>>>        Set PrintDlgInPreview of (phoWinPrint(Self)) to bShowDialog
72701>>>>>    End_Procedure
72702>>>>>    
72702>>>>>    Function DFGetPrintDlgInPreview Returns Boolean
72704>>>>>        Boolean bShowDialog
72704>>>>>        Get PrintDlgInPreview of (phoWinPrint(Self)) to bShowDialog
72705>>>>>        Function_Return bShowDialog
72706>>>>>    End_Function
72707>>>>>    
72707>>>>>    
72707>>>>>    Procedure DFSetEnablePrintFromPreview Boolean bEnablePrint
72709>>>>>        Set EnablePrintFromPreview of (phoWinPrint(Self)) to bEnablePrint
72710>>>>>    End_Procedure
72711>>>>>    
72711>>>>>    Function DFGetEnablePrintFromPreview Returns Boolean
72713>>>>>        Boolean bEnablePrint
72713>>>>>        Get EnablePrintFromPreview of (phoWinPrint(Self)) to bEnablePrint
72714>>>>>        Function_Return bEnablePrint
72715>>>>>    End_Function
72716>>>>>    
72716>>>>>    
72716>>>>>    
72716>>>>>    Procedure DFSetMargins Number nLeft Number nTop Number nRight Number nBottom
72718>>>>>        Send DFSetMargins of (phoWinPrint(Self)) nLeft nTop nRight nBottom
72719>>>>>    End_Procedure
72720>>>>>    
72720>>>>>    Procedure DFSetTopBottom Number nTop Number nBottom Boolean bAllPages
72722>>>>>        Send DFSetTopBottom of (phoWinPrint(Self)) nTop nBottom bAllPages
72723>>>>>    End_Procedure
72724>>>>>    
72724>>>>>    
72724>>>>>    Procedure DFSetDevice String sPrinterName
72726>>>>>        Send DFSetDevice of (phoWinPrint(Self)) sPrinterName
72727>>>>>    End_Procedure
72728>>>>>    
72728>>>>>    Function DFGetCurrentDevice Returns String // sPrinterName
72730>>>>>        String sPrinterName
72730>>>>>        Get DFGetCurrentDevice of (phoWinPrint(Self)) to sPrinterName
72731>>>>>        Function_Return sPrinterName
72732>>>>>    End_Function
72733>>>>>    
72733>>>>>    
72733>>>>>    Procedure DFSetUserDefinedPapersize Number nLength Number nWidth
72735>>>>>        Send DFSetUserDefinedPapersize of (phoWinPrint(Self)) nLength nWidth
72736>>>>>    End_Procedure
72737>>>>>    
72737>>>>>    Function DFGetUserDefinedLength Returns Number
72739>>>>>        Number nSize
72739>>>>>        Get DFGetUserDefinedLength of (phoWinPrint(Self)) to nSize
72740>>>>>        Function_Return nSize
72741>>>>>    End_Function
72742>>>>>    
72742>>>>>    Function DFGetUserDefinedWidth Returns Number
72744>>>>>        Number nSize
72744>>>>>        Get DFGetUserDefinedWidth of (phoWinPrint(Self)) to nSize
72745>>>>>        Function_Return nSize
72746>>>>>    End_Function
72747>>>>>    
72747>>>>>    
72747>>>>>    Procedure DFSetNumberOfCopies Integer iCopies
72749>>>>>        Send DFSetNumberOfCopies of (phoWinPrint(Self)) iCopies
72750>>>>>    End_Procedure
72751>>>>>    
72751>>>>>    Procedure DFPrinterBinFirstPage Integer eBinType
72753>>>>>        Send DFPrinterBinFirstPage of (phoWinPrint(Self)) eBinType
72754>>>>>    End_Procedure
72755>>>>>    
72755>>>>>    Procedure DFClearPrinter
72757>>>>>        Send DFClearPrinter of (phoWinPrint(Self))
72758>>>>>    End_Procedure
72759>>>>>    
72759>>>>>    Function DFGetDFColor Integer iRed Integer iGreen Integer iBlue Returns Integer
72761>>>>>        Integer iWPColor
72761>>>>>        Get DFGetDFColor of (phoWinPrint(Self)) iRed iGreen iBlue to iWPColor
72762>>>>>        Function_Return iWPColor
72763>>>>>    End_Function
72764>>>>>    
72764>>>>>    Function RGBToWPColor Integer iRgb Returns Integer
72766>>>>>        Integer iWPColor
72766>>>>>        Get RGBToWPColor of (phoWinPrint(Self)) iRGB to iWPColor
72767>>>>>        Function_Return iWPColor
72768>>>>>    End_Function
72769>>>>>    
72769>>>>>    
72769>>>>>End_Class
72770>>>Use Windows.pkg
72770>>>
72770>>>Use cEmployeeDataDictionary.dd
72770>>>Use cLineDataDictionary.dd
72770>>>Use cPageHeaderDataDictionary.dd
72770>>>Use cShoeDataDictionary.dd
72770>>>Use cPageFooterDataDictionary.dd
72770>>>
72770>>>ACTIVATE_VIEW Activate_oReportView2 FOR oReportView2
72780>>>>
72780>>>Object oReportView2 is a ReportView
72782>>>    Set Location to 6 6
72783>>>    Set Size to 180 202
72784>>>    Set Label To "ReportView2"
72785>>>
72785>>>
72785>>>    Object oEmployee_DD is a cEmployeeDataDictionary
72787>>>    End_Object 
72788>>>
72788>>>    Object oLine_DD is a cLineDataDictionary
72790>>>    End_Object 
72791>>>
72791>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
72793>>>        Set DDO_Server To oEmployee_DD
72794>>>        Set DDO_Server To oLine_DD
72795>>>        Property Date pdStartdate
72797>>>        Property Date pdStopdate
72799>>>
72799>>>        Procedure OnConstrain 
72802>>>            Date dStart dStop
72802>>>
72802>>>            Get pdStartdate to dStart
72803>>>            Get pdStopdate to dStop
72804>>>
72804>>>            Case Begin
72804>>>                Case (dStart <> 0 and dStop <> 0)
72806>>>                    Constrain PageHeader.date between dStart and dStop
72810>>>                    Case Break
72811>>>                Case (dStart <> 0)
72814>>>                    Constrain PageHeader.date GE dStart
72816>>>                    Case Break
72817>>>                Case (dStop <> 0)
72820>>>                    Constrain PageHeader.date LE dStop
72822>>>            Case End
72822>>>        End_Procedure 
72823>>>    End_Object 
72824>>>
72824>>>    Object oShoe_DD is a cShoeDataDictionary
72826>>>    End_Object 
72827>>>
72827>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
72829>>>        Set DDO_Server To oPageHeader_DD
72830>>>        Set DDO_Server To oShoe_DD
72831>>>        Property Number pnStartprice
72833>>>        Property Number pnStopprice
72835>>>        Property Number pnStartquantity
72837>>>        Property Number pnStopquantity
72839>>>
72839>>>        Procedure OnConstrain 
72842>>>            Number nStart nStop
72842>>>
72842>>>            Get pnStartprice To nStart
72843>>>            Get pnStopprice To nStop
72844>>>
72844>>>            Case Begin
72844>>>                Case (nStart <> 0 and nStop <> 0)
72846>>>                    Constrain PageFooter.price between nStart and nStop
72850>>>                    Case Break
72851>>>                Case (nStart <> 0)
72854>>>                    Constrain PageFooter.price GE nStart
72856>>>                    Case Break
72857>>>                Case (nStop <> 0)
72860>>>                    Constrain PageFooter.price LE nStop
72862>>>            Case End
72862>>>
72862>>>            Get pnStartquantity To nStart
72863>>>            Get pnStopquantity To nStop
72864>>>
72864>>>            Case Begin
72864>>>                Case (nStart <> 0 and nStop <> 0)
72866>>>                    Constrain PageFooter.quantity between nStart and nStop
72870>>>                    Case Break
72871>>>                Case (nStart <> 0)
72874>>>                    Constrain PageFooter.quantity GE nStart
72876>>>                    Case Break
72877>>>                Case (nStop <> 0)
72880>>>                    Constrain PageFooter.quantity LE nStop
72882>>>            Case End
72882>>>        End_Procedure 
72883>>>    End_Object 
72884>>>
72884>>>    Set Main_DD To oPageFooter_DD
72885>>>
72885>>>
72885>>>
72885>>>    Object odateSelection is a Group
72887>>>        Set Size to 35 179
72888>>>        Set Location to 5 12
72889>>>        Set Label to "Select date"
72890>>>
72890>>>        Object oSelStart is a Form
72892>>>            Set Label to "From:"
72893>>>            Set Size to 12 60
72894>>>            Set Location to 13 30
72895>>>            Set Status_Help to "First value in selection range."
72896>>>            Set Label_Col_Offset to 2
72897>>>            Set Label_Justification_Mode to jMode_Right
72898>>>            Set Form_datatype to mask_date_window
72899>>>            Set Prompt_Object to oMonthCalendarPrompt
72900>>>            Set Prompt_Button_Mode to PB_PromptOn
72901>>>        End_Object 
72902>>>
72902>>>        Object oSelStop is a Form
72904>>>            Set Label to "To:"
72905>>>            Set Size to 12 60
72906>>>            Set Location to 13 111
72907>>>            Set Status_Help to "Last value in selection range."
72908>>>            Set Label_Col_Offset to 2
72909>>>            Set Label_Justification_Mode to jMode_Right
72910>>>            Set Form_datatype to mask_date_window
72911>>>            Set Prompt_Object to oMonthCalendarPrompt
72912>>>            Set Prompt_Button_Mode to PB_PromptOn
72913>>>        End_Object 
72914>>>
72914>>>
72914>>>        Function StartValue returns String
72917>>>            string sValue
72917>>>            Get Value of oSelStart to sValue
72918>>>            Function_return sValue
72919>>>        End_Function 
72920>>>
72920>>>        Function StopValue returns String
72923>>>            string sValue
72923>>>            Get Value of oSelStop to sValue
72924>>>            Function_return sValue
72925>>>        End_Function 
72926>>>
72926>>>    End_Object 
72927>>>    Object opriceSelection is a Group
72929>>>        Set Size to 35 179
72930>>>        Set Location to 45 12
72931>>>        Set Label to "Select price"
72932>>>
72932>>>        Object oSelStart is a Form
72934>>>            Set Label to "From:"
72935>>>            Set Size to 12 60
72936>>>            Set Location to 13 30
72937>>>            Set Status_Help to "First value in selection range."
72938>>>            Set Label_Col_Offset to 2
72939>>>            Set Label_Justification_Mode to jMode_Right
72940>>>            Set Form_datatype to 2
72941>>>        End_Object 
72942>>>
72942>>>        Object oSelStop is a Form
72944>>>            Set Label to "To:"
72945>>>            Set Size to 12 60
72946>>>            Set Location to 13 111
72947>>>            Set Status_Help to "Last value in selection range."
72948>>>            Set Label_Col_Offset to 2
72949>>>            Set Label_Justification_Mode to jMode_Right
72950>>>            Set Form_datatype to 2
72951>>>        End_Object 
72952>>>
72952>>>
72952>>>        Function StartValue returns String
72955>>>            string sValue
72955>>>            Get Value of oSelStart to sValue
72956>>>            Function_return sValue
72957>>>        End_Function 
72958>>>
72958>>>        Function StopValue returns String
72961>>>            string sValue
72961>>>            Get Value of oSelStop to sValue
72962>>>            Function_return sValue
72963>>>        End_Function 
72964>>>
72964>>>    End_Object 
72965>>>    Object oquantitySelection is a Group
72967>>>        Set Size to 35 179
72968>>>        Set Location to 85 12
72969>>>        Set Label to "Select quantity"
72970>>>
72970>>>        Object oSelStart is a Form
72972>>>            Set Label to "From:"
72973>>>            Set Size to 12 60
72974>>>            Set Location to 13 30
72975>>>            Set Status_Help to "First value in selection range."
72976>>>            Set Label_Col_Offset to 2
72977>>>            Set Label_Justification_Mode to jMode_Right
72978>>>            Set Form_datatype to 0
72979>>>        End_Object 
72980>>>
72980>>>        Object oSelStop is a Form
72982>>>            Set Label to "To:"
72983>>>            Set Size to 12 60
72984>>>            Set Location to 13 111
72985>>>            Set Status_Help to "Last value in selection range."
72986>>>            Set Label_Col_Offset to 2
72987>>>            Set Label_Justification_Mode to jMode_Right
72988>>>            Set Form_datatype to 0
72989>>>        End_Object 
72990>>>
72990>>>
72990>>>        Function StartValue returns String
72993>>>            string sValue
72993>>>            Get Value of oSelStart to sValue
72994>>>            Function_return sValue
72995>>>        End_Function 
72996>>>
72996>>>        Function StopValue returns String
72999>>>            string sValue
72999>>>            Get Value of oSelStop to sValue
73000>>>            Function_return sValue
73001>>>        End_Function 
73002>>>
73002>>>    End_Object 
73003>>>
73003>>>    Object oPrintTo is a RadioGroup
73005>>>        Set Size to 38 118
73006>>>        Set Location to 130 12
73007>>>        Set Label to "Send Report to"
73008>>>
73008>>>        Object oRadio1 is a Radio
73010>>>            Set Label to "Report Viewer"
73011>>>            Set Size to 10 61
73012>>>            Set Location to 12 6
73013>>>            Set Status_Help to "Prints the report to screen"
73014>>>        End_Object 
73015>>>
73015>>>        Object oRadio2 is a Radio
73017>>>            Set Label to "Printer"
73018>>>            Set Size to 10 42
73019>>>            Set Location to 24 6
73020>>>            Set Status_Help to "Prints the report to printer"
73021>>>        End_Object 
73022>>>
73022>>>
73022>>>        Function IsToPrinter Returns boolean
73025>>>            integer iRadio
73025>>>            Get Current_radio to iRadio
73026>>>            Function_return (iRadio=1)
73027>>>        End_Function 
73028>>>
73028>>>    End_Object 
73029>>>
73029>>>    Object oBtnPrint is a Button
73031>>>        Set Label to "Print"
73032>>>        Set Location to 125 140
73033>>>        Set Status_Help to "Print the Selected report"
73034>>>        Set Default_State to TRUE
73035>>>        Procedure OnClick
73038>>>            Send StartReport
73039>>>        End_Procedure
73040>>>    End_Object 
73041>>>
73041>>>    Object oBtnPrinterSetup is a Button
73043>>>        Set Label to "Printer Setup"
73044>>>        Set Location to 142 140
73045>>>        Set Status_Help to "Set up printer for report"
73046>>>        Procedure OnClick
73049>>>            Send DFPrintSetup of oReport
73050>>>        End_Procedure
73051>>>    End_Object 
73052>>>
73052>>>    Object oBtnCancel is a Button
73054>>>        Set Label to "Cancel"
73055>>>        Set Location to 159 140
73056>>>        Set Status_Help to "Close this Panel"
73057>>>        Procedure OnClick
73060>>>            Send Close_Panel
73061>>>        End_Procedure
73062>>>    End_Object 
73063>>>
73063>>>
73063>>>
73063>>>    Object oReport is a cWinReport2
73065>>>
73065>>>        Set Report_Title to "ReportView2"
73066>>>
73066>>>        // Set DDO, Index and breaks for the report
73066>>>        Set Server to oPageFooter_DD
73067>>>        Set Ordering to 6
73068>>>        Report_Breaks PageFooter.page_header_id PageFooter.shoe_id
73083>>>
73083>>>        Function Starting_Main_Report Returns Integer
73086>>>            Boolean bErr
73086>>>            Send DFSetMetrics wpm_cm
73087>>>            Send DFSetmargins 1 1 1 1
73088>>>            //Send DFSetLandscape false // This can be used to force a page orientation
73088>>>            Forward Get Starting_Main_Report to bErr
73090>>>            Function_return bErr
73091>>>        End_Function 
73092>>>
73092>>>        // Page_Top is printed first at the top margin of each page
73092>>>        Procedure Page_Top 
73095>>>            string  sFont
73095>>>            integer iFontSize
73095>>>
73095>>>            Move "Times New Roman" to sFont
73096>>>            Move 10 to iFontSize
73097>>>
73097>>>            DFFont sFont
73098>>>            DFFontSize iFontSize
73099>>>            DFBeginHeader DFPageTop
73100>>>                DFHeaderFrame Hdr_NoFrame
73101>>>                DFHeaderPos   Hdr_Left
73102>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
73103>>>            DFEndHeader
73105>>>
73105>>>        End_Procedure 
73106>>>
73106>>>        // Report_Header is printed once in a report after Page_Top
73106>>>        //Procedure Report_Header
73106>>>        //    string  sFont
73106>>>        //    integer iFontSize
73106>>>        //    Move "Times New Roman" to sFont
73106>>>        //    Move 10 to iFontSize
73106>>>        //    DFFont sFont
73106>>>        //    DFFontSize iFontSize
73106>>>        //    DFBeginHeader  DFReportHeader
73106>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73106>>>        //        DFHeaderPos    Hdr_Left
73106>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73106>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
73106>>>        //    DFEndHeader
73106>>>        //End_Procedure
73106>>>
73106>>>        Procedure Page_Header 
73109>>>            integer iFill iBorder iStyle
73109>>>            string  sFont sReportTitle
73109>>>            integer iFontSize
73109>>>
73109>>>            Move "Times New Roman" to sFont
73110>>>            Move 16 to iFontSize
73111>>>            Move (Font_bold + rgb_White) to iStyle
73112>>>            Move (rgb_dGrey) to iFill
73113>>>            Move (rgb_dGrey) to iBorder
73114>>>            Get Report_Title to sReportTitle
73115>>>
73115>>>            DFFont sFont
73116>>>            DFFontSize iFontSize
73117>>>            DFBeginHeader DFPageHeader
73118>>>                DFHeaderPos   Hdr_Left
73119>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
73120>>>                DFWritelnPos sReportTitle 0.1 iStyle
73121>>>                DFHeaderMargin HM_BottomOuter 0.08
73122>>>            DFEndHeader
73124>>>
73124>>>        End_Procedure 
73125>>>
73125>>>        // Page_Title appears on every page after Page_Header
73125>>>        //Procedure Page_Title
73125>>>        //    string  sFont
73125>>>        //    integer iFontSize
73125>>>        //    Move "Times New Roman" to sFont
73125>>>        //    Move 10 to iFontSize
73125>>>        //    DFFont sFont
73125>>>        //    DFFontSize iFontSize
73125>>>        //    DFBeginHeader  DFPageTitle
73125>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73125>>>        //        DFHeaderPos    Hdr_Left
73125>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73125>>>        //        DFWrite     "Page_Title" (Font_Bold+Font_Center)
73125>>>        //    DFEndHeader
73125>>>        //End_Procedure
73125>>>
73125>>>        Procedure SubHeader1 
73128>>>            string  sFont 
73128>>>            integer iFontSize iStyle
73128>>>            integer iFill iBorder iHeaderStyle
73128>>>
73128>>>            Move "Times New Roman" to sFont
73129>>>            Move 10 to iFontSize
73130>>>            Move (Font_Bold + rgb_dBlue) to iStyle
73131>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
73132>>>            Move (rgb_dGrey) to iBorder
73133>>>            Get DFGetDFColor 242 242 242 to iFill
73134>>>
73134>>>            DFFont sFont
73135>>>            DFFontSize iFontSize
73136>>>            DFBeginHeader DFSubHeader 1
73137>>>                DFHeaderLineCheck 5
73138>>>                DFHeaderWrap   HDR_Wrap
73139>>>                DFHeaderPos    HDR_Left
73140>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
73141>>>                DFHeaderMargin hm_BottomOuter 0.08
73142>>>                DFHeaderMargin hm_TopInner    0.04
73143>>>                DFHeaderMargin hm_BottomInner 0.04
73144>>>
73144>>>                // display fields to be placed in this sub-header
73144>>>                DFWritePos "Header:"                         0.1 iHeaderStyle -1 4.9
73145>>>                DFWritePos PageHeader.id                  5 (iStyle + Font_Right) 0
73146>>>                DFWriteLn
73147>>>                DFWritePos "Date:"                       0.1 iHeaderStyle -1 4.9
73148>>>                DFWritePos PageHeader.date                5 iStyle -1
73149>>>                DFWriteLn
73150>>>                DFWritePos "Hours:"                      0.1 iHeaderStyle -1 4.9
73151>>>                DFWritePos PageHeader.hours               5 (iStyle + Font_Right) 0
73152>>>                DFWriteLn
73153>>>                DFWritePos "Line Type:"                       0.1 iHeaderStyle -1 4.9
73154>>>                DFWritePos Line.type                      5 iStyle -1
73155>>>                DFWriteLn
73156>>>                DFWritePos "Name:"                       0.1 iHeaderStyle -1 4.9
73157>>>                DFWritePos Employee.name                  5 iStyle -1
73158>>>                DFWriteLn
73159>>>
73159>>>            DFEndHeader
73161>>>
73161>>>        End_Procedure 
73162>>>
73162>>>        Procedure SubHeader2 
73165>>>            string  sFont 
73165>>>            integer iFontSize iStyle
73165>>>            integer iFill iBorder iHeaderStyle
73165>>>
73165>>>            Move "Times New Roman" to sFont
73166>>>            Move 10 to iFontSize
73167>>>            Move (Font_Bold + rgb_dBlue) to iStyle
73168>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
73169>>>            Move (rgb_dGrey) to iBorder
73170>>>            Get DFGetDFColor 242 242 242 to iFill
73171>>>
73171>>>            DFFont sFont
73172>>>            DFFontSize iFontSize
73173>>>            DFBeginHeader DFSubHeader 2
73174>>>                DFHeaderLineCheck 5
73175>>>                DFHeaderWrap   HDR_Wrap
73176>>>                DFHeaderPos    HDR_Left
73177>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
73178>>>                DFHeaderMargin hm_BottomOuter 0.08
73179>>>                DFHeaderMargin hm_TopInner    0.04
73180>>>                DFHeaderMargin hm_BottomInner 0.04
73181>>>
73181>>>                // display fields to be placed in this sub-header
73181>>>                DFWritePos "Shoe:"                       0.1 iHeaderStyle -1 4.9
73182>>>                DFWritePos Shoe.name                      5 iStyle -1
73183>>>                DFWriteLn
73184>>>
73184>>>                // write the heading for the body section
73184>>>                DFFontSize 1 // create a very small space on top and below the horizontal bar
73185>>>                DFWriteLn
73186>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
73187>>>                DFWriteLn
73188>>>                DFFontSize iFontSize
73189>>>                DFWritePos "Id"                           (0.08 + 0.85) (iHeaderStyle + Font_Right) -1 0.85
73190>>>                DFWritePos "Shoe Id"                      (1.01 + 1.79) (iHeaderStyle + Font_Right) -1 1.79
73191>>>                DFWritePos "Price"                        (2.88 + 2.34) (iHeaderStyle + Font_Right) -1 2.34
73192>>>                DFWritePos "Quantity"                     (5.3 + 2.04) (iHeaderStyle + Font_Right) -1 2.04
73193>>>                DFWriteLn
73194>>>
73194>>>            DFEndHeader
73196>>>
73196>>>        End_Procedure 
73197>>>
73197>>>        Procedure Body 
73200>>>            string  sFont 
73200>>>            integer iFontSize iStyle
73200>>>
73200>>>            Move "Times New Roman" to sFont
73201>>>            Move 10 to iFontSize
73202>>>            Move (font_default) to iStyle
73203>>>
73203>>>            DFFont sFont
73204>>>            DFFontSize iFontSize
73205>>>
73205>>>            DFWritePos PageFooter.id                  (0.08 + 0.85) (iStyle + Font_Right) 0 0.85
73206>>>            DFWritePos PageFooter.shoe_id             (1.01 + 1.79) (iStyle + Font_Right) 0 1.79
73207>>>            DFWritePos PageFooter.price               (2.88 + 2.34) (iStyle + Font_Right) 2 2.34
73208>>>            DFWritePos PageFooter.quantity            (5.3 + 2.04) (iStyle + Font_Right) 0 2.04
73209>>>            DFWriteLn
73210>>>
73210>>>        End_Procedure 
73211>>>
73211>>>        // Sub-totals appear at each break
73211>>>        //Procedure SubTotal2
73211>>>        //    string  sFont
73211>>>        //    integer iFontSize
73211>>>        //    Move "Times New Roman" to sFont
73211>>>        //    Move 10 to iFontSize
73211>>>        //    DFFont sFont
73211>>>        //    DFFontSize iFontSize
73211>>>        //    DFBeginHeader DFSubTotal
73211>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73211>>>        //        DFHeaderPos    Hdr_Left
73211>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73211>>>        //        DFWrite     "SubTotal2" (Font_Bold+Font_Center)
73211>>>        //    DFEndHeader
73211>>>        //End_Procedure
73211>>>
73211>>>        // Sub-totals appear at each break
73211>>>        //Procedure SubTotal1
73211>>>        //    string  sFont
73211>>>        //    integer iFontSize
73211>>>        //    Move "Times New Roman" to sFont
73211>>>        //    Move 10 to iFontSize
73211>>>        //    DFFont sFont
73211>>>        //    DFFontSize iFontSize
73211>>>        //    DFBeginHeader DFSubTotal
73211>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73211>>>        //        DFHeaderPos    Hdr_Left
73211>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73211>>>        //        DFWrite     "SubTotal1" (Font_Bold+Font_Center)
73211>>>        //    DFEndHeader
73211>>>        //End_Procedure
73211>>>
73211>>>        // Totals appear at the end of the report before Report_Footer
73211>>>        //Procedure Total
73211>>>        //    string  sFont
73211>>>        //    integer iFontSize
73211>>>        //    Move "Times New Roman" to sFont
73211>>>        //    Move 10 to iFontSize
73211>>>        //    DFFont sFont
73211>>>        //    DFFontSize iFontSize
73211>>>        //    DFBeginHeader  DFTotal
73211>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73211>>>        //        DFHeaderPos    Hdr_Left
73211>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73211>>>        //        DFWrite     "Total" (Font_Bold+Font_Center)
73211>>>        //    DFEndHeader
73211>>>        //End_Procedure
73211>>>
73211>>>        // Report_Footer is printed once on the last page before Page_Footer
73211>>>        //Procedure Report_Footer
73211>>>        //    string  sFont
73211>>>        //    integer iFontSize
73211>>>        //    Move "Times New Roman" to sFont
73211>>>        //    Move 10 to iFontSize
73211>>>        //    DFFont sFont
73211>>>        //    DFFontSize iFontSize
73211>>>        //    DFBeginHeader DFReportFooter
73211>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73211>>>        //        DFHeaderPos    Hdr_Left
73211>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73211>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
73211>>>        //    DFEndHeader
73211>>>        //End_Procedure
73211>>>
73211>>>        Procedure Page_Footer 
73214>>>            string sStart sStop sText
73214>>>            string  sFont 
73214>>>            integer iFontSize iStyle
73214>>>
73214>>>            Move "Times New Roman" to sFont
73215>>>            Move 10 to iFontSize
73216>>>            Move (font_default) to iStyle
73217>>>
73217>>>            DFFont sFont
73218>>>            DFFontSize iFontSize
73219>>>            DFBeginHeader DFPageFooter
73220>>>                DFHeaderFrame hdr_NoFrame
73221>>>                DFHeaderPos   hdr_Left
73222>>>
73222>>>                Get pdStartdate of oPageHeader_DD to sStart
73223>>>                Get pdStopdate  of oPageHeader_DD to sStop
73224>>>                Get SelectionCriteraDescription "PageHeader.date" sStart sStop to sText
73225>>>                If (sText<>"") begin
73227>>>                    DFWriteLnPos sText 0.1
73228>>>                end
73228>>>>
73228>>>
73228>>>                Get pnStartprice of oPageFooter_DD to sStart
73229>>>                Get pnStopprice  of oPageFooter_DD to sStop
73230>>>                Get SelectionCriteraDescription "PageFooter.price" sStart sStop to sText
73231>>>                If (sText<>"") begin
73233>>>                    DFWriteLnPos sText 0.1
73234>>>                end
73234>>>>
73234>>>
73234>>>                Get pnStartquantity of oPageFooter_DD to sStart
73235>>>                Get pnStopquantity  of oPageFooter_DD to sStop
73236>>>                Get SelectionCriteraDescription "PageFooter.quantity" sStart sStop to sText
73237>>>                If (sText<>"") begin
73239>>>                    DFWriteLnPos sText 0.1
73240>>>                end
73240>>>>
73240>>>
73240>>>            DFEndHeader
73242>>>        End_Procedure 
73243>>>
73243>>>        // Page_Bottom is printed last at the bottom margin of each page
73243>>>        Procedure Page_Bottom 
73246>>>            string sFont
73246>>>            integer iFontSize iBorder iStyle
73246>>>            DateTime dtDT
73246>>>
73246>>>            Move (CurrentDateTime()) to dtDT
73247>>>
73247>>>            Move "Times New Roman" to sFont
73248>>>            Move 10 to iFontSize
73249>>>            Move (font_default) to iStyle
73250>>>            Move (rgb_dGrey) to iBorder
73251>>>
73251>>>            DFFont sFont
73252>>>            DFFontSize iFontSize
73253>>>            DFBeginHeader DFPageBottom
73254>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
73255>>>                DFHeaderPos Hdr_Left
73256>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
73257>>>            DFEndHeader
73259>>>
73259>>>        End_Procedure 
73260>>>
73260>>>        // Returns string with description of selection ranges
73260>>>        // Pass: Selection title, start value and end value. Return: description
73260>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
73263>>>            string sText
73263>>>            If (sStart=""  AND sStop="") ;                function_return ""
73266>>>            If (sStart="0" AND sStop="0") ;                function_return ""
73269>>>            If (sStart<>"" AND sStop<>"") begin
73271>>>                Move ("between" * sStart * "and" * sStop) to sText
73272>>>            end
73272>>>>
73272>>>            Else if (sStart > "") begin
73275>>>                Move ("starting at" * sStart) to sText
73276>>>            end
73276>>>>
73276>>>            Else if (sStop > "") begin
73279>>>                Move ("up to" * sStop) to sText
73280>>>            End
73280>>>>
73280>>>            function_return (sTitle * sText)
73281>>>        End_Function
73282>>>
73282>>>    End_Object 
73283>>>
73283>>>    Procedure StartReport 
73286>>>        Boolean bToPrinter
73286>>>        String sValue
73286>>>        Number nStart nStop
73286>>>        Date dStart dStop
73286>>>
73286>>>        // Set all selection critera properties
73286>>>        Get StartValue of odateSelection to sValue
73287>>>        Set pdStartdate of oPageHeader_DD To sValue
73288>>>
73288>>>        Get StopValue of odateSelection to sValue
73289>>>        Set pdStopdate of oPageHeader_DD To sValue
73290>>>
73290>>>        Get StartValue of opriceSelection to sValue
73291>>>        Set pnStartprice of oPageFooter_DD To sValue
73292>>>
73292>>>        Get StopValue of opriceSelection to sValue
73293>>>        Set pnStopprice of oPageFooter_DD To sValue
73294>>>
73294>>>        Get StartValue of oquantitySelection to sValue
73295>>>        Set pnStartquantity of oPageFooter_DD To sValue
73296>>>
73296>>>        Get StopValue of oquantitySelection to sValue
73297>>>        Set pnStopquantity of oPageFooter_DD To sValue
73298>>>
73298>>>
73298>>>        // determine if direct print
73298>>>        Get IsToPrinter of oPrintTo to bToPrinter
73299>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
73300>>>
73300>>>        // run the report
73300>>>        Send Run_Report of oReport
73301>>>
73301>>>    End_Procedure 
73302>>>
73302>>>End_Object 
73303>
73303>        Procedure Activate_About
73306>            Send DoAbout "" "" "" "" ""
73307>        End_Procedure
73308>
73308>    End_Object
73309>
73309>End_Object
73310>
73310>Start_UI
73311>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 42555
Total Resources: 0
Total Commands : 73310
Total Windows  : 0
Total Pages    : 0
Static Data    : 426707
Message area   : 526101
Total Blocks   : 26509
