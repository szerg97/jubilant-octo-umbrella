Compiling Program: C:\DataFlex Projects\ShoeFactory\AppSrc\Application.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 19.1\Pkg\dfallent.pkd)
67438>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJStandardCommandBarSystem.pkg)
67438>>>// these are all the packages used in a standard MDI menubar/toolbar system
67438>>>
67438>>>Use cCJCommandBarSystem.pkg
67438>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJStandardMenuItemClasses.pkg)
67438>>>>>Use Dfpanel.pkg
67438>>>>>Use cCJCommandBarSystem.pkg
67438>>>>>Use LanguageText.pkg
67438>>>>>
67438>>>>>
67438>>>>>Class cCJUndoMenuItem is a cCJMenuItem
67439>>>>>    
67439>>>>>    Procedure Construct_Object
67441>>>>>        Forward Send Construct_Object
67443>>>>>        Set psCaption   to C_$CaptionUndo
67444>>>>>        Set psToolTip to C_$ToolTipUndo
67445>>>>>        Set psDescription to C_$DescUndo
67446>>>>>        Set psImage to "ActionUndo.ico"
67447>>>>>        Set pbActiveUpdate to True
67448>>>>>        Set psCategory to C_$CategoryEdit
67449>>>>>        Set psShortcut to C_$Key_Ctrl_Z
67450>>>>>    End_Procedure
67451>>>>>    
67451>>>>>    Procedure OnExecute Variant vCommandBarControl
67453>>>>>        Send Undo of (focus(Self))
67454>>>>>    End_Procedure
67455>>>>>    
67455>>>>>    Function IsEnabled Returns Boolean
67457>>>>>        Boolean bEnabled
67457>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
67458>>>>>        Function_Return bEnabled
67459>>>>>    End_Function
67460>>>>>    
67460>>>>>End_Class
67461>>>>>
67461>>>>>
67461>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
67462>>>>>    
67462>>>>>    Procedure Construct_Object
67464>>>>>        Forward Send Construct_Object
67466>>>>>        Set psCaption   to C_$CaptionDelete
67467>>>>>        Set psToolTip to C_$ToolTipDelete
67468>>>>>        Set psDescription to C_$DescDelete
67469>>>>>        Set psImage to "actionDelete.ico"
67470>>>>>        Set psShortcut to C_$Key_Delete
67471>>>>>        Set pbActiveUpdate to True
67472>>>>>        Set psCategory to C_$CategoryEdit
67473>>>>>    End_Procedure
67474>>>>>    
67474>>>>>    
67474>>>>>    Procedure OnExecute Variant vCommandBarControl
67476>>>>>        Send Delete of (focus(Self))
67477>>>>>    End_Procedure
67478>>>>>    
67478>>>>>    Function IsEnabled Returns Boolean
67480>>>>>        Boolean bEnabled
67480>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
67481>>>>>        Function_Return bEnabled
67482>>>>>    End_Function
67483>>>>>    
67483>>>>>End_Class
67484>>>>>
67484>>>>>
67484>>>>>Class cCJCutMenuItem is a cCJMenuItem
67485>>>>>    
67485>>>>>    Procedure Construct_Object
67487>>>>>        Forward Send Construct_Object
67489>>>>>        Set psCaption   to C_$CaptionCut
67490>>>>>        Set psToolTip to C_$TooltipCut
67491>>>>>        Set psDescription to C_$DescCut
67492>>>>>        Set psImage to "actionCut.ico"
67493>>>>>        Set psShortcut to C_$Key_Ctrl_X
67494>>>>>        Set pbActiveUpdate to True
67495>>>>>        Set psCategory to C_$CategoryEdit
67496>>>>>    End_Procedure
67497>>>>>    
67497>>>>>    
67497>>>>>    Procedure OnExecute Variant vCommandBarControl
67499>>>>>        Send Cut of (focus(Self))
67500>>>>>    End_Procedure
67501>>>>>    
67501>>>>>    Function IsEnabled Returns Boolean
67503>>>>>        Boolean bEnabled
67503>>>>>        Get CanCut of (Focus(Self)) to bEnabled
67504>>>>>        Function_Return bEnabled
67505>>>>>    End_Function
67506>>>>>    
67506>>>>>End_Class
67507>>>>>
67507>>>>>
67507>>>>>Class cCJCopyMenuItem is a cCJMenuItem
67508>>>>>    
67508>>>>>    Procedure Construct_Object
67510>>>>>        Forward Send Construct_Object
67512>>>>>        Set psCaption   to C_$CaptionCopy
67513>>>>>        Set psToolTip to C_$ToolTipCopy
67514>>>>>        Set psDescription to C_$DescCopy
67515>>>>>        Set psImage to "actionCopy.ico"
67516>>>>>        Set psShortcut to C_$Key_Ctrl_C
67517>>>>>        Set pbActiveUpdate to True
67518>>>>>        Set psCategory to C_$CategoryEdit
67519>>>>>    End_Procedure
67520>>>>>    
67520>>>>>    
67520>>>>>    Procedure OnExecute Variant vCommandBarControl
67522>>>>>        Send Copy of (focus(Self))
67523>>>>>    End_Procedure
67524>>>>>    
67524>>>>>    Function IsEnabled Returns Boolean
67526>>>>>        Boolean bEnabled
67526>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
67527>>>>>        Function_Return bEnabled
67528>>>>>    End_Function
67529>>>>>    
67529>>>>>End_Class
67530>>>>>
67530>>>>>
67530>>>>>Class cCJPasteMenuItem is a cCJMenuItem
67531>>>>>    
67531>>>>>    Procedure Construct_Object
67533>>>>>        Forward Send Construct_Object
67535>>>>>        Set psCaption   to C_$CaptionPaste
67536>>>>>        Set psToolTip to C_$ToolTipPaste
67537>>>>>        Set psDescription to C_$DescPaste
67538>>>>>        Set psImage to "actionPaste.ico"
67539>>>>>        Set pbActiveUpdate to True
67540>>>>>        Set psShortcut to C_$Key_Ctrl_V
67541>>>>>        Set psCategory to C_$CategoryEdit
67542>>>>>    End_Procedure
67543>>>>>    
67543>>>>>    
67543>>>>>    Procedure OnExecute Variant vCommandBarControl
67545>>>>>        Send Paste of (focus(Self))
67546>>>>>    End_Procedure
67547>>>>>    
67547>>>>>    Function IsEnabled Returns Boolean
67549>>>>>        Boolean bEnabled
67549>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
67550>>>>>        Function_Return bEnabled
67551>>>>>    End_Function
67552>>>>>    
67552>>>>>End_Class
67553>>>>>
67553>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
67554>>>>>    
67554>>>>>    Procedure Construct_Object
67556>>>>>        Forward Send Construct_Object
67558>>>>>        Set psCaption   to C_$CaptionSelectAll
67559>>>>>        Set psToolTip to C_$ToolTipSelectAll
67560>>>>>        Set psDescription to C_$DescSelectAll
67561>>>>>        Set pbActiveUpdate to True
67562>>>>>        Set psShortcut to C_$Key_Ctrl_A
67563>>>>>        Set psCategory to C_$CategoryEdit
67564>>>>>    End_Procedure
67565>>>>>    
67565>>>>>    
67565>>>>>    Procedure OnExecute Variant vCommandBarControl
67567>>>>>        Send Select_All of (focus(Self))
67568>>>>>    End_Procedure
67569>>>>>    
67569>>>>>    Function IsEnabled Returns Boolean
67571>>>>>        Boolean bEnabled
67571>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
67572>>>>>        Function_Return bEnabled
67573>>>>>    End_Function
67574>>>>>    
67574>>>>>End_Class
67575>>>>>
67575>>>>>
67575>>>>>Class cCJExitMenuItem is a cCJMenuItem
67576>>>>>    
67576>>>>>    Procedure Construct_Object
67578>>>>>        Forward Send Construct_Object
67580>>>>>        Set psCaption to C_$CaptionExit
67581>>>>>        Set psToolTip to C_$ToolTipExit
67582>>>>>        Set psDescription to C_$ToolTipExit
67583>>>>>        Set psShortcut to C_$Key_Alt_F4
67584>>>>>        Set psCategory to C_$CategoryFile
67585>>>>>    End_Procedure
67586>>>>>    
67586>>>>>    Procedure OnExecute Variant vCommandBarControl
67588>>>>>        Send Exit_Application of Desktop
67589>>>>>    End_Procedure
67590>>>>>    
67590>>>>>End_Class
67591>>>>>
67591>>>>>Class cCJHelpMenuItem is a cCJMenuItem
67592>>>>>    
67592>>>>>    Procedure Construct_Object
67594>>>>>        Forward Send Construct_Object
67596>>>>>        Set psCaption to C_$CaptionHelp
67597>>>>>        Set psDescription to C_$ToolTipHelp
67598>>>>>        Set psToolTip to C_$DescHelp
67599>>>>>        Set psImage to "ActionHelp.ico"
67600>>>>>        Set psShortcut to "F1"
67601>>>>>        Set psCategory to C_$CategoryHelp
67602>>>>>    End_Procedure
67603>>>>>    
67603>>>>>    Procedure OnExecute Variant vCommandBarControl
67605>>>>>        Send Help of (Focus(Self))
67606>>>>>    End_Procedure
67607>>>>>    
67607>>>>>End_Class
67608>>>>>
67608>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
67609>>>>>    
67609>>>>>    Procedure Construct_Object
67611>>>>>        Forward Send Construct_Object
67613>>>>>        Set psCaption to C_$CaptionAddStatusbar
67614>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
67615>>>>>        Set psDescription to  C_$DescAddStatusbar
67616>>>>>        Set psCategory to C_$CategoryWindow
67617>>>>>    End_Procedure
67618>>>>>    
67618>>>>>    Procedure OnExecute Variant vCommandBarControl
67620>>>>>        Handle hoCommandBars hoClientArea
67620>>>>>        Get CommandBarSystemObject to hoCommandBars
67621>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67622>>>>>        If hoClientArea Begin
67624>>>>>            // the clientarea's parent panel has message
67624>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
67625>>>>>        End
67625>>>>>>
67625>>>>>    End_Procedure
67626>>>>>    
67626>>>>>    Function IsChecked Returns Boolean
67628>>>>>        Boolean bOn
67628>>>>>        Handle hoCommandBars hoClientArea
67628>>>>>        Get CommandBarSystemObject to hoCommandBars
67629>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67630>>>>>        If hoClientArea Begin
67632>>>>>            // the clientarea's parent panel has message
67632>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
67633>>>>>        End
67633>>>>>>
67633>>>>>        Function_Return bOn
67634>>>>>    End_Function
67635>>>>>End_Class
67636>>>>>
67636>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
67637>>>>>    
67637>>>>>    Procedure Construct_Object
67639>>>>>        Forward Send Construct_Object
67641>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
67642>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
67643>>>>>        Set psDescription to C_$DescAutoArrangeIcons
67644>>>>>        Set psCategory to C_$CategoryWindow
67645>>>>>    End_Procedure
67646>>>>>    
67646>>>>>    Procedure OnExecute Variant vCommandBarControl
67648>>>>>        Handle hoCommandBars hoClientArea
67648>>>>>        Get CommandBarSystemObject to hoCommandBars
67649>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67650>>>>>        If hoClientArea Begin
67652>>>>>            // the clientarea's parent panel has message
67652>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
67653>>>>>        End
67653>>>>>>
67653>>>>>    End_Procedure
67654>>>>>    
67654>>>>>    Function IsChecked Returns Boolean
67656>>>>>        Boolean bOn
67656>>>>>        Handle hoCommandBars hoClientArea
67656>>>>>        Get CommandBarSystemObject to hoCommandBars
67657>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67658>>>>>        If hoClientArea Begin
67660>>>>>            // the clientarea's parent panel has message
67660>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
67661>>>>>        End
67661>>>>>>
67661>>>>>        Function_Return bOn
67662>>>>>    End_Function
67663>>>>>End_Class
67664>>>>>
67664>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
67665>>>>>    
67665>>>>>    Procedure Construct_Object
67667>>>>>        Forward Send Construct_Object
67669>>>>>        Set psCaption to C_$CaptionRestoreMenus
67670>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
67671>>>>>        Set psDescription to C_$DescRestoreMenus
67672>>>>>        Set psCategory to C_$CategoryWindow
67673>>>>>    End_Procedure
67674>>>>>    
67674>>>>>    Procedure OnExecute Variant vCommandBarControl
67676>>>>>        Handle hoCommandBars
67676>>>>>        Get CommandBarSystemObject to hoCommandBars
67677>>>>>        Send RestoreLayout of hoCommandBars
67678>>>>>    End_Procedure
67679>>>>>    
67679>>>>>End_Class
67680>>>>>
67680>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
67681>>>>>    
67681>>>>>    Procedure Construct_Object
67683>>>>>        Forward Send Construct_Object
67685>>>>>        Set psCaption to C_$CaptionCascade
67686>>>>>        Set psToolTip to C_$ToolTipCascade
67687>>>>>        Set psDescription to  C_$DescCascade
67688>>>>>        Set psImage to "ActionCascade.ico"
67689>>>>>        Set psCategory to C_$CategoryWindow
67690>>>>>    End_Procedure
67691>>>>>    
67691>>>>>    Procedure OnExecute Variant vCommandBarControl
67693>>>>>        Handle hoCommandBars hoClientArea
67693>>>>>        Get CommandBarSystemObject to hoCommandBars
67694>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67695>>>>>        If hoClientArea Begin
67697>>>>>            Send Cascade_Windows of hoClientArea
67698>>>>>        End
67698>>>>>>
67698>>>>>    End_Procedure
67699>>>>>End_Class
67700>>>>>
67700>>>>>Class cCJTileHorizontally is a cCJMenuItem
67701>>>>>    
67701>>>>>    Procedure Construct_Object
67703>>>>>        Forward Send Construct_Object
67705>>>>>        Set psCaption to C_$CaptionTileHorizontally
67706>>>>>        Set psToolTip to C_$ToolTipTileHorizontally
67707>>>>>        Set psDescription to  C_$DescTileHorizontally
67708>>>>>        Set psImage to "ActionTileHorizontally.ico"
67709>>>>>        Set psCategory to C_$CategoryWindow
67710>>>>>    End_Procedure
67711>>>>>    
67711>>>>>    Procedure OnExecute Variant vCommandBarControl
67713>>>>>        Handle hoCommandBars hoClientArea
67713>>>>>        Get CommandBarSystemObject to hoCommandBars
67714>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67715>>>>>        If hoClientArea Begin
67717>>>>>            Send Tile_Windows_Horizontal of hoClientArea
67718>>>>>        End
67718>>>>>>
67718>>>>>    End_Procedure
67719>>>>>End_Class
67720>>>>>
67720>>>>>Class cCJTileVertically is a cCJMenuItem
67721>>>>>    
67721>>>>>    Procedure Construct_Object
67723>>>>>        Forward Send Construct_Object
67725>>>>>        Set psCaption to C_$CaptionTileVertically
67726>>>>>        Set psToolTip to C_$ToolTipTileVertically
67727>>>>>        Set psDescription to  C_$DescTileVertically
67728>>>>>        Set psImage to "ActionTileVertically.ico"
67729>>>>>        Set psCategory to C_$CategoryWindow
67730>>>>>    End_Procedure
67731>>>>>    
67731>>>>>    Procedure OnExecute Variant vCommandBarControl
67733>>>>>        Handle hoCommandBars hoClientArea
67733>>>>>        Get CommandBarSystemObject to hoCommandBars
67734>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67735>>>>>        If hoClientArea Begin
67737>>>>>            Send Tile_Windows_Vertical of hoClientArea
67738>>>>>        End
67738>>>>>>
67738>>>>>    End_Procedure
67739>>>>>End_Class
67740>>>>>
67740>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
67741>>>>>    
67741>>>>>    Procedure Construct_Object
67743>>>>>        Forward Send Construct_Object
67745>>>>>        Set psCaption to C_$CaptionMinimizeWindows
67746>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
67747>>>>>        Set psDescription to  C_$DescMinimizeWindows
67748>>>>>        Set psCategory to C_$CategoryWindow
67749>>>>>    End_Procedure
67750>>>>>    
67750>>>>>    Procedure OnExecute Variant vCommandBarControl
67752>>>>>        Handle hoCommandBars hoClientArea
67752>>>>>        Get CommandBarSystemObject to hoCommandBars
67753>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67754>>>>>        If hoClientArea Begin
67756>>>>>            // the clientarea's parent panel has message
67756>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
67757>>>>>        End
67757>>>>>>
67757>>>>>    End_Procedure
67758>>>>>End_Class
67759>>>>>
67759>>>>>
67759>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
67760>>>>>    
67760>>>>>    Procedure Construct_Object
67762>>>>>        Forward Send Construct_Object
67764>>>>>        Set psCaption to C_$CaptionRestoreWindows
67765>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
67766>>>>>        Set psDescription to  C_$DescRestoreWindows
67767>>>>>        Set psCategory to C_$CategoryWindow
67768>>>>>    End_Procedure
67769>>>>>    
67769>>>>>    Procedure OnExecute Variant vCommandBarControl
67771>>>>>        Handle hoCommandBars hoClientArea
67771>>>>>        Get CommandBarSystemObject to hoCommandBars
67772>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67773>>>>>        If hoClientArea Begin
67775>>>>>            // the clientarea's parent panel has message
67775>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
67776>>>>>        End
67776>>>>>>
67776>>>>>    End_Procedure
67777>>>>>End_Class
67778>>>>>
67778>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
67779>>>>>    
67779>>>>>    Procedure Construct_Object
67781>>>>>        Forward Send Construct_Object
67783>>>>>        Set psCaption to C_$CaptionArrangeIcons
67784>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
67785>>>>>        Set psDescription to  C_$DescArrangeIcons
67786>>>>>        Set psCategory to C_$CategoryWindow
67787>>>>>    End_Procedure
67788>>>>>    
67788>>>>>    Procedure OnExecute Variant vCommandBarControl
67790>>>>>        Handle hoCommandBars hoClientArea
67790>>>>>        Get CommandBarSystemObject to hoCommandBars
67791>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67792>>>>>        If hoClientArea Begin
67794>>>>>            Send Arrange_Icons of hoClientArea
67795>>>>>        End
67795>>>>>>
67795>>>>>    End_Procedure
67796>>>>>    
67796>>>>>End_Class
67797>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJAboutMenuItem.pkg)
67797>>>>>Use cCJCommandBarSystem.pkg
67797>>>>>Use LanguageText.pkg
67797>>>>>
67797>>>>>// It is expected that if you use this class that you provide an about object that is
67797>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
67797>>>>>// because you may wish to create your own custom about package.
67797>>>>>
67797>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
67798>>>>>
67798>>>>>    Procedure Construct_Object
67800>>>>>        Forward Send Construct_Object
67802>>>>>        Set psCaption to C_$CaptionAbout
67803>>>>>        Set psDescription to C_$ToolTipAbout
67804>>>>>        Set psToolTip to C_$DescAbout
67805>>>>>        Set psImage to "ActionAbout.ico"
67806>>>>>        Set psCategory to C_$CategoryHelp
67807>>>>>    End_Procedure
67808>>>>>    
67808>>>>>    Procedure OnExecute Variant vCommandBarControl
67810>>>>>        Handle hoCommandBars hoClientArea
67810>>>>>        Get CommandBarSystemObject to hoCommandBars
67811>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67812>>>>>        If hoClientArea Begin
67814>>>>>            Send Activate_About of hoClientArea
67815>>>>>        End
67815>>>>>>
67815>>>>>    End_Procedure
67816>>>>>
67816>>>>>End_Class
67817>>>>>
67817>>>>>
67817>>>Use cCJDeoMenuItemClasses.pkg
67817>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJMDIWindowsMenuItem.pkg)
67817>>>>>Use cCJCommandBarSystem.pkg
67817>>>>>
67817>>>>>Register_Function Client_ID Returns Integer
67817>>>>>
67817>>>>>// only used by cCJMDIWIndowsMenuItem
67817>>>>>Class cCJMDIWindowItem is a cCJMenuItem
67818>>>>>    
67818>>>>>    Procedure Construct_Object
67820>>>>>        Forward Send Construct_Object
67822>>>>>        Property Handle phWindow 0 // object id of view
67823>>>>>        Set pbControlFlagNoMovable to True
67824>>>>>        Set pbActiveUpdate to True
67825>>>>>    End_Procedure
67826>>>>>    
67826>>>>>    Procedure OnExecute Variant vCommandBarControl
67828>>>>>        Handle hWindow
67828>>>>>        Get phWindow to hWindow
67829>>>>>        Send Activate_View of hWindow
67830>>>>>    End_Procedure
67831>>>>>    
67831>>>>>End_Class
67832>>>>>
67832>>>>>
67832>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
67833>>>>>    
67833>>>>>    Procedure Construct_Object
67835>>>>>        Forward Send Construct_Object
67837>>>>>        Property Handle[] phArrayOfWindows
67838>>>>>        Set peControlType to xtpControlPopup
67839>>>>>        Set psCategory to C_$CategoryWindow
67840>>>>>    End_Procedure
67841>>>>>    
67841>>>>>    // This adds MDI windows to the existing menu items.
67841>>>>>    // This removes any existing windows menus and always adds a new set to the end
67841>>>>>    
67841>>>>>    Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
67843>>>>>        Handle  hClientArea hView
67843>>>>>        String  sLabel
67843>>>>>        Integer i iWindows
67843>>>>>        Handle[] hArrayOfWindows
67844>>>>>        Variant vItem
67844>>>>>        
67844>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
67844>>>>>        // also assume that destroying an action removes all menu instances of that action
67844>>>>>        Get phArrayOfWindows to hArrayOfWindows
67845>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
67846>>>>>        For i from 0 to (iWindows-1)
67852>>>>>>
67852>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
67853>>>>>        Loop
67854>>>>>>
67854>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
67855>>>>>        
67855>>>>>        // Add all views to this menu. Create the action and add the item
67855>>>>>        Move 0 to i
67856>>>>>        Get Client_Id to hClientArea // object id of client area
67857>>>>>        If (hClientArea > 0) Begin
67859>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
67860>>>>>            While (hView <> 0)
67864>>>>>                If (Active_State(hView)) Begin
67866>>>>>                    // create the action
67866>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
67867>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
67868>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
67869>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
67870>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
67872>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
67873>>>>>                    End
67873>>>>>>
67873>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
67874>>>>>                    If (i=0) Begin
67876>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
67877>>>>>                    End
67877>>>>>>
67877>>>>>                    // Create a menu item for this action
67877>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
67878>>>>>                    Increment i
67879>>>>>                End
67879>>>>>>
67879>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
67880>>>>>            Loop
67881>>>>>>
67881>>>>>        End
67881>>>>>>
67881>>>>>        
67881>>>>>        Set phArrayOfWindows to hArrayOfWindows
67882>>>>>        
67882>>>>>    End_Procedure
67883>>>>>    
67883>>>>>End_Class
67884>
67884>Object oHtmlHelp is a cHtmlHelp
67886>End_Object
67887>
67887>Object oApplication is a cApplication
67889>    Set peHelpType to htHtmlHelp
67890>
67890>    Object oConnection is a cConnection
67892>        Use LoginEncryption.pkg
Including file: LoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\LoginEncryption.pkg)
67892>>>Use cLoginEncryption.pkg
Including file: cLoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cLoginEncryption.pkg)
67892>>>>>Use cCryptographer.pkg
Including file: cCryptographer.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCryptographer.pkg)
67892>>>>>>>Use VdfBase.pkg
67892>>>>>>>
67892>>>>>>>Use CryptographerConstants.pkg
Including file: CryptographerConstants.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\CryptographerConstants.pkg)
67892>>>>>>>>>//   Author  : Ulbe Stellema
67892>>>>>>>>>// Algorithm classes
67892>>>>>>>>>Define ALG_CLASS_ANY                    for |CI$00000000 // (0)
67892>>>>>>>>>Define ALG_CLASS_SIGNATURE              for |CI$00002000 // (1 << 13)
67892>>>>>>>>>Define ALG_CLASS_MSG_ENCRYPT            for |CI$00004000 // (2 << 13)
67892>>>>>>>>>Define ALG_CLASS_DATA_ENCRYPT           for |CI$00006000 // (3 << 13)
67892>>>>>>>>>Define ALG_CLASS_HASH                   for |CI$00008000 // (4 << 13)
67892>>>>>>>>>Define ALG_CLASS_KEY_EXCHANGE           for |CI$0000A000 // (5 << 13)
67892>>>>>>>>>Define ALG_CLASS_ALL                    for |CI$0000E000 // (7 << 13)
67892>>>>>>>>>
67892>>>>>>>>>// Algorithm types
67892>>>>>>>>>Define ALG_TYPE_ANY                     for |CI$00000000 // (0)
67892>>>>>>>>>Define ALG_TYPE_DSS                     for |CI$00000200 // (1 << 9)
67892>>>>>>>>>Define ALG_TYPE_RSA                     for |CI$00000400 // (2 << 9)
67892>>>>>>>>>Define ALG_TYPE_BLOCK                   for |CI$00000600 // (3 << 9)
67892>>>>>>>>>Define ALG_TYPE_STREAM                  for |CI$00000800 // (4 << 9)
67892>>>>>>>>>Define ALG_TYPE_DH                      for |CI$00000A00 // (5 << 9)
67892>>>>>>>>>Define ALG_TYPE_SECURECHANNEL           for |CI$00000C00 // (6 << 9)
67892>>>>>>>>>
67892>>>>>>>>>// Generic sub-ids
67892>>>>>>>>>Define ALG_SID_ANY                      for |CI$00000000 // (0)
67892>>>>>>>>>
67892>>>>>>>>>// RSA sub-ids
67892>>>>>>>>>Define ALG_SID_RSA_ANY                  for 0
67892>>>>>>>>>Define ALG_SID_RSA_PKCS                 for 1
67892>>>>>>>>>Define ALG_SID_RSA_MSATWORK             for 2
67892>>>>>>>>>Define ALG_SID_RSA_ENTRUST              for 3
67892>>>>>>>>>Define ALG_SID_RSA_PGP                  for 4
67892>>>>>>>>>
67892>>>>>>>>>// DSS sub-ids
67892>>>>>>>>>Define ALG_SID_DSS_ANY                  for 0
67892>>>>>>>>>Define ALG_SID_DSS_PKCS                 for 1
67892>>>>>>>>>Define ALG_SID_DSS_DMS                  for 2
67892>>>>>>>>>
67892>>>>>>>>>// DES sub_ids
67892>>>>>>>>>Define ALG_SID_DES                      for 1
67892>>>>>>>>>Define ALG_SID_3DES                     for 3
67892>>>>>>>>>Define ALG_SID_DESX                     for 4
67892>>>>>>>>>Define ALG_SID_IDEA                     for 5
67892>>>>>>>>>Define ALG_SID_CAST                     for 6
67892>>>>>>>>>Define ALG_SID_SAFERSK64                for 7
67892>>>>>>>>>Define ALG_SID_SAFERSK128               for 8
67892>>>>>>>>>Define ALG_SID_3DES_112                 for 9
67892>>>>>>>>>Define ALG_SID_CYLINK_MEK               for 12
67892>>>>>>>>>Define ALG_SID_RC5                      for 13
67892>>>>>>>>>Define ALG_SID_AES_128                  for 14
67892>>>>>>>>>Define ALG_SID_AES_192                  for 15
67892>>>>>>>>>Define ALG_SID_AES_256                  for 16
67892>>>>>>>>>Define ALG_SID_AES                      for 17
67892>>>>>>>>>
67892>>>>>>>>>// Fortezza sub-ids
67892>>>>>>>>>Define ALG_SID_SKIPJACK                 for 10
67892>>>>>>>>>Define ALG_SID_TEK                      for 11
67892>>>>>>>>>
67892>>>>>>>>>// RC2 sub-ids
67892>>>>>>>>>Define ALG_SID_RC2                      for 2
67892>>>>>>>>>
67892>>>>>>>>>// Stream cipher sub-ids
67892>>>>>>>>>Define ALG_SID_RC4                      for 1
67892>>>>>>>>>Define ALG_SID_SEAL                     for 2
67892>>>>>>>>>
67892>>>>>>>>>// Diffie-Hellman sub-ids
67892>>>>>>>>>Define ALG_SID_DH_SANDF                 for 1
67892>>>>>>>>>Define ALG_SID_DH_EPHEM                 for 2
67892>>>>>>>>>Define ALG_SID_AGREED_KEY_ANY           for 3
67892>>>>>>>>>Define ALG_SID_KEA                      for 4
67892>>>>>>>>>
67892>>>>>>>>>// Hash sub ids
67892>>>>>>>>>Define ALG_SID_MD2                      for 1
67892>>>>>>>>>Define ALG_SID_MD4                      for 2
67892>>>>>>>>>Define ALG_SID_MD5                      for 3
67892>>>>>>>>>Define ALG_SID_SHA                      for 4
67892>>>>>>>>>Define ALG_SID_SHA1                     for 4
67892>>>>>>>>>Define ALG_SID_MAC                      for 5
67892>>>>>>>>>Define ALG_SID_RIPEMD                   for 6
67892>>>>>>>>>Define ALG_SID_RIPEMD160                for 7
67892>>>>>>>>>Define ALG_SID_SSL3SHAMD5               for 8
67892>>>>>>>>>Define ALG_SID_HMAC                     for 9
67892>>>>>>>>>Define ALG_SID_TLS1PRF                  for 10
67892>>>>>>>>>Define ALG_SID_HASH_REPLACE_OWF         for 11
67892>>>>>>>>>Define ALG_SID_SHA_256                  for 12
67892>>>>>>>>>Define ALG_SID_SHA_384                  for 13
67892>>>>>>>>>Define ALG_SID_SHA_512                  for 14
67892>>>>>>>>>
67892>>>>>>>>>// secure channel sub ids
67892>>>>>>>>>Define ALG_SID_SSL3_MASTER              for 1
67892>>>>>>>>>Define ALG_SID_SCHANNEL_MASTER_HASH     for 2
67892>>>>>>>>>Define ALG_SID_SCHANNEL_MAC_KEY         for 3
67892>>>>>>>>>Define ALG_SID_PCT1_MASTER              for 4
67892>>>>>>>>>Define ALG_SID_SSL2_MASTER              for 5
67892>>>>>>>>>Define ALG_SID_TLS1_MASTER              for 6
67892>>>>>>>>>Define ALG_SID_SCHANNEL_ENC_KEY         for 7
67892>>>>>>>>>
67892>>>>>>>>>// algorithm identifier definitions
67892>>>>>>>>>Define CALG_MD2                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD2)
67892>>>>>>>>>Define CALG_MD4                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD4)
67892>>>>>>>>>Define CALG_MD5                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD5)
67892>>>>>>>>>Define CALG_SHA                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA)
67892>>>>>>>>>Define CALG_SHA1                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA1)
67892>>>>>>>>>Define CALG_MAC                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MAC)
67892>>>>>>>>>Define CALG_RSA_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
67892>>>>>>>>>Define CALG_DSS_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_DSS ior ALG_SID_DSS_ANY)
67892>>>>>>>>>Define CALG_NO_SIGN                     for (ALG_CLASS_SIGNATURE ior ALG_TYPE_ANY ior ALG_SID_ANY)
67892>>>>>>>>>Define CALG_RSA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
67892>>>>>>>>>Define CALG_DES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DES)
67892>>>>>>>>>Define CALG_3DES_112                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES_112)
67892>>>>>>>>>Define CALG_3DES                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES)
67892>>>>>>>>>Define CALG_DESX                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DESX)
67892>>>>>>>>>Define CALG_RC2                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC2)
67892>>>>>>>>>Define CALG_RC4                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_RC4)
67892>>>>>>>>>Define CALG_SEAL                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_SEAL)
67892>>>>>>>>>Define CALG_DH_SF                       for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_SANDF)
67892>>>>>>>>>Define CALG_DH_EPHEM                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_EPHEM)
67892>>>>>>>>>Define CALG_AGREEDKEY_ANY               for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_AGREED_KEY_ANY)
67892>>>>>>>>>Define CALG_KEA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_KEA)
67892>>>>>>>>>Define CALG_HUGHES_MD5                  for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_ANY ior ALG_SID_MD5)
67892>>>>>>>>>Define CALG_SKIPJACK                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_SKIPJACK)
67892>>>>>>>>>Define CALG_TEK                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_TEK)
67892>>>>>>>>>Define CALG_CYLINK_MEK                  for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_CYLINK_MEK)
67892>>>>>>>>>Define CALG_SSL3_SHAMD5                 for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SSL3SHAMD5)
67892>>>>>>>>>Define CALG_SSL3_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL3_MASTER)
67892>>>>>>>>>Define CALG_SCHANNEL_MASTER_HASH        for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MASTER_HASH)
67892>>>>>>>>>Define CALG_SCHANNEL_MAC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MAC_KEY)
67892>>>>>>>>>Define CALG_SCHANNEL_ENC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_ENC_KEY)
67892>>>>>>>>>Define CALG_PCT1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_PCT1_MASTER)
67892>>>>>>>>>Define CALG_SSL2_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL2_MASTER)
67892>>>>>>>>>Define CALG_TLS1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_TLS1_MASTER)
67892>>>>>>>>>Define CALG_RC5                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC5)
67892>>>>>>>>>Define CALG_HMAC                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HMAC)
67892>>>>>>>>>Define CALG_TLS1PRF                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_TLS1PRF)
67892>>>>>>>>>Define CALG_HASH_REPLACE_OWF            for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HASH_REPLACE_OWF)
67892>>>>>>>>>Define CALG_AES_128                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_128)
67892>>>>>>>>>Define CALG_AES_192                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_192)
67892>>>>>>>>>Define CALG_AES_256                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_256)
67892>>>>>>>>>Define CALG_AES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES)
67892>>>>>>>>>Define CALG_SHA_256                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_256)
67892>>>>>>>>>Define CALG_SHA_384                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_384)
67892>>>>>>>>>Define CALG_SHA_512                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_512)
67892>>>>>>>>>
67892>>>>>>>>>// Providers
67892>>>>>>>>>Define MS_DEF_PROV                      for "Microsoft Base Cryptographic Provider v1.0"
67892>>>>>>>>>Define MS_ENHANCED_PROV                 for "Microsoft Enhanced Cryptographic Provider v1.0"
67892>>>>>>>>>Define MS_STRONG_PROV                   for "Microsoft Strong Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_RSA_SIG_PROV              for "Microsoft RSA Signature Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_RSA_SCHANNEL_PROV         for "Microsoft RSA SChannel Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DSS_PROV                  for "Microsoft Base DSS Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DSS_DH_PROV               for "Microsoft Base DSS and Diffie-Hellman Cryptographic Provider"
67892>>>>>>>>>Define MS_ENH_DSS_DH_PROV               for "Microsoft Enhanced DSS and Diffie-Hellman Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DH_SCHANNEL_PROV          for "Microsoft DH SChannel Cryptographic Provider"
67892>>>>>>>>>Define MS_SCARD_PROV                    for "Microsoft Base Smart Card Crypto Provider"
67892>>>>>>>>>Define MS_ENH_RSA_AES_PROV              for "Microsoft Enhanced RSA and AES Cryptographic Provider"
67892>>>>>>>>>
67892>>>>>>>>>// dwFlags definitions for CryptAcquireContext
67892>>>>>>>>>Define CRYPT_VERIFYCONTEXT              for |CI$F0000000
67892>>>>>>>>>Define CRYPT_NEWKEYSET                  for |CI$00000008
67892>>>>>>>>>Define CRYPT_DELETEKEYSET               for |CI$00000010
67892>>>>>>>>>Define CRYPT_MACHINE_KEYSET             for |CI$00000020
67892>>>>>>>>>Define CRYPT_SILENT                     for |CI$00000040
67892>>>>>>>>>
67892>>>>>>>>>// dwFlag definitions for CryptGenKey
67892>>>>>>>>>Define CRYPT_EXPORTABLE                 for |CI$00000001
67892>>>>>>>>>Define CRYPT_USER_PROTECTED             for |CI$00000002
67892>>>>>>>>>Define CRYPT_CREATE_SALT                for |CI$00000004
67892>>>>>>>>>Define CRYPT_UPDATE_KEY                 for |CI$00000008
67892>>>>>>>>>Define CRYPT_NO_SALT                    for |CI$00000010
67892>>>>>>>>>Define CRYPT_PREGEN                     for |CI$00000040
67892>>>>>>>>>Define CRYPT_RECIPIENT                  for |CI$00000010
67892>>>>>>>>>Define CRYPT_INITIATOR                  for |CI$00000040
67892>>>>>>>>>Define CRYPT_ONLINE                     for |CI$00000080
67892>>>>>>>>>Define CRYPT_SF                         for |CI$00000100
67892>>>>>>>>>Define CRYPT_CREATE_IV                  for |CI$00000200
67892>>>>>>>>>Define CRYPT_KEK                        for |CI$00000400
67892>>>>>>>>>Define CRYPT_DATA_KEY                   for |CI$00000800
67892>>>>>>>>>Define CRYPT_VOLATILE                   for |CI$00001000
67892>>>>>>>>>Define CRYPT_SGCKEY                     for |CI$00002000
67892>>>>>>>>>Define CRYPT_ARCHIVABLE                 for |CI$00004000
67892>>>>>>>>>
67892>>>>>>>>>// Provider types
67892>>>>>>>>>Define PROV_RSA_FULL                    for 1
67892>>>>>>>>>Define PROV_RSA_SIG                     for 2
67892>>>>>>>>>Define PROV_DSS                         for 3
67892>>>>>>>>>Define PROV_FORTEZZA                    for 4
67892>>>>>>>>>Define PROV_MS_EXCHANGE                 for 5
67892>>>>>>>>>Define PROV_SSL                         for 6
67892>>>>>>>>>Define PROV_RSA_SCHANNEL                for 12
67892>>>>>>>>>Define PROV_DSS_DH                      for 13
67892>>>>>>>>>Define PROV_EC_ECDSA_SIG                for 14
67892>>>>>>>>>Define PROV_EC_ECNRA_SIG                for 15
67892>>>>>>>>>Define PROV_EC_ECDSA_FULL               for 16
67892>>>>>>>>>Define PROV_EC_ECNRA_FULL               for 17
67892>>>>>>>>>Define PROV_DH_SCHANNEL                 for 18
67892>>>>>>>>>Define PROV_SPYRUS_LYNKS                for 20
67892>>>>>>>>>Define PROV_RNG                         for 21
67892>>>>>>>>>Define PROV_INTEL_SEC                   for 22
67892>>>>>>>>>Define PROV_REPLACE_OWF                 for 23
67892>>>>>>>>>Define PROV_RSA_AES                     for 24
67892>>>>>>>>>
67892>>>>>>>>>// KP_MODE
67892>>>>>>>>>// KP_MODE
67892>>>>>>>>>Define CRYPT_MODE_CBC                   for 1       // Cipher block chaining
67892>>>>>>>>>Define CRYPT_MODE_ECB                   for 2       // Electronic code book
67892>>>>>>>>>Define CRYPT_MODE_OFB                   for 3       // Output feedback mode
67892>>>>>>>>>Define CRYPT_MODE_CFB                   for 4       // Cipher feedback mode
67892>>>>>>>>>Define CRYPT_MODE_CTS                   for 5       // Ciphertext stealing mode
67892>>>>>>>>>Define CRYPT_MODE_CBCI                  for 6       // ANSI CBC Interleaved
67892>>>>>>>>>Define CRYPT_MODE_CFBP                  for 7       // ANSI CFB Pipelined
67892>>>>>>>>>Define CRYPT_MODE_OFBP                  for 8       // ANSI OFB Pipelined
67892>>>>>>>>>Define CRYPT_MODE_CBCOFM                for 9       // ANSI CBC + OF Masking
67892>>>>>>>>>Define CRYPT_MODE_CBCOFMI               for 10      // ANSI CBC + OFM Interleaved
67892>>>>>>>>>
67892>>>>>>>>>// dwParam definitions for CryptGetKeyParam
67892>>>>>>>>>Define KP_IV                            for 1       // Initialization vector
67892>>>>>>>>>Define KP_SALT                          for 2       // Salt value
67892>>>>>>>>>Define KP_PADDING                       for 3       // Padding values
67892>>>>>>>>>Define KP_MODE                          for 4       // Mode of the cipher
67892>>>>>>>>>Define KP_MODE_BITS                     for 5       // Number of bits to feedback
67892>>>>>>>>>Define KP_PERMISSIONS                   for 6       // Key permissions DWORD
67892>>>>>>>>>Define KP_ALGID                         for 7       // Key algorithm
67892>>>>>>>>>Define KP_BLOCKLEN                      for 8       // Block size of the cipher
67892>>>>>>>>>Define KP_KEYLEN                        for 9       // Length of key in bits
67892>>>>>>>>>Define KP_SALT_EX                       for 10      // Length of salt in bytes
67892>>>>>>>>>Define KP_P                             for 11      // DSS/Diffie-Hellman P value
67892>>>>>>>>>Define KP_G                             for 12      // DSS/Diffie-Hellman G value
67892>>>>>>>>>Define KP_Q                             for 13      // DSS Q value
67892>>>>>>>>>Define KP_X                             for 14      // Diffie-Hellman X value
67892>>>>>>>>>Define KP_Y                             for 15      // Y value
67892>>>>>>>>>Define KP_RA                            for 16      // Fortezza RA value
67892>>>>>>>>>Define KP_RB                            for 17      // Fortezza RB value
67892>>>>>>>>>Define KP_INFO                          for 18      // for putting information into an RSA envelope
67892>>>>>>>>>Define KP_EFFECTIVE_KEYLEN              for 19      // setting and getting RC2 effective key length
67892>>>>>>>>>Define KP_SCHANNEL_ALG                  for 20      // for setting the Secure Channel algorithms
67892>>>>>>>>>Define KP_CLIENT_RANDOM                 for 21      // for setting the Secure Channel client random data
67892>>>>>>>>>Define KP_SERVER_RANDOM                 for 22      // for setting the Secure Channel server random data
67892>>>>>>>>>Define KP_RP                            for 23
67892>>>>>>>>>Define KP_PRECOMP_MD5                   for 24
67892>>>>>>>>>Define KP_PRECOMP_SHA                   for 25
67892>>>>>>>>>Define KP_CERTIFICATE                   for 26      // for setting Secure Channel certificate data (PCT1)
67892>>>>>>>>>Define KP_CLEAR_KEY                     for 27      // for setting Secure Channel clear key data (PCT1)
67892>>>>>>>>>Define KP_PUB_EX_LEN                    for 28
67892>>>>>>>>>Define KP_PUB_EX_VAL                    for 29
67892>>>>>>>>>Define KP_KEYVAL                        for 30
67892>>>>>>>>>Define KP_ADMIN_PIN                     for 31
67892>>>>>>>>>Define KP_KEYEXCHANGE_PIN               for 32
67892>>>>>>>>>Define KP_SIGNATURE_PIN                 for 33
67892>>>>>>>>>Define KP_PREHASH                       for 34
67892>>>>>>>>>Define KP_ROUNDS                        for 35
67892>>>>>>>>>Define KP_OAEP_PARAMS                   for 36      // for setting OAEP params on RSA keys
67892>>>>>>>>>Define KP_CMS_KEY_INFO                  for 37
67892>>>>>>>>>Define KP_CMS_DH_KEY_INFO               for 38
67892>>>>>>>>>Define KP_PUB_PARAMS                    for 39      // for setting public parameters
67892>>>>>>>>>Define KP_VERIFY_PARAMS                 for 40      // for verifying DSA and DH parameters
67892>>>>>>>>>Define KP_HIGHEST_VERSION               for 41      // for TLS protocol version setting
67892>>>>>>>>>Define KP_GET_USE_COUNT                 for 42      // for use with PP_CRYPT_COUNT_KEY_USE contexts
67892>>>>>>>>>
67892>>>>>>>>>// dwParam definitions for CryptGetHashParam
67892>>>>>>>>>Define HP_ALGID                         for |CI$0001  // Hash algorithm
67892>>>>>>>>>Define HP_HASHVAL                       for |CI$0002  // Hash value
67892>>>>>>>>>Define HP_HASHSIZE                      for |CI$0004  // Hash value size
67892>>>>>>>>>Define HP_HMAC_INFO                     for |CI$0005  // information for creating an HMA
67892>>>>>>>>>
67892>>>>>>>>>// key BLOB types
67892>>>>>>>>>Define KEYSTATEBLOB                     for |CI$0C
67892>>>>>>>>>Define OPAQUEKEYBLOB                    for |CI$09
67892>>>>>>>>>Define PLAINTEXTKEYBLOB                 for |CI$08
67892>>>>>>>>>Define PRIVATEKEYBLOB                   for |CI$07
67892>>>>>>>>>Define PUBLICKEYBLOB                    for |CI$06
67892>>>>>>>>>Define PUBLICKEYBLOBEX                  for |CI$0A
67892>>>>>>>>>Define SIMPLEBLOB                       for |CI$01
67892>>>>>>>>>Define SYMMETRICWRAPKEYBLOB             for |CI$0B
67892>>>>>>>>>
67892>>>>>>>>>Define CUR_BLOB_VERSION                 for 2
67892>>>>>>>>>
67892>>>>>>>>>//  Structure cryptimportkey
67892>>>>>>>>>Struct PUBLICKEYSTRUC
67892>>>>>>>>>    UChar    bType
67892>>>>>>>>>    UChar    bVersion
67892>>>>>>>>>    UShort   reserved
67892>>>>>>>>>    UInteger aiKeyAlg
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>Struct tPLAINTEXTKEYBLOB
67892>>>>>>>>>    PUBLICKEYSTRUC hdr
67892>>>>>>>>>    PUBLICKEYSTRUC hdr
67892>>>>>>>>>    UInteger       dwKeySize
67892>>>>>>>>>//    UChar[]        rgbKeyData
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>//  Structure for specifying the inner and outer strings when calculating HMAC hash (use with CryptSetHashParam)
67892>>>>>>>>>Struct HMAC_INFO
67892>>>>>>>>>    UInteger HashAlgid
67892>>>>>>>>>    Pointer pbInnerString
67892>>>>>>>>>    DWord cbInnerString
67892>>>>>>>>>    Pointer pbOuterString
67892>>>>>>>>>    DWord cbOuterString
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>External_Function CryptAcquireContext "CryptAcquireContextA" advapi32.dll ;    Pointer phProv ;    Pointer szContainer ;    Pointer szProvider ;    Integer dwProvType ;    Integer dwFlags ;    Returns Boolean
67893>>>>>>>>>
67893>>>>>>>>>External_Function CryptReleaseContext "CryptReleaseContext" advapi32.dll ;    Handle hProv ;    Integer dwFlags ;    Returns Boolean
67894>>>>>>>>>
67894>>>>>>>>>External_Function CryptCreateHash "CryptCreateHash" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hKey ;    Integer dwFlags ;    Pointer phHash ;    Returns Boolean
67895>>>>>>>>>
67895>>>>>>>>>External_Function CryptDestroyHash "CryptDestroyHash" advapi32.dll ;    Handle hHash ;    Returns Boolean
67896>>>>>>>>>
67896>>>>>>>>>External_Function CryptHashData "CryptHashData" advapi32.dll ;    Handle hHash ;    Pointer pbData ;    Integer dwDataLen ;    Integer dwFlags ;    Returns Boolean
67897>>>>>>>>>
67897>>>>>>>>>External_Function CryptDeriveKey "CryptDeriveKey" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hBaseData ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
67898>>>>>>>>>
67898>>>>>>>>>External_Function CryptGetHashParam "CryptGetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    DWord dwFlags ;    Returns Integer
67899>>>>>>>>>
67899>>>>>>>>>External_Function CryptDestroyKey "CryptDestroyKey" advapi32.dll ;    Handle hKey ;    Returns Boolean
67900>>>>>>>>>
67900>>>>>>>>>External_Function CryptImportKey "CryptImportKey" advapi32.dll ;    Handle hProv ;    Pointer pbData ;    Integer dwDataLen ;    Handle hPubKey ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
67901>>>>>>>>>
67901>>>>>>>>>External_Function CryptGetKeyParam "CryptGetKeyParam" advapi32.dll ;    Handle hKey ;    Integer dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwFlags ;    Returns Boolean
67902>>>>>>>>>    
67902>>>>>>>>>External_Function CryptSetKeyParam "CryptSetKeyParam" advapi32.dll ;    Handle   hKey ;    UInteger dwParam ;    Pointer  pbdata ;    UInteger dwFlags ;    Returns  Boolean
67903>>>>>>>>>
67903>>>>>>>>>External_Function CryptEncrypt "CryptEncrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwBufLen ;    Returns Boolean
67904>>>>>>>>>
67904>>>>>>>>>External_Function CryptDecrypt "CryptDecrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Returns Boolean
67905>>>>>>>>>
67905>>>>>>>>>External_Function CryptGenRandom "CryptGenRandom" advapi32.dll ;    Handle hProv ;    DWord dwLen ;    Pointer pbBuffer ;    Returns Boolean
67906>>>>>>>>>    
67906>>>>>>>>>External_Function CryptSetHashParam "CryptSetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Integer dwFlags ;    Returns Boolean
67907>>>>>>>>>    
67907>>>>>>>
67907>>>>>>>Class cCryptographer is a cObject
67908>>>>>>>    
67908>>>>>>>    Procedure Construct_Object
67910>>>>>>>        Forward Send Construct_Object
67912>>>>>>>        
67912>>>>>>>        Property String     psProvider  MS_ENHANCED_PROV
67913>>>>>>>        Property Integer    piProvider  PROV_RSA_FULL
67914>>>>>>>        Property Integer    piCipher    CALG_RC4
67915>>>>>>>        Property Integer    piHash      CALG_MD5
67916>>>>>>>        
67916>>>>>>>        // Private properties
67916>>>>>>>        Property Handle     Private_phProv
67917>>>>>>>    End_Procedure
67918>>>>>>>    
67918>>>>>>>    
67918>>>>>>>    // Acquire key container handle
67918>>>>>>>    Function AcquireContext Returns Handle
67920>>>>>>>        Integer iProvider
67920>>>>>>>        String sProvider
67920>>>>>>>        Handle hProv
67920>>>>>>>        Boolean bOk
67920>>>>>>>        Address addrProv
67920>>>>>>>        
67920>>>>>>>        Move 0 to hProv
67921>>>>>>>        Get piProvider to iProvider
67922>>>>>>>        Get psProvider to sProvider
67923>>>>>>>        
67923>>>>>>>        //  Determine address to be passed as provider
67923>>>>>>>        If (Trim(sProvider) <> "") Begin
67925>>>>>>>            Move (AddressOf(sProvider)) to addrProv
67926>>>>>>>        End
67926>>>>>>>>
67926>>>>>>>        Else Begin
67927>>>>>>>            Move 0 to addrProv
67928>>>>>>>        End
67928>>>>>>>>
67928>>>>>>>        
67928>>>>>>>        //  Acquire Crypto Context
67928>>>>>>>        Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_VERIFYCONTEXT)) to bOk
67929>>>>>>>        If (not(bOk) or hProv = 0) Begin
67931>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET ior CRYPT_VERIFYCONTEXT)) to bOk
67932>>>>>>>        End
67932>>>>>>>>
67932>>>>>>>        
67932>>>>>>>        If (not(bOk) or hProv = 0) Begin
67934>>>>>>>            // Fallback to original
67934>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,0)) to bOk
67935>>>>>>>            
67935>>>>>>>            If (not(bOk) or hProv = 0) Begin
67937>>>>>>>                Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET)) to bOk
67938>>>>>>>            End
67938>>>>>>>>
67938>>>>>>>        End
67938>>>>>>>>
67938>>>>>>>        Set Private_phProv to hProv
67939>>>>>>>        
67939>>>>>>>        Function_Return hProv
67940>>>>>>>    End_Function
67941>>>>>>>    
67941>>>>>>>    // Releases key container handle
67941>>>>>>>    Function ReleaseContext Handle hProv Returns Boolean
67943>>>>>>>        Function_Return (CryptReleaseContext(hProv,0))
67944>>>>>>>    End_Function
67945>>>>>>>    
67945>>>>>>>    // Creates hash object
67945>>>>>>>    Function CreateHash Handle hProv Returns Handle
67947>>>>>>>        Integer iAlgorithm
67947>>>>>>>        Handle hHash
67947>>>>>>>        Boolean bOk
67947>>>>>>>        
67947>>>>>>>        Move 0 to hHash
67948>>>>>>>        Get piHash to iAlgorithm
67949>>>>>>>        Move (CryptCreateHash(hProv,iAlgorithm,0,0,AddressOf(hHash))) to bOk
67950>>>>>>>        
67950>>>>>>>        Function_Return hHash
67951>>>>>>>    End_Function
67952>>>>>>>    
67952>>>>>>>    // Destroys the hash object
67952>>>>>>>    Function DestroyHash Handle hHash Returns Boolean
67954>>>>>>>        Function_Return (CryptDestroyHash(hHash))
67955>>>>>>>    End_Function
67956>>>>>>>    
67956>>>>>>>    // Adds data to hash object
67956>>>>>>>    Function HashData Handle hHash String sData Returns Boolean
67958>>>>>>>        Function_Return (CryptHashData(hHash,AddressOf(sData),Length(sData),0))
67959>>>>>>>    End_Function
67960>>>>>>>    
67960>>>>>>>    // Generates session key
67960>>>>>>>    Function DeriveKey Handle hProv Handle hHash Returns Handle
67962>>>>>>>        Integer iAlgorithm
67962>>>>>>>        Handle hKey
67962>>>>>>>        Boolean bOk
67962>>>>>>>        
67962>>>>>>>        Move 0 to hKey
67963>>>>>>>        Get piCipher to iAlgorithm
67964>>>>>>>        Move (CryptDeriveKey(hProv,iAlgorithm,hHash,CRYPT_EXPORTABLE,AddressOf(hKey))) to bOk
67965>>>>>>>        
67965>>>>>>>        Function_Return hKey
67966>>>>>>>    End_Function
67967>>>>>>>    
67967>>>>>>>    // Imports a plain text key
67967>>>>>>>    Function ImportPlainTextKey Handle hProv UChar[] ucaKey Returns Handle
67969>>>>>>>        tPLAINTEXTKEYBLOB blobhead
67969>>>>>>>        tPLAINTEXTKEYBLOB blobhead
67969>>>>>>>        Boolean   bSuccess
67969>>>>>>>        Handle    hKey
67969>>>>>>>        Integer   iHeadSize iKeySize
67969>>>>>>>        UChar[]   ucaKeyblob
67970>>>>>>>        Integer iVoid
67970>>>>>>>        
67970>>>>>>>        Move (SizeOfType(tPLAINTEXTKEYBLOB)) to iHeadSize
67971>>>>>>>        Move (SizeOfArray(ucaKey)) to iKeySize
67972>>>>>>>        
67972>>>>>>>        Move PLAINTEXTKEYBLOB to blobhead.hdr.bType
67973>>>>>>>        Move CUR_BLOB_VERSION   to blobhead.hdr.bVersion
67974>>>>>>>        Get piCipher            to blobhead.hdr.aiKeyAlg
67975>>>>>>>        Move iKeySize           to blobhead.dwKeySize
67976>>>>>>>        
67976>>>>>>>        Move (ResizeArray(ucaKeyblob, iHeadSize)) to ucaKeyblob
67977>>>>>>>        Move (CopyMemory(AddressOf(ucaKeyblob), AddressOf(blobhead), iHeadSize)) to iVoid
67978>>>>>>>        Move (AppendArray(ucaKeyblob, ucaKey)) to ucaKeyblob
67979>>>>>>>        
67979>>>>>>>        Move 0 to hKey
67980>>>>>>>        Move (CryptImportKey(hProv, AddressOf(ucaKeyblob), SizeOfArray(ucaKeyblob), 0, 0, AddressOf(hKey))) to bSuccess
67981>>>>>>>        If (not(bSuccess)) Begin
67983>>>>>>>            Move (ShowLastError()) to iVoid
67984>>>>>>>        End
67984>>>>>>>>
67984>>>>>>>        
67984>>>>>>>        Function_Return hKey
67985>>>>>>>    End_Function
67986>>>>>>>    
67986>>>>>>>    // Destroys the key
67986>>>>>>>    Function DestroyKey Handle hKey Returns Boolean
67988>>>>>>>        Function_Return (CryptDestroyKey(hKey))
67989>>>>>>>    End_Function
67990>>>>>>>    
67990>>>>>>>    // Retrieves key data
67990>>>>>>>    Function KeyParameter Handle hKey Integer iQuery Returns Integer
67992>>>>>>>        Integer iBuffer iLen
67992>>>>>>>        Boolean bOk
67992>>>>>>>        
67992>>>>>>>        Move (SizeOfType(Integer)) to iLen
67993>>>>>>>        Move (CryptGetKeyParam(hKey,iQuery,AddressOf(iBuffer),AddressOf(iLen),0)) to bOk
67994>>>>>>>        Function_Return iBuffer
67995>>>>>>>    End_Function
67996>>>>>>>    
67996>>>>>>>    // Retrieves a hash value
67996>>>>>>>    Function HashValue Handle lhHash Returns String
67998>>>>>>>        String  lsHash
67998>>>>>>>        Integer liResult
67998>>>>>>>        DWord   dwDataLen
67998>>>>>>>        
67998>>>>>>>        Move 0 to dwDataLen
67999>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,0,AddressOf(dwDataLen),0)) to liResult
68000>>>>>>>        If (liResult = 0) ;            Function_Return ""
68003>>>>>>>        
68003>>>>>>>        Move (Repeat(Character(0),dwDataLen)) to lsHash
68004>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,AddressOf(lsHash),AddressOf(dwDataLen),0)) to liResult
68005>>>>>>>        If (liResult = 0) ;            Function_Return ""
68008>>>>>>>        
68008>>>>>>>        Function_Return lsHash
68009>>>>>>>    End_Function
68010>>>>>>>
68010>>>>>>>    // Encrypts data
68010>>>>>>>    Function Encrypt String sPassword String sData Returns String
68012>>>>>>>        Handle hProv hHash hKey
68012>>>>>>>        Integer iAlgorithm iDataLen iCipherLen iErr
68012>>>>>>>        Boolean bOk
68012>>>>>>>        
68012>>>>>>>        Get AcquireContext to hProv
68013>>>>>>>        If (hProv) Begin
68015>>>>>>>            Get CreateHash hProv to hHash
68016>>>>>>>            If (hHash) Begin
68018>>>>>>>                Get HashData hHash sPassword to bOk
68019>>>>>>>                If (bOk) Begin
68021>>>>>>>                    Get piCipher to iAlgorithm
68022>>>>>>>                    Get DeriveKey hProv hHash to hKey
68023>>>>>>>                End
68023>>>>>>>>
68023>>>>>>>                Get DestroyHash hHash to bOk
68024>>>>>>>            End
68024>>>>>>>>
68024>>>>>>>            
68024>>>>>>>            If (hKey) Begin
68026>>>>>>>                //  First call to determine resulting data size
68026>>>>>>>                Move (Length(sData)) to iDataLen
68027>>>>>>>                Move (Length(sData)) to iCipherLen
68028>>>>>>>                Move (CryptEncrypt(hKey, 0, True, 0, 0, AddressOf(iCipherLen), iDataLen)) to bOk
68029>>>>>>>                
68029>>>>>>>                //  Reserve space in string
68029>>>>>>>                If (iDataLen < iCipherLen) Begin
68031>>>>>>>                    Move (sData + Repeat(" ", iCipherLen - iDataLen)) to sData
68032>>>>>>>                End
68032>>>>>>>>
68032>>>>>>>                
68032>>>>>>>                //  Call to really decrypt
68032>>>>>>>                Move (CryptEncrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen),Length(sData))) to bOk
68033>>>>>>>                //If (not(bOk)) Begin
68033>>>>>>>                //Move "" to sData
68033>>>>>>>                //Move (GetLastError()) to iErr
68033>>>>>>>                //End
68033>>>>>>>                
68033>>>>>>>                Get DestroyKey hKey to bOk
68034>>>>>>>            End 
68034>>>>>>>>
68034>>>>>>>            Get ReleaseContext hProv to bOk
68035>>>>>>>        End 
68035>>>>>>>>
68035>>>>>>>        Function_Return sData
68036>>>>>>>    End_Function
68037>>>>>>>    
68037>>>>>>>    // Decrypts data
68037>>>>>>>    Function Decrypt String sPassword String sData Returns String
68039>>>>>>>        Handle hProv hHash hKey
68039>>>>>>>        Integer iAlgorithm iDataLen
68039>>>>>>>        Boolean bOk
68039>>>>>>>        
68039>>>>>>>        Get AcquireContext to hProv
68040>>>>>>>        If (hProv) Begin
68042>>>>>>>            Get CreateHash hProv to hHash
68043>>>>>>>            If (hHash) Begin
68045>>>>>>>                Get HashData hHash sPassword to bOk
68046>>>>>>>                If (bOk) Begin
68048>>>>>>>                    Get piCipher to iAlgorithm
68049>>>>>>>                    Get DeriveKey hProv hHash to hKey
68050>>>>>>>                End
68050>>>>>>>>
68050>>>>>>>                Get DestroyHash hHash to bOk
68051>>>>>>>            End
68051>>>>>>>>
68051>>>>>>>            
68051>>>>>>>            If (hKey) Begin
68053>>>>>>>                Move (Length(sData)) to iDataLen
68054>>>>>>>                Move (CryptDecrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen))) to bOk
68055>>>>>>>                //  Resulting dat can be shorter as the input string, in that case we shorten the result string
68055>>>>>>>                If (Length(sData) > iDataLen) Begin
68057>>>>>>>                    Move (Left(sData, iDataLen)) to sData
68058>>>>>>>                End
68058>>>>>>>>
68058>>>>>>>                
68058>>>>>>>                Get DestroyKey hKey to bOk
68059>>>>>>>            End
68059>>>>>>>>
68059>>>>>>>            Get ReleaseContext hProv to bOk
68060>>>>>>>        End
68060>>>>>>>>
68060>>>>>>>        Function_Return sData
68061>>>>>>>    End_Function
68062>>>>>>>    
68062>>>>>>>    //  Generates random data.
68062>>>>>>>    Function GenerateRandom Integer iBytes Returns UChar[]
68064>>>>>>>        Handle hProv
68064>>>>>>>        UChar[] uaResult
68065>>>>>>>        Boolean bRes
68065>>>>>>>        
68065>>>>>>>        Get AcquireContext to hProv
68066>>>>>>>        
68066>>>>>>>        Move (ResizeArray(uaResult, iBytes)) to uaResult
68067>>>>>>>        Move (CryptGenRandom(hProv, iBytes, AddressOf(uaResult))) to bRes
68068>>>>>>>        
68068>>>>>>>        Get ReleaseContext hProv to bRes
68069>>>>>>>        
68069>>>>>>>        Function_Return uaResult
68070>>>>>>>    End_Function
68071>>>>>>>    
68071>>>>>>>    //  Generates random data and does a base64 encoding to properly present it as a string.
68071>>>>>>>    Function GenerateRandomString Integer iLenght Returns String
68073>>>>>>>        String sResult
68073>>>>>>>        UChar[] aData
68074>>>>>>>        Address pBase64
68074>>>>>>>        Integer iVoid
68074>>>>>>>        
68074>>>>>>>        Get GenerateRandom iLenght to aData
68075>>>>>>>        
68075>>>>>>>        Move (Base64Encode(AddressOf(aData), iLenght)) to pBase64
68076>>>>>>>        Move pBase64 to sResult
68077>>>>>>>        Move (Free(pBase64)) to iVoid
68078>>>>>>>        
68078>>>>>>>        Function_Return (Left(sResult, iLenght))
68079>>>>>>>    End_Function
68080>>>>>>>    
68080>>>>>>>End_Class
68081>>>>>
68081>>>>>Class cLoginEncryption is a cObject
68082>>>>>    
68082>>>>>    Procedure Construct_Object
68084>>>>>        Forward Send Construct_Object
68086>>>>>        // this must be set to a multi (40ish) character random key
68086>>>>>        Property String psEncryptPassword ""
68087>>>>>        
68087>>>>>        Object oDataCrypter is a cCryptographer
68089>>>>>            Set piHash to CALG_SHA_256
68090>>>>>            Set piCipher to CALG_AES_256
68091>>>>>            Set psProvider to "" //  Not providing a specific provider gives the default provider for the provider type
68092>>>>>            Set piProvider to PROV_RSA_AES
68093>>>>>        End_Object
68094>>>>>    End_Procedure
68095>>>>>    
68095>>>>>    // This can be augmented to return a password encryption key using any
68095>>>>>    // hidden mechanism desired.
68095>>>>>    Function GetEncryptionPassword Returns String
68097>>>>>        String sPassword
68097>>>>>        Get psEncryptPassword to sPassword
68098>>>>>        Function_Return sPassword
68099>>>>>    End_Function
68100>>>>>    
68100>>>>>    // Encrypts a string into an unreadable hash that can later be decrypted using DecryptKey.
68100>>>>>    //
68100>>>>>    // Params:
68100>>>>>    //   sPlainText     String to encrypt.
68100>>>>>    // Returns:
68100>>>>>    //   Base64 encoded hash.
68100>>>>>    Function EncryptPassword String sPlainText Returns String
68102>>>>>        String sEncryptPassword sBinary sBase64
68102>>>>>        Address pBase64
68102>>>>>        Integer iVoid
68102>>>>>        
68102>>>>>        //  Encrypt Key
68102>>>>>        Get GetEncryptionPassword to sEncryptPassword
68103>>>>>        If (sEncryptPassword = "") Begin
68105>>>>>            Error DFERR_PROGRAM "No encryption password set"
68106>>>>>>
68106>>>>>        End
68106>>>>>>
68106>>>>>        
68106>>>>>        Get Encrypt of oDataCrypter sEncryptPassword sPlainText to sBinary
68107>>>>>        
68107>>>>>        If (sPlainText = sBinary or sBinary = "") Begin
68109>>>>>            Error DFERR_PROGRAM "Unable to encrypt database login password"
68110>>>>>>
68110>>>>>            Function_Return ""
68111>>>>>        End
68111>>>>>>
68111>>>>>        
68111>>>>>        //  Encode binary hash to Base64
68111>>>>>        Move (Base64Encode(AddressOf(sBinary), Length(sBinary))) to pBase64
68112>>>>>        Move pBase64 to sBase64
68113>>>>>        Move (Free(pBase64)) to iVoid
68114>>>>>        
68114>>>>>        Function_Return sBase64
68115>>>>>    End_Function
68116>>>>>    
68116>>>>>    
68116>>>>>    // Decrypts the unreadable hash generated by EncryptKey into a readable string.
68116>>>>>    //
68116>>>>>    // Params:
68116>>>>>    //   sBase64EncryptedPassword       Base64 Encrypted password
68116>>>>>    // Returns:
68116>>>>>    //   Readable plain text password
68116>>>>>    Function DecryptPassword String sBase64EncryptedPassword Returns String
68118>>>>>        String sEncryptPassword sPlainText sBinary
68118>>>>>        Boolean bIsHex
68118>>>>>        Integer iLen iVoid
68118>>>>>        Address pBinary
68118>>>>>        
68118>>>>>        If (sBase64EncryptedPassword <> "") Begin
68120>>>>>            //  Decode from Base64
68120>>>>>            Move (Base64Decode(AddressOf(sBase64EncryptedPassword), &iLen)) to pBinary
68121>>>>>            
68121>>>>>            Move (Repeat(Character(0), iLen)) to sBinary
68122>>>>>            Move (CopyMemory(AddressOf(sBinary), pBinary, iLen)) to iVoid
68123>>>>>            
68123>>>>>            Move (Free(pBinary)) to iVoid
68124>>>>>            
68124>>>>>            //  Encrypted binary hash to string
68124>>>>>            Get GetEncryptionPassword to sEncryptPassword
68125>>>>>            Get Decrypt of oDataCrypter sEncryptPassword sBinary to sPlainText
68126>>>>>        End
68126>>>>>>
68126>>>>>        
68126>>>>>        Function_Return sPlainText
68127>>>>>    End_Function
68128>>>>>End_Class
68129>>>
68129>>>Object oLoginEncryption is a cLoginEncryption
68131>>>
68131>>>    // this must be created in your appsrc directory and must contain an encryption
68131>>>    // key that is set to psEncryptPassword. It will look something like this
68131>>>    //
68131>>>    // Set psEncryptPassword to "JchUAo7W@r.b{<Yk~OONi0nq=sMi[*Rn[A-`Vo)q"
68131>>>    //  
Including file: LoginEncryptionKey.inc    (C:\DataFlex Projects\ShoeFactory\AppSrc\LoginEncryptionKey.inc)
68131>>>>// Studio generated login encryption key
68131>>>>Set psEncryptPassword to "rHn+igXUe(,,M<?dkNtebWQJ$w>FT\9<FI)(MsQz"
68132>>>>
68132>>>    
68132>>>    // use this to register this object to your cConnection Object. This object
68132>>>    // must be created after the cConnection object
68132>>>    Move Self to ghoLoginEncryption
68133>>>End_Object
68134>        Use DatabaseLoginDialog.dg
Including file: DatabaseLoginDialog.dg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\DatabaseLoginDialog.dg)
68134>>>
68134>>>Use Windows.pkg
68134>>>Use cConnection.pkg
68134>>>Use dfLine.pkg
68134>>>
68134>>>Object oDatabaseLoginDialog is a ModalPanel
68136>>>    Set Label to "Database Login"
68137>>>    Set Location to 2 2
68138>>>    Set Size to 110 211
68139>>>    
68139>>>    Property String psId
68141>>>    Property Boolean pbOk False
68143>>>    Property Boolean pbChanged False
68145>>>    Property Boolean pbAllowRemember True
68147>>>    
68147>>>    // this registers this object with the cConnection object.
68147>>>    Move Self to ghoLoginConnectDialog
68148>>>    
68148>>>    Object oUserIDForm is a Form
68150>>>        Set Label to "User Name"
68151>>>        Set Size to 12 85
68152>>>        Set Location to 34 79
68153>>>        Set Label_Col_Offset to 64
68154>>>        Set peAnchors to anTopLeftRight
68155>>>    End_Object
68156>>>    
68156>>>    Object oPwdForm is a Form
68158>>>        Set Size to 12 85
68159>>>        Set Location to 49 79
68160>>>        Set Label_Col_Offset to 64
68161>>>        Set Password_State to True
68162>>>        Set peAnchors to anTopLeftRight
68163>>>        Set Label to "Password"
68164>>>    End_Object
68165>>>    
68165>>>    Object oTrustedConnection is a CheckBox
68167>>>        Set Size to 10 50
68168>>>        Set Location to 65 79
68169>>>        Set Label to "Trusted Connection"
68170>>>    End_Object
68171>>>    
68171>>>    Object oRemember is a CheckBox
68173>>>        Set Size to 10 50
68174>>>        Set Location to 79 14
68175>>>        Set Label to "Remember and don't ask again"
68176>>>        Set Checked_State to True
68177>>>    End_Object
68178>>>    
68178>>>    Object oLogin_btn is a Button
68180>>>        Set Label to "&Login"
68181>>>        Set Location to 92 102
68182>>>        Set peAnchors to anBottomRight
68183>>>        Set Default_State to True
68184>>>        
68184>>>        Procedure OnClick
68187>>>            Boolean bTrust
68187>>>            String sUser sPwd sConn sErr sId
68187>>>            Integer iError
68187>>>            Get psId to sId
68188>>>            Get Value of oUserIDForm to sUser
68189>>>            Get Value of oPwdForm to sPwd
68190>>>            Get Checked_State of oTrustedConnection to bTrust
68191>>>            
68191>>>            Get LoginConnectIdNewCredentials of ghoConnection sId sUser sPwd bTrust to iError
68192>>>            If (iError=0) Begin
68194>>>                Set pbOk to True
68195>>>                Set pbChanged to True
68196>>>                Send Close_Panel
68197>>>            End
68197>>>>
68197>>>            Else Begin
68198>>>                Get psErrorText of ghoConnection to sErr
68199>>>                Send UserError sErr "Login Error"
68200>>>            End
68200>>>>
68200>>>        End_Procedure
68201>>>    End_Object
68202>>>    
68202>>>    Object oCancel_btn is a Button
68204>>>        Set Label to "&Cancel"
68205>>>        Set Location to 92 157
68206>>>        Set peAnchors to anBottomRight
68207>>>        
68207>>>        Procedure OnClick
68210>>>            Send Close_Panel
68211>>>        End_Procedure
68212>>>    End_Object
68213>>>    
68213>>>    Object oConnectionIdInfo is a TextBox
68215>>>        Set Size to 10 50
68216>>>        Set Location to 4 14
68217>>>        Set Label to 'Connection Id='
68218>>>    End_Object
68219>>>    
68219>>>    Object oConnectionServerInfo is a TextBox
68221>>>        Set Size to 10 50
68222>>>        Set Location to 16 14
68223>>>        Set Label to 'Server'
68224>>>    End_Object
68225>>>    
68225>>>    Object oLineControl1 is a LineControl
68227>>>        Set Size to 2 202
68228>>>        Set Location to 29 5
68229>>>    End_Object
68230>>>    
68230>>>    Function LoginConnectIdDialog String sId Returns Boolean
68233>>>        Boolean bOk bChanged bTrusted bAllowRemember bRemember
68233>>>        String sUser sPwd sDescription
68233>>>        tConnection Connect
68233>>>        tConnection Connect
68233>>>        
68233>>>        Get pbAllowRemember to bAllowRemember
68234>>>        
68234>>>        
68234>>>        If not bAllowRemember Begin
68236>>>            Set Enabled_State of oRemember to bRemember
68237>>>            Set Visible_State of oRemember to bRemember
68238>>>        End
68238>>>>
68238>>>        
68238>>>        Get ConnectionIdInfo of ghoConnection sId to Connect
68239>>>        Set Value of oConnectionIdInfo to ("Connection ID="+Connect.sId)
68240>>>        Set Value of oConnectionServerInfo to Connect.sString
68241>>>        
68241>>>        Set psId to sId
68242>>>        Set pbOk to False
68243>>>        Set pbChanged to False
68244>>>        Set Value of oUserIDForm to Connect.sUID
68245>>>        Set Value of oPwdForm to ""
68246>>>        
68246>>>        Send Popup
68247>>>        
68247>>>        Get pbOk to bOk
68248>>>        Get pbChanged to bChanged
68249>>>        If (bChanged and bOk) Begin
68251>>>            If bAllowRemember Begin
68253>>>                Get Checked_State of oRemember to bRemember
68254>>>                If bRemember Begin
68256>>>                    Get Checked_State of oTrustedConnection to bTrusted
68257>>>                    If not (bTrusted) Begin
68259>>>                        Get Value of oUserIDForm to sUser
68260>>>                        Get Value of oPwdForm to sPwd
68261>>>                    End
68261>>>>
68261>>>                    Get StoreConnectionIdCredentials of ghoConnection sId sUser sPwd bTrusted to bOk
68262>>>                End
68262>>>>
68262>>>            End
68262>>>>
68262>>>        End
68262>>>>
68262>>>        Function_Return bOk
68263>>>    End_Function
68264>>>    
68264>>>    
68264>>>    On_Key Key_Alt+Key_O Send KeyAction of oLogin_btn
68265>>>    On_Key Key_Alt+Key_L Send KeyAction of oCancel_btn
68266>>>End_Object
68267>>>
68267>    End_Object
68268>
68268>End_Object
68269>
68269>Object oToolTipController is a cToolTipController
68271>    Move Self to ghoToolTipController
68272>End_Object
68273>
68273>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\oEditContextMenu.pkg)
68273>>>Use cCJStandardMenuItemClasses.pkg
68273>>>
68273>>>Object oEditContextMenu is a cCJContextMenu
68275>>>    
68275>>>    Move Self to Default_Form_Floating_Menu_ID
68276>>>    
68276>>>    Object oUndoMenuItem is a cCJUndoMenuItem
68278>>>    End_Object
68279>>>    
68279>>>    Object oCutMenuItem is a cCJCutMenuItem
68281>>>        Set pbControlBeginGroup to True
68282>>>    End_Object
68283>>>    
68283>>>    Object oCopyMenuItem is a cCJCopyMenuItem
68285>>>    End_Object
68286>>>
68286>>>    Object oPasteMenuItem is a cCJPasteMenuItem
68288>>>    End_Object
68289>>>
68289>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
68291>>>    End_Object
68292>>>
68292>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
68294>>>        Set pbControlBeginGroup to True
68295>>>    End_Object
68296>>>
68296>>>End_Object
68297>>>
68297>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\oDEOEditContextMenu17.pkg)
68297>>>Use Windows.pkg
68297>>>Use cCJStandardMenuItemClasses.pkg
68297>>>Use cCJDeoMenuItemClasses.pkg
68297>>>
68297>>>
68297>>>Object oDEOEditContextMenu17 is a cCJContextMenu
68299>>>    
68299>>>    Move Self to Default_dbFloating_Menu_ID
68300>>>    
68300>>>    Object oUndoMenuItem is a cCJUndoMenuItem
68302>>>    End_Object
68303>>>    
68303>>>    Object oCutMenuItem is a cCJCutMenuItem
68305>>>        Set pbControlBeginGroup to True
68306>>>    End_Object
68307>>>    
68307>>>    Object oCopyMenuItem is a cCJCopyMenuItem
68309>>>    End_Object
68310>>>
68310>>>    Object oPasteMenuItem is a cCJPasteMenuItem
68312>>>    End_Object
68313>>>
68313>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
68315>>>    End_Object
68316>>>
68316>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
68318>>>        Set pbControlBeginGroup to True
68319>>>    End_Object
68320>>>
68320>>>    Object oPromptMenuItem is a cCJPromptMenuItem
68322>>>        Set pbControlBeginGroup to True
68323>>>    End_Object
68324>>>
68324>>>    Object oFindNextMenu is a cCJFindNextMenuItem
68326>>>        Set pbControlBeginGroup to True
68327>>>    End_Object
68328>>>
68328>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
68330>>>    End_Object
68331>>>
68331>>>    Object oClearMenuItem is a cCJClearMenuItem
68333>>>        Set pbControlBeginGroup to True
68334>>>    End_Object
68335>>>
68335>>>    Object oClearAllMenu is a cCJClearAllMenuItem
68337>>>    End_Object
68338>>>
68338>>>    Object oSaveMenu is a cCJSaveMenuItem
68340>>>    End_Object
68341>>>    
68341>>>    Object oDeleteMenu is a cCJDeleteMenuItem
68343>>>    End_Object
68344>>>
68344>>>    Object oRememberitem is a cCJRememberFieldMenuItem
68346>>>        Set pbControlBeginGroup to True
68347>>>    End_Object
68348>>>
68348>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
68350>>>    End_Object
68351>>>
68351>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
68353>>>    End_Object
68354>>>
68354>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
68356>>>    End_Object
68357>>>
68357>>>End_Object
68358>
68358>Object oMain is a Panel
68360>    Set Label To "My Project"
68361>    Set Location to 4 3
68362>    Set Size to 300 450
68363>
68363>    Object oCommandBarSystem is a cCJCommandBarSystem
68365>        Set pbTimerUpdate to True
68366>        Set peVisualTheme to xtpThemeOffice2013Outlook
68367>        Set pbAutoResizeIcons to True
68368>
68368>        Procedure OnCreateCommandBars
68371>            Handle hoOptions
68371>            Get OptionsObject to hoOptions
68372>            Forward Send OnCreateCommandBars
68374>        End_Procedure
68375>
68375>        Object oMenuBar is a cCJMenuBar
68377>
68377>            Object oFileMenu is a cCJMenuItem
68379>                Set peControlType to xtpControlPopup          
68380>                Set psCaption   to "&File"
68381>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
68382>                Set psCategory to "Menus"
68383>
68383>                Object oClearMenuItem is a cCJClearMenuItem
68385>                    Set pbAddToDesignerMenu to True
68386>                End_Object
68387>
68387>                Object oClearAllMenu is a cCJClearAllMenuItem
68389>                    Set pbAddToDesignerMenu to True
68390>                End_Object
68391>
68391>                Object oPromptMenuItem is a cCJPromptMenuItem
68393>                    Set pbAddToDesignerMenu to True
68394>                    Set pbControlBeginGroup to True
68395>                End_Object
68396>
68396>                Object oFindMenuItem is a cCJFindMenuItem
68398>                    Set pbAddToDesignerMenu to True
68399>                    Set pbControlBeginGroup to True
68400>                End_Object
68401>
68401>                Object oFindNextMenu is a cCJFindNextMenuItem
68403>                    Set pbAddToDesignerMenu to True
68404>                End_Object
68405>
68405>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
68407>                    Set pbAddToDesignerMenu to True
68408>                End_Object
68409>
68409>                Object oFindFirstMenu is a cCJFindFirstMenuItem
68411>                    Set pbAddToDesignerMenu to True
68412>                End_Object
68413>
68413>                Object oFindLastMenu is a cCJFindLastMenuItem
68415>                    Set pbAddToDesignerMenu to True
68416>                End_Object
68417>
68417>                Object oSaveMenuItem is a cCJSaveMenuItem
68419>                    Set pbAddToDesignerMenu to True
68420>                    Set pbControlBeginGroup to True
68421>                End_Object
68422>
68422>                Object oDeleteMenuItem is a cCJDeleteMenuItem
68424>                    Set pbAddToDesignerMenu to True
68425>                End_Object
68426>
68426>                Object oExitMenu is a cCJExitMenuItem
68428>                    Set pbControlBeginGroup to True
68429>                End_Object
68430>
68430>            End_Object
68431>
68431>            Object oViewMenu is a cCJMenuItem
68433>                Set peControlType to xtpControlPopup
68434>                Set psCaption to "&View"
68435>                Set psToolTip to "View"
68436>                Set psDescription to "Available Views"
68437>
68437>                Object oEmpEntryMenuItem is a cCJMenuItem
68439>                    Set psCaption to "EmpEntry"
68440>                    Set psTooltip to "EmpEntry"
68441>                
68441>                    Procedure OnExecute Variant vCommandBarControl
68444>                        Handle hoClient
68444>                        Get Client_Id to hoClient
68445>                        Send Activate_oEmpEntry of hoClient
68446>                    End_Procedure
68447>                End_Object
68448>
68448>                Object oLineEntryMenuItem is a cCJMenuItem
68450>                    Set psCaption to "LineEntry"
68451>                    Set psTooltip to "LineEntry"
68452>                
68452>                    Procedure OnExecute Variant vCommandBarControl
68455>                        Handle hoClient
68455>                        Get Client_Id to hoClient
68456>                        Send Activate_oLineEntry of hoClient
68457>                    End_Procedure
68458>                End_Object
68459>
68459>                Object oPageHeaderEntryMenuItem is a cCJMenuItem
68461>                    Set psCaption to "PageHeaderEntry"
68462>                    Set psTooltip to "PageHeaderEntry"
68463>                
68463>                    Procedure OnExecute Variant vCommandBarControl
68466>                        Handle hoClient
68466>                        Get Client_Id to hoClient
68467>                        Send Activate_oPageHeaderEntry of hoClient
68468>                    End_Procedure
68469>                End_Object
68470>
68470>                Object oShoeEntryMenuItem is a cCJMenuItem
68472>                    Set psCaption to "ShoeEntry"
68473>                    Set psTooltip to "ShoeEntry"
68474>                
68474>                    Procedure OnExecute Variant vCommandBarControl
68477>                        Handle hoClient
68477>                        Get Client_Id to hoClient
68478>                        Send Activate_oShoeEntry of hoClient
68479>                    End_Procedure
68480>                End_Object
68481>
68481>                Object oPageFooterEntryMenuItem is a cCJMenuItem
68483>                    Set psCaption to "PageFooterEntry"
68484>                    Set psTooltip to "PageFooterEntry"
68485>                
68485>                    Procedure OnExecute Variant vCommandBarControl
68488>                        Handle hoClient
68488>                        Get Client_Id to hoClient
68489>                        Send Activate_oPageFooterEntry of hoClient
68490>                    End_Procedure
68491>                End_Object
68492>            End_Object
68493>            
68493>            Object oReportMenu is a cCJMenuItem
68495>                Set peControlType to xtpControlPopup          
68496>                Set psCaption to "&Report"
68497>                Set psToolTip to "Report"
68498>                Set psDescription to "Available Reports"
68499>            End_Object
68500>
68500>            Object oNavigateMenu is a cCJMenuItem
68502>                Set peControlType to xtpControlPopup      
68503>                Set psCaption to "&Navigate"    
68504>                Set psTooltip to "Navigate"    
68505>                Set psDescription to "Move to different areas of the application"
68506>
68506>                Object oNextAreaMenu is a cCJNextAreaMenu
68508>                End_Object
68509>
68509>                Object oPriorAreaMenu is a cCJPriorAreaMenu
68511>                End_Object
68512>
68512>                Object oNextViewMenu is a cCJNextViewMenu
68514>                End_Object
68515>
68515>                Object oPriorViewMenu is a cCJPriorViewMenu
68517>                End_Object
68518>
68518>                Object oPromptMenu is a cCJPromptMenuItem
68520>                    Set pbControlBeginGroup to True
68521>                End_Object
68522>
68522>                Object oZoomMenu is a cCJZoomMenuItem
68524>                End_Object
68525>
68525>            End_Object
68526>
68526>            Object oWindowMenu is a cCJMDIWindowsMenuItem
68528>                Set peControlType to xtpControlPopup
68529>                Set psCaption to "&Window"
68530>                Set psToolTip to "Window"
68531>                Set psDescription to "Display Current Views and set other display options."    
68532>
68532>                // These are the static windows items. More will be created in onInitPopup 
68532>                Object oDisplayOptionsMenu is a cCJMenuItem
68534>                    Set peControlType to xtpControlPopup          
68535>                    Set psCaption to "&Display Options"
68536>                    Set psToolTip to "Display Options"
68537>                    Set psDescription to "Set display options"
68538>
68538>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
68540>                    End_Object
68541>
68541>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
68543>                    End_Object
68544>
68544>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
68546>                        Set pbControlBeginGroup to True
68547>                    End_Object
68548>
68548>                End_Object
68549>
68549>                Object oCascadeMenu is a cCJCascadeMenuItem
68551>                    Set pbControlBeginGroup to True
68552>                End_Object
68553>
68553>                Object oHorizTile is a cCJTileHorizontally
68555>                End_Object
68556>
68556>                Object oVertTile is a cCJTileVertically
68558>                End_Object
68559>
68559>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
68561>                    Set pbControlBeginGroup to True
68562>                End_Object
68563>
68563>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
68565>                End_Object
68566>
68566>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
68568>                    Set pbControlBeginGroup to True
68569>                End_Object
68570>
68570>            End_Object
68571>
68571>            Object oHelpMenu is a cCJMenuItem
68573>                Set peControlType to xtpControlPopup    
68574>                Set psCaption to "&Help"
68575>                Set psDescription to "Access Information for learning and using this DataFlex application."
68576>                Set psToolTip to "Help"
68577>
68577>                Object oHelpMenuItem is a cCJHelpMenuItem 
68579>                End_Object
68580>
68580>                Object oAboutMenuItem is a cCJAboutMenuItem
68582>                End_Object
68583>
68583>            End_Object
68584>
68584>        End_Object
68585>
68585>        Object oFindToolBar is a cCJToolbar
68587>            Set psTitle to "Finding Toolbar"
68588>
68588>            Object oFindFirstTool is a cCJFindFirstMenuItem
68590>            End_Object
68591>
68591>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
68593>            End_Object
68594>
68594>            Object oFindMenuTool is a cCJFindMenuItem
68596>            End_Object
68597>
68597>            Object oFindNextTool is a cCJFindNextMenuItem
68599>            End_Object
68600>
68600>            Object oFindLastTool is a cCJFindLastMenuItem
68602>            End_Object
68603>
68603>            Object oPromptToolItem is a cCJPromptMenuItem
68605>                Set pbControlBeginGroup to True
68606>            End_Object
68607>
68607>        End_Object
68608>
68608>        Object oFileToolBar is a cCJToolbar
68610>            Set psTitle to "Data Entry Toolbar"
68611>
68611>            Object oClearToolItem is a cCJClearMenuItem
68613>                Set peControlStyle to xtpButtonIconAndCaption
68614>            End_Object
68615>
68615>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
68617>                Set peControlStyle to xtpButtonIconAndCaption
68618>            End_Object
68619>
68619>            Object oSaveToolItem is a cCJSaveMenuItem
68621>                Set peControlStyle to xtpButtonIconAndCaption
68622>                Set pbControlBeginGroup to True
68623>            End_Object
68624>
68624>            Object oDeleteToolItem is a cCJDeleteMenuItem
68626>                Set peControlStyle to xtpButtonIconAndCaption
68627>            End_Object
68628>
68628>        End_Object
68629>
68629>        Object oEditToolBar is a cCJToolbar
68631>            Set psTitle to "Edit Toolbar"
68632>
68632>            Object oCutToolbarItem is a cCJCutMenuItem
68634>            End_Object
68635>
68635>            Object oCopyToolbarItem is a cCJCopyMenuItem
68637>            End_Object
68638>
68638>            Object oPasteToolbarItem is a cCJPasteMenuItem
68640>            End_Object
68641>
68641>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
68643>                Set pbControlBeginGroup to True
68644>            End_Object
68645>
68645>        End_Object
68646>
68646>        Object oRememberToolbar is a cCJToolbar
68648>            Set psTitle to C_$Remember
68649>
68649>            Object oRememberItems is a cCJMenuItem
68651>
68651>                Set peControlType to xtpControlPopup
68652>                Set peControlStyle to xtpButtonCaption
68653>                Set psCaption to C_$Remember
68654>                
68654>                Object oMenuItem is a cCJRememberFieldMenuItem
68656>                    Set peControlStyle to xtpButtonIconAndCaption
68657>                End_Object
68658>                
68658>                Object oMenuItem is a cCJRememberLastFieldMenuItem
68660>                    Set peControlStyle to xtpButtonIconAndCaption
68661>                End_Object
68662>                
68662>                Object oMenuItem is a cCJUnRememberFieldMenuItem
68664>                    Set peControlStyle to xtpButtonIconAndCaption
68665>                End_Object
68666>                
68666>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
68668>                    Set peControlStyle to xtpButtonIconAndCaption
68669>                End_Object
68670>
68670>            End_Object
68671>            
68671>        End_Object
68672>        
68672>        Object oStatusBar is a cCJStatusBar
68674>
68674>            Object oStatusPane1 is a cCJStatusBarPane
68676>                Set piID to sbpIDIdlePane
68677>                Set pbStyleStretch to True
68678>            End_Object
68679>
68679>            Object oStatusPane2 is a cCJStatusBarPane
68681>                Set phoViewPane to Self
68682>                Set pbStyleStretch to True
68683>            End_Object
68684>
68684>        End_Object
68685>
68685>    End_Object
68686>
68686>    Object oClientArea is a ClientArea
68688>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\StdAbout.pkg)
68688>>>// This provides a quick and simple way to create an about package for a program.
68688>>>// You need to create a message inside you client area called Activate_About.
68688>>>// Within this message you should send the message DoAbout passing needed
68688>>>// string information.
68688>>>//
68688>>>//       Procedure Activate_About
68688>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
68688>>>//       End_Procedure
68688>>>//    where: sTitle =     Name of application. If none provided, uses caption
68688>>>//                        bar title
68688>>>//           sVersion   = Version Line. If none provided, will be blank
68688>>>//           sCopyRight = Copyright Line. If none provided, will be blank
68688>>>//           sAuthor    = Author name, blank if none provided
68688>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
68688>>>//                        is used.
68688>>>// It is expected that you will place this in your own object package. For
68688>>>// example an order about package may look like this:
68688>>>//
68688>>>//   // OrderAbout.pkg
68688>>>//   Use StdAbout.pkg
68688>>>//   Procedure Activate_About
68688>>>//      String sTitle sCopyright sVersion sAuthor
68688>>>//      Move "My Order Entry System" to sTitle
68688>>>//      Move "Version 2.1" to sVersion
68688>>>//      Move "Copyright xxxx, Super Software Inc." to sCopyright
68688>>>//      Move "John Smith"  to sAuthor
68688>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
68688>>>//   end_procedure
68688>>>//   // end of file.
68688>>>
68688>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Dfabout.pkg)
68688>>>>>Use LanguageText.pkg
68688>>>>>Use Windows.pkg
68688>>>>>Use DFbitmap.pkg
68688>>>>>Use GlobalFunctionsProcedures.pkg
68688>>>>>Use cTextEdit.pkg
68688>>>>>Use tWinStructs.pkg
68688>>>>>
68688>>>>>Use cli.pkg
68688>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 19.1\Pkg\DFBTRDRV.PKG)
68688>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
68688>>>>>>>// Notice      : This package contains constants and commands, used to call
68688>>>>>>>//               specific functions in the DFBTRDRV.
68688>>>>>>>Use Ui
68688>>>>>>>//
68688>>>>>>>// Driver Indentification
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>// Driver attributes
68688>>>>>>>//
68688>>>>>>>// Call_Driver functions ID's
68688>>>>>>>//
68688>>>>>>>//
68688>>>>>>>// DFBTRFN_CONVERT_FILE options
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// DFBTRFN_SET_OWNER options
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to create all vars which may be needed
68688>>>>>>>// in other commands.
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to set the owner of a Btrieve file.
68688>>>>>>>// File must have been opened.
68688>>>>>>>// Filenumber needs to be passed.
68688>>>>>>>// To clear set the owner to "".
68688>>>>>>>// Examples:
68688>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
68688>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
68688>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
68688>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
68688>>>>>>>// To clear:
68688>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to parse DFBTR_SET_OWNVER
68688>>>>>>>// options.
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to parse for Callback
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to clear the owner of a Btrieve file.
68688>>>>>>>// File must have been opened.
68688>>>>>>>// Filenumber needs to be passed.
68688>>>>>>>// Examples:
68688>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to add a owner name to the internal list of ownernames
68688>>>>>>>// which will be tries when opening files.
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to remove all owners from the internal list of ownernames
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to set the owner name to be used when opening the DDF files.
68688>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
68688>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
68688>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to change the transaction type.
68688>>>>>>>// Valid types are:
68688>>>>>>>//     DFBTRTT_NONE
68688>>>>>>>//     DFBTRTT_EXCLUSIVE
68688>>>>>>>//     DFBTRTT_CONCURRENT
68688>>>>>>>//
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to get the current transaction type.
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to set explicit_locking
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to get explicit locking
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>//
68688>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
68688>>>>>>>//
68688>>>>>>>
68688>>>>>>>// Purpose: An instance of this class can be used as a broker object to
68688>>>>>>>//          call several Dfbtrdrv releated methods.
68688>>>>>>>
68688>>>>>>>Class cDFBtrDrvHandler is an Array
68689>>>>>>>    
68689>>>>>>>    Procedure Construct_Object Integer iImage
68691>>>>>>>        Forward Send Construct_object iImage
68693>>>>>>>        
68693>>>>>>>        Property String  psDriverID "DFBTRDRV"
68694>>>>>>>    End_Procedure
68695>>>>>>>    
68695>>>>>>>    //  The revsion of a Dfbtrdrv Connectivity Kit
68695>>>>>>>    //
68695>>>>>>>    
68695>>>>>>>    Function CKRevision Returns String
68697>>>>>>>        String  sDriverID
68697>>>>>>>        String  sRevision
68697>>>>>>>        String  sVoid
68697>>>>>>>        Integer iRetval
68697>>>>>>>        
68697>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68697>>>>>>>        // This error would otherwise be raised when we have an older
68697>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68697>>>>>>>        Send Ignore_error to Error_object_Id 20491
68698>>>>>>>        Get psDriverID to sDriverID
68699>>>>>>>        Move (Repeat(" ", 255)) to sRevision
68700>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
68705>>>>>>>        Send Trap_Error to Error_object_Id 20491
68706>>>>>>>        If (Trim(sRevision) = "") Begin
68708>>>>>>>            // Unable to get the revision. return all zeroes.
68708>>>>>>>            Move "0.0.0.0" to sRevision
68709>>>>>>>        End
68709>>>>>>>>
68709>>>>>>>        Function_Return sRevision
68710>>>>>>>    End_Function
68711>>>>>>>    
68711>>>>>>>    Function CkUsesUri Returns Integer
68713>>>>>>>        String  sDriverID
68713>>>>>>>        String  sVoid1
68713>>>>>>>        String  sVoid2
68713>>>>>>>        Integer iRetval
68713>>>>>>>        
68713>>>>>>>        Get psDriverID to sDriverID
68714>>>>>>>        
68714>>>>>>>        Move 0 to iRetval
68715>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68715>>>>>>>        // This error would otherwise be raised when we have an older
68715>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
68715>>>>>>>        Send Ignore_error to Error_object_Id 20491
68716>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
68721>>>>>>>        Send Trap_Error to Error_object_Id 20491
68722>>>>>>>        
68722>>>>>>>        Function_Return iRetval
68723>>>>>>>    End_Function
68724>>>>>>>    
68724>>>>>>>    
68724>>>>>>>    
68724>>>>>>>    // Extract the Nth part of a a.b.c.d revsion string.
68724>>>>>>>    //
68724>>>>>>>    // Returns : The part version number or -1 if there is no such part number.
68724>>>>>>>    //
68724>>>>>>>    
68724>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
68726>>>>>>>        Integer iPartRev
68726>>>>>>>        Integer iCurrentPart
68726>>>>>>>        Integer iSeparatorPos
68726>>>>>>>        
68726>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
68729>>>>>>>        
68729>>>>>>>        Move 0 to iCurrentPart
68730>>>>>>>        Repeat
68730>>>>>>>>
68730>>>>>>>            Move (Pos(".", sRevision)) to iSeparatorPos
68731>>>>>>>            If (iSeparatorPos > 0) Begin
68733>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) to iPartRev
68734>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) to sRevision
68735>>>>>>>                Increment iCurrentPart
68736>>>>>>>            End
68736>>>>>>>>
68736>>>>>>>            Else If (sRevision <> "") Begin
68739>>>>>>>                Move sRevision to iPartRev
68740>>>>>>>                Move "" to sRevision
68741>>>>>>>                Increment iCurrentPart
68742>>>>>>>            End
68742>>>>>>>>
68742>>>>>>>            Else ;                Move -1 to iPartRev
68744>>>>>>>        Until (iCurrentPart >= iPartNum or iPartRev = -1)
68746>>>>>>>        
68746>>>>>>>        Function_Return iPartRev
68747>>>>>>>    End_Function
68748>>>>>>>    
68748>>>>>>>    
68748>>>>>>>    
68748>>>>>>>    //
68748>>>>>>>    //  Returns the major revision of the CK
68748>>>>>>>    //
68748>>>>>>>    
68748>>>>>>>    Function CKMajorRevision Returns Integer
68750>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
68751>>>>>>>    End_Function
68752>>>>>>>    
68752>>>>>>>    
68752>>>>>>>    
68752>>>>>>>    //  Returns the minor revision of the CK
68752>>>>>>>    //
68752>>>>>>>    
68752>>>>>>>    Function CKMinorRevision Returns Integer
68754>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
68755>>>>>>>    End_Function
68756>>>>>>>    
68756>>>>>>>    
68756>>>>>>>    //  Returns the release revision of the CK
68756>>>>>>>    //
68756>>>>>>>    
68756>>>>>>>    Function CKReleaseRevision Returns Integer
68758>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
68759>>>>>>>    End_Function
68760>>>>>>>    
68760>>>>>>>    
68760>>>>>>>    //  Returns the major revision of the CK
68760>>>>>>>    //
68760>>>>>>>    
68760>>>>>>>    Function CKBuildRevision Returns Integer
68762>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
68763>>>>>>>    End_Function
68764>>>>>>>    
68764>>>>>>>    
68764>>>>>>>    //  Determines if the CK conforms to a passed minimal revsion.
68764>>>>>>>    //
68764>>>>>>>    
68764>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
68766>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_Return (True)
68769>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
68772>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_Return (True)
68775>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
68778>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_Return (True)
68781>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) and iBuild <= CKBuildRevision(Current_object)) ;                    Function_Return (True)
68785>>>>>>>            End
68785>>>>>>>>
68785>>>>>>>        End
68785>>>>>>>>
68785>>>>>>>        
68785>>>>>>>        Function_Return (False)
68786>>>>>>>    End_Function
68787>>>>>>>    
68787>>>>>>>    //   Functions to query the Pervasive.SQL version:
68787>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
68787>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
68787>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
68787>>>>>>>    //
68787>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
68787>>>>>>>    //   in the following format:
68787>>>>>>>    //       <version>.<revision>.<type>
68787>>>>>>>    //   possible values for <type>:
68787>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
68787>>>>>>>    //         server using Workgroup authentication mode
68787>>>>>>>    //       C for client cache engine
68787>>>>>>>    //       D for DOS workstation
68787>>>>>>>    //       N for client Requester
68787>>>>>>>    //       S for NetWare server
68787>>>>>>>    //       T for 32-bit Windows server engine
68787>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
68787>>>>>>>    //
68787>>>>>>>    //   example:
68787>>>>>>>    //       8.50.T
68787>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
68787>>>>>>>    //   32-bits Windows server.
68787>>>>>>>    //
68787>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
68787>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
68787>>>>>>>    //
68787>>>>>>>    //   If the version information is not available or can not be obtained
68787>>>>>>>    //   the functions will return "0.0.0"
68787>>>>>>>    
68787>>>>>>>    //  Returns the version information of the
68787>>>>>>>    //           Pervasive.SQL Client requester.
68787>>>>>>>    
68787>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
68789>>>>>>>        
68789>>>>>>>        String  sDriverID
68789>>>>>>>        String  sVersion
68789>>>>>>>        String  sVoid
68789>>>>>>>        Integer iRetval
68789>>>>>>>        
68789>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68789>>>>>>>        // This error would otherwise be raised when we have an older
68789>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68789>>>>>>>        Send Ignore_error to Error_object_Id 20491
68790>>>>>>>        Get psDriverID to sDriverID
68791>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68792>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68797>>>>>>>        Send Trap_Error to Error_object_Id 20491
68798>>>>>>>        If (Trim(sVersion) = "") Begin
68800>>>>>>>            // Unable to get the revision. return all zeroes.
68800>>>>>>>            Move "0.0.0" to sVersion
68801>>>>>>>        End
68801>>>>>>>>
68801>>>>>>>        Function_Return sVersion
68802>>>>>>>    End_Function
68803>>>>>>>    
68803>>>>>>>    //           Pervasive.SQL Engine
68803>>>>>>>    
68803>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
68805>>>>>>>        
68805>>>>>>>        String  sDriverID
68805>>>>>>>        String  sVersion
68805>>>>>>>        String  sVoid
68805>>>>>>>        Integer iRetval
68805>>>>>>>        
68805>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68805>>>>>>>        // This error would otherwise be raised when we have an older
68805>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68805>>>>>>>        Send Ignore_error to Error_object_Id 20491
68806>>>>>>>        Get psDriverID to sDriverID
68807>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68808>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68813>>>>>>>        Send Trap_Error to Error_object_Id 20491
68814>>>>>>>        If (Trim(sVersion) = "") Begin
68816>>>>>>>            // Unable to get the revision. return all zeroes.
68816>>>>>>>            Move "0.0.0" to sVersion
68817>>>>>>>        End
68817>>>>>>>>
68817>>>>>>>        Function_Return sVersion
68818>>>>>>>    End_Function
68819>>>>>>>    
68819>>>>>>>    //  Returns the version information of the
68819>>>>>>>    //           Pervasive.SQL Server Engine
68819>>>>>>>    
68819>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
68821>>>>>>>        
68821>>>>>>>        String  sDriverID
68821>>>>>>>        String  sVersion
68821>>>>>>>        String  sVoid
68821>>>>>>>        Integer iRetval
68821>>>>>>>        
68821>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68821>>>>>>>        // This error would otherwise be raised when we have an older
68821>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68821>>>>>>>        Send Ignore_error to Error_object_Id 20491
68822>>>>>>>        Get psDriverID to sDriverID
68823>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68824>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68829>>>>>>>        Send Trap_Error to Error_object_Id 20491
68830>>>>>>>        If (Trim(sVersion) = "") Begin
68832>>>>>>>            // Unable to get the revision. return all zeroes.
68832>>>>>>>            Move "0.0.0" to sVersion
68833>>>>>>>        End
68833>>>>>>>>
68833>>>>>>>        Function_Return sVersion
68834>>>>>>>    End_Function
68835>>>>>>>    
68835>>>>>>>End_Class
68836>>>>>>>
68836>>>>>>>
68836>>>>>Use MSSqldrv.pkg
Including file: MSSqldrv.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\MSSqldrv.pkg)
68836>>>>>>>//     Package that declares MS SQL driver constants and functions.
68836>>>>>>>//     This package can be used by developers who want to add Data Access
68836>>>>>>>//     MS SQL Client specific code to a DataFlex application.
68836>>>>>>>
68836>>>>>>>Use Cli.pkg
68836>>>>>>>Use SQL.pkg
68836>>>>>>>
68836>>>>>>>//   Driver Indentification
68836>>>>>>>
68836>>>>>>>//   Error number constants
68836>>>>>>>
68836>>>>>>>
68836>>>>>>>//   Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
68836>>>>>>>
68836>>>>>>>
68836>>>>>>>
68836>>>>>>>
68836>>>>>>>
68836>>>>>>>
68836>>>>>>>// SQL Server spcific types.
68836>>>>>>>Define SQL_SS_TIMESTAMPOFFSET   for   (-155) //SQL server datetimeoffset type */
68836>>>>>>>Define SQL_SS_TIME2             for   (-154) //SQL server time type */
68836>>>>>>>Define SQL_SS_XML               for   (-152) //SQL server xml type */
68836>>>>>>>Define SQL_SS_VARIANT           for   (-150) //SQL server variant type */
68836>>>>>>>
68836>>>>>>>// SQL Server spcific types.
68836>>>>>>>Define SQL_TYPE_TIMESTAMP2      for   (-200) //SQL server datetime2 type */
68836>>>>>>>Define SQL_VARCHARMAX           for   (-201) //SQL server varchar(max) type */
68836>>>>>>>Define SQL_WVARCHARMAX          for   (-202) //SQL server wvarchar(max) type */
68836>>>>>>>Define SQL_VARBINARYMAX         for   (-203) //SQL server varbinary(max) type */
68836>>>>>>>Define SQL_TYPE_MONEY           for   (-204) //SQL server money type */
68836>>>>>>>Define SQL_TYPE_SMALLMONEY      for   (-205) //SQL server smallmoney type */
68836>>>>>>>Define SQL_TYPE_SMALLDATETIME   for   (-206) //SQL server smalldatetype type */
68836>>>>>>>
68836>>>>>>>
68836>>>>>>>//   MSSQL_SetConstraint <FileNum> <ConstraintText>
68836>>>>>>>//
68836>>>>>>>//     Setup a constraint for a file.
68836>>>>>>>
68836>>>>>>>
68836>>>>>>>Class cMSSQLHandler is a cCLIHandler
68837>>>>>>>    
68837>>>>>>>    Procedure Construct_Object
68839>>>>>>>        Forward Send Construct_Object
68841>>>>>>>        
68841>>>>>>>        Set psDriverID to MSSQLDRV_ID
68842>>>>>>>    End_Procedure
68843>>>>>>>    
68843>>>>>>>    
68843>>>>>>>    
68843>>>>>>>    //   Extract the list from the out connect string.
68843>>>>>>>    Function ExtractList String sOutConnStr Integer hoStore Returns Integer
68845>>>>>>>        String  sItem
68845>>>>>>>        Integer iStart
68845>>>>>>>        Integer iEnd
68845>>>>>>>        
68845>>>>>>>        If (hoStore = 0) ;            Move Current_object to hoStore
68848>>>>>>>        
68848>>>>>>>        Send Delete_Data to hoStore
68849>>>>>>>        Move (Pos("{", sOutConnStr)) to iStart
68850>>>>>>>        While (iStart > 0)
68854>>>>>>>            Move (Right(sOutConnStr, Length(sOutConnStr) - iStart)) to sOutConnStr
68855>>>>>>>            If (Left(sOutConnStr, 1) = "}") ;                Move 0 to iStart
68858>>>>>>>            Else Begin
68859>>>>>>>                Move (Pos(",", sOutConnStr)) to iStart
68860>>>>>>>                Move (Pos("}", sOutConnStr)) to iEnd
68861>>>>>>>                If ((iStart = 0) or (iEnd < iStart)) ;                    Move iEnd to iStart
68864>>>>>>>                
68864>>>>>>>                If (iStart > 0) ;                    Set Value of hoStore  (Item_Count(Current_Object)) to (Left(sOutConnStr, iStart - 1))
68867>>>>>>>                
68867>>>>>>>                If (iStart = iEnd) ;                    Move 0 to iStart
68870>>>>>>>            End
68870>>>>>>>>
68870>>>>>>>        Loop
68871>>>>>>>>
68871>>>>>>>        
68871>>>>>>>        Function_Return (Item_Count(hoStore))
68872>>>>>>>    End_Function
68873>>>>>>>    
68873>>>>>>>    
68873>>>>>>>    
68873>>>>>>>    //   Call the driver's browse connect function
68873>>>>>>>    Function BrowseConnect String sInConnStr Returns String
68875>>>>>>>        String  sDriver
68875>>>>>>>        String  sOutConnStr
68875>>>>>>>        Integer iArg
68875>>>>>>>        Integer iRetval
68875>>>>>>>        
68875>>>>>>>        Get psDriverID to sDriver
68876>>>>>>>        If (sDriver <> "") Begin
68878>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
68879>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
68884>>>>>>>        End
68884>>>>>>>>
68884>>>>>>>        
68884>>>>>>>        Function_Return sOutConnStr
68885>>>>>>>    End_Function// BrowseConnect
68886>>>>>>>    
68886>>>>>>>    
68886>>>>>>>    Function BrowseConnectLocal String sInConnStr Returns String
68888>>>>>>>        String  sDriver
68888>>>>>>>        String  sOutConnStr
68888>>>>>>>        Integer iArg
68888>>>>>>>        Integer iRetval
68888>>>>>>>        
68888>>>>>>>        Move 1 to iArg // Browses only local
68889>>>>>>>        
68889>>>>>>>        Get psDriverID to sDriver
68890>>>>>>>        If (sDriver <> "") Begin
68892>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
68893>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
68898>>>>>>>        End
68898>>>>>>>>
68898>>>>>>>        
68898>>>>>>>        Function_Return sOutConnStr
68899>>>>>>>    End_Function// BrowseConnect
68900>>>>>>>    
68900>>>>>>>    
68900>>>>>>>    Function EnumerateServersNetworkOrLocal Integer iNetworkLocal  Returns Integer
68902>>>>>>>        
68902>>>>>>>        String  sServerList
68902>>>>>>>        Integer iNumServers
68902>>>>>>>        Integer iDriver
68902>>>>>>>        Integer iClientVersion
68902>>>>>>>        String  sDriver
68902>>>>>>>        
68902>>>>>>>        Get DriverIndex MSSQLDRV_ID to iDriver
68903>>>>>>>        
68903>>>>>>>        If (iDriver) Begin
68905>>>>>>>            
68905>>>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iDriver to iClientVersion
68908>>>>>>>            
68908>>>>>>>            Get SqlServerClientDriverName iClientVersion to sDriver
68909>>>>>>>            
68909>>>>>>>            Move ("DRIVER={" + sDriver + "};") to sDriver
68910>>>>>>>            If (iNetworkLocal = 0) Begin
68912>>>>>>>                Get BrowseConnect sDriver to sServerList
68913>>>>>>>            End
68913>>>>>>>>
68913>>>>>>>            Else Begin
68914>>>>>>>                Get BrowseConnectLocal sDriver to sServerList
68915>>>>>>>            End
68915>>>>>>>>
68915>>>>>>>            Get ExtractList sServerList Current_object to iNumServers
68916>>>>>>>        End
68916>>>>>>>>
68916>>>>>>>        
68916>>>>>>>        Function_Return iNumServers
68917>>>>>>>        
68917>>>>>>>    End_Function
68918>>>>>>>    
68918>>>>>>>    //   Enumerate the available SQL Server database servers
68918>>>>>>>    //   This function will return all SQL Server instances on the network.
68918>>>>>>>    //   This may take a long time.
68918>>>>>>>    //   To enumerate only local SQL Server instances use EnumerateServersLocal
68918>>>>>>>    Function EnumerateServers Returns Integer
68920>>>>>>>        
68920>>>>>>>        Integer iNumServers
68920>>>>>>>        Integer iNetworkLocal
68920>>>>>>>        
68920>>>>>>>        Move 0 to iNetworkLocal // 0 = enumerate network servers
68921>>>>>>>        
68921>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
68922>>>>>>>        
68922>>>>>>>        Function_Return iNumServers
68923>>>>>>>        
68923>>>>>>>    End_Function
68924>>>>>>>    
68924>>>>>>>    
68924>>>>>>>    //   Enumerate the available SQL Server database servers
68924>>>>>>>    //   This function will return only return SQL Server instance on the local machine
68924>>>>>>>    //   To enumerate all SQL Server instances in a network use EnumerateServers
68924>>>>>>>    Function EnumerateServersLocal Returns Integer
68926>>>>>>>        
68926>>>>>>>        Integer iNumServers
68926>>>>>>>        Integer iNetworkLocal
68926>>>>>>>        
68926>>>>>>>        Move 1 to iNetworkLocal // 1 = enumerate local servers
68927>>>>>>>        
68927>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
68928>>>>>>>        
68928>>>>>>>        Function_Return iNumServers
68929>>>>>>>        
68929>>>>>>>    End_Function
68930>>>>>>>    
68930>>>>>>>    
68930>>>>>>>    
68930>>>>>>>    //   Enumerate database in a given server.
68930>>>>>>>    Function EnumerateDatabases String sServer String sUser String sPassWord Returns Integer
68932>>>>>>>        Integer hoSQL
68932>>>>>>>        String  sConnect
68932>>>>>>>        String  sDatabase
68932>>>>>>>        Integer hdbc
68932>>>>>>>        Integer hstmt
68932>>>>>>>        Integer iFetchResult
68932>>>>>>>        
68932>>>>>>>        If (Num_Arguments < 3) ;            Move "" to sPassWord
68935>>>>>>>        If (Num_Arguments < 2) ;            Move "" to sUser
68938>>>>>>>        
68938>>>>>>>        If (sUser <> "") ;            Move ("SERVER=" + Trim(sServer) + ";UID=" + Trim(sUser) + ";PWD=" + Trim(sPassword) + ";") to sConnect
68941>>>>>>>        Else ;            Move ("SERVER=" + Trim(sServer) + ";Trusted_Connection=yes") to sConnect
68943>>>>>>>        
68943>>>>>>>        Object oEnumDBSQLmanager is a cSQLHandleManager
68945>>>>>>>            Move Current_Object to hoSQL
68946>>>>>>>        End_Object
68947>>>>>>>        
68947>>>>>>>        If (hoSQL <> 0) Begin
68949>>>>>>>            Get SQLConnect of hoSQL "MSSQLDRV" sConnect to hdbc
68950>>>>>>>            If (hdbc <> 0) Begin
68952>>>>>>>                Get SQLOpen of hdbc to hstmt
68953>>>>>>>                If (hstmt <> 0) Begin
68955>>>>>>>                    //   We could do a direct select on the sysdatabases table but we use
68955>>>>>>>                    //   the stored procedure sp_database instead. SQL Server recommends this
68955>>>>>>>                    //   approach in case meta data might change, the stored procedure will
68955>>>>>>>                    //   stay the same.
68955>>>>>>>                    Send SQLSetProcedureName to hstmt "sp_databases"
68956>>>>>>>                    Send SQLCall to hstmt
68957>>>>>>>                    Repeat
68957>>>>>>>>
68957>>>>>>>                        Get SQLFetch of hstmt to iFetchResult
68958>>>>>>>                        If (iFetchResult <> 0) Begin
68960>>>>>>>                            Get SQLColumnValue of hstmt 1 to sDatabase
68961>>>>>>>                            Set Value  (Item_Count(Current_Object)) to sDatabase
68962>>>>>>>                        End
68962>>>>>>>>
68962>>>>>>>                    Until (iFetchResult = 0)
68964>>>>>>>                    
68964>>>>>>>                    Send SQLClose to hstmt
68965>>>>>>>                End
68965>>>>>>>>
68965>>>>>>>                Send SQLDisconnect to hdbc
68966>>>>>>>            End
68966>>>>>>>>
68966>>>>>>>        End
68966>>>>>>>>
68966>>>>>>>        Send Destroy_Object to hoSQL
68967>>>>>>>        
68967>>>>>>>        Function_Return (Item_Count(Current_Object))
68968>>>>>>>    End_Function
68969>>>>>>>    
68969>>>>>>>    
68969>>>>>>>    Function SqlServerClientVersionName Integer iClientVersion  Returns String
68971>>>>>>>        
68971>>>>>>>        String  sSqlServerClientVersionName
68971>>>>>>>        
68971>>>>>>>        
68971>>>>>>>        Case Begin
68971>>>>>>>            
68971>>>>>>>            Case (iClientVersion = SQLSERVER2017CLIENT)
68973>>>>>>>                Move SQLSERVER2017CLIENTNAME to sSqlServerClientVersionName
68974>>>>>>>                Case Break
68975>>>>>>>                
68975>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
68978>>>>>>>                Move SQLSERVER2016CLIENTNAME to sSqlServerClientVersionName
68979>>>>>>>                Case Break
68980>>>>>>>            
68980>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
68983>>>>>>>                Move SQLSERVER2014CLIENTNAME to sSqlServerClientVersionName
68984>>>>>>>                Case Break
68985>>>>>>>            
68985>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
68988>>>>>>>                Move SQLSERVER2012CLIENTNAME to sSqlServerClientVersionName
68989>>>>>>>                Case Break
68990>>>>>>>            
68990>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
68993>>>>>>>                Move SQLSERVER2008CLIENTNAME to sSqlServerClientVersionName
68994>>>>>>>                Case Break
68995>>>>>>>            
68995>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
68998>>>>>>>                Move SQLSERVER2005CLIENTNAME to sSqlServerClientVersionName
68999>>>>>>>                Case Break
69000>>>>>>>            
69000>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
69003>>>>>>>                Move SQLSERVER2000CLIENTNAME to sSqlServerClientVersionName
69004>>>>>>>                Case Break
69005>>>>>>>            
69005>>>>>>>            Case Else
69005>>>>>>>                Move SQLSERVERUNKNOWNCLIENTNAME to sSqlServerClientVersionName
69006>>>>>>>                
69006>>>>>>>        Case End
69006>>>>>>>        
69006>>>>>>>        
69006>>>>>>>        Function_Return sSqlServerClientVersionName
69007>>>>>>>        
69007>>>>>>>    End_Function
69008>>>>>>>
69008>>>>>>>
69008>>>>>>>    Function SqlServerClientDriverName Integer iClientVersion  Returns String
69010>>>>>>>        
69010>>>>>>>        String  sSqlServerClientDriverName
69010>>>>>>>        
69010>>>>>>>        Case Begin
69010>>>>>>>            
69010>>>>>>>            Case (iClientVersion = SQLSERVER2017CLIENT)
69012>>>>>>>                Move SQLSERVER2017DRVRSTR to sSqlServerClientDriverName
69013>>>>>>>                Case Break
69014>>>>>>>                
69014>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
69017>>>>>>>                Move SQLSERVER2016DRVRSTR to sSqlServerClientDriverName
69018>>>>>>>                Case Break
69019>>>>>>>            
69019>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
69022>>>>>>>                Move SQLSERVER2014DRVRSTR to sSqlServerClientDriverName
69023>>>>>>>                Case Break
69024>>>>>>>            
69024>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
69027>>>>>>>                Move SQLSERVER2012DRVRSTR to sSqlServerClientDriverName
69028>>>>>>>                Case Break
69029>>>>>>>            
69029>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
69032>>>>>>>                Move SQLSERVER2008DRVRSTR to sSqlServerClientDriverName
69033>>>>>>>                Case Break
69034>>>>>>>            
69034>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
69037>>>>>>>                Move SQLSERVER2005DRVRSTR to sSqlServerClientDriverName
69038>>>>>>>                Case Break
69039>>>>>>>            
69039>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
69042>>>>>>>                Move SQLSERVER2000DRVRSTR to sSqlServerClientDriverName
69043>>>>>>>                Case Break
69044>>>>>>>            
69044>>>>>>>            Case Else
69044>>>>>>>                Move SQLSERVER2000DRVRSTR to sSqlServerClientDriverName
69045>>>>>>>                
69045>>>>>>>        Case End
69045>>>>>>>        
69045>>>>>>>        
69045>>>>>>>        Function_Return sSqlServerClientDriverName
69046>>>>>>>        
69046>>>>>>>    End_Function
69047>>>>>>>    
69047>>>>>>>    
69047>>>>>>>End_Class
69048>>>>>>>
69048>>>>>>>
69048>>>>>
69048>>>>>
69048>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
69049>>>>>
69049>>>>>Register_Function phoWorkspace Returns Handle
69049>>>>>Register_Function Help_filename Returns String
69049>>>>>Register_Function GetHelpFile Returns String
69049>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
69049>>>>>
69049>>>>>//    This function reads the current username Of windows and returns that
69049>>>>>//    name or an text unknown user
69049>>>>>Function Network_User_Name for cDesktop Returns String
69051>>>>>    String sName
69051>>>>>    Integer iRetval iLength
69051>>>>>    
69051>>>>>    Move 0 to iLength
69052>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
69053>>>>>    Move (ZeroString(iLength)) to sName
69054>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
69055>>>>>    
69055>>>>>    If (iRetval = NO_ERROR) Begin
69057>>>>>        Function_Return (CString (sName))
69058>>>>>    End
69058>>>>>>
69058>>>>>    
69058>>>>>    Function_Return "User Unknown"
69059>>>>>End_Function
69060>>>>>
69060>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
69061>>>>>
69061>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
69062>>>>>
69062>>>>>Class SysinfoDisplay is a cTextEdit
69063>>>>>    Procedure Construct_Object
69065>>>>>        Forward Send Construct_Object
69067>>>>>        
69067>>>>>        Set Location to 6 6
69068>>>>>        Set Size to 110 255
69069>>>>>        Set Read_Only_State to True
69070>>>>>        Set pbWrap to False
69071>>>>>    End_Procedure
69072>>>>>    
69072>>>>>    //    This method will show the name Of the current directory in the system
69072>>>>>    //    information box
69072>>>>>    Procedure Show_Current_Directory
69074>>>>>        String sDir
69074>>>>>        
69074>>>>>        Get_Current_Directory to sDir
69075>>>>>        
69075>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
69076>>>>>    End_Procedure
69077>>>>>    
69077>>>>>    Procedure Show_Windows_Directory
69079>>>>>        String sWindir
69079>>>>>        
69079>>>>>        Get_Windows_Directory to sWindir
69080>>>>>        
69080>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
69081>>>>>    End_Procedure
69082>>>>>    
69082>>>>>    Procedure Show_Current_User
69084>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
69085>>>>>    End_Procedure
69086>>>>>    
69086>>>>>    Procedure Show_Number_Format
69088>>>>>        Integer iFormat
69088>>>>>        String sFormatText
69088>>>>>        
69088>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
69091>>>>>        Move (Character (iFormat)) to sFormatText
69092>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
69093>>>>>        
69093>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
69096>>>>>        Move (Character (iFormat)) to sFormatText
69097>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
69098>>>>>    End_Procedure
69099>>>>>    
69099>>>>>    Procedure Show_Filelist_Name
69101>>>>>        String sFilename
69101>>>>>        
69101>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
69104>>>>>        
69104>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
69105>>>>>        Send AppendTextLn ""
69106>>>>>    End_Procedure
69107>>>>>    
69107>>>>>    Procedure Show_Lock_Delay
69109>>>>>        Integer iLockdelay
69109>>>>>        
69109>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
69112>>>>>        
69112>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
69113>>>>>    End_Procedure
69114>>>>>    
69114>>>>>    Procedure Show_Lock_Timeout
69116>>>>>        Integer iLockTimeout
69116>>>>>        
69116>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
69119>>>>>        
69119>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
69120>>>>>    End_Procedure
69121>>>>>    
69121>>>>>    Procedure Show_Screen_Size
69123>>>>>        Integer iYscreensize iXscreensize
69123>>>>>        
69123>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) to iXscreensize
69124>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) to iYscreensize
69125>>>>>        
69125>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
69126>>>>>    End_Procedure
69127>>>>>    
69127>>>>>    Procedure Show_Page_Size
69129>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
69130>>>>>    End_Procedure
69131>>>>>    
69131>>>>>    Procedure Show_Date
69133>>>>>        Date dToday
69133>>>>>        
69133>>>>>        Move (CurrentDateTime()) to  dToday
69134>>>>>        
69134>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
69135>>>>>    End_Procedure
69136>>>>>    
69136>>>>>    Procedure Show_Date_Format
69138>>>>>        Integer iDateFormat
69138>>>>>        String sDateFormat
69138>>>>>        
69138>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
69141>>>>>        Case Begin
69141>>>>>            Case (iDateFormat = DF_DATE_USA)
69143>>>>>                Move C_$USA to sDateFormat
69144>>>>>                Case Break
69145>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
69148>>>>>                Move C_$European to sDateFormat
69149>>>>>                Case Break
69150>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
69153>>>>>                Move C_$Military to sDateFormat
69154>>>>>                Case Break
69155>>>>>            Case Else
69155>>>>>                Move C_$UnknownDateType to sDateFormat
69156>>>>>                Case Break
69157>>>>>        Case End
69157>>>>>        
69157>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
69158>>>>>    End_Procedure
69159>>>>>    
69159>>>>>    Procedure Show_Systemresources
69161>>>>>        tWinMemoryStatusEx MemoryStatusInfo
69161>>>>>        tWinMemoryStatusEx MemoryStatusInfo
69161>>>>>        Integer iRetval
69161>>>>>        
69161>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
69162>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
69163>>>>>        If (iRetval = 0) Begin
69165>>>>>            Move (ShowLastError ()) to iRetval
69166>>>>>        End
69166>>>>>>
69166>>>>>        
69166>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
69167>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
69168>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Integer ( Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0)))
69169>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Integer ( Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0)))
69170>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Integer ( Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0)))
69171>>>>>    End_Procedure
69172>>>>>    
69172>>>>>    Procedure Show_Registration
69174>>>>>        String sRegName
69174>>>>>        Integer iSN iMaxUsers
69174>>>>>        
69174>>>>>        Registration sRegName iSN
69175>>>>>>
69175>>>>>        
69175>>>>>        Get_Licensed_Max_Users to iMaxUsers
69176>>>>>        
69176>>>>>        Send AppendTextLn ""
69177>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
69178>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
69179>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
69180>>>>>    End_Procedure
69181>>>>>    
69181>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
69181>>>>>    // To the workspace object passing the an object and message To send back
69181>>>>>    // To this object. It is expected that the workspace object will send this
69181>>>>>    // message for every line Of information it wants displayed (passing the
69181>>>>>    // information To be displayed
69181>>>>>    Register_Procedure EnumerateWorkspaceData Handle hObjId Handle hmMessId
69181>>>>>    
69181>>>>>    Procedure Show_ServicePack
69183>>>>>        String sKey sVersionDescription sVersion
69183>>>>>        Handle hoRegistry
69183>>>>>        Boolean bExists bOpened
69183>>>>>        
69183>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
69184>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
69185>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
69186>>>>>        
69186>>>>>        Move C_DFVersionRegistryRoot to sKey
69187>>>>>        Get KeyExists of hoRegistry sKey to bExists
69188>>>>>        If (bExists) Begin
69190>>>>>            Get OpenKey of hoRegistry sKey to bOpened
69191>>>>>            If (bOpened) Begin
69193>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
69194>>>>>                If (bExists) Begin
69196>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
69197>>>>>                End
69197>>>>>>
69197>>>>>                
69197>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
69198>>>>>                If (bExists) Begin
69200>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
69201>>>>>                End
69201>>>>>>
69201>>>>>                Send CloseKey of hoRegistry
69202>>>>>            End
69202>>>>>>
69202>>>>>        End
69202>>>>>>
69202>>>>>        Send Destroy of hoRegistry
69203>>>>>        
69203>>>>>        If (sVersionDescription <> "") Begin
69205>>>>>            Send AppendTextLn (sVersionDescription * "-" * sVersion)
69206>>>>>            Send AppendTextLn ""
69207>>>>>        End
69207>>>>>>
69207>>>>>    End_Procedure
69208>>>>>    
69208>>>>>    
69208>>>>>    Procedure Show_WorkspaceInformation
69210>>>>>        Integer hoWorkspace
69210>>>>>        
69210>>>>>        If (ghoApplication <> 0) Begin
69212>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
69213>>>>>            If (hoWorkspace <> 0) Begin
69215>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
69216>>>>>                Send AppendTextLn ""
69217>>>>>            End
69217>>>>>>
69217>>>>>        End
69217>>>>>>
69217>>>>>    End_Procedure
69218>>>>>    
69218>>>>>    // If connection ids are used, we will send the message EnumerateConnections
69218>>>>>    // to the connection manager object passing the an object and message to send
69218>>>>>    // back to this object. It is expected that the connection manager object will
69218>>>>>    // send this message for every line Of information it wants displayed (passing
69218>>>>>    // the information To be displayed
69218>>>>>    Register_Procedure EnumerateConnections Integer hObjId Integer hmMessId
69218>>>>>    
69218>>>>>    Procedure Show_ConnectionIdInformation
69220>>>>>        If (ghoConnection > 0) Begin
69222>>>>>            Send AppendTextLn ""
69223>>>>>            Send EnumerateConnections of ghoConnection Self (RefProc(AppendTextLn))
69224>>>>>        End
69224>>>>>>
69224>>>>>    End_Procedure
69225>>>>>    
69225>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
69227>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
69228>>>>>    End_Function
69229>>>>>    
69229>>>>>    Procedure Show_Versions
69231>>>>>        Integer iVersion iRevision iBuild
69231>>>>>        
69231>>>>>        Version_Information iVersion iRevision iBuild
69233>>>>>        
69233>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
69234>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
69235>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
69236>>>>>    End_Procedure
69237>>>>>    
69237>>>>>    Function CKRevisionNumber String sDriverID Returns String
69239>>>>>        Handle hoCLIHandler
69239>>>>>        Handle hoDFBtrDrvHandler
69239>>>>>        String sCKRevision
69239>>>>>        
69239>>>>>        
69239>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
69241>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
69242>>>>>            Set psDriverID of hoCLIHandler to sDriverID
69243>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
69244>>>>>            Send Destroy of hoCLIHandler
69245>>>>>        End
69245>>>>>>
69245>>>>>        Else Begin
69246>>>>>            If (sDriverID = "DFBTRDRV") Begin
69248>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
69249>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
69250>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
69251>>>>>                Send Destroy of hoDFBtrDrvHandler
69252>>>>>            End
69252>>>>>>
69252>>>>>        End
69252>>>>>>
69252>>>>>        
69252>>>>>        Function_Return sCKRevision
69253>>>>>    End_Function
69254>>>>>    
69254>>>>>    
69254>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
69256>>>>>        
69256>>>>>        If (sDriverID = "DATAFLEX") Begin
69258>>>>>            Function_Return False
69259>>>>>        End
69259>>>>>>
69259>>>>>        
69259>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
69260>>>>>    End_Function
69261>>>>>    
69261>>>>>    
69261>>>>>    Procedure Show_Drivers
69263>>>>>        String sCurrentDriver sRevNumber
69263>>>>>        String sLoadedDrivers sClientDriver
69263>>>>>        Integer iNumberOfDrivers iCount iClientVersion iMSSQLIndex
69263>>>>>        Boolean bOK
69263>>>>>        Handle hoMsqlDrv
69263>>>>>        
69263>>>>>        Move "" to sLoadedDrivers
69264>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
69267>>>>>        For iCount from 1 to iNumberOfDrivers
69273>>>>>>
69273>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
69276>>>>>            If (sLoadedDrivers <> "") Begin
69278>>>>>                Move (Append (sLoadedDrivers, ", ")) to sLoadedDrivers
69279>>>>>            End
69279>>>>>>
69279>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
69280>>>>>            If (bOK) Begin
69282>>>>>                If (sCurrentDriver = "MSSQLDRV") Begin
69284>>>>>                    Move iCount to iMSSQLIndex
69285>>>>>                End
69285>>>>>>
69285>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
69286>>>>>                // if mssqldrv, show the client number
69286>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
69287>>>>>            End
69287>>>>>>
69287>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) to sLoadedDrivers
69288>>>>>        Loop
69289>>>>>>
69289>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
69290>>>>>        If (iMSSQLIndex>0) Begin
69292>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iMSSQLIndex to iClientVersion
69295>>>>>            Get Create (RefClass(cMSSQLHandler)) to hoMsqlDrv
69296>>>>>            Get SqlServerClientVersionName of hoMsqlDrv iClientVersion to sClientDriver
69297>>>>>            Send Destroy of hoMsqlDrv
69298>>>>>            Send AppendTextLn (SFormat("MSSQLDRV Client Version: %1", sClientDriver))
69299>>>>>        End
69299>>>>>>
69299>>>>>    End_Procedure
69300>>>>>    
69300>>>>>    Procedure Show_HelpFile
69302>>>>>        String sHelpFile
69302>>>>>        Integer eHelpType
69302>>>>>        
69302>>>>>        If (ghoApplication <> 0) Begin
69304>>>>>            Get peHelpType of ghoApplication to eHelpType
69305>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
69307>>>>>                Get GetHelpFile of ghoHtmlHelp to sHelpFile
69308>>>>>            End
69308>>>>>>
69308>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
69311>>>>>                Get Help_filename of Help_object_id to sHelpFile
69312>>>>>            End
69312>>>>>>
69312>>>>>            Else Begin
69313>>>>>                Move C_$ThereIsNoHelpfileDefined to sHelpFile
69314>>>>>            End
69314>>>>>>
69314>>>>>            
69314>>>>>            Send AppendTextLn ""
69315>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
69316>>>>>        End
69316>>>>>>
69316>>>>>    End_Procedure
69317>>>>>    
69317>>>>>    Procedure Show_EnterAsTab
69319>>>>>        Boolean bEnterKeyAsTabKey
69319>>>>>        String sText
69319>>>>>        
69319>>>>>        If (ghoApplication <> 0) Begin
69321>>>>>            Get pbEnterKeyAsTabKey of ghoApplication to bEnterKeyAsTabKey
69322>>>>>            If (bEnterKeyAsTabKey) Begin
69324>>>>>                Move "True" to sText
69325>>>>>            End
69325>>>>>>
69325>>>>>            Else Begin
69326>>>>>                Move "False" to sText
69327>>>>>            End
69327>>>>>>
69327>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
69328>>>>>        End
69328>>>>>>
69328>>>>>    End_Procedure
69329>>>>>    
69329>>>>>    //    During activation we will remove the old information and add the newly
69329>>>>>    //    found systeminformation
69329>>>>>    Procedure Add_Focus Integer hoRoot
69331>>>>>        Forward Send Add_Focus hoRoot
69333>>>>>        
69333>>>>>        Send Delete_Data
69334>>>>>        
69334>>>>>        Set Changed_State to False
69335>>>>>        Set Read_Only_State to True
69336>>>>>        
69336>>>>>        Send Show_ServicePack
69337>>>>>        Send Show_Versions
69338>>>>>        Send Show_Drivers
69339>>>>>        If (ghoConnection <> 0) Begin
69341>>>>>            Send Show_ConnectionIdInformation
69342>>>>>        End
69342>>>>>>
69342>>>>>        Send Show_HelpFile
69343>>>>>        Send Show_Current_Directory
69344>>>>>        Send Show_Filelist_Name
69345>>>>>        If (ghoApplication <> 0) Begin
69347>>>>>            Send Show_WorkSpaceInformation // added To show WS info
69348>>>>>        End
69348>>>>>>
69348>>>>>        Send Show_Current_User
69349>>>>>        Send Show_Windows_Directory
69350>>>>>        Send Show_Screen_Size
69351>>>>>        Send Show_Page_Size
69352>>>>>        Send Show_EnterAsTab
69353>>>>>        Send Show_Number_Format
69354>>>>>        Send Show_Date_Format
69355>>>>>        Send Show_Lock_Delay
69356>>>>>        Send Show_Lock_Timeout
69357>>>>>        Send Show_Date
69358>>>>>        Send Show_Systemresources
69359>>>>>        Send Show_Registration
69360>>>>>        Send Beginning_of_Data
69361>>>>>        
69361>>>>>        Set Icon to 'default.ico'
69362>>>>>    End_Procedure
69363>>>>>End_Class
69364>>>>>
69364>>>>>Class SysInfoDialog is a ModalPanel
69365>>>>>    Procedure Construct_Object
69367>>>>>        Forward Send Construct_Object
69369>>>>>        
69369>>>>>        Set Label to C_$SystemInformation
69370>>>>>        Set Size to 140 267
69371>>>>>        Set piMinSize to 140 267
69372>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69373>>>>>        Set Border_Style to Border_Thick
69374>>>>>        
69374>>>>>        Object oSysinfoDisplay is a SysInfoDisplay
69376>>>>>            Set peAnchors to anAll
69377>>>>>        End_Object
69378>>>>>        
69378>>>>>        Object oCloseButton is a Button
69380>>>>>            Set Label to C_$Close
69381>>>>>            Set Location to 120 210
69382>>>>>            Set Message 0 to (Refproc (Close_Panel))
69383>>>>>            Set Default_State to True
69384>>>>>            Set peAnchors to anBottomRight
69385>>>>>        End_Object
69386>>>>>        
69386>>>>>        On_Key kCancel Send Close_Panel
69387>>>>>    End_Procedure
69388>>>>>End_Class
69389>>>>>
69389>>>>>Class AboutDialog is a ModalPanel
69390>>>>>    Procedure Construct_Object
69392>>>>>        String sVdfRootDir
69392>>>>>        
69392>>>>>        Forward Send Construct_Object
69394>>>>>        
69394>>>>>        Set Label to C_$About
69395>>>>>        Set Size to 89 212
69396>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69397>>>>>        
69397>>>>>        Object oSysInfoDialog is a SysInfoDialog
69399>>>>>        End_Object
69400>>>>>        
69400>>>>>        Object oBox is a Container3d
69402>>>>>            Set Border_Style to Border_StaticEdge
69403>>>>>            Set Size to 63 202
69404>>>>>            Set Location to 4 5
69405>>>>>            
69405>>>>>            Object oAboutGraphic is a BitmapContainer
69407>>>>>                Set Border_Style to Border_None
69408>>>>>                Set Bitmap_Style to Bitmap_Center
69409>>>>>                Set Size to 48 48
69410>>>>>                Set Location to 7 2
69411>>>>>            End_Object
69412>>>>>            
69412>>>>>            Object oProductName is a TextBox
69414>>>>>                Set Label to C_$ProductName
69415>>>>>                Set Size to 10 45
69416>>>>>                Set Location to 8 53
69417>>>>>            End_Object
69418>>>>>            
69418>>>>>            Object oVersion is a TextBox
69420>>>>>                Set Label to C_$Version
69421>>>>>                Set Size to 10 25
69422>>>>>                Set Location to 21 53
69423>>>>>            End_Object
69424>>>>>            
69424>>>>>            Object oCopyright is a TextBox
69426>>>>>                Set Label to C_$Copyright
69427>>>>>                Set Size to 10 31
69428>>>>>                Set Location to 34 53
69429>>>>>            End_Object
69430>>>>>            
69430>>>>>            Object oAuthor is a TextBox
69432>>>>>                Set Label to C_$Author
69433>>>>>                Set Size to 10 22
69434>>>>>                Set Location to 46 53
69435>>>>>            End_Object
69436>>>>>        End_Object
69437>>>>>        
69437>>>>>        Object oOKButton is a Button
69439>>>>>            On_Item C_$OK Send Close_Panel
69440>>>>>            Set Size to 14 50
69441>>>>>            Set Location to 71 157
69442>>>>>        End_Object
69443>>>>>        
69443>>>>>        Object oSysInfoButton is a Button
69445>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
69446>>>>>            Set Size to 14 50
69447>>>>>            Set Location to 71 101
69448>>>>>        End_Object
69449>>>>>        
69449>>>>>        On_Key Kcancel Send KeyAction of oOKButton
69450>>>>>        
69450>>>>>        Set Logo to "DacAbout.bmp"  // square bitmaps Of 42x42 work best
69451>>>>>    End_Procedure
69452>>>>>    
69452>>>>>    Procedure Set ProductName String sProductName
69454>>>>>        Set Label of oProductName to sProductName
69455>>>>>    End_Procedure
69456>>>>>    
69456>>>>>    Procedure Set Version String sVersion
69458>>>>>        Set Label of oVersion to sVersion
69459>>>>>    End_Procedure
69460>>>>>    
69460>>>>>    Procedure Set Copyright String sCopyright
69462>>>>>        Set Label of oCopyright to sCopyright
69463>>>>>    End_Procedure
69464>>>>>    
69464>>>>>    Procedure Set Author String sAuthor
69466>>>>>        Set Label of oAuthor to sAuthor
69467>>>>>    End_Procedure
69468>>>>>    
69468>>>>>    Procedure Set Logo String sLogo
69470>>>>>        // square bitmaps Of 42x42 work best
69470>>>>>        Set Bitmap of oAboutGraphic to sLogo
69471>>>>>    End_Procedure
69472>>>>>    
69472>>>>>    Procedure Show_Sysinfo
69474>>>>>        Send Popup_Modal of oSysinfoDialog
69475>>>>>    End_Procedure
69476>>>>>    
69476>>>>>    Procedure End_Construct_Object
69478>>>>>        Handle hoVersionInfo
69478>>>>>        Boolean bIncluded
69478>>>>>        Integer iMajor iMinor iRelease iBuild
69478>>>>>        String sLabel
69478>>>>>        
69478>>>>>        Get Label of oVersion to sLabel
69479>>>>>        If (sLabel = C_$VERSION) Begin
69481>>>>>            // set it To the version info Of the program, if available
69481>>>>>            If (ghoApplication <> 0) Begin
69483>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
69484>>>>>                If (hoVersionInfo <> 0) Begin
69486>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
69487>>>>>                    If (bIncluded) Begin
69489>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
69490>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
69491>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
69492>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
69493>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
69494>>>>>                        Set Version to sLabel
69495>>>>>                    End
69495>>>>>>
69495>>>>>                End
69495>>>>>>
69495>>>>>            End
69495>>>>>>
69495>>>>>        End
69495>>>>>>
69495>>>>>        
69495>>>>>        Forward Send End_Construct_Object
69497>>>>>    End_Procedure
69498>>>>>End_Class
69499>>>
69499>>>//  This is the default message. It is expected that you will
69499>>>//  create your own message to override this
69499>>>Procedure Activate_About
69502>>>    Send DoAbout "" "" "" "" ""
69503>>>End_Procedure
69504>>>
69504>>>//  It is expected that you will send this message (most
69504>>>//  likely from Activate_About. This creates an about object, activates it
69504>>>//  and destroys it when done. It is not exepected that you will augment this.
69504>>>Procedure DoAbout String sTitle String sVersion String sCopyRight String sAuthor String sBitmap
69507>>>    Integer hoObj hoMain
69507>>>    
69507>>>    // create object
69507>>>    Object About is an AboutDialog
69509>>>        // if no title passed use the label of the main panel
69509>>>        // (if a main panel exists).
69509>>>        If (sTitle = "") Begin
69511>>>            Get Main_Window of desktop to hoMain
69512>>>            If hoMain ;                Get Label of hoMain to sTitle
69515>>>        End
69515>>>>
69515>>>        Set productname to sTitle
69516>>>        Set version     to sVersion
69517>>>        Set copyright   to sCopyRight
69518>>>        Set author      to sAuthor
69519>>>        If (sBitmap <> '') ;            Set logo to sBitMap // square bitmaps of 42x42 work best
69522>>>        Move Self to hoObj // object Id
69523>>>    End_Object
69524>>>    Send Popup   of hoObj    // popup the about object
69525>>>    Send Destroy of hoObj // when done, it will be destroyed
69526>>>End_Procedure
69527>>>
69527>        Use EmpEntry.vw
Including file: EmpEntry.vw    (C:\DataFlex Projects\ShoeFactory\AppSrc\EmpEntry.vw)
69527>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\EmpEntry.vw
69527>>>// EmpEntry
69527>>>//
69527>>>
69527>>>Use DFClient.pkg
69527>>>Use DFEntry.pkg
69527>>>
69527>>>Use cEmployeeDataDictionary.dd
Including file: cEmployeeDataDictionary.dd    (C:\DataFlex Projects\ShoeFactory\DDSrc\cEmployeeDataDictionary.dd)
69527>>>>>Use DataDict.pkg
69527>>>>>
69527>>>>>Open Employee
Including file: Employee.fd    (C:\DataFlex Projects\ShoeFactory\DDSrc\Employee.fd)
69529>>>>>Open PageHeader
Including file: PageHeader.fd    (C:\DataFlex Projects\ShoeFactory\DDSrc\PageHeader.fd)
69531>>>>>Open system
Including file: system.fd    (C:\DataFlex Projects\ShoeFactory\DDSrc\system.fd)
69533>>>>>
69533>>>>>Register_Object Employee_sl
69533>>>>>
69533>>>>>Class cEmployeeDataDictionary is a DataDictionary
69534>>>>>    
69534>>>>>    Procedure Construct_Object
69536>>>>>        Forward Send Construct_Object
69538>>>>>        Set Main_File to Employee.File_Number
69539>>>>>
69539>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69540>>>>>
69540>>>>>        Set Add_Client_File to PageHeader.File_Number
69541>>>>>
69541>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69542>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69543>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69544>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69545>>>>>
69545>>>>>        Set Field_Auto_Increment Field Employee.id to File_Field system.employee_id
69546>>>>>        Set Field_Prompt_Object Field Employee.id to Employee_sl
69547>>>>>
69547>>>>>    End_Procedure
69548>>>>>
69548>>>>>End_Class
69549>>>>>
69549>>>>>Use Employee.sl
Including file: Employee.sl    (C:\DataFlex Projects\ShoeFactory\AppSrc\Employee.sl)
69549>>>>>>>// Employee.sl
69549>>>>>>>// Employee Lookup List
69549>>>>>>>
69549>>>>>>>Use DFClient.pkg
69549>>>>>>>Use cDbCJGridPromptList.pkg
69549>>>>>>>Use cDbCJGridColumn.pkg
69549>>>>>>>Use Windows.pkg
69549>>>>>>>
69549>>>>>>>Use cEmployeeDataDictionary.dd
69549>>>>>>>
69549>>>>>>>CD_Popup_Object Employee_sl is a dbModalPanel
69567>>>>>>>>
69567>>>>>>>    Set Location to 5 5
69568>>>>>>>    Set Size to 134 288
69569>>>>>>>    Set Label To "Employee Lookup List"
69570>>>>>>>    Set Border_Style to Border_Thick
69571>>>>>>>    Set Minimize_Icon to False
69572>>>>>>>
69572>>>>>>>
69572>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
69574>>>>>>>    End_Object 
69575>>>>>>>
69575>>>>>>>    Set Main_DD To oEmployee_DD
69576>>>>>>>    Set Server  To oEmployee_DD
69577>>>>>>>
69577>>>>>>>
69577>>>>>>>
69577>>>>>>>    Object oSelList is a cDbCJGridPromptList
69579>>>>>>>        Set Size to 105 278
69580>>>>>>>        Set Location to 5 5
69581>>>>>>>        Set peAnchors to anAll
69582>>>>>>>        Set psLayoutSection to "Employee_sl_oSelList"
69583>>>>>>>        Set Ordering to 1
69584>>>>>>>        Set pbAutoServer to True
69585>>>>>>>
69585>>>>>>>        Object oEmployee_id is a cDbCJGridColumn
69587>>>>>>>            Entry_Item Employee.id
69588>>>>>>>            Set piWidth to 46
69589>>>>>>>            Set psCaption to "id"
69590>>>>>>>        End_Object 
69591>>>>>>>
69591>>>>>>>        Object oEmployee_name is a cDbCJGridColumn
69593>>>>>>>            Entry_Item Employee.name
69594>>>>>>>            Set piWidth to 250
69595>>>>>>>            Set psCaption to "name"
69596>>>>>>>        End_Object 
69597>>>>>>>
69597>>>>>>>        Object oEmployee_id_card is a cDbCJGridColumn
69599>>>>>>>            Entry_Item Employee.id_card
69600>>>>>>>            Set piWidth to 150
69601>>>>>>>            Set psCaption to "id card"
69602>>>>>>>        End_Object 
69603>>>>>>>
69603>>>>>>>
69603>>>>>>>    End_Object 
69604>>>>>>>
69604>>>>>>>    Object oOk_bn is a Button
69606>>>>>>>        Set Label to "&Ok"
69607>>>>>>>        Set Location to 115 125
69608>>>>>>>        Set peAnchors to anBottomRight
69609>>>>>>>
69609>>>>>>>        Procedure OnClick
69612>>>>>>>            Send OK of oSelList
69613>>>>>>>        End_Procedure
69614>>>>>>>
69614>>>>>>>    End_Object 
69615>>>>>>>
69615>>>>>>>    Object oCancel_bn is a Button
69617>>>>>>>        Set Label to "&Cancel"
69618>>>>>>>        Set Location to 115 179
69619>>>>>>>        Set peAnchors to anBottomRight
69620>>>>>>>
69620>>>>>>>        Procedure OnClick
69623>>>>>>>            Send Cancel of oSelList
69624>>>>>>>        End_Procedure
69625>>>>>>>
69625>>>>>>>    End_Object 
69626>>>>>>>
69626>>>>>>>    Object oSearch_bn is a Button
69628>>>>>>>        Set Label to "&Search..."
69629>>>>>>>        Set Location to 115 233
69630>>>>>>>        Set peAnchors to anBottomRight
69631>>>>>>>
69631>>>>>>>        Procedure OnClick
69634>>>>>>>            Send Search of oSelList
69635>>>>>>>        End_Procedure
69636>>>>>>>
69636>>>>>>>    End_Object 
69637>>>>>>>
69637>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
69638>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
69639>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
69640>>>>>>>
69640>>>>>>>
69640>>>>>>>CD_End_Object // Employee_sl
69642>>>>>>>>
69642>>>
69642>>>ACTIVATE_VIEW Activate_oEmpEntry FOR oEmpEntry
69652>>>>
69652>>>Object oEmpEntry is a dbView
69654>>>    Set Location to 5 5
69655>>>    Set Size to 22 452
69656>>>    Set Label To "EmpEntry"
69657>>>    Set Border_Style to Border_Thick
69658>>>
69658>>>
69658>>>    Object oEmployee_DD is a cEmployeeDataDictionary
69660>>>    End_Object 
69661>>>
69661>>>    Set Main_DD To oEmployee_DD
69662>>>    Set Server  To oEmployee_DD
69663>>>
69663>>>
69663>>>
69663>>>    Object oEmployeeid is a dbForm
69665>>>        Entry_Item Employee.id
69666>>>        Set Size to 12 34
69667>>>        Set Location to 5 13
69668>>>        Set peAnchors to anTopLeftRight
69669>>>        Set Label to "id"
69670>>>        Set Label_Justification_mode to jMode_Left
69671>>>        Set Label_Col_Offset to 8
69672>>>        Set Label_row_Offset to 0
69673>>>    End_Object 
69674>>>
69674>>>    Object oEmployeename is a dbForm
69676>>>        Entry_Item Employee.name
69677>>>        Set Size to 12 250
69678>>>        Set Location to 5 72
69679>>>        Set peAnchors to anTopRight
69680>>>        Set Label to "name"
69681>>>        Set Label_Justification_mode to jMode_Left
69682>>>        Set Label_Col_Offset to 20
69683>>>        Set Label_row_Offset to 0
69684>>>    End_Object 
69685>>>
69685>>>    Object oEmployeeid_card is a dbForm
69687>>>        Entry_Item Employee.id_card
69688>>>        Set Size to 12 96
69689>>>        Set Location to 5 351
69690>>>        Set peAnchors to anTopRight
69691>>>        Set Label to "id card"
69692>>>        Set Label_Justification_mode to jMode_Left
69693>>>        Set Label_Col_Offset to 24
69694>>>        Set Label_row_Offset to 0
69695>>>    End_Object
69696>>>    
69696>>>    Object oDetailGrid is a cDbCJGrid
69698>>>        Set Size to 229 348
69699>>>        Set Location to 73 5
69700>>>        Set Server to oEmployee_DD
69701>>>        Set Ordering to 1
69702>>>        Set peAnchors to anAll
69703>>>        Set psLayoutSection to "oEmployeeEntry_oDetailGrid"
69704>>>        Set pbAllowInsertRow to False
69705>>>        Set pbHeaderPrompts to True
69706>>>        
69706>>>        
69706>>>        
69706>>>        Object oEmployeeId is a cDbCJGridColumn
69708>>>        Entry_Item Employee.id
69709>>>        Set piWidth to 78
69710>>>        Set psCaption to "Azonosito"
69711>>>        End_Object
69712>>>        
69712>>>        
69712>>>        
69712>>>        Object oEmployeeName is a cDbCJGridColumn
69714>>>        Entry_Item Employee.name
69715>>>        Set piWidth to 115
69716>>>        Set psCaption to "Nv"
69717>>>        End_Object
69718>>>        
69718>>>        
69718>>>        
69718>>>        Object oEmployeeIdCard is a cDbCJGridColumn
69720>>>        Entry_Item Employee.id_card
69721>>>        Set piWidth to 387
69722>>>        Set psCaption to "Szemlyig."
69723>>>        End_Object
69724>>>
69724>>>
69724>>>
69724>>>    End_Object
69725>>>    
69725>>>End_Object 
69726>        Use LineEntry.vw
Including file: LineEntry.vw    (C:\DataFlex Projects\ShoeFactory\AppSrc\LineEntry.vw)
69726>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\LineEntry.vw
69726>>>// LineEntry
69726>>>//
69726>>>
69726>>>Use DFClient.pkg
69726>>>Use DFEntry.pkg
69726>>>
69726>>>Use cLineDataDictionary.dd
Including file: cLineDataDictionary.dd    (C:\DataFlex Projects\ShoeFactory\DDSrc\cLineDataDictionary.dd)
69726>>>>>Use DataDict.pkg
69726>>>>>
69726>>>>>Open Line
Including file: Line.fd    (C:\DataFlex Projects\ShoeFactory\DDSrc\Line.fd)
69728>>>>>Open PageHeader
69730>>>>>Open system
69732>>>>>
69732>>>>>Object oTypeValid is a DescriptionValidationTable
69734>>>>>    Procedure Fill_List
69737>>>>>        Forward Send Fill_List
69739>>>>>        Send Add_Table_Value "Type A" "Type A"
69740>>>>>        Send Add_Table_Value "Type B" "Type B"
69741>>>>>        Send Add_Table_Value "Type C" "Type C"
69742>>>>>        Send Add_Table_Value "Type D" "Type D"
69743>>>>>        Send Add_Table_Value "Type E" "Type E"
69744>>>>>    End_Procedure
69745>>>>>End_Object
69746>>>>>
69746>>>>>Register_Object Line_sl
69746>>>>>
69746>>>>>Class cLineDataDictionary is a DataDictionary
69747>>>>>    
69747>>>>>    Procedure Construct_Object
69749>>>>>        Forward Send Construct_Object
69751>>>>>        Set Main_File to Line.File_Number
69752>>>>>
69752>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69753>>>>>
69753>>>>>        Set Add_Client_File to PageHeader.File_Number
69754>>>>>
69754>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69755>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69756>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69757>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69758>>>>>
69758>>>>>        Set Field_Auto_Increment Field Line.id to File_Field system.line_id
69759>>>>>        Set Field_Prompt_Object Field Line.id to Line_sl
69760>>>>>
69760>>>>>        Set Field_Value_Table Field Line.type to oTypeValid
69761>>>>>
69761>>>>>    End_Procedure
69762>>>>>
69762>>>>>End_Class
69763>>>>>
69763>>>>>Use Line.sl
Including file: Line.sl    (C:\DataFlex Projects\ShoeFactory\AppSrc\Line.sl)
69763>>>>>>>// Line.sl
69763>>>>>>>// Line Lookup List
69763>>>>>>>
69763>>>>>>>Use DFClient.pkg
69763>>>>>>>Use cDbCJGridPromptList.pkg
69763>>>>>>>Use cDbCJGridColumn.pkg
69763>>>>>>>Use Windows.pkg
69763>>>>>>>
69763>>>>>>>Use cLineDataDictionary.dd
69763>>>>>>>
69763>>>>>>>CD_Popup_Object Line_sl is a dbModalPanel
69781>>>>>>>>
69781>>>>>>>    Set Location to 5 5
69782>>>>>>>    Set Size to 134 72
69783>>>>>>>    Set Label To "Line Lookup List"
69784>>>>>>>    Set Border_Style to Border_Thick
69785>>>>>>>    Set Minimize_Icon to False
69786>>>>>>>
69786>>>>>>>
69786>>>>>>>    Object oLine_DD is a cLineDataDictionary
69788>>>>>>>    End_Object 
69789>>>>>>>
69789>>>>>>>    Set Main_DD To oLine_DD
69790>>>>>>>    Set Server  To oLine_DD
69791>>>>>>>
69791>>>>>>>
69791>>>>>>>
69791>>>>>>>    Object oSelList is a cDbCJGridPromptList
69793>>>>>>>        Set Size to 105 62
69794>>>>>>>        Set Location to 5 5
69795>>>>>>>        Set peAnchors to anAll
69796>>>>>>>        Set psLayoutSection to "Line_sl_oSelList"
69797>>>>>>>        Set Ordering to 1
69798>>>>>>>        Set pbAutoServer to True
69799>>>>>>>
69799>>>>>>>        Object oLine_id is a cDbCJGridColumn
69801>>>>>>>            Entry_Item Line.id
69802>>>>>>>            Set piWidth to 46
69803>>>>>>>            Set psCaption to "id"
69804>>>>>>>        End_Object 
69805>>>>>>>
69805>>>>>>>        Object oLine_type is a cDbCJGridColumn
69807>>>>>>>            Entry_Item Line.type
69808>>>>>>>            Set piWidth to 40
69809>>>>>>>            Set psCaption to "type"
69810>>>>>>>        End_Object 
69811>>>>>>>
69811>>>>>>>
69811>>>>>>>    End_Object 
69812>>>>>>>
69812>>>>>>>    Object oOk_bn is a Button
69814>>>>>>>        Set Label to "&Ok"
69815>>>>>>>        Set Location to 115 -91
69816>>>>>>>        Set peAnchors to anBottomRight
69817>>>>>>>
69817>>>>>>>        Procedure OnClick
69820>>>>>>>            Send OK of oSelList
69821>>>>>>>        End_Procedure
69822>>>>>>>
69822>>>>>>>    End_Object 
69823>>>>>>>
69823>>>>>>>    Object oCancel_bn is a Button
69825>>>>>>>        Set Label to "&Cancel"
69826>>>>>>>        Set Location to 115 -37
69827>>>>>>>        Set peAnchors to anBottomRight
69828>>>>>>>
69828>>>>>>>        Procedure OnClick
69831>>>>>>>            Send Cancel of oSelList
69832>>>>>>>        End_Procedure
69833>>>>>>>
69833>>>>>>>    End_Object 
69834>>>>>>>
69834>>>>>>>    Object oSearch_bn is a Button
69836>>>>>>>        Set Label to "&Search..."
69837>>>>>>>        Set Location to 115 17
69838>>>>>>>        Set peAnchors to anBottomRight
69839>>>>>>>
69839>>>>>>>        Procedure OnClick
69842>>>>>>>            Send Search of oSelList
69843>>>>>>>        End_Procedure
69844>>>>>>>
69844>>>>>>>    End_Object 
69845>>>>>>>
69845>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
69846>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
69847>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
69848>>>>>>>
69848>>>>>>>
69848>>>>>>>CD_End_Object // Line_sl
69850>>>>>>>>
69850>>>
69850>>>ACTIVATE_VIEW Activate_oLineEntry FOR oLineEntry
69860>>>>
69860>>>Object oLineEntry is a dbView
69862>>>    Set Location to 5 5
69863>>>    Set Size to 22 138
69864>>>    Set Label To "LineEntry"
69865>>>    Set Border_Style to Border_Thick
69866>>>
69866>>>
69866>>>    Object oLine_DD is a cLineDataDictionary
69868>>>    End_Object 
69869>>>
69869>>>    Set Main_DD To oLine_DD
69870>>>    Set Server  To oLine_DD
69871>>>
69871>>>
69871>>>
69871>>>    Object oLineid is a dbForm
69873>>>        Entry_Item Line.id
69874>>>        Set Size to 12 55
69875>>>        Set Location to 5 13
69876>>>        Set peAnchors to anTopLeftRight
69877>>>        Set Label to "id"
69878>>>        Set Label_Justification_mode to jMode_Left
69879>>>        Set Label_Col_Offset to 8
69880>>>        Set Label_row_Offset to 0
69881>>>    End_Object 
69882>>>
69882>>>    Object oLinetype is a dbForm
69884>>>        Entry_Item Line.type
69885>>>        Set Size to 12 44
69886>>>        Set Location to 5 88
69887>>>        Set peAnchors to anTopRight
69888>>>        Set Label to "type"
69889>>>        Set Label_Justification_mode to jMode_Left
69890>>>        Set Label_Col_Offset to 16
69891>>>        Set Label_row_Offset to 0
69892>>>    End_Object 
69893>>>
69893>>>
69893>>>End_Object 
69894>        Use PageHeaderEntry.vw
Including file: PageHeaderEntry.vw    (C:\DataFlex Projects\ShoeFactory\AppSrc\PageHeaderEntry.vw)
69894>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\PageHeaderEntry.vw
69894>>>// PageHeaderEntry
69894>>>//
69894>>>
69894>>>Use DFClient.pkg
69894>>>Use DFEntry.pkg
69894>>>
69894>>>Use cEmployeeDataDictionary.dd
69894>>>Use cLineDataDictionary.dd
69894>>>Use cPageHeaderDataDictionary.dd
Including file: cPageHeaderDataDictionary.dd    (C:\DataFlex Projects\ShoeFactory\DDSrc\cPageHeaderDataDictionary.dd)
69894>>>>>Use DataDict.pkg
69894>>>>>
69894>>>>>Open PageHeader
69896>>>>>Open Employee
69898>>>>>Open Line
69900>>>>>Open system
69902>>>>>Open PageFooter
Including file: PageFooter.fd    (C:\DataFlex Projects\ShoeFactory\DDSrc\PageFooter.fd)
69904>>>>>
69904>>>>>Register_Object PageHeader_sl
69904>>>>>
69904>>>>>Class cPageHeaderDataDictionary is a DataDictionary
69905>>>>>    
69905>>>>>    Procedure Construct_Object
69907>>>>>        Forward Send Construct_Object
69909>>>>>        Set Main_File to PageHeader.File_Number
69910>>>>>
69910>>>>>        Set Add_Client_File to PageFooter.File_Number
69911>>>>>
69911>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69912>>>>>
69912>>>>>        Set Add_Server_File to Employee.File_Number
69913>>>>>        Set Add_Server_File to Line.File_Number
69914>>>>>
69914>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69915>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69916>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69917>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69918>>>>>
69918>>>>>        Set Field_Auto_Increment Field PageHeader.id to File_Field system.page_header_id
69919>>>>>        Set Field_Prompt_Object Field PageHeader.id to PageHeader_sl
69920>>>>>
69920>>>>>    End_Procedure
69921>>>>>
69921>>>>>End_Class
69922>>>>>
69922>>>>>Use PageHeader.sl
Including file: PageHeader.sl    (C:\DataFlex Projects\ShoeFactory\AppSrc\PageHeader.sl)
69922>>>>>>>// PageHeader.sl
69922>>>>>>>// PageHeader Lookup List
69922>>>>>>>
69922>>>>>>>Use DFClient.pkg
69922>>>>>>>Use cDbCJGridPromptList.pkg
69922>>>>>>>Use cDbCJGridColumn.pkg
69922>>>>>>>Use Windows.pkg
69922>>>>>>>
69922>>>>>>>Use cEmployeeDataDictionary.dd
69922>>>>>>>Use cLineDataDictionary.dd
69922>>>>>>>Use cPageHeaderDataDictionary.dd
69922>>>>>>>
69922>>>>>>>CD_Popup_Object PageHeader_sl is a dbModalPanel
69940>>>>>>>>
69940>>>>>>>    Set Location to 5 5
69941>>>>>>>    Set Size to 134 126
69942>>>>>>>    Set Label To "PageHeader Lookup List"
69943>>>>>>>    Set Border_Style to Border_Thick
69944>>>>>>>    Set Minimize_Icon to False
69945>>>>>>>
69945>>>>>>>
69945>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
69947>>>>>>>    End_Object 
69948>>>>>>>
69948>>>>>>>    Object oLine_DD is a cLineDataDictionary
69950>>>>>>>    End_Object 
69951>>>>>>>
69951>>>>>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
69953>>>>>>>        Set DDO_Server To oEmployee_DD
69954>>>>>>>        Set DDO_Server To oLine_DD
69955>>>>>>>    End_Object 
69956>>>>>>>
69956>>>>>>>    Set Main_DD To oPageHeader_DD
69957>>>>>>>    Set Server  To oPageHeader_DD
69958>>>>>>>
69958>>>>>>>
69958>>>>>>>
69958>>>>>>>    Object oSelList is a cDbCJGridPromptList
69960>>>>>>>        Set Size to 105 116
69961>>>>>>>        Set Location to 5 5
69962>>>>>>>        Set peAnchors to anAll
69963>>>>>>>        Set psLayoutSection to "PageHeader_sl_oSelList"
69964>>>>>>>        Set Ordering to 1
69965>>>>>>>        Set pbAutoServer to True
69966>>>>>>>
69966>>>>>>>        Object oPageHeader_id is a cDbCJGridColumn
69968>>>>>>>            Entry_Item PageHeader.id
69969>>>>>>>            Set piWidth to 46
69970>>>>>>>            Set psCaption to "id"
69971>>>>>>>        End_Object 
69972>>>>>>>
69972>>>>>>>        Object oEmployee_id is a cDbCJGridColumn
69974>>>>>>>            Entry_Item Employee.id
69975>>>>>>>            Set piWidth to 81
69976>>>>>>>            Set psCaption to "employee id"
69977>>>>>>>        End_Object 
69978>>>>>>>
69978>>>>>>>        Object oLine_id is a cDbCJGridColumn
69980>>>>>>>            Entry_Item Line.id
69981>>>>>>>            Set piWidth to 48
69982>>>>>>>            Set psCaption to "line id"
69983>>>>>>>        End_Object 
69984>>>>>>>
69984>>>>>>>
69984>>>>>>>    End_Object 
69985>>>>>>>
69985>>>>>>>    Object oOk_bn is a Button
69987>>>>>>>        Set Label to "&Ok"
69988>>>>>>>        Set Location to 115 -37
69989>>>>>>>        Set peAnchors to anBottomRight
69990>>>>>>>
69990>>>>>>>        Procedure OnClick
69993>>>>>>>            Send OK of oSelList
69994>>>>>>>        End_Procedure
69995>>>>>>>
69995>>>>>>>    End_Object 
69996>>>>>>>
69996>>>>>>>    Object oCancel_bn is a Button
69998>>>>>>>        Set Label to "&Cancel"
69999>>>>>>>        Set Location to 115 17
70000>>>>>>>        Set peAnchors to anBottomRight
70001>>>>>>>
70001>>>>>>>        Procedure OnClick
70004>>>>>>>            Send Cancel of oSelList
70005>>>>>>>        End_Procedure
70006>>>>>>>
70006>>>>>>>    End_Object 
70007>>>>>>>
70007>>>>>>>    Object oSearch_bn is a Button
70009>>>>>>>        Set Label to "&Search..."
70010>>>>>>>        Set Location to 115 71
70011>>>>>>>        Set peAnchors to anBottomRight
70012>>>>>>>
70012>>>>>>>        Procedure OnClick
70015>>>>>>>            Send Search of oSelList
70016>>>>>>>        End_Procedure
70017>>>>>>>
70017>>>>>>>    End_Object 
70018>>>>>>>
70018>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
70019>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
70020>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
70021>>>>>>>
70021>>>>>>>
70021>>>>>>>CD_End_Object // PageHeader_sl
70023>>>>>>>>
70023>>>
70023>>>ACTIVATE_VIEW Activate_oPageHeaderEntry FOR oPageHeaderEntry
70033>>>>
70033>>>Object oPageHeaderEntry is a dbView
70035>>>    Set Location to 5 5
70036>>>    Set Size to 50 414
70037>>>    Set Label To "PageHeaderEntry"
70038>>>    Set Border_Style to Border_Thick
70039>>>
70039>>>
70039>>>    Object oEmployee_DD is a cEmployeeDataDictionary
70041>>>    End_Object 
70042>>>
70042>>>    Object oLine_DD is a cLineDataDictionary
70044>>>    End_Object 
70045>>>
70045>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
70047>>>        Set DDO_Server To oEmployee_DD
70048>>>        Set DDO_Server To oLine_DD
70049>>>    End_Object 
70050>>>
70050>>>    Set Main_DD To oPageHeader_DD
70051>>>    Set Server  To oPageHeader_DD
70052>>>
70052>>>
70052>>>
70052>>>    Object oPageHeaderid is a dbForm
70054>>>        Entry_Item PageHeader.id
70055>>>        Set Size to 12 34
70056>>>        Set Location to 5 34
70057>>>        Set peAnchors to anTopLeftRight
70058>>>        Set Label to "id"
70059>>>        Set Label_Justification_mode to jMode_Left
70060>>>        Set Label_Col_Offset to 29
70061>>>        Set Label_row_Offset to 0
70062>>>    End_Object 
70063>>>
70063>>>    Object oEmployeeid is a dbForm
70065>>>        Entry_Item Employee.id
70066>>>        Set Size to 12 34
70067>>>        Set Location to 5 114
70068>>>        Set peAnchors to anTopRight
70069>>>        Set Label to "employee id"
70070>>>        Set Label_Justification_mode to jMode_Left
70071>>>        Set Label_Col_Offset to 41
70072>>>        Set Label_row_Offset to 0
70073>>>    End_Object 
70074>>>
70074>>>    Object oLineid is a dbForm
70076>>>        Entry_Item Line.id
70077>>>        Set Size to 12 34
70078>>>        Set Location to 5 174
70079>>>        Set peAnchors to anTopRight
70080>>>        Set Label to "line id"
70081>>>        Set Label_Justification_mode to jMode_Left
70082>>>        Set Label_Col_Offset to 21
70083>>>        Set Label_row_Offset to 0
70084>>>    End_Object 
70085>>>
70085>>>    Object oEmployeename is a dbForm
70087>>>        Entry_Item Employee.name
70088>>>        Set Size to 12 250
70089>>>        Set Location to 19 34
70090>>>        Set peAnchors to anTopLeftRight
70091>>>        Set Label to "name"
70092>>>        Set Label_Justification_mode to jMode_Left
70093>>>        Set Label_Col_Offset to 29
70094>>>        Set Label_row_Offset to 0
70095>>>    End_Object 
70096>>>
70096>>>    Object oEmployeeid_card is a dbForm
70098>>>        Entry_Item Employee.id_card
70099>>>        Set Size to 12 96
70100>>>        Set Location to 19 313
70101>>>        Set peAnchors to anTopRight
70102>>>        Set Label to "id card"
70103>>>        Set Label_Justification_mode to jMode_Left
70104>>>        Set Label_Col_Offset to 24
70105>>>        Set Label_row_Offset to 0
70106>>>    End_Object 
70107>>>
70107>>>    Object oLinetype is a dbForm
70109>>>        Entry_Item Line.type
70110>>>        Set Size to 12 59
70111>>>        Set Location to 33 34
70112>>>        Set peAnchors to anTopLeftRight
70113>>>        Set Label to "line type"
70114>>>        Set Label_Justification_mode to jMode_Left
70115>>>        Set Label_Col_Offset to 29
70116>>>        Set Label_row_Offset to 0
70117>>>    End_Object 
70118>>>
70118>>>
70118>>>End_Object 
70119>        Use ShoeEntry.vw
Including file: ShoeEntry.vw    (C:\DataFlex Projects\ShoeFactory\AppSrc\ShoeEntry.vw)
70119>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\ShoeEntry.vw
70119>>>// ShoeEntry
70119>>>//
70119>>>
70119>>>Use DFClient.pkg
70119>>>Use DFEntry.pkg
70119>>>
70119>>>Use cShoeDataDictionary.dd
Including file: cShoeDataDictionary.dd    (C:\DataFlex Projects\ShoeFactory\DDSrc\cShoeDataDictionary.dd)
70119>>>>>Use DataDict.pkg
70119>>>>>
70119>>>>>Open Shoe
Including file: Shoe.fd    (C:\DataFlex Projects\ShoeFactory\DDSrc\Shoe.fd)
70121>>>>>Open system
70123>>>>>Open PageFooter
70125>>>>>
70125>>>>>Register_Object Shoe_sl
70125>>>>>
70125>>>>>Class cShoeDataDictionary is a DataDictionary
70126>>>>>    
70126>>>>>    Procedure Construct_Object
70128>>>>>        Forward Send Construct_Object
70130>>>>>        Set Main_File to Shoe.File_Number
70131>>>>>
70131>>>>>        Set Add_Client_File to PageFooter.File_Number
70132>>>>>
70132>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
70133>>>>>
70133>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
70134>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
70135>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
70136>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
70137>>>>>
70137>>>>>        Set Field_Auto_Increment Field Shoe.id to File_Field system.shoe_id
70138>>>>>        Set Field_Prompt_Object Field Shoe.id to Shoe_sl
70139>>>>>
70139>>>>>        Set Field_Prompt_Object Field Shoe.name to Shoe_sl
70140>>>>>
70140>>>>>        Set Field_Prompt_Object Field Shoe.price to Shoe_sl
70141>>>>>
70141>>>>>    End_Procedure
70142>>>>>
70142>>>>>End_Class
70143>>>>>
70143>>>>>Use Shoe.sl
Including file: Shoe.sl    (C:\DataFlex Projects\ShoeFactory\AppSrc\Shoe.sl)
70143>>>>>>>// Shoe.sl
70143>>>>>>>// Shoe Lookup List
70143>>>>>>>
70143>>>>>>>Use DFClient.pkg
70143>>>>>>>Use cDbCJGridPromptList.pkg
70143>>>>>>>Use cDbCJGridColumn.pkg
70143>>>>>>>Use Windows.pkg
70143>>>>>>>
70143>>>>>>>Use cShoeDataDictionary.dd
70143>>>>>>>
70143>>>>>>>CD_Popup_Object Shoe_sl is a dbModalPanel
70161>>>>>>>>
70161>>>>>>>    Set Location to 5 5
70162>>>>>>>    Set Size to 134 272
70163>>>>>>>    Set Label To "Shoe Lookup List"
70164>>>>>>>    Set Border_Style to Border_Thick
70165>>>>>>>    Set Minimize_Icon to False
70166>>>>>>>
70166>>>>>>>
70166>>>>>>>    Object oShoe_DD is a cShoeDataDictionary
70168>>>>>>>    End_Object 
70169>>>>>>>
70169>>>>>>>    Set Main_DD To oShoe_DD
70170>>>>>>>    Set Server  To oShoe_DD
70171>>>>>>>
70171>>>>>>>
70171>>>>>>>
70171>>>>>>>    Object oSelList is a cDbCJGridPromptList
70173>>>>>>>        Set Size to 105 262
70174>>>>>>>        Set Location to 5 5
70175>>>>>>>        Set peAnchors to anAll
70176>>>>>>>        Set psLayoutSection to "Shoe_sl_oSelList"
70177>>>>>>>        Set Ordering to 1
70178>>>>>>>        Set pbAutoServer to True
70179>>>>>>>
70179>>>>>>>        Object oShoe_id is a cDbCJGridColumn
70181>>>>>>>            Entry_Item Shoe.id
70182>>>>>>>            Set piWidth to 60
70183>>>>>>>            Set psCaption to "id"
70184>>>>>>>        End_Object 
70185>>>>>>>
70185>>>>>>>        Object oShoe_name is a cDbCJGridColumn
70187>>>>>>>            Entry_Item Shoe.name
70188>>>>>>>            Set piWidth to 250
70189>>>>>>>            Set psCaption to "name"
70190>>>>>>>        End_Object 
70191>>>>>>>
70191>>>>>>>        Object oShoe_price is a cDbCJGridColumn
70193>>>>>>>            Entry_Item Shoe.price
70194>>>>>>>            Set piWidth to 110
70195>>>>>>>            Set psCaption to "price"
70196>>>>>>>        End_Object 
70197>>>>>>>
70197>>>>>>>
70197>>>>>>>    End_Object 
70198>>>>>>>
70198>>>>>>>    Object oOk_bn is a Button
70200>>>>>>>        Set Label to "&Ok"
70201>>>>>>>        Set Location to 115 109
70202>>>>>>>        Set peAnchors to anBottomRight
70203>>>>>>>
70203>>>>>>>        Procedure OnClick
70206>>>>>>>            Send OK of oSelList
70207>>>>>>>        End_Procedure
70208>>>>>>>
70208>>>>>>>    End_Object 
70209>>>>>>>
70209>>>>>>>    Object oCancel_bn is a Button
70211>>>>>>>        Set Label to "&Cancel"
70212>>>>>>>        Set Location to 115 163
70213>>>>>>>        Set peAnchors to anBottomRight
70214>>>>>>>
70214>>>>>>>        Procedure OnClick
70217>>>>>>>            Send Cancel of oSelList
70218>>>>>>>        End_Procedure
70219>>>>>>>
70219>>>>>>>    End_Object 
70220>>>>>>>
70220>>>>>>>    Object oSearch_bn is a Button
70222>>>>>>>        Set Label to "&Search..."
70223>>>>>>>        Set Location to 115 217
70224>>>>>>>        Set peAnchors to anBottomRight
70225>>>>>>>
70225>>>>>>>        Procedure OnClick
70228>>>>>>>            Send Search of oSelList
70229>>>>>>>        End_Procedure
70230>>>>>>>
70230>>>>>>>    End_Object 
70231>>>>>>>
70231>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
70232>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
70233>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
70234>>>>>>>
70234>>>>>>>
70234>>>>>>>CD_End_Object // Shoe_sl
70236>>>>>>>>
70236>>>
70236>>>ACTIVATE_VIEW Activate_oShoeEntry FOR oShoeEntry
70246>>>>
70246>>>Object oShoeEntry is a dbView
70248>>>    Set Location to 5 5
70249>>>    Set Size to 22 430
70250>>>    Set Label To "ShoeEntry"
70251>>>    Set Border_Style to Border_Thick
70252>>>
70252>>>
70252>>>    Object oShoe_DD is a cShoeDataDictionary
70254>>>    End_Object 
70255>>>
70255>>>    Set Main_DD To oShoe_DD
70256>>>    Set Server  To oShoe_DD
70257>>>
70257>>>
70257>>>
70257>>>    Object oShoeid is a dbForm
70259>>>        Entry_Item Shoe.id
70260>>>        Set Size to 12 42
70261>>>        Set Location to 5 13
70262>>>        Set peAnchors to anTopLeftRight
70263>>>        Set Label to "id"
70264>>>        Set Label_Justification_mode to jMode_Left
70265>>>        Set Label_Col_Offset to 8
70266>>>        Set Label_row_Offset to 0
70267>>>    End_Object 
70268>>>
70268>>>    Object oShoename is a dbForm
70270>>>        Entry_Item Shoe.name
70271>>>        Set Size to 12 250
70272>>>        Set Location to 5 80
70273>>>        Set peAnchors to anTopRight
70274>>>        Set Label to "name"
70275>>>        Set Label_Justification_mode to jMode_Left
70276>>>        Set Label_Col_Offset to 20
70277>>>        Set Label_row_Offset to 0
70278>>>    End_Object 
70279>>>
70279>>>    Object oShoeprice is a dbForm
70281>>>        Entry_Item Shoe.price
70282>>>        Set Size to 12 72
70283>>>        Set Location to 5 353
70284>>>        Set peAnchors to anTopRight
70285>>>        Set Label to "price"
70286>>>        Set Label_Justification_mode to jMode_Left
70287>>>        Set Label_Col_Offset to 18
70288>>>        Set Label_row_Offset to 0
70289>>>    End_Object 
70290>>>
70290>>>
70290>>>End_Object 
70291>        Use PageFooterEntry.vw
Including file: PageFooterEntry.vw    (C:\DataFlex Projects\ShoeFactory\AppSrc\PageFooterEntry.vw)
70291>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\PageFooterEntry.vw
70291>>>// PageFooterEntry
70291>>>//
70291>>>
70291>>>Use DFClient.pkg
70291>>>Use DFEntry.pkg
70291>>>Use DfTabDlg.pkg
70291>>>
70291>>>Use cEmployeeDataDictionary.dd
70291>>>Use cLineDataDictionary.dd
70291>>>Use cPageHeaderDataDictionary.dd
70291>>>Use cShoeDataDictionary.dd
70291>>>Use cPageFooterDataDictionary.dd
Including file: cPageFooterDataDictionary.dd    (C:\DataFlex Projects\ShoeFactory\DDSrc\cPageFooterDataDictionary.dd)
70291>>>>>Use DataDict.pkg
70291>>>>>
70291>>>>>Open PageFooter
70293>>>>>Open PageHeader
70295>>>>>Open Shoe
70297>>>>>Open system
70299>>>>>
70299>>>>>Register_Object PageFooter_sl
70299>>>>>
70299>>>>>Class cPageFooterDataDictionary is a DataDictionary
70300>>>>>    
70300>>>>>    Procedure Construct_Object
70302>>>>>        Forward Send Construct_Object
70304>>>>>        Set Main_File to PageFooter.File_Number
70305>>>>>
70305>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
70306>>>>>
70306>>>>>        Set Add_Server_File to PageHeader.File_Number
70307>>>>>        Set Add_Server_File to Shoe.File_Number
70308>>>>>
70308>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
70309>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
70310>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
70311>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
70312>>>>>
70312>>>>>        Set Field_Auto_Increment Field PageFooter.id to File_Field system.page_footer_id
70313>>>>>        Set Field_Prompt_Object Field PageFooter.id to PageFooter_sl
70314>>>>>
70314>>>>>    End_Procedure
70315>>>>>
70315>>>>>End_Class
70316>>>>>
70316>>>>>Use PageFooter.sl
Including file: PageFooter.sl    (C:\DataFlex Projects\ShoeFactory\AppSrc\PageFooter.sl)
70316>>>>>>>// PageFooter.sl
70316>>>>>>>// PageFooter Lookup List
70316>>>>>>>
70316>>>>>>>Use DFClient.pkg
70316>>>>>>>Use cDbCJGridPromptList.pkg
70316>>>>>>>Use cDbCJGridColumn.pkg
70316>>>>>>>Use Windows.pkg
70316>>>>>>>
70316>>>>>>>Use cEmployeeDataDictionary.dd
70316>>>>>>>Use cLineDataDictionary.dd
70316>>>>>>>Use cPageHeaderDataDictionary.dd
70316>>>>>>>Use cShoeDataDictionary.dd
70316>>>>>>>Use cPageFooterDataDictionary.dd
70316>>>>>>>
70316>>>>>>>CD_Popup_Object PageFooter_sl is a dbModalPanel
70334>>>>>>>>
70334>>>>>>>    Set Location to 5 5
70335>>>>>>>    Set Size to 134 141
70336>>>>>>>    Set Label To "PageFooter Lookup List"
70337>>>>>>>    Set Border_Style to Border_Thick
70338>>>>>>>    Set Minimize_Icon to False
70339>>>>>>>
70339>>>>>>>
70339>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
70341>>>>>>>    End_Object 
70342>>>>>>>
70342>>>>>>>    Object oLine_DD is a cLineDataDictionary
70344>>>>>>>    End_Object 
70345>>>>>>>
70345>>>>>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
70347>>>>>>>        Set DDO_Server To oEmployee_DD
70348>>>>>>>        Set DDO_Server To oLine_DD
70349>>>>>>>    End_Object 
70350>>>>>>>
70350>>>>>>>    Object oShoe_DD is a cShoeDataDictionary
70352>>>>>>>    End_Object 
70353>>>>>>>
70353>>>>>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
70355>>>>>>>        Set DDO_Server To oPageHeader_DD
70356>>>>>>>        Set DDO_Server To oShoe_DD
70357>>>>>>>    End_Object 
70358>>>>>>>
70358>>>>>>>    Set Main_DD To oPageFooter_DD
70359>>>>>>>    Set Server  To oPageFooter_DD
70360>>>>>>>
70360>>>>>>>
70360>>>>>>>
70360>>>>>>>    Object oSelList is a cDbCJGridPromptList
70362>>>>>>>        Set Size to 105 131
70363>>>>>>>        Set Location to 5 5
70364>>>>>>>        Set peAnchors to anAll
70365>>>>>>>        Set psLayoutSection to "PageFooter_sl_oSelList"
70366>>>>>>>        Set Ordering to 1
70367>>>>>>>        Set pbAutoServer to True
70368>>>>>>>
70368>>>>>>>        Object oPageFooter_id is a cDbCJGridColumn
70370>>>>>>>            Entry_Item PageFooter.id
70371>>>>>>>            Set piWidth to 46
70372>>>>>>>            Set psCaption to "id"
70373>>>>>>>        End_Object 
70374>>>>>>>
70374>>>>>>>        Object oPageHeader_id is a cDbCJGridColumn
70376>>>>>>>            Entry_Item PageHeader.id
70377>>>>>>>            Set piWidth to 95
70378>>>>>>>            Set psCaption to "page header id"
70379>>>>>>>        End_Object 
70380>>>>>>>
70380>>>>>>>        Object oShoe_id is a cDbCJGridColumn
70382>>>>>>>            Entry_Item Shoe.id
70383>>>>>>>            Set piWidth to 60
70384>>>>>>>            Set psCaption to "shoe id"
70385>>>>>>>        End_Object 
70386>>>>>>>
70386>>>>>>>
70386>>>>>>>    End_Object 
70387>>>>>>>
70387>>>>>>>    Object oOk_bn is a Button
70389>>>>>>>        Set Label to "&Ok"
70390>>>>>>>        Set Location to 115 -22
70391>>>>>>>        Set peAnchors to anBottomRight
70392>>>>>>>
70392>>>>>>>        Procedure OnClick
70395>>>>>>>            Send OK of oSelList
70396>>>>>>>        End_Procedure
70397>>>>>>>
70397>>>>>>>    End_Object 
70398>>>>>>>
70398>>>>>>>    Object oCancel_bn is a Button
70400>>>>>>>        Set Label to "&Cancel"
70401>>>>>>>        Set Location to 115 32
70402>>>>>>>        Set peAnchors to anBottomRight
70403>>>>>>>
70403>>>>>>>        Procedure OnClick
70406>>>>>>>            Send Cancel of oSelList
70407>>>>>>>        End_Procedure
70408>>>>>>>
70408>>>>>>>    End_Object 
70409>>>>>>>
70409>>>>>>>    Object oSearch_bn is a Button
70411>>>>>>>        Set Label to "&Search..."
70412>>>>>>>        Set Location to 115 86
70413>>>>>>>        Set peAnchors to anBottomRight
70414>>>>>>>
70414>>>>>>>        Procedure OnClick
70417>>>>>>>            Send Search of oSelList
70418>>>>>>>        End_Procedure
70419>>>>>>>
70419>>>>>>>    End_Object 
70420>>>>>>>
70420>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
70421>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
70422>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
70423>>>>>>>
70423>>>>>>>
70423>>>>>>>CD_End_Object // PageFooter_sl
70425>>>>>>>>
70425>>>
70425>>>ACTIVATE_VIEW Activate_oPageFooterEntry FOR oPageFooterEntry
70435>>>>
70435>>>Object oPageFooterEntry is a dbView
70437>>>    Set Location to 5 5
70438>>>    Set Size to 79 445
70439>>>    Set Label To "PageFooterEntry"
70440>>>    Set Border_Style to Border_Thick
70441>>>
70441>>>
70441>>>    Object oEmployee_DD is a cEmployeeDataDictionary
70443>>>    End_Object 
70444>>>
70444>>>    Object oLine_DD is a cLineDataDictionary
70446>>>    End_Object 
70447>>>
70447>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
70449>>>        Set DDO_Server To oEmployee_DD
70450>>>        Set DDO_Server To oLine_DD
70451>>>    End_Object 
70452>>>
70452>>>    Object oShoe_DD is a cShoeDataDictionary
70454>>>    End_Object 
70455>>>
70455>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
70457>>>        Set DDO_Server To oPageHeader_DD
70458>>>        Set DDO_Server To oShoe_DD
70459>>>    End_Object 
70460>>>
70460>>>    Set Main_DD To oPageFooter_DD
70461>>>    Set Server  To oPageFooter_DD
70462>>>
70462>>>
70462>>>
70462>>>    Object oPageFooterid is a dbForm
70464>>>        Entry_Item PageFooter.id
70465>>>        Set Size to 12 34
70466>>>        Set Location to 5 13
70467>>>        Set peAnchors to anTopLeftRight
70468>>>        Set Label to "id"
70469>>>        Set Label_Justification_mode to jMode_Left
70470>>>        Set Label_Col_Offset to 8
70471>>>        Set Label_row_Offset to 0
70472>>>    End_Object 
70473>>>
70473>>>    Object oPageHeaderid is a dbForm
70475>>>        Entry_Item PageHeader.id
70476>>>        Set Size to 12 34
70477>>>        Set Location to 5 119
70478>>>        Set peAnchors to anTopRight
70479>>>        Set Label to "page header id"
70480>>>        Set Label_Justification_mode to jMode_Left
70481>>>        Set Label_Col_Offset to 49
70482>>>        Set Label_row_Offset to 0
70483>>>    End_Object 
70484>>>
70484>>>    Object oShoeid is a dbForm
70486>>>        Entry_Item Shoe.id
70487>>>        Set Size to 12 42
70488>>>        Set Location to 5 202
70489>>>        Set peAnchors to anTopRight
70490>>>        Set Label to "shoe id"
70491>>>        Set Label_Justification_mode to jMode_Left
70492>>>        Set Label_Col_Offset to 25
70493>>>        Set Label_row_Offset to 0
70494>>>    End_Object 
70495>>>
70495>>>    Object oTabDialog is a dbTabDialog
70497>>>        Set Size to 47 435
70498>>>        Set Location to 27 5
70499>>>        Set peAnchors to anTopLeftRight
70500>>>
70500>>>        Object oTabPage1 is a dbTabPage
70502>>>            Set Label to "Tab Page Label"
70503>>>
70503>>>            Object oPageHeaderid is a dbForm
70505>>>                Entry_Item PageHeader.id
70506>>>                Set Size to 12 34
70507>>>                Set Location to 10 13
70508>>>                Set peAnchors to anTopLeftRight
70509>>>                Set Label to "id"
70510>>>                Set Label_Justification_mode to jMode_Left
70511>>>                Set Label_Col_Offset to 8
70512>>>                Set Label_row_Offset to 0
70513>>>            End_Object 
70514>>>
70514>>>            Object oEmployeeid is a dbForm
70516>>>                Entry_Item Employee.id
70517>>>                Set Size to 12 34
70518>>>                Set Location to 10 93
70519>>>                Set peAnchors to anTopRight
70520>>>                Set Label to "employee id"
70521>>>                Set Label_Justification_mode to jMode_Left
70522>>>                Set Label_Col_Offset to 41
70523>>>                Set Label_row_Offset to 0
70524>>>            End_Object 
70525>>>
70525>>>            Object oLineid is a dbForm
70527>>>                Entry_Item Line.id
70528>>>                Set Size to 12 34
70529>>>                Set Location to 10 153
70530>>>                Set peAnchors to anTopRight
70531>>>                Set Label to "line id"
70532>>>                Set Label_Justification_mode to jMode_Left
70533>>>                Set Label_Col_Offset to 21
70534>>>                Set Label_row_Offset to 0
70535>>>            End_Object 
70536>>>
70536>>>        End_Object 
70537>>>
70537>>>        Object oTabPage2 is a dbTabPage
70539>>>            Set Label to "Tab Page Label"
70540>>>
70540>>>            Object oShoeid is a dbForm
70542>>>                Entry_Item Shoe.id
70543>>>                Set Size to 12 42
70544>>>                Set Location to 10 13
70545>>>                Set peAnchors to anTopLeftRight
70546>>>                Set Label to "id"
70547>>>                Set Label_Justification_mode to jMode_Left
70548>>>                Set Label_Col_Offset to 8
70549>>>                Set Label_row_Offset to 0
70550>>>            End_Object 
70551>>>
70551>>>            Object oShoename is a dbForm
70553>>>                Entry_Item Shoe.name
70554>>>                Set Size to 12 250
70555>>>                Set Location to 10 80
70556>>>                Set peAnchors to anTopRight
70557>>>                Set Label to "name"
70558>>>                Set Label_Justification_mode to jMode_Left
70559>>>                Set Label_Col_Offset to 20
70560>>>                Set Label_row_Offset to 0
70561>>>            End_Object 
70562>>>
70562>>>            Object oShoeprice is a dbForm
70564>>>                Entry_Item Shoe.price
70565>>>                Set Size to 12 72
70566>>>                Set Location to 10 353
70567>>>                Set peAnchors to anTopRight
70568>>>                Set Label to "price"
70569>>>                Set Label_Justification_mode to jMode_Left
70570>>>                Set Label_Col_Offset to 18
70571>>>                Set Label_row_Offset to 0
70572>>>            End_Object 
70573>>>
70573>>>        End_Object 
70574>>>
70574>>>    End_Object 
70575>>>
70575>>>
70575>>>End_Object 
70576>
70576>        Procedure Activate_About
70579>            Send DoAbout "" "" "" "" ""
70580>        End_Procedure
70581>
70581>    End_Object
70582>
70582>End_Object
70583>
70583>Start_UI
70584>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 41025
Total Resources: 0
Total Commands : 70583
Total Windows  : 0
Total Pages    : 0
Static Data    : 399503
Message area   : 506108
Total Blocks   : 25470
