Compiling Program: C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\Application.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 19.1\Pkg\dfallent.pkd)
67438>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJStandardCommandBarSystem.pkg)
67438>>>// these are all the packages used in a standard MDI menubar/toolbar system
67438>>>
67438>>>Use cCJCommandBarSystem.pkg
67438>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJStandardMenuItemClasses.pkg)
67438>>>>>Use Dfpanel.pkg
67438>>>>>Use cCJCommandBarSystem.pkg
67438>>>>>Use LanguageText.pkg
67438>>>>>
67438>>>>>
67438>>>>>Class cCJUndoMenuItem is a cCJMenuItem
67439>>>>>    
67439>>>>>    Procedure Construct_Object
67441>>>>>        Forward Send Construct_Object
67443>>>>>        Set psCaption   to C_$CaptionUndo
67444>>>>>        Set psToolTip to C_$ToolTipUndo
67445>>>>>        Set psDescription to C_$DescUndo
67446>>>>>        Set psImage to "ActionUndo.ico"
67447>>>>>        Set pbActiveUpdate to True
67448>>>>>        Set psCategory to C_$CategoryEdit
67449>>>>>        Set psShortcut to C_$Key_Ctrl_Z
67450>>>>>    End_Procedure
67451>>>>>    
67451>>>>>    Procedure OnExecute Variant vCommandBarControl
67453>>>>>        Send Undo of (focus(Self))
67454>>>>>    End_Procedure
67455>>>>>    
67455>>>>>    Function IsEnabled Returns Boolean
67457>>>>>        Boolean bEnabled
67457>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
67458>>>>>        Function_Return bEnabled
67459>>>>>    End_Function
67460>>>>>    
67460>>>>>End_Class
67461>>>>>
67461>>>>>
67461>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
67462>>>>>    
67462>>>>>    Procedure Construct_Object
67464>>>>>        Forward Send Construct_Object
67466>>>>>        Set psCaption   to C_$CaptionDelete
67467>>>>>        Set psToolTip to C_$ToolTipDelete
67468>>>>>        Set psDescription to C_$DescDelete
67469>>>>>        Set psImage to "actionDelete.ico"
67470>>>>>        Set psShortcut to C_$Key_Delete
67471>>>>>        Set pbActiveUpdate to True
67472>>>>>        Set psCategory to C_$CategoryEdit
67473>>>>>    End_Procedure
67474>>>>>    
67474>>>>>    
67474>>>>>    Procedure OnExecute Variant vCommandBarControl
67476>>>>>        Send Delete of (focus(Self))
67477>>>>>    End_Procedure
67478>>>>>    
67478>>>>>    Function IsEnabled Returns Boolean
67480>>>>>        Boolean bEnabled
67480>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
67481>>>>>        Function_Return bEnabled
67482>>>>>    End_Function
67483>>>>>    
67483>>>>>End_Class
67484>>>>>
67484>>>>>
67484>>>>>Class cCJCutMenuItem is a cCJMenuItem
67485>>>>>    
67485>>>>>    Procedure Construct_Object
67487>>>>>        Forward Send Construct_Object
67489>>>>>        Set psCaption   to C_$CaptionCut
67490>>>>>        Set psToolTip to C_$TooltipCut
67491>>>>>        Set psDescription to C_$DescCut
67492>>>>>        Set psImage to "actionCut.ico"
67493>>>>>        Set psShortcut to C_$Key_Ctrl_X
67494>>>>>        Set pbActiveUpdate to True
67495>>>>>        Set psCategory to C_$CategoryEdit
67496>>>>>    End_Procedure
67497>>>>>    
67497>>>>>    
67497>>>>>    Procedure OnExecute Variant vCommandBarControl
67499>>>>>        Send Cut of (focus(Self))
67500>>>>>    End_Procedure
67501>>>>>    
67501>>>>>    Function IsEnabled Returns Boolean
67503>>>>>        Boolean bEnabled
67503>>>>>        Get CanCut of (Focus(Self)) to bEnabled
67504>>>>>        Function_Return bEnabled
67505>>>>>    End_Function
67506>>>>>    
67506>>>>>End_Class
67507>>>>>
67507>>>>>
67507>>>>>Class cCJCopyMenuItem is a cCJMenuItem
67508>>>>>    
67508>>>>>    Procedure Construct_Object
67510>>>>>        Forward Send Construct_Object
67512>>>>>        Set psCaption   to C_$CaptionCopy
67513>>>>>        Set psToolTip to C_$ToolTipCopy
67514>>>>>        Set psDescription to C_$DescCopy
67515>>>>>        Set psImage to "actionCopy.ico"
67516>>>>>        Set psShortcut to C_$Key_Ctrl_C
67517>>>>>        Set pbActiveUpdate to True
67518>>>>>        Set psCategory to C_$CategoryEdit
67519>>>>>    End_Procedure
67520>>>>>    
67520>>>>>    
67520>>>>>    Procedure OnExecute Variant vCommandBarControl
67522>>>>>        Send Copy of (focus(Self))
67523>>>>>    End_Procedure
67524>>>>>    
67524>>>>>    Function IsEnabled Returns Boolean
67526>>>>>        Boolean bEnabled
67526>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
67527>>>>>        Function_Return bEnabled
67528>>>>>    End_Function
67529>>>>>    
67529>>>>>End_Class
67530>>>>>
67530>>>>>
67530>>>>>Class cCJPasteMenuItem is a cCJMenuItem
67531>>>>>    
67531>>>>>    Procedure Construct_Object
67533>>>>>        Forward Send Construct_Object
67535>>>>>        Set psCaption   to C_$CaptionPaste
67536>>>>>        Set psToolTip to C_$ToolTipPaste
67537>>>>>        Set psDescription to C_$DescPaste
67538>>>>>        Set psImage to "actionPaste.ico"
67539>>>>>        Set pbActiveUpdate to True
67540>>>>>        Set psShortcut to C_$Key_Ctrl_V
67541>>>>>        Set psCategory to C_$CategoryEdit
67542>>>>>    End_Procedure
67543>>>>>    
67543>>>>>    
67543>>>>>    Procedure OnExecute Variant vCommandBarControl
67545>>>>>        Send Paste of (focus(Self))
67546>>>>>    End_Procedure
67547>>>>>    
67547>>>>>    Function IsEnabled Returns Boolean
67549>>>>>        Boolean bEnabled
67549>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
67550>>>>>        Function_Return bEnabled
67551>>>>>    End_Function
67552>>>>>    
67552>>>>>End_Class
67553>>>>>
67553>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
67554>>>>>    
67554>>>>>    Procedure Construct_Object
67556>>>>>        Forward Send Construct_Object
67558>>>>>        Set psCaption   to C_$CaptionSelectAll
67559>>>>>        Set psToolTip to C_$ToolTipSelectAll
67560>>>>>        Set psDescription to C_$DescSelectAll
67561>>>>>        Set pbActiveUpdate to True
67562>>>>>        Set psShortcut to C_$Key_Ctrl_A
67563>>>>>        Set psCategory to C_$CategoryEdit
67564>>>>>    End_Procedure
67565>>>>>    
67565>>>>>    
67565>>>>>    Procedure OnExecute Variant vCommandBarControl
67567>>>>>        Send Select_All of (focus(Self))
67568>>>>>    End_Procedure
67569>>>>>    
67569>>>>>    Function IsEnabled Returns Boolean
67571>>>>>        Boolean bEnabled
67571>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
67572>>>>>        Function_Return bEnabled
67573>>>>>    End_Function
67574>>>>>    
67574>>>>>End_Class
67575>>>>>
67575>>>>>
67575>>>>>Class cCJExitMenuItem is a cCJMenuItem
67576>>>>>    
67576>>>>>    Procedure Construct_Object
67578>>>>>        Forward Send Construct_Object
67580>>>>>        Set psCaption to C_$CaptionExit
67581>>>>>        Set psToolTip to C_$ToolTipExit
67582>>>>>        Set psDescription to C_$ToolTipExit
67583>>>>>        Set psShortcut to C_$Key_Alt_F4
67584>>>>>        Set psCategory to C_$CategoryFile
67585>>>>>    End_Procedure
67586>>>>>    
67586>>>>>    Procedure OnExecute Variant vCommandBarControl
67588>>>>>        Send Exit_Application of Desktop
67589>>>>>    End_Procedure
67590>>>>>    
67590>>>>>End_Class
67591>>>>>
67591>>>>>Class cCJHelpMenuItem is a cCJMenuItem
67592>>>>>    
67592>>>>>    Procedure Construct_Object
67594>>>>>        Forward Send Construct_Object
67596>>>>>        Set psCaption to C_$CaptionHelp
67597>>>>>        Set psDescription to C_$ToolTipHelp
67598>>>>>        Set psToolTip to C_$DescHelp
67599>>>>>        Set psImage to "ActionHelp.ico"
67600>>>>>        Set psShortcut to "F1"
67601>>>>>        Set psCategory to C_$CategoryHelp
67602>>>>>    End_Procedure
67603>>>>>    
67603>>>>>    Procedure OnExecute Variant vCommandBarControl
67605>>>>>        Send Help of (Focus(Self))
67606>>>>>    End_Procedure
67607>>>>>    
67607>>>>>End_Class
67608>>>>>
67608>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
67609>>>>>    
67609>>>>>    Procedure Construct_Object
67611>>>>>        Forward Send Construct_Object
67613>>>>>        Set psCaption to C_$CaptionAddStatusbar
67614>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
67615>>>>>        Set psDescription to  C_$DescAddStatusbar
67616>>>>>        Set psCategory to C_$CategoryWindow
67617>>>>>    End_Procedure
67618>>>>>    
67618>>>>>    Procedure OnExecute Variant vCommandBarControl
67620>>>>>        Handle hoCommandBars hoClientArea
67620>>>>>        Get CommandBarSystemObject to hoCommandBars
67621>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67622>>>>>        If hoClientArea Begin
67624>>>>>            // the clientarea's parent panel has message
67624>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
67625>>>>>        End
67625>>>>>>
67625>>>>>    End_Procedure
67626>>>>>    
67626>>>>>    Function IsChecked Returns Boolean
67628>>>>>        Boolean bOn
67628>>>>>        Handle hoCommandBars hoClientArea
67628>>>>>        Get CommandBarSystemObject to hoCommandBars
67629>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67630>>>>>        If hoClientArea Begin
67632>>>>>            // the clientarea's parent panel has message
67632>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
67633>>>>>        End
67633>>>>>>
67633>>>>>        Function_Return bOn
67634>>>>>    End_Function
67635>>>>>End_Class
67636>>>>>
67636>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
67637>>>>>    
67637>>>>>    Procedure Construct_Object
67639>>>>>        Forward Send Construct_Object
67641>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
67642>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
67643>>>>>        Set psDescription to C_$DescAutoArrangeIcons
67644>>>>>        Set psCategory to C_$CategoryWindow
67645>>>>>    End_Procedure
67646>>>>>    
67646>>>>>    Procedure OnExecute Variant vCommandBarControl
67648>>>>>        Handle hoCommandBars hoClientArea
67648>>>>>        Get CommandBarSystemObject to hoCommandBars
67649>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67650>>>>>        If hoClientArea Begin
67652>>>>>            // the clientarea's parent panel has message
67652>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
67653>>>>>        End
67653>>>>>>
67653>>>>>    End_Procedure
67654>>>>>    
67654>>>>>    Function IsChecked Returns Boolean
67656>>>>>        Boolean bOn
67656>>>>>        Handle hoCommandBars hoClientArea
67656>>>>>        Get CommandBarSystemObject to hoCommandBars
67657>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67658>>>>>        If hoClientArea Begin
67660>>>>>            // the clientarea's parent panel has message
67660>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
67661>>>>>        End
67661>>>>>>
67661>>>>>        Function_Return bOn
67662>>>>>    End_Function
67663>>>>>End_Class
67664>>>>>
67664>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
67665>>>>>    
67665>>>>>    Procedure Construct_Object
67667>>>>>        Forward Send Construct_Object
67669>>>>>        Set psCaption to C_$CaptionRestoreMenus
67670>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
67671>>>>>        Set psDescription to C_$DescRestoreMenus
67672>>>>>        Set psCategory to C_$CategoryWindow
67673>>>>>    End_Procedure
67674>>>>>    
67674>>>>>    Procedure OnExecute Variant vCommandBarControl
67676>>>>>        Handle hoCommandBars
67676>>>>>        Get CommandBarSystemObject to hoCommandBars
67677>>>>>        Send RestoreLayout of hoCommandBars
67678>>>>>    End_Procedure
67679>>>>>    
67679>>>>>End_Class
67680>>>>>
67680>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
67681>>>>>    
67681>>>>>    Procedure Construct_Object
67683>>>>>        Forward Send Construct_Object
67685>>>>>        Set psCaption to C_$CaptionCascade
67686>>>>>        Set psToolTip to C_$ToolTipCascade
67687>>>>>        Set psDescription to  C_$DescCascade
67688>>>>>        Set psImage to "ActionCascade.ico"
67689>>>>>        Set psCategory to C_$CategoryWindow
67690>>>>>    End_Procedure
67691>>>>>    
67691>>>>>    Procedure OnExecute Variant vCommandBarControl
67693>>>>>        Handle hoCommandBars hoClientArea
67693>>>>>        Get CommandBarSystemObject to hoCommandBars
67694>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67695>>>>>        If hoClientArea Begin
67697>>>>>            Send Cascade_Windows of hoClientArea
67698>>>>>        End
67698>>>>>>
67698>>>>>    End_Procedure
67699>>>>>End_Class
67700>>>>>
67700>>>>>Class cCJTileHorizontally is a cCJMenuItem
67701>>>>>    
67701>>>>>    Procedure Construct_Object
67703>>>>>        Forward Send Construct_Object
67705>>>>>        Set psCaption to C_$CaptionTileHorizontally
67706>>>>>        Set psToolTip to C_$ToolTipTileHorizontally
67707>>>>>        Set psDescription to  C_$DescTileHorizontally
67708>>>>>        Set psImage to "ActionTileHorizontally.ico"
67709>>>>>        Set psCategory to C_$CategoryWindow
67710>>>>>    End_Procedure
67711>>>>>    
67711>>>>>    Procedure OnExecute Variant vCommandBarControl
67713>>>>>        Handle hoCommandBars hoClientArea
67713>>>>>        Get CommandBarSystemObject to hoCommandBars
67714>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67715>>>>>        If hoClientArea Begin
67717>>>>>            Send Tile_Windows_Horizontal of hoClientArea
67718>>>>>        End
67718>>>>>>
67718>>>>>    End_Procedure
67719>>>>>End_Class
67720>>>>>
67720>>>>>Class cCJTileVertically is a cCJMenuItem
67721>>>>>    
67721>>>>>    Procedure Construct_Object
67723>>>>>        Forward Send Construct_Object
67725>>>>>        Set psCaption to C_$CaptionTileVertically
67726>>>>>        Set psToolTip to C_$ToolTipTileVertically
67727>>>>>        Set psDescription to  C_$DescTileVertically
67728>>>>>        Set psImage to "ActionTileVertically.ico"
67729>>>>>        Set psCategory to C_$CategoryWindow
67730>>>>>    End_Procedure
67731>>>>>    
67731>>>>>    Procedure OnExecute Variant vCommandBarControl
67733>>>>>        Handle hoCommandBars hoClientArea
67733>>>>>        Get CommandBarSystemObject to hoCommandBars
67734>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67735>>>>>        If hoClientArea Begin
67737>>>>>            Send Tile_Windows_Vertical of hoClientArea
67738>>>>>        End
67738>>>>>>
67738>>>>>    End_Procedure
67739>>>>>End_Class
67740>>>>>
67740>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
67741>>>>>    
67741>>>>>    Procedure Construct_Object
67743>>>>>        Forward Send Construct_Object
67745>>>>>        Set psCaption to C_$CaptionMinimizeWindows
67746>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
67747>>>>>        Set psDescription to  C_$DescMinimizeWindows
67748>>>>>        Set psCategory to C_$CategoryWindow
67749>>>>>    End_Procedure
67750>>>>>    
67750>>>>>    Procedure OnExecute Variant vCommandBarControl
67752>>>>>        Handle hoCommandBars hoClientArea
67752>>>>>        Get CommandBarSystemObject to hoCommandBars
67753>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67754>>>>>        If hoClientArea Begin
67756>>>>>            // the clientarea's parent panel has message
67756>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
67757>>>>>        End
67757>>>>>>
67757>>>>>    End_Procedure
67758>>>>>End_Class
67759>>>>>
67759>>>>>
67759>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
67760>>>>>    
67760>>>>>    Procedure Construct_Object
67762>>>>>        Forward Send Construct_Object
67764>>>>>        Set psCaption to C_$CaptionRestoreWindows
67765>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
67766>>>>>        Set psDescription to  C_$DescRestoreWindows
67767>>>>>        Set psCategory to C_$CategoryWindow
67768>>>>>    End_Procedure
67769>>>>>    
67769>>>>>    Procedure OnExecute Variant vCommandBarControl
67771>>>>>        Handle hoCommandBars hoClientArea
67771>>>>>        Get CommandBarSystemObject to hoCommandBars
67772>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67773>>>>>        If hoClientArea Begin
67775>>>>>            // the clientarea's parent panel has message
67775>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
67776>>>>>        End
67776>>>>>>
67776>>>>>    End_Procedure
67777>>>>>End_Class
67778>>>>>
67778>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
67779>>>>>    
67779>>>>>    Procedure Construct_Object
67781>>>>>        Forward Send Construct_Object
67783>>>>>        Set psCaption to C_$CaptionArrangeIcons
67784>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
67785>>>>>        Set psDescription to  C_$DescArrangeIcons
67786>>>>>        Set psCategory to C_$CategoryWindow
67787>>>>>    End_Procedure
67788>>>>>    
67788>>>>>    Procedure OnExecute Variant vCommandBarControl
67790>>>>>        Handle hoCommandBars hoClientArea
67790>>>>>        Get CommandBarSystemObject to hoCommandBars
67791>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67792>>>>>        If hoClientArea Begin
67794>>>>>            Send Arrange_Icons of hoClientArea
67795>>>>>        End
67795>>>>>>
67795>>>>>    End_Procedure
67796>>>>>    
67796>>>>>End_Class
67797>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJAboutMenuItem.pkg)
67797>>>>>Use cCJCommandBarSystem.pkg
67797>>>>>Use LanguageText.pkg
67797>>>>>
67797>>>>>// It is expected that if you use this class that you provide an about object that is
67797>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
67797>>>>>// because you may wish to create your own custom about package.
67797>>>>>
67797>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
67798>>>>>
67798>>>>>    Procedure Construct_Object
67800>>>>>        Forward Send Construct_Object
67802>>>>>        Set psCaption to C_$CaptionAbout
67803>>>>>        Set psDescription to C_$ToolTipAbout
67804>>>>>        Set psToolTip to C_$DescAbout
67805>>>>>        Set psImage to "ActionAbout.ico"
67806>>>>>        Set psCategory to C_$CategoryHelp
67807>>>>>    End_Procedure
67808>>>>>    
67808>>>>>    Procedure OnExecute Variant vCommandBarControl
67810>>>>>        Handle hoCommandBars hoClientArea
67810>>>>>        Get CommandBarSystemObject to hoCommandBars
67811>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67812>>>>>        If hoClientArea Begin
67814>>>>>            Send Activate_About of hoClientArea
67815>>>>>        End
67815>>>>>>
67815>>>>>    End_Procedure
67816>>>>>
67816>>>>>End_Class
67817>>>>>
67817>>>>>
67817>>>Use cCJDeoMenuItemClasses.pkg
67817>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJMDIWindowsMenuItem.pkg)
67817>>>>>Use cCJCommandBarSystem.pkg
67817>>>>>
67817>>>>>Register_Function Client_ID Returns Integer
67817>>>>>
67817>>>>>// only used by cCJMDIWIndowsMenuItem
67817>>>>>Class cCJMDIWindowItem is a cCJMenuItem
67818>>>>>    
67818>>>>>    Procedure Construct_Object
67820>>>>>        Forward Send Construct_Object
67822>>>>>        Property Handle phWindow 0 // object id of view
67823>>>>>        Set pbControlFlagNoMovable to True
67824>>>>>        Set pbActiveUpdate to True
67825>>>>>    End_Procedure
67826>>>>>    
67826>>>>>    Procedure OnExecute Variant vCommandBarControl
67828>>>>>        Handle hWindow
67828>>>>>        Get phWindow to hWindow
67829>>>>>        Send Activate_View of hWindow
67830>>>>>    End_Procedure
67831>>>>>    
67831>>>>>End_Class
67832>>>>>
67832>>>>>
67832>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
67833>>>>>    
67833>>>>>    Procedure Construct_Object
67835>>>>>        Forward Send Construct_Object
67837>>>>>        Property Handle[] phArrayOfWindows
67838>>>>>        Set peControlType to xtpControlPopup
67839>>>>>        Set psCategory to C_$CategoryWindow
67840>>>>>    End_Procedure
67841>>>>>    
67841>>>>>    // This adds MDI windows to the existing menu items.
67841>>>>>    // This removes any existing windows menus and always adds a new set to the end
67841>>>>>    
67841>>>>>    Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
67843>>>>>        Handle  hClientArea hView
67843>>>>>        String  sLabel
67843>>>>>        Integer i iWindows
67843>>>>>        Handle[] hArrayOfWindows
67844>>>>>        Variant vItem
67844>>>>>        
67844>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
67844>>>>>        // also assume that destroying an action removes all menu instances of that action
67844>>>>>        Get phArrayOfWindows to hArrayOfWindows
67845>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
67846>>>>>        For i from 0 to (iWindows-1)
67852>>>>>>
67852>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
67853>>>>>        Loop
67854>>>>>>
67854>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
67855>>>>>        
67855>>>>>        // Add all views to this menu. Create the action and add the item
67855>>>>>        Move 0 to i
67856>>>>>        Get Client_Id to hClientArea // object id of client area
67857>>>>>        If (hClientArea > 0) Begin
67859>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
67860>>>>>            While (hView <> 0)
67864>>>>>                If (Active_State(hView)) Begin
67866>>>>>                    // create the action
67866>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
67867>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
67868>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
67869>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
67870>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
67872>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
67873>>>>>                    End
67873>>>>>>
67873>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
67874>>>>>                    If (i=0) Begin
67876>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
67877>>>>>                    End
67877>>>>>>
67877>>>>>                    // Create a menu item for this action
67877>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
67878>>>>>                    Increment i
67879>>>>>                End
67879>>>>>>
67879>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
67880>>>>>            Loop
67881>>>>>>
67881>>>>>        End
67881>>>>>>
67881>>>>>        
67881>>>>>        Set phArrayOfWindows to hArrayOfWindows
67882>>>>>        
67882>>>>>    End_Procedure
67883>>>>>    
67883>>>>>End_Class
67884>
67884>Object oHtmlHelp is a cHtmlHelp
67886>End_Object
67887>
67887>Object oApplication is a cApplication
67889>    Set peHelpType to htHtmlHelp
67890>
67890>    Object oConnection is a cConnection
67892>        Use LoginEncryption.pkg
Including file: LoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\LoginEncryption.pkg)
67892>>>Use cLoginEncryption.pkg
Including file: cLoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cLoginEncryption.pkg)
67892>>>>>Use cCryptographer.pkg
Including file: cCryptographer.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCryptographer.pkg)
67892>>>>>>>Use VdfBase.pkg
67892>>>>>>>
67892>>>>>>>Use CryptographerConstants.pkg
Including file: CryptographerConstants.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\CryptographerConstants.pkg)
67892>>>>>>>>>//   Author  : Ulbe Stellema
67892>>>>>>>>>// Algorithm classes
67892>>>>>>>>>Define ALG_CLASS_ANY                    for |CI$00000000 // (0)
67892>>>>>>>>>Define ALG_CLASS_SIGNATURE              for |CI$00002000 // (1 << 13)
67892>>>>>>>>>Define ALG_CLASS_MSG_ENCRYPT            for |CI$00004000 // (2 << 13)
67892>>>>>>>>>Define ALG_CLASS_DATA_ENCRYPT           for |CI$00006000 // (3 << 13)
67892>>>>>>>>>Define ALG_CLASS_HASH                   for |CI$00008000 // (4 << 13)
67892>>>>>>>>>Define ALG_CLASS_KEY_EXCHANGE           for |CI$0000A000 // (5 << 13)
67892>>>>>>>>>Define ALG_CLASS_ALL                    for |CI$0000E000 // (7 << 13)
67892>>>>>>>>>
67892>>>>>>>>>// Algorithm types
67892>>>>>>>>>Define ALG_TYPE_ANY                     for |CI$00000000 // (0)
67892>>>>>>>>>Define ALG_TYPE_DSS                     for |CI$00000200 // (1 << 9)
67892>>>>>>>>>Define ALG_TYPE_RSA                     for |CI$00000400 // (2 << 9)
67892>>>>>>>>>Define ALG_TYPE_BLOCK                   for |CI$00000600 // (3 << 9)
67892>>>>>>>>>Define ALG_TYPE_STREAM                  for |CI$00000800 // (4 << 9)
67892>>>>>>>>>Define ALG_TYPE_DH                      for |CI$00000A00 // (5 << 9)
67892>>>>>>>>>Define ALG_TYPE_SECURECHANNEL           for |CI$00000C00 // (6 << 9)
67892>>>>>>>>>
67892>>>>>>>>>// Generic sub-ids
67892>>>>>>>>>Define ALG_SID_ANY                      for |CI$00000000 // (0)
67892>>>>>>>>>
67892>>>>>>>>>// RSA sub-ids
67892>>>>>>>>>Define ALG_SID_RSA_ANY                  for 0
67892>>>>>>>>>Define ALG_SID_RSA_PKCS                 for 1
67892>>>>>>>>>Define ALG_SID_RSA_MSATWORK             for 2
67892>>>>>>>>>Define ALG_SID_RSA_ENTRUST              for 3
67892>>>>>>>>>Define ALG_SID_RSA_PGP                  for 4
67892>>>>>>>>>
67892>>>>>>>>>// DSS sub-ids
67892>>>>>>>>>Define ALG_SID_DSS_ANY                  for 0
67892>>>>>>>>>Define ALG_SID_DSS_PKCS                 for 1
67892>>>>>>>>>Define ALG_SID_DSS_DMS                  for 2
67892>>>>>>>>>
67892>>>>>>>>>// DES sub_ids
67892>>>>>>>>>Define ALG_SID_DES                      for 1
67892>>>>>>>>>Define ALG_SID_3DES                     for 3
67892>>>>>>>>>Define ALG_SID_DESX                     for 4
67892>>>>>>>>>Define ALG_SID_IDEA                     for 5
67892>>>>>>>>>Define ALG_SID_CAST                     for 6
67892>>>>>>>>>Define ALG_SID_SAFERSK64                for 7
67892>>>>>>>>>Define ALG_SID_SAFERSK128               for 8
67892>>>>>>>>>Define ALG_SID_3DES_112                 for 9
67892>>>>>>>>>Define ALG_SID_CYLINK_MEK               for 12
67892>>>>>>>>>Define ALG_SID_RC5                      for 13
67892>>>>>>>>>Define ALG_SID_AES_128                  for 14
67892>>>>>>>>>Define ALG_SID_AES_192                  for 15
67892>>>>>>>>>Define ALG_SID_AES_256                  for 16
67892>>>>>>>>>Define ALG_SID_AES                      for 17
67892>>>>>>>>>
67892>>>>>>>>>// Fortezza sub-ids
67892>>>>>>>>>Define ALG_SID_SKIPJACK                 for 10
67892>>>>>>>>>Define ALG_SID_TEK                      for 11
67892>>>>>>>>>
67892>>>>>>>>>// RC2 sub-ids
67892>>>>>>>>>Define ALG_SID_RC2                      for 2
67892>>>>>>>>>
67892>>>>>>>>>// Stream cipher sub-ids
67892>>>>>>>>>Define ALG_SID_RC4                      for 1
67892>>>>>>>>>Define ALG_SID_SEAL                     for 2
67892>>>>>>>>>
67892>>>>>>>>>// Diffie-Hellman sub-ids
67892>>>>>>>>>Define ALG_SID_DH_SANDF                 for 1
67892>>>>>>>>>Define ALG_SID_DH_EPHEM                 for 2
67892>>>>>>>>>Define ALG_SID_AGREED_KEY_ANY           for 3
67892>>>>>>>>>Define ALG_SID_KEA                      for 4
67892>>>>>>>>>
67892>>>>>>>>>// Hash sub ids
67892>>>>>>>>>Define ALG_SID_MD2                      for 1
67892>>>>>>>>>Define ALG_SID_MD4                      for 2
67892>>>>>>>>>Define ALG_SID_MD5                      for 3
67892>>>>>>>>>Define ALG_SID_SHA                      for 4
67892>>>>>>>>>Define ALG_SID_SHA1                     for 4
67892>>>>>>>>>Define ALG_SID_MAC                      for 5
67892>>>>>>>>>Define ALG_SID_RIPEMD                   for 6
67892>>>>>>>>>Define ALG_SID_RIPEMD160                for 7
67892>>>>>>>>>Define ALG_SID_SSL3SHAMD5               for 8
67892>>>>>>>>>Define ALG_SID_HMAC                     for 9
67892>>>>>>>>>Define ALG_SID_TLS1PRF                  for 10
67892>>>>>>>>>Define ALG_SID_HASH_REPLACE_OWF         for 11
67892>>>>>>>>>Define ALG_SID_SHA_256                  for 12
67892>>>>>>>>>Define ALG_SID_SHA_384                  for 13
67892>>>>>>>>>Define ALG_SID_SHA_512                  for 14
67892>>>>>>>>>
67892>>>>>>>>>// secure channel sub ids
67892>>>>>>>>>Define ALG_SID_SSL3_MASTER              for 1
67892>>>>>>>>>Define ALG_SID_SCHANNEL_MASTER_HASH     for 2
67892>>>>>>>>>Define ALG_SID_SCHANNEL_MAC_KEY         for 3
67892>>>>>>>>>Define ALG_SID_PCT1_MASTER              for 4
67892>>>>>>>>>Define ALG_SID_SSL2_MASTER              for 5
67892>>>>>>>>>Define ALG_SID_TLS1_MASTER              for 6
67892>>>>>>>>>Define ALG_SID_SCHANNEL_ENC_KEY         for 7
67892>>>>>>>>>
67892>>>>>>>>>// algorithm identifier definitions
67892>>>>>>>>>Define CALG_MD2                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD2)
67892>>>>>>>>>Define CALG_MD4                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD4)
67892>>>>>>>>>Define CALG_MD5                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD5)
67892>>>>>>>>>Define CALG_SHA                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA)
67892>>>>>>>>>Define CALG_SHA1                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA1)
67892>>>>>>>>>Define CALG_MAC                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MAC)
67892>>>>>>>>>Define CALG_RSA_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
67892>>>>>>>>>Define CALG_DSS_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_DSS ior ALG_SID_DSS_ANY)
67892>>>>>>>>>Define CALG_NO_SIGN                     for (ALG_CLASS_SIGNATURE ior ALG_TYPE_ANY ior ALG_SID_ANY)
67892>>>>>>>>>Define CALG_RSA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
67892>>>>>>>>>Define CALG_DES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DES)
67892>>>>>>>>>Define CALG_3DES_112                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES_112)
67892>>>>>>>>>Define CALG_3DES                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES)
67892>>>>>>>>>Define CALG_DESX                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DESX)
67892>>>>>>>>>Define CALG_RC2                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC2)
67892>>>>>>>>>Define CALG_RC4                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_RC4)
67892>>>>>>>>>Define CALG_SEAL                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_SEAL)
67892>>>>>>>>>Define CALG_DH_SF                       for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_SANDF)
67892>>>>>>>>>Define CALG_DH_EPHEM                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_EPHEM)
67892>>>>>>>>>Define CALG_AGREEDKEY_ANY               for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_AGREED_KEY_ANY)
67892>>>>>>>>>Define CALG_KEA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_KEA)
67892>>>>>>>>>Define CALG_HUGHES_MD5                  for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_ANY ior ALG_SID_MD5)
67892>>>>>>>>>Define CALG_SKIPJACK                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_SKIPJACK)
67892>>>>>>>>>Define CALG_TEK                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_TEK)
67892>>>>>>>>>Define CALG_CYLINK_MEK                  for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_CYLINK_MEK)
67892>>>>>>>>>Define CALG_SSL3_SHAMD5                 for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SSL3SHAMD5)
67892>>>>>>>>>Define CALG_SSL3_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL3_MASTER)
67892>>>>>>>>>Define CALG_SCHANNEL_MASTER_HASH        for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MASTER_HASH)
67892>>>>>>>>>Define CALG_SCHANNEL_MAC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MAC_KEY)
67892>>>>>>>>>Define CALG_SCHANNEL_ENC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_ENC_KEY)
67892>>>>>>>>>Define CALG_PCT1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_PCT1_MASTER)
67892>>>>>>>>>Define CALG_SSL2_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL2_MASTER)
67892>>>>>>>>>Define CALG_TLS1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_TLS1_MASTER)
67892>>>>>>>>>Define CALG_RC5                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC5)
67892>>>>>>>>>Define CALG_HMAC                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HMAC)
67892>>>>>>>>>Define CALG_TLS1PRF                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_TLS1PRF)
67892>>>>>>>>>Define CALG_HASH_REPLACE_OWF            for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HASH_REPLACE_OWF)
67892>>>>>>>>>Define CALG_AES_128                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_128)
67892>>>>>>>>>Define CALG_AES_192                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_192)
67892>>>>>>>>>Define CALG_AES_256                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_256)
67892>>>>>>>>>Define CALG_AES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES)
67892>>>>>>>>>Define CALG_SHA_256                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_256)
67892>>>>>>>>>Define CALG_SHA_384                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_384)
67892>>>>>>>>>Define CALG_SHA_512                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_512)
67892>>>>>>>>>
67892>>>>>>>>>// Providers
67892>>>>>>>>>Define MS_DEF_PROV                      for "Microsoft Base Cryptographic Provider v1.0"
67892>>>>>>>>>Define MS_ENHANCED_PROV                 for "Microsoft Enhanced Cryptographic Provider v1.0"
67892>>>>>>>>>Define MS_STRONG_PROV                   for "Microsoft Strong Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_RSA_SIG_PROV              for "Microsoft RSA Signature Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_RSA_SCHANNEL_PROV         for "Microsoft RSA SChannel Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DSS_PROV                  for "Microsoft Base DSS Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DSS_DH_PROV               for "Microsoft Base DSS and Diffie-Hellman Cryptographic Provider"
67892>>>>>>>>>Define MS_ENH_DSS_DH_PROV               for "Microsoft Enhanced DSS and Diffie-Hellman Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DH_SCHANNEL_PROV          for "Microsoft DH SChannel Cryptographic Provider"
67892>>>>>>>>>Define MS_SCARD_PROV                    for "Microsoft Base Smart Card Crypto Provider"
67892>>>>>>>>>Define MS_ENH_RSA_AES_PROV              for "Microsoft Enhanced RSA and AES Cryptographic Provider"
67892>>>>>>>>>
67892>>>>>>>>>// dwFlags definitions for CryptAcquireContext
67892>>>>>>>>>Define CRYPT_VERIFYCONTEXT              for |CI$F0000000
67892>>>>>>>>>Define CRYPT_NEWKEYSET                  for |CI$00000008
67892>>>>>>>>>Define CRYPT_DELETEKEYSET               for |CI$00000010
67892>>>>>>>>>Define CRYPT_MACHINE_KEYSET             for |CI$00000020
67892>>>>>>>>>Define CRYPT_SILENT                     for |CI$00000040
67892>>>>>>>>>
67892>>>>>>>>>// dwFlag definitions for CryptGenKey
67892>>>>>>>>>Define CRYPT_EXPORTABLE                 for |CI$00000001
67892>>>>>>>>>Define CRYPT_USER_PROTECTED             for |CI$00000002
67892>>>>>>>>>Define CRYPT_CREATE_SALT                for |CI$00000004
67892>>>>>>>>>Define CRYPT_UPDATE_KEY                 for |CI$00000008
67892>>>>>>>>>Define CRYPT_NO_SALT                    for |CI$00000010
67892>>>>>>>>>Define CRYPT_PREGEN                     for |CI$00000040
67892>>>>>>>>>Define CRYPT_RECIPIENT                  for |CI$00000010
67892>>>>>>>>>Define CRYPT_INITIATOR                  for |CI$00000040
67892>>>>>>>>>Define CRYPT_ONLINE                     for |CI$00000080
67892>>>>>>>>>Define CRYPT_SF                         for |CI$00000100
67892>>>>>>>>>Define CRYPT_CREATE_IV                  for |CI$00000200
67892>>>>>>>>>Define CRYPT_KEK                        for |CI$00000400
67892>>>>>>>>>Define CRYPT_DATA_KEY                   for |CI$00000800
67892>>>>>>>>>Define CRYPT_VOLATILE                   for |CI$00001000
67892>>>>>>>>>Define CRYPT_SGCKEY                     for |CI$00002000
67892>>>>>>>>>Define CRYPT_ARCHIVABLE                 for |CI$00004000
67892>>>>>>>>>
67892>>>>>>>>>// Provider types
67892>>>>>>>>>Define PROV_RSA_FULL                    for 1
67892>>>>>>>>>Define PROV_RSA_SIG                     for 2
67892>>>>>>>>>Define PROV_DSS                         for 3
67892>>>>>>>>>Define PROV_FORTEZZA                    for 4
67892>>>>>>>>>Define PROV_MS_EXCHANGE                 for 5
67892>>>>>>>>>Define PROV_SSL                         for 6
67892>>>>>>>>>Define PROV_RSA_SCHANNEL                for 12
67892>>>>>>>>>Define PROV_DSS_DH                      for 13
67892>>>>>>>>>Define PROV_EC_ECDSA_SIG                for 14
67892>>>>>>>>>Define PROV_EC_ECNRA_SIG                for 15
67892>>>>>>>>>Define PROV_EC_ECDSA_FULL               for 16
67892>>>>>>>>>Define PROV_EC_ECNRA_FULL               for 17
67892>>>>>>>>>Define PROV_DH_SCHANNEL                 for 18
67892>>>>>>>>>Define PROV_SPYRUS_LYNKS                for 20
67892>>>>>>>>>Define PROV_RNG                         for 21
67892>>>>>>>>>Define PROV_INTEL_SEC                   for 22
67892>>>>>>>>>Define PROV_REPLACE_OWF                 for 23
67892>>>>>>>>>Define PROV_RSA_AES                     for 24
67892>>>>>>>>>
67892>>>>>>>>>// KP_MODE
67892>>>>>>>>>// KP_MODE
67892>>>>>>>>>Define CRYPT_MODE_CBC                   for 1       // Cipher block chaining
67892>>>>>>>>>Define CRYPT_MODE_ECB                   for 2       // Electronic code book
67892>>>>>>>>>Define CRYPT_MODE_OFB                   for 3       // Output feedback mode
67892>>>>>>>>>Define CRYPT_MODE_CFB                   for 4       // Cipher feedback mode
67892>>>>>>>>>Define CRYPT_MODE_CTS                   for 5       // Ciphertext stealing mode
67892>>>>>>>>>Define CRYPT_MODE_CBCI                  for 6       // ANSI CBC Interleaved
67892>>>>>>>>>Define CRYPT_MODE_CFBP                  for 7       // ANSI CFB Pipelined
67892>>>>>>>>>Define CRYPT_MODE_OFBP                  for 8       // ANSI OFB Pipelined
67892>>>>>>>>>Define CRYPT_MODE_CBCOFM                for 9       // ANSI CBC + OF Masking
67892>>>>>>>>>Define CRYPT_MODE_CBCOFMI               for 10      // ANSI CBC + OFM Interleaved
67892>>>>>>>>>
67892>>>>>>>>>// dwParam definitions for CryptGetKeyParam
67892>>>>>>>>>Define KP_IV                            for 1       // Initialization vector
67892>>>>>>>>>Define KP_SALT                          for 2       // Salt value
67892>>>>>>>>>Define KP_PADDING                       for 3       // Padding values
67892>>>>>>>>>Define KP_MODE                          for 4       // Mode of the cipher
67892>>>>>>>>>Define KP_MODE_BITS                     for 5       // Number of bits to feedback
67892>>>>>>>>>Define KP_PERMISSIONS                   for 6       // Key permissions DWORD
67892>>>>>>>>>Define KP_ALGID                         for 7       // Key algorithm
67892>>>>>>>>>Define KP_BLOCKLEN                      for 8       // Block size of the cipher
67892>>>>>>>>>Define KP_KEYLEN                        for 9       // Length of key in bits
67892>>>>>>>>>Define KP_SALT_EX                       for 10      // Length of salt in bytes
67892>>>>>>>>>Define KP_P                             for 11      // DSS/Diffie-Hellman P value
67892>>>>>>>>>Define KP_G                             for 12      // DSS/Diffie-Hellman G value
67892>>>>>>>>>Define KP_Q                             for 13      // DSS Q value
67892>>>>>>>>>Define KP_X                             for 14      // Diffie-Hellman X value
67892>>>>>>>>>Define KP_Y                             for 15      // Y value
67892>>>>>>>>>Define KP_RA                            for 16      // Fortezza RA value
67892>>>>>>>>>Define KP_RB                            for 17      // Fortezza RB value
67892>>>>>>>>>Define KP_INFO                          for 18      // for putting information into an RSA envelope
67892>>>>>>>>>Define KP_EFFECTIVE_KEYLEN              for 19      // setting and getting RC2 effective key length
67892>>>>>>>>>Define KP_SCHANNEL_ALG                  for 20      // for setting the Secure Channel algorithms
67892>>>>>>>>>Define KP_CLIENT_RANDOM                 for 21      // for setting the Secure Channel client random data
67892>>>>>>>>>Define KP_SERVER_RANDOM                 for 22      // for setting the Secure Channel server random data
67892>>>>>>>>>Define KP_RP                            for 23
67892>>>>>>>>>Define KP_PRECOMP_MD5                   for 24
67892>>>>>>>>>Define KP_PRECOMP_SHA                   for 25
67892>>>>>>>>>Define KP_CERTIFICATE                   for 26      // for setting Secure Channel certificate data (PCT1)
67892>>>>>>>>>Define KP_CLEAR_KEY                     for 27      // for setting Secure Channel clear key data (PCT1)
67892>>>>>>>>>Define KP_PUB_EX_LEN                    for 28
67892>>>>>>>>>Define KP_PUB_EX_VAL                    for 29
67892>>>>>>>>>Define KP_KEYVAL                        for 30
67892>>>>>>>>>Define KP_ADMIN_PIN                     for 31
67892>>>>>>>>>Define KP_KEYEXCHANGE_PIN               for 32
67892>>>>>>>>>Define KP_SIGNATURE_PIN                 for 33
67892>>>>>>>>>Define KP_PREHASH                       for 34
67892>>>>>>>>>Define KP_ROUNDS                        for 35
67892>>>>>>>>>Define KP_OAEP_PARAMS                   for 36      // for setting OAEP params on RSA keys
67892>>>>>>>>>Define KP_CMS_KEY_INFO                  for 37
67892>>>>>>>>>Define KP_CMS_DH_KEY_INFO               for 38
67892>>>>>>>>>Define KP_PUB_PARAMS                    for 39      // for setting public parameters
67892>>>>>>>>>Define KP_VERIFY_PARAMS                 for 40      // for verifying DSA and DH parameters
67892>>>>>>>>>Define KP_HIGHEST_VERSION               for 41      // for TLS protocol version setting
67892>>>>>>>>>Define KP_GET_USE_COUNT                 for 42      // for use with PP_CRYPT_COUNT_KEY_USE contexts
67892>>>>>>>>>
67892>>>>>>>>>// dwParam definitions for CryptGetHashParam
67892>>>>>>>>>Define HP_ALGID                         for |CI$0001  // Hash algorithm
67892>>>>>>>>>Define HP_HASHVAL                       for |CI$0002  // Hash value
67892>>>>>>>>>Define HP_HASHSIZE                      for |CI$0004  // Hash value size
67892>>>>>>>>>Define HP_HMAC_INFO                     for |CI$0005  // information for creating an HMA
67892>>>>>>>>>
67892>>>>>>>>>// key BLOB types
67892>>>>>>>>>Define KEYSTATEBLOB                     for |CI$0C
67892>>>>>>>>>Define OPAQUEKEYBLOB                    for |CI$09
67892>>>>>>>>>Define PLAINTEXTKEYBLOB                 for |CI$08
67892>>>>>>>>>Define PRIVATEKEYBLOB                   for |CI$07
67892>>>>>>>>>Define PUBLICKEYBLOB                    for |CI$06
67892>>>>>>>>>Define PUBLICKEYBLOBEX                  for |CI$0A
67892>>>>>>>>>Define SIMPLEBLOB                       for |CI$01
67892>>>>>>>>>Define SYMMETRICWRAPKEYBLOB             for |CI$0B
67892>>>>>>>>>
67892>>>>>>>>>Define CUR_BLOB_VERSION                 for 2
67892>>>>>>>>>
67892>>>>>>>>>//  Structure cryptimportkey
67892>>>>>>>>>Struct PUBLICKEYSTRUC
67892>>>>>>>>>    UChar    bType
67892>>>>>>>>>    UChar    bVersion
67892>>>>>>>>>    UShort   reserved
67892>>>>>>>>>    UInteger aiKeyAlg
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>Struct tPLAINTEXTKEYBLOB
67892>>>>>>>>>    PUBLICKEYSTRUC hdr
67892>>>>>>>>>    PUBLICKEYSTRUC hdr
67892>>>>>>>>>    UInteger       dwKeySize
67892>>>>>>>>>//    UChar[]        rgbKeyData
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>//  Structure for specifying the inner and outer strings when calculating HMAC hash (use with CryptSetHashParam)
67892>>>>>>>>>Struct HMAC_INFO
67892>>>>>>>>>    UInteger HashAlgid
67892>>>>>>>>>    Pointer pbInnerString
67892>>>>>>>>>    DWord cbInnerString
67892>>>>>>>>>    Pointer pbOuterString
67892>>>>>>>>>    DWord cbOuterString
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>External_Function CryptAcquireContext "CryptAcquireContextA" advapi32.dll ;    Pointer phProv ;    Pointer szContainer ;    Pointer szProvider ;    Integer dwProvType ;    Integer dwFlags ;    Returns Boolean
67893>>>>>>>>>
67893>>>>>>>>>External_Function CryptReleaseContext "CryptReleaseContext" advapi32.dll ;    Handle hProv ;    Integer dwFlags ;    Returns Boolean
67894>>>>>>>>>
67894>>>>>>>>>External_Function CryptCreateHash "CryptCreateHash" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hKey ;    Integer dwFlags ;    Pointer phHash ;    Returns Boolean
67895>>>>>>>>>
67895>>>>>>>>>External_Function CryptDestroyHash "CryptDestroyHash" advapi32.dll ;    Handle hHash ;    Returns Boolean
67896>>>>>>>>>
67896>>>>>>>>>External_Function CryptHashData "CryptHashData" advapi32.dll ;    Handle hHash ;    Pointer pbData ;    Integer dwDataLen ;    Integer dwFlags ;    Returns Boolean
67897>>>>>>>>>
67897>>>>>>>>>External_Function CryptDeriveKey "CryptDeriveKey" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hBaseData ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
67898>>>>>>>>>
67898>>>>>>>>>External_Function CryptGetHashParam "CryptGetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    DWord dwFlags ;    Returns Integer
67899>>>>>>>>>
67899>>>>>>>>>External_Function CryptDestroyKey "CryptDestroyKey" advapi32.dll ;    Handle hKey ;    Returns Boolean
67900>>>>>>>>>
67900>>>>>>>>>External_Function CryptImportKey "CryptImportKey" advapi32.dll ;    Handle hProv ;    Pointer pbData ;    Integer dwDataLen ;    Handle hPubKey ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
67901>>>>>>>>>
67901>>>>>>>>>External_Function CryptGetKeyParam "CryptGetKeyParam" advapi32.dll ;    Handle hKey ;    Integer dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwFlags ;    Returns Boolean
67902>>>>>>>>>    
67902>>>>>>>>>External_Function CryptSetKeyParam "CryptSetKeyParam" advapi32.dll ;    Handle   hKey ;    UInteger dwParam ;    Pointer  pbdata ;    UInteger dwFlags ;    Returns  Boolean
67903>>>>>>>>>
67903>>>>>>>>>External_Function CryptEncrypt "CryptEncrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwBufLen ;    Returns Boolean
67904>>>>>>>>>
67904>>>>>>>>>External_Function CryptDecrypt "CryptDecrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Returns Boolean
67905>>>>>>>>>
67905>>>>>>>>>External_Function CryptGenRandom "CryptGenRandom" advapi32.dll ;    Handle hProv ;    DWord dwLen ;    Pointer pbBuffer ;    Returns Boolean
67906>>>>>>>>>    
67906>>>>>>>>>External_Function CryptSetHashParam "CryptSetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Integer dwFlags ;    Returns Boolean
67907>>>>>>>>>    
67907>>>>>>>
67907>>>>>>>Class cCryptographer is a cObject
67908>>>>>>>    
67908>>>>>>>    Procedure Construct_Object
67910>>>>>>>        Forward Send Construct_Object
67912>>>>>>>        
67912>>>>>>>        Property String     psProvider  MS_ENHANCED_PROV
67913>>>>>>>        Property Integer    piProvider  PROV_RSA_FULL
67914>>>>>>>        Property Integer    piCipher    CALG_RC4
67915>>>>>>>        Property Integer    piHash      CALG_MD5
67916>>>>>>>        
67916>>>>>>>        // Private properties
67916>>>>>>>        Property Handle     Private_phProv
67917>>>>>>>    End_Procedure
67918>>>>>>>    
67918>>>>>>>    
67918>>>>>>>    // Acquire key container handle
67918>>>>>>>    Function AcquireContext Returns Handle
67920>>>>>>>        Integer iProvider
67920>>>>>>>        String sProvider
67920>>>>>>>        Handle hProv
67920>>>>>>>        Boolean bOk
67920>>>>>>>        Address addrProv
67920>>>>>>>        
67920>>>>>>>        Move 0 to hProv
67921>>>>>>>        Get piProvider to iProvider
67922>>>>>>>        Get psProvider to sProvider
67923>>>>>>>        
67923>>>>>>>        //  Determine address to be passed as provider
67923>>>>>>>        If (Trim(sProvider) <> "") Begin
67925>>>>>>>            Move (AddressOf(sProvider)) to addrProv
67926>>>>>>>        End
67926>>>>>>>>
67926>>>>>>>        Else Begin
67927>>>>>>>            Move 0 to addrProv
67928>>>>>>>        End
67928>>>>>>>>
67928>>>>>>>        
67928>>>>>>>        //  Acquire Crypto Context
67928>>>>>>>        Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_VERIFYCONTEXT)) to bOk
67929>>>>>>>        If (not(bOk) or hProv = 0) Begin
67931>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET ior CRYPT_VERIFYCONTEXT)) to bOk
67932>>>>>>>        End
67932>>>>>>>>
67932>>>>>>>        
67932>>>>>>>        If (not(bOk) or hProv = 0) Begin
67934>>>>>>>            // Fallback to original
67934>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,0)) to bOk
67935>>>>>>>            
67935>>>>>>>            If (not(bOk) or hProv = 0) Begin
67937>>>>>>>                Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET)) to bOk
67938>>>>>>>            End
67938>>>>>>>>
67938>>>>>>>        End
67938>>>>>>>>
67938>>>>>>>        Set Private_phProv to hProv
67939>>>>>>>        
67939>>>>>>>        Function_Return hProv
67940>>>>>>>    End_Function
67941>>>>>>>    
67941>>>>>>>    // Releases key container handle
67941>>>>>>>    Function ReleaseContext Handle hProv Returns Boolean
67943>>>>>>>        Function_Return (CryptReleaseContext(hProv,0))
67944>>>>>>>    End_Function
67945>>>>>>>    
67945>>>>>>>    // Creates hash object
67945>>>>>>>    Function CreateHash Handle hProv Returns Handle
67947>>>>>>>        Integer iAlgorithm
67947>>>>>>>        Handle hHash
67947>>>>>>>        Boolean bOk
67947>>>>>>>        
67947>>>>>>>        Move 0 to hHash
67948>>>>>>>        Get piHash to iAlgorithm
67949>>>>>>>        Move (CryptCreateHash(hProv,iAlgorithm,0,0,AddressOf(hHash))) to bOk
67950>>>>>>>        
67950>>>>>>>        Function_Return hHash
67951>>>>>>>    End_Function
67952>>>>>>>    
67952>>>>>>>    // Destroys the hash object
67952>>>>>>>    Function DestroyHash Handle hHash Returns Boolean
67954>>>>>>>        Function_Return (CryptDestroyHash(hHash))
67955>>>>>>>    End_Function
67956>>>>>>>    
67956>>>>>>>    // Adds data to hash object
67956>>>>>>>    Function HashData Handle hHash String sData Returns Boolean
67958>>>>>>>        Function_Return (CryptHashData(hHash,AddressOf(sData),Length(sData),0))
67959>>>>>>>    End_Function
67960>>>>>>>    
67960>>>>>>>    // Generates session key
67960>>>>>>>    Function DeriveKey Handle hProv Handle hHash Returns Handle
67962>>>>>>>        Integer iAlgorithm
67962>>>>>>>        Handle hKey
67962>>>>>>>        Boolean bOk
67962>>>>>>>        
67962>>>>>>>        Move 0 to hKey
67963>>>>>>>        Get piCipher to iAlgorithm
67964>>>>>>>        Move (CryptDeriveKey(hProv,iAlgorithm,hHash,CRYPT_EXPORTABLE,AddressOf(hKey))) to bOk
67965>>>>>>>        
67965>>>>>>>        Function_Return hKey
67966>>>>>>>    End_Function
67967>>>>>>>    
67967>>>>>>>    // Imports a plain text key
67967>>>>>>>    Function ImportPlainTextKey Handle hProv UChar[] ucaKey Returns Handle
67969>>>>>>>        tPLAINTEXTKEYBLOB blobhead
67969>>>>>>>        tPLAINTEXTKEYBLOB blobhead
67969>>>>>>>        Boolean   bSuccess
67969>>>>>>>        Handle    hKey
67969>>>>>>>        Integer   iHeadSize iKeySize
67969>>>>>>>        UChar[]   ucaKeyblob
67970>>>>>>>        Integer iVoid
67970>>>>>>>        
67970>>>>>>>        Move (SizeOfType(tPLAINTEXTKEYBLOB)) to iHeadSize
67971>>>>>>>        Move (SizeOfArray(ucaKey)) to iKeySize
67972>>>>>>>        
67972>>>>>>>        Move PLAINTEXTKEYBLOB to blobhead.hdr.bType
67973>>>>>>>        Move CUR_BLOB_VERSION   to blobhead.hdr.bVersion
67974>>>>>>>        Get piCipher            to blobhead.hdr.aiKeyAlg
67975>>>>>>>        Move iKeySize           to blobhead.dwKeySize
67976>>>>>>>        
67976>>>>>>>        Move (ResizeArray(ucaKeyblob, iHeadSize)) to ucaKeyblob
67977>>>>>>>        Move (CopyMemory(AddressOf(ucaKeyblob), AddressOf(blobhead), iHeadSize)) to iVoid
67978>>>>>>>        Move (AppendArray(ucaKeyblob, ucaKey)) to ucaKeyblob
67979>>>>>>>        
67979>>>>>>>        Move 0 to hKey
67980>>>>>>>        Move (CryptImportKey(hProv, AddressOf(ucaKeyblob), SizeOfArray(ucaKeyblob), 0, 0, AddressOf(hKey))) to bSuccess
67981>>>>>>>        If (not(bSuccess)) Begin
67983>>>>>>>            Move (ShowLastError()) to iVoid
67984>>>>>>>        End
67984>>>>>>>>
67984>>>>>>>        
67984>>>>>>>        Function_Return hKey
67985>>>>>>>    End_Function
67986>>>>>>>    
67986>>>>>>>    // Destroys the key
67986>>>>>>>    Function DestroyKey Handle hKey Returns Boolean
67988>>>>>>>        Function_Return (CryptDestroyKey(hKey))
67989>>>>>>>    End_Function
67990>>>>>>>    
67990>>>>>>>    // Retrieves key data
67990>>>>>>>    Function KeyParameter Handle hKey Integer iQuery Returns Integer
67992>>>>>>>        Integer iBuffer iLen
67992>>>>>>>        Boolean bOk
67992>>>>>>>        
67992>>>>>>>        Move (SizeOfType(Integer)) to iLen
67993>>>>>>>        Move (CryptGetKeyParam(hKey,iQuery,AddressOf(iBuffer),AddressOf(iLen),0)) to bOk
67994>>>>>>>        Function_Return iBuffer
67995>>>>>>>    End_Function
67996>>>>>>>    
67996>>>>>>>    // Retrieves a hash value
67996>>>>>>>    Function HashValue Handle lhHash Returns String
67998>>>>>>>        String  lsHash
67998>>>>>>>        Integer liResult
67998>>>>>>>        DWord   dwDataLen
67998>>>>>>>        
67998>>>>>>>        Move 0 to dwDataLen
67999>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,0,AddressOf(dwDataLen),0)) to liResult
68000>>>>>>>        If (liResult = 0) ;            Function_Return ""
68003>>>>>>>        
68003>>>>>>>        Move (Repeat(Character(0),dwDataLen)) to lsHash
68004>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,AddressOf(lsHash),AddressOf(dwDataLen),0)) to liResult
68005>>>>>>>        If (liResult = 0) ;            Function_Return ""
68008>>>>>>>        
68008>>>>>>>        Function_Return lsHash
68009>>>>>>>    End_Function
68010>>>>>>>
68010>>>>>>>    // Encrypts data
68010>>>>>>>    Function Encrypt String sPassword String sData Returns String
68012>>>>>>>        Handle hProv hHash hKey
68012>>>>>>>        Integer iAlgorithm iDataLen iCipherLen iErr
68012>>>>>>>        Boolean bOk
68012>>>>>>>        
68012>>>>>>>        Get AcquireContext to hProv
68013>>>>>>>        If (hProv) Begin
68015>>>>>>>            Get CreateHash hProv to hHash
68016>>>>>>>            If (hHash) Begin
68018>>>>>>>                Get HashData hHash sPassword to bOk
68019>>>>>>>                If (bOk) Begin
68021>>>>>>>                    Get piCipher to iAlgorithm
68022>>>>>>>                    Get DeriveKey hProv hHash to hKey
68023>>>>>>>                End
68023>>>>>>>>
68023>>>>>>>                Get DestroyHash hHash to bOk
68024>>>>>>>            End
68024>>>>>>>>
68024>>>>>>>            
68024>>>>>>>            If (hKey) Begin
68026>>>>>>>                //  First call to determine resulting data size
68026>>>>>>>                Move (Length(sData)) to iDataLen
68027>>>>>>>                Move (Length(sData)) to iCipherLen
68028>>>>>>>                Move (CryptEncrypt(hKey, 0, True, 0, 0, AddressOf(iCipherLen), iDataLen)) to bOk
68029>>>>>>>                
68029>>>>>>>                //  Reserve space in string
68029>>>>>>>                If (iDataLen < iCipherLen) Begin
68031>>>>>>>                    Move (sData + Repeat(" ", iCipherLen - iDataLen)) to sData
68032>>>>>>>                End
68032>>>>>>>>
68032>>>>>>>                
68032>>>>>>>                //  Call to really decrypt
68032>>>>>>>                Move (CryptEncrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen),Length(sData))) to bOk
68033>>>>>>>                //If (not(bOk)) Begin
68033>>>>>>>                //Move "" to sData
68033>>>>>>>                //Move (GetLastError()) to iErr
68033>>>>>>>                //End
68033>>>>>>>                
68033>>>>>>>                Get DestroyKey hKey to bOk
68034>>>>>>>            End 
68034>>>>>>>>
68034>>>>>>>            Get ReleaseContext hProv to bOk
68035>>>>>>>        End 
68035>>>>>>>>
68035>>>>>>>        Function_Return sData
68036>>>>>>>    End_Function
68037>>>>>>>    
68037>>>>>>>    // Decrypts data
68037>>>>>>>    Function Decrypt String sPassword String sData Returns String
68039>>>>>>>        Handle hProv hHash hKey
68039>>>>>>>        Integer iAlgorithm iDataLen
68039>>>>>>>        Boolean bOk
68039>>>>>>>        
68039>>>>>>>        Get AcquireContext to hProv
68040>>>>>>>        If (hProv) Begin
68042>>>>>>>            Get CreateHash hProv to hHash
68043>>>>>>>            If (hHash) Begin
68045>>>>>>>                Get HashData hHash sPassword to bOk
68046>>>>>>>                If (bOk) Begin
68048>>>>>>>                    Get piCipher to iAlgorithm
68049>>>>>>>                    Get DeriveKey hProv hHash to hKey
68050>>>>>>>                End
68050>>>>>>>>
68050>>>>>>>                Get DestroyHash hHash to bOk
68051>>>>>>>            End
68051>>>>>>>>
68051>>>>>>>            
68051>>>>>>>            If (hKey) Begin
68053>>>>>>>                Move (Length(sData)) to iDataLen
68054>>>>>>>                Move (CryptDecrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen))) to bOk
68055>>>>>>>                //  Resulting dat can be shorter as the input string, in that case we shorten the result string
68055>>>>>>>                If (Length(sData) > iDataLen) Begin
68057>>>>>>>                    Move (Left(sData, iDataLen)) to sData
68058>>>>>>>                End
68058>>>>>>>>
68058>>>>>>>                
68058>>>>>>>                Get DestroyKey hKey to bOk
68059>>>>>>>            End
68059>>>>>>>>
68059>>>>>>>            Get ReleaseContext hProv to bOk
68060>>>>>>>        End
68060>>>>>>>>
68060>>>>>>>        Function_Return sData
68061>>>>>>>    End_Function
68062>>>>>>>    
68062>>>>>>>    //  Generates random data.
68062>>>>>>>    Function GenerateRandom Integer iBytes Returns UChar[]
68064>>>>>>>        Handle hProv
68064>>>>>>>        UChar[] uaResult
68065>>>>>>>        Boolean bRes
68065>>>>>>>        
68065>>>>>>>        Get AcquireContext to hProv
68066>>>>>>>        
68066>>>>>>>        Move (ResizeArray(uaResult, iBytes)) to uaResult
68067>>>>>>>        Move (CryptGenRandom(hProv, iBytes, AddressOf(uaResult))) to bRes
68068>>>>>>>        
68068>>>>>>>        Get ReleaseContext hProv to bRes
68069>>>>>>>        
68069>>>>>>>        Function_Return uaResult
68070>>>>>>>    End_Function
68071>>>>>>>    
68071>>>>>>>    //  Generates random data and does a base64 encoding to properly present it as a string.
68071>>>>>>>    Function GenerateRandomString Integer iLenght Returns String
68073>>>>>>>        String sResult
68073>>>>>>>        UChar[] aData
68074>>>>>>>        Address pBase64
68074>>>>>>>        Integer iVoid
68074>>>>>>>        
68074>>>>>>>        Get GenerateRandom iLenght to aData
68075>>>>>>>        
68075>>>>>>>        Move (Base64Encode(AddressOf(aData), iLenght)) to pBase64
68076>>>>>>>        Move pBase64 to sResult
68077>>>>>>>        Move (Free(pBase64)) to iVoid
68078>>>>>>>        
68078>>>>>>>        Function_Return (Left(sResult, iLenght))
68079>>>>>>>    End_Function
68080>>>>>>>    
68080>>>>>>>End_Class
68081>>>>>
68081>>>>>Class cLoginEncryption is a cObject
68082>>>>>    
68082>>>>>    Procedure Construct_Object
68084>>>>>        Forward Send Construct_Object
68086>>>>>        // this must be set to a multi (40ish) character random key
68086>>>>>        Property String psEncryptPassword ""
68087>>>>>        
68087>>>>>        Object oDataCrypter is a cCryptographer
68089>>>>>            Set piHash to CALG_SHA_256
68090>>>>>            Set piCipher to CALG_AES_256
68091>>>>>            Set psProvider to "" //  Not providing a specific provider gives the default provider for the provider type
68092>>>>>            Set piProvider to PROV_RSA_AES
68093>>>>>        End_Object
68094>>>>>    End_Procedure
68095>>>>>    
68095>>>>>    // This can be augmented to return a password encryption key using any
68095>>>>>    // hidden mechanism desired.
68095>>>>>    Function GetEncryptionPassword Returns String
68097>>>>>        String sPassword
68097>>>>>        Get psEncryptPassword to sPassword
68098>>>>>        Function_Return sPassword
68099>>>>>    End_Function
68100>>>>>    
68100>>>>>    // Encrypts a string into an unreadable hash that can later be decrypted using DecryptKey.
68100>>>>>    //
68100>>>>>    // Params:
68100>>>>>    //   sPlainText     String to encrypt.
68100>>>>>    // Returns:
68100>>>>>    //   Base64 encoded hash.
68100>>>>>    Function EncryptPassword String sPlainText Returns String
68102>>>>>        String sEncryptPassword sBinary sBase64
68102>>>>>        Address pBase64
68102>>>>>        Integer iVoid
68102>>>>>        
68102>>>>>        //  Encrypt Key
68102>>>>>        Get GetEncryptionPassword to sEncryptPassword
68103>>>>>        If (sEncryptPassword = "") Begin
68105>>>>>            Error DFERR_PROGRAM "No encryption password set"
68106>>>>>>
68106>>>>>        End
68106>>>>>>
68106>>>>>        
68106>>>>>        Get Encrypt of oDataCrypter sEncryptPassword sPlainText to sBinary
68107>>>>>        
68107>>>>>        If (sPlainText = sBinary or sBinary = "") Begin
68109>>>>>            Error DFERR_PROGRAM "Unable to encrypt database login password"
68110>>>>>>
68110>>>>>            Function_Return ""
68111>>>>>        End
68111>>>>>>
68111>>>>>        
68111>>>>>        //  Encode binary hash to Base64
68111>>>>>        Move (Base64Encode(AddressOf(sBinary), Length(sBinary))) to pBase64
68112>>>>>        Move pBase64 to sBase64
68113>>>>>        Move (Free(pBase64)) to iVoid
68114>>>>>        
68114>>>>>        Function_Return sBase64
68115>>>>>    End_Function
68116>>>>>    
68116>>>>>    
68116>>>>>    // Decrypts the unreadable hash generated by EncryptKey into a readable string.
68116>>>>>    //
68116>>>>>    // Params:
68116>>>>>    //   sBase64EncryptedPassword       Base64 Encrypted password
68116>>>>>    // Returns:
68116>>>>>    //   Readable plain text password
68116>>>>>    Function DecryptPassword String sBase64EncryptedPassword Returns String
68118>>>>>        String sEncryptPassword sPlainText sBinary
68118>>>>>        Boolean bIsHex
68118>>>>>        Integer iLen iVoid
68118>>>>>        Address pBinary
68118>>>>>        
68118>>>>>        If (sBase64EncryptedPassword <> "") Begin
68120>>>>>            //  Decode from Base64
68120>>>>>            Move (Base64Decode(AddressOf(sBase64EncryptedPassword), &iLen)) to pBinary
68121>>>>>            
68121>>>>>            Move (Repeat(Character(0), iLen)) to sBinary
68122>>>>>            Move (CopyMemory(AddressOf(sBinary), pBinary, iLen)) to iVoid
68123>>>>>            
68123>>>>>            Move (Free(pBinary)) to iVoid
68124>>>>>            
68124>>>>>            //  Encrypted binary hash to string
68124>>>>>            Get GetEncryptionPassword to sEncryptPassword
68125>>>>>            Get Decrypt of oDataCrypter sEncryptPassword sBinary to sPlainText
68126>>>>>        End
68126>>>>>>
68126>>>>>        
68126>>>>>        Function_Return sPlainText
68127>>>>>    End_Function
68128>>>>>End_Class
68129>>>
68129>>>Object oLoginEncryption is a cLoginEncryption
68131>>>
68131>>>    // this must be created in your appsrc directory and must contain an encryption
68131>>>    // key that is set to psEncryptPassword. It will look something like this
68131>>>    //
68131>>>    // Set psEncryptPassword to "JchUAo7W@r.b{<Yk~OONi0nq=sMi[*Rn[A-`Vo)q"
68131>>>    //  
Including file: LoginEncryptionKey.inc    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\LoginEncryptionKey.inc)
68131>>>>// Studio generated login encryption key
68131>>>>Set psEncryptPassword to "rHn+igXUe(,,M<?dkNtebWQJ$w>FT\9<FI)(MsQz"
68132>>>>
68132>>>    
68132>>>    // use this to register this object to your cConnection Object. This object
68132>>>    // must be created after the cConnection object
68132>>>    Move Self to ghoLoginEncryption
68133>>>End_Object
68134>        Use DatabaseLoginDialog.dg
Including file: DatabaseLoginDialog.dg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\DatabaseLoginDialog.dg)
68134>>>
68134>>>Use Windows.pkg
68134>>>Use cConnection.pkg
68134>>>Use dfLine.pkg
68134>>>
68134>>>Object oDatabaseLoginDialog is a ModalPanel
68136>>>    Set Label to "Database Login"
68137>>>    Set Location to 2 2
68138>>>    Set Size to 110 211
68139>>>    
68139>>>    Property String psId
68141>>>    Property Boolean pbOk False
68143>>>    Property Boolean pbChanged False
68145>>>    Property Boolean pbAllowRemember True
68147>>>    
68147>>>    // this registers this object with the cConnection object.
68147>>>    Move Self to ghoLoginConnectDialog
68148>>>    
68148>>>    Object oUserIDForm is a Form
68150>>>        Set Label to "User Name"
68151>>>        Set Size to 12 85
68152>>>        Set Location to 34 79
68153>>>        Set Label_Col_Offset to 64
68154>>>        Set peAnchors to anTopLeftRight
68155>>>    End_Object
68156>>>    
68156>>>    Object oPwdForm is a Form
68158>>>        Set Size to 12 85
68159>>>        Set Location to 49 79
68160>>>        Set Label_Col_Offset to 64
68161>>>        Set Password_State to True
68162>>>        Set peAnchors to anTopLeftRight
68163>>>        Set Label to "Password"
68164>>>    End_Object
68165>>>    
68165>>>    Object oTrustedConnection is a CheckBox
68167>>>        Set Size to 10 50
68168>>>        Set Location to 65 79
68169>>>        Set Label to "Trusted Connection"
68170>>>    End_Object
68171>>>    
68171>>>    Object oRemember is a CheckBox
68173>>>        Set Size to 10 50
68174>>>        Set Location to 79 14
68175>>>        Set Label to "Remember and don't ask again"
68176>>>        Set Checked_State to True
68177>>>    End_Object
68178>>>    
68178>>>    Object oLogin_btn is a Button
68180>>>        Set Label to "&Login"
68181>>>        Set Location to 92 102
68182>>>        Set peAnchors to anBottomRight
68183>>>        Set Default_State to True
68184>>>        
68184>>>        Procedure OnClick
68187>>>            Boolean bTrust
68187>>>            String sUser sPwd sConn sErr sId
68187>>>            Integer iError
68187>>>            Get psId to sId
68188>>>            Get Value of oUserIDForm to sUser
68189>>>            Get Value of oPwdForm to sPwd
68190>>>            Get Checked_State of oTrustedConnection to bTrust
68191>>>            
68191>>>            Get LoginConnectIdNewCredentials of ghoConnection sId sUser sPwd bTrust to iError
68192>>>            If (iError=0) Begin
68194>>>                Set pbOk to True
68195>>>                Set pbChanged to True
68196>>>                Send Close_Panel
68197>>>            End
68197>>>>
68197>>>            Else Begin
68198>>>                Get psErrorText of ghoConnection to sErr
68199>>>                Send UserError sErr "Login Error"
68200>>>            End
68200>>>>
68200>>>        End_Procedure
68201>>>    End_Object
68202>>>    
68202>>>    Object oCancel_btn is a Button
68204>>>        Set Label to "&Cancel"
68205>>>        Set Location to 92 157
68206>>>        Set peAnchors to anBottomRight
68207>>>        
68207>>>        Procedure OnClick
68210>>>            Send Close_Panel
68211>>>        End_Procedure
68212>>>    End_Object
68213>>>    
68213>>>    Object oConnectionIdInfo is a TextBox
68215>>>        Set Size to 10 50
68216>>>        Set Location to 4 14
68217>>>        Set Label to 'Connection Id='
68218>>>    End_Object
68219>>>    
68219>>>    Object oConnectionServerInfo is a TextBox
68221>>>        Set Size to 10 50
68222>>>        Set Location to 16 14
68223>>>        Set Label to 'Server'
68224>>>    End_Object
68225>>>    
68225>>>    Object oLineControl1 is a LineControl
68227>>>        Set Size to 2 202
68228>>>        Set Location to 29 5
68229>>>    End_Object
68230>>>    
68230>>>    Function LoginConnectIdDialog String sId Returns Boolean
68233>>>        Boolean bOk bChanged bTrusted bAllowRemember bRemember
68233>>>        String sUser sPwd sDescription
68233>>>        tConnection Connect
68233>>>        tConnection Connect
68233>>>        
68233>>>        Get pbAllowRemember to bAllowRemember
68234>>>        
68234>>>        
68234>>>        If not bAllowRemember Begin
68236>>>            Set Enabled_State of oRemember to bRemember
68237>>>            Set Visible_State of oRemember to bRemember
68238>>>        End
68238>>>>
68238>>>        
68238>>>        Get ConnectionIdInfo of ghoConnection sId to Connect
68239>>>        Set Value of oConnectionIdInfo to ("Connection ID="+Connect.sId)
68240>>>        Set Value of oConnectionServerInfo to Connect.sString
68241>>>        
68241>>>        Set psId to sId
68242>>>        Set pbOk to False
68243>>>        Set pbChanged to False
68244>>>        Set Value of oUserIDForm to Connect.sUID
68245>>>        Set Value of oPwdForm to ""
68246>>>        
68246>>>        Send Popup
68247>>>        
68247>>>        Get pbOk to bOk
68248>>>        Get pbChanged to bChanged
68249>>>        If (bChanged and bOk) Begin
68251>>>            If bAllowRemember Begin
68253>>>                Get Checked_State of oRemember to bRemember
68254>>>                If bRemember Begin
68256>>>                    Get Checked_State of oTrustedConnection to bTrusted
68257>>>                    If not (bTrusted) Begin
68259>>>                        Get Value of oUserIDForm to sUser
68260>>>                        Get Value of oPwdForm to sPwd
68261>>>                    End
68261>>>>
68261>>>                    Get StoreConnectionIdCredentials of ghoConnection sId sUser sPwd bTrusted to bOk
68262>>>                End
68262>>>>
68262>>>            End
68262>>>>
68262>>>        End
68262>>>>
68262>>>        Function_Return bOk
68263>>>    End_Function
68264>>>    
68264>>>    
68264>>>    On_Key Key_Alt+Key_O Send KeyAction of oLogin_btn
68265>>>    On_Key Key_Alt+Key_L Send KeyAction of oCancel_btn
68266>>>End_Object
68267>>>
68267>    End_Object
68268>
68268>End_Object
68269>
68269>Object oToolTipController is a cToolTipController
68271>    Move Self to ghoToolTipController
68272>End_Object
68273>
68273>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\oEditContextMenu.pkg)
68273>>>Use cCJStandardMenuItemClasses.pkg
68273>>>
68273>>>Object oEditContextMenu is a cCJContextMenu
68275>>>    
68275>>>    Move Self to Default_Form_Floating_Menu_ID
68276>>>    
68276>>>    Object oUndoMenuItem is a cCJUndoMenuItem
68278>>>    End_Object
68279>>>    
68279>>>    Object oCutMenuItem is a cCJCutMenuItem
68281>>>        Set pbControlBeginGroup to True
68282>>>    End_Object
68283>>>    
68283>>>    Object oCopyMenuItem is a cCJCopyMenuItem
68285>>>    End_Object
68286>>>
68286>>>    Object oPasteMenuItem is a cCJPasteMenuItem
68288>>>    End_Object
68289>>>
68289>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
68291>>>    End_Object
68292>>>
68292>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
68294>>>        Set pbControlBeginGroup to True
68295>>>    End_Object
68296>>>
68296>>>End_Object
68297>>>
68297>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\oDEOEditContextMenu17.pkg)
68297>>>Use Windows.pkg
68297>>>Use cCJStandardMenuItemClasses.pkg
68297>>>Use cCJDeoMenuItemClasses.pkg
68297>>>
68297>>>
68297>>>Object oDEOEditContextMenu17 is a cCJContextMenu
68299>>>    
68299>>>    Move Self to Default_dbFloating_Menu_ID
68300>>>    
68300>>>    Object oUndoMenuItem is a cCJUndoMenuItem
68302>>>    End_Object
68303>>>    
68303>>>    Object oCutMenuItem is a cCJCutMenuItem
68305>>>        Set pbControlBeginGroup to True
68306>>>    End_Object
68307>>>    
68307>>>    Object oCopyMenuItem is a cCJCopyMenuItem
68309>>>    End_Object
68310>>>
68310>>>    Object oPasteMenuItem is a cCJPasteMenuItem
68312>>>    End_Object
68313>>>
68313>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
68315>>>    End_Object
68316>>>
68316>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
68318>>>        Set pbControlBeginGroup to True
68319>>>    End_Object
68320>>>
68320>>>    Object oPromptMenuItem is a cCJPromptMenuItem
68322>>>        Set pbControlBeginGroup to True
68323>>>    End_Object
68324>>>
68324>>>    Object oFindNextMenu is a cCJFindNextMenuItem
68326>>>        Set pbControlBeginGroup to True
68327>>>    End_Object
68328>>>
68328>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
68330>>>    End_Object
68331>>>
68331>>>    Object oClearMenuItem is a cCJClearMenuItem
68333>>>        Set pbControlBeginGroup to True
68334>>>    End_Object
68335>>>
68335>>>    Object oClearAllMenu is a cCJClearAllMenuItem
68337>>>    End_Object
68338>>>
68338>>>    Object oSaveMenu is a cCJSaveMenuItem
68340>>>    End_Object
68341>>>    
68341>>>    Object oDeleteMenu is a cCJDeleteMenuItem
68343>>>    End_Object
68344>>>
68344>>>    Object oRememberitem is a cCJRememberFieldMenuItem
68346>>>        Set pbControlBeginGroup to True
68347>>>    End_Object
68348>>>
68348>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
68350>>>    End_Object
68351>>>
68351>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
68353>>>    End_Object
68354>>>
68354>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
68356>>>    End_Object
68357>>>
68357>>>End_Object
68358>
68358>Object oMain is a Panel
68360>    Set Label To "My Project"
68361>    Set Location to 4 3
68362>    Set Size to 300 450
68363>
68363>    Object oCommandBarSystem is a cCJCommandBarSystem
68365>        Set pbTimerUpdate to True
68366>        Set peVisualTheme to xtpThemeOffice2013Outlook
68367>        Set pbAutoResizeIcons to True
68368>
68368>        Procedure OnCreateCommandBars
68371>            Handle hoOptions
68371>            Get OptionsObject to hoOptions
68372>            Forward Send OnCreateCommandBars
68374>        End_Procedure
68375>
68375>        Object oMenuBar is a cCJMenuBar
68377>
68377>            Object oFileMenu is a cCJMenuItem
68379>                Set peControlType to xtpControlPopup          
68380>                Set psCaption   to "&File"
68381>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
68382>                Set psCategory to "Menus"
68383>
68383>                Object oClearMenuItem is a cCJClearMenuItem
68385>                    Set pbAddToDesignerMenu to True
68386>                End_Object
68387>
68387>                Object oClearAllMenu is a cCJClearAllMenuItem
68389>                    Set pbAddToDesignerMenu to True
68390>                End_Object
68391>
68391>                Object oPromptMenuItem is a cCJPromptMenuItem
68393>                    Set pbAddToDesignerMenu to True
68394>                    Set pbControlBeginGroup to True
68395>                End_Object
68396>
68396>                Object oFindMenuItem is a cCJFindMenuItem
68398>                    Set pbAddToDesignerMenu to True
68399>                    Set pbControlBeginGroup to True
68400>                End_Object
68401>
68401>                Object oFindNextMenu is a cCJFindNextMenuItem
68403>                    Set pbAddToDesignerMenu to True
68404>                End_Object
68405>
68405>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
68407>                    Set pbAddToDesignerMenu to True
68408>                End_Object
68409>
68409>                Object oFindFirstMenu is a cCJFindFirstMenuItem
68411>                    Set pbAddToDesignerMenu to True
68412>                End_Object
68413>
68413>                Object oFindLastMenu is a cCJFindLastMenuItem
68415>                    Set pbAddToDesignerMenu to True
68416>                End_Object
68417>
68417>                Object oSaveMenuItem is a cCJSaveMenuItem
68419>                    Set pbAddToDesignerMenu to True
68420>                    Set pbControlBeginGroup to True
68421>                End_Object
68422>
68422>                Object oDeleteMenuItem is a cCJDeleteMenuItem
68424>                    Set pbAddToDesignerMenu to True
68425>                End_Object
68426>
68426>                Object oExitMenu is a cCJExitMenuItem
68428>                    Set pbControlBeginGroup to True
68429>                End_Object
68430>
68430>            End_Object
68431>
68431>            Object oViewMenu is a cCJMenuItem
68433>                Set peControlType to xtpControlPopup
68434>                Set psCaption to "&View"
68435>                Set psToolTip to "View"
68436>                Set psDescription to "Available Views"
68437>
68437>                Object oEmpEntryMenuItem is a cCJMenuItem
68439>                    Set psCaption to "EmpEntry"
68440>                    Set psTooltip to "EmpEntry"
68441>                
68441>                    Procedure OnExecute Variant vCommandBarControl
68444>                        Handle hoClient
68444>                        Get Client_Id to hoClient
68445>                        Send Activate_oEmpEntry of hoClient
68446>                    End_Procedure
68447>                End_Object
68448>
68448>                Object oLineEntryMenuItem is a cCJMenuItem
68450>                    Set psCaption to "LineEntry"
68451>                    Set psTooltip to "LineEntry"
68452>                
68452>                    Procedure OnExecute Variant vCommandBarControl
68455>                        Handle hoClient
68455>                        Get Client_Id to hoClient
68456>                        Send Activate_oLineEntry of hoClient
68457>                    End_Procedure
68458>                End_Object
68459>
68459>                Object oPageHeaderEntryMenuItem is a cCJMenuItem
68461>                    Set psCaption to "PageHeaderEntry"
68462>                    Set psTooltip to "PageHeaderEntry"
68463>                
68463>                    Procedure OnExecute Variant vCommandBarControl
68466>                        Handle hoClient
68466>                        Get Client_Id to hoClient
68467>                        Send Activate_oPageHeaderEntry of hoClient
68468>                    End_Procedure
68469>                End_Object
68470>
68470>                Object oShoeEntryMenuItem is a cCJMenuItem
68472>                    Set psCaption to "ShoeEntry"
68473>                    Set psTooltip to "ShoeEntry"
68474>                
68474>                    Procedure OnExecute Variant vCommandBarControl
68477>                        Handle hoClient
68477>                        Get Client_Id to hoClient
68478>                        Send Activate_oShoeEntry of hoClient
68479>                    End_Procedure
68480>                End_Object
68481>
68481>                Object oPageFooterEntryMenuItem is a cCJMenuItem
68483>                    Set psCaption to "PageFooterEntry"
68484>                    Set psTooltip to "PageFooterEntry"
68485>                
68485>                    Procedure OnExecute Variant vCommandBarControl
68488>                        Handle hoClient
68488>                        Get Client_Id to hoClient
68489>                        Send Activate_oPageFooterEntry of hoClient
68490>                    End_Procedure
68491>                End_Object
68492>
68492>                Object oPageFooterEntry2MenuItem is a cCJMenuItem
68494>                    Set psCaption to "PageFooterEntry2"
68495>                    Set psTooltip to "PageFooterEntry2"
68496>                
68496>                    Procedure OnExecute Variant vCommandBarControl
68499>                        Handle hoClient
68499>                        Get Client_Id to hoClient
68500>                        Send Activate_oPageFooterEntry2 of hoClient
68501>                    End_Procedure
68502>                End_Object
68503>
68503>                Object oPageFooterEntry3MenuItem is a cCJMenuItem
68505>                    Set psCaption to "PageFooterEntry3"
68506>                    Set psTooltip to "PageFooterEntry3"
68507>                
68507>                    Procedure OnExecute Variant vCommandBarControl
68510>                        Handle hoClient
68510>                        Get Client_Id to hoClient
68511>                        Send Activate_oPageFooterEntry3 of hoClient
68512>                    End_Procedure
68513>                End_Object
68514>
68514>                Object oPageFooterEntry4MenuItem is a cCJMenuItem
68516>                    Set psCaption to "PageFooterEntry4"
68517>                    Set psTooltip to "PageFooterEntry4"
68518>                
68518>                    Procedure OnExecute Variant vCommandBarControl
68521>                        Handle hoClient
68521>                        Get Client_Id to hoClient
68522>                        Send Activate_oPageFooterEntry4 of hoClient
68523>                    End_Procedure
68524>                End_Object
68525>            End_Object
68526>            
68526>            Object oReportMenu is a cCJMenuItem
68528>                Set peControlType to xtpControlPopup
68529>                Set psCaption to "&Report"
68530>                Set psToolTip to "Report"
68531>                Set psDescription to "Available Reports"
68532>
68532>                Object oReportViewMenuItem is a cCJMenuItem
68534>                    Set psCaption to "ReportView"
68535>                    Set psTooltip to "ReportView"
68536>                
68536>                    Procedure OnExecute Variant vCommandBarControl
68539>                        Handle hoClient
68539>                        Get Client_Id to hoClient
68540>                        Send Activate_oReportView of hoClient
68541>                    End_Procedure
68542>                End_Object
68543>
68543>                Object oReportView2MenuItem is a cCJMenuItem
68545>                    Set psCaption to "ReportView2"
68546>                    Set psTooltip to "ReportView2"
68547>                
68547>                    Procedure OnExecute Variant vCommandBarControl
68550>                        Handle hoClient
68550>                        Get Client_Id to hoClient
68551>                        Send Activate_oReportView2 of hoClient
68552>                    End_Procedure
68553>                End_Object
68554>            End_Object
68555>
68555>            Object oNavigateMenu is a cCJMenuItem
68557>                Set peControlType to xtpControlPopup      
68558>                Set psCaption to "&Navigate"    
68559>                Set psTooltip to "Navigate"    
68560>                Set psDescription to "Move to different areas of the application"
68561>
68561>                Object oNextAreaMenu is a cCJNextAreaMenu
68563>                End_Object
68564>
68564>                Object oPriorAreaMenu is a cCJPriorAreaMenu
68566>                End_Object
68567>
68567>                Object oNextViewMenu is a cCJNextViewMenu
68569>                End_Object
68570>
68570>                Object oPriorViewMenu is a cCJPriorViewMenu
68572>                End_Object
68573>
68573>                Object oPromptMenu is a cCJPromptMenuItem
68575>                    Set pbControlBeginGroup to True
68576>                End_Object
68577>
68577>                Object oZoomMenu is a cCJZoomMenuItem
68579>                End_Object
68580>
68580>            End_Object
68581>
68581>            Object oWindowMenu is a cCJMDIWindowsMenuItem
68583>                Set peControlType to xtpControlPopup
68584>                Set psCaption to "&Window"
68585>                Set psToolTip to "Window"
68586>                Set psDescription to "Display Current Views and set other display options."    
68587>
68587>                // These are the static windows items. More will be created in onInitPopup 
68587>                Object oDisplayOptionsMenu is a cCJMenuItem
68589>                    Set peControlType to xtpControlPopup          
68590>                    Set psCaption to "&Display Options"
68591>                    Set psToolTip to "Display Options"
68592>                    Set psDescription to "Set display options"
68593>
68593>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
68595>                    End_Object
68596>
68596>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
68598>                    End_Object
68599>
68599>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
68601>                        Set pbControlBeginGroup to True
68602>                    End_Object
68603>
68603>                End_Object
68604>
68604>                Object oCascadeMenu is a cCJCascadeMenuItem
68606>                    Set pbControlBeginGroup to True
68607>                End_Object
68608>
68608>                Object oHorizTile is a cCJTileHorizontally
68610>                End_Object
68611>
68611>                Object oVertTile is a cCJTileVertically
68613>                End_Object
68614>
68614>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
68616>                    Set pbControlBeginGroup to True
68617>                End_Object
68618>
68618>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
68620>                End_Object
68621>
68621>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
68623>                    Set pbControlBeginGroup to True
68624>                End_Object
68625>
68625>            End_Object
68626>
68626>            Object oHelpMenu is a cCJMenuItem
68628>                Set peControlType to xtpControlPopup    
68629>                Set psCaption to "&Help"
68630>                Set psDescription to "Access Information for learning and using this DataFlex application."
68631>                Set psToolTip to "Help"
68632>
68632>                Object oHelpMenuItem is a cCJHelpMenuItem 
68634>                End_Object
68635>
68635>                Object oAboutMenuItem is a cCJAboutMenuItem
68637>                End_Object
68638>
68638>            End_Object
68639>
68639>        End_Object
68640>
68640>        Object oFindToolBar is a cCJToolbar
68642>            Set psTitle to "Finding Toolbar"
68643>
68643>            Object oFindFirstTool is a cCJFindFirstMenuItem
68645>            End_Object
68646>
68646>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
68648>            End_Object
68649>
68649>            Object oFindMenuTool is a cCJFindMenuItem
68651>            End_Object
68652>
68652>            Object oFindNextTool is a cCJFindNextMenuItem
68654>            End_Object
68655>
68655>            Object oFindLastTool is a cCJFindLastMenuItem
68657>            End_Object
68658>
68658>            Object oPromptToolItem is a cCJPromptMenuItem
68660>                Set pbControlBeginGroup to True
68661>            End_Object
68662>
68662>        End_Object
68663>
68663>        Object oFileToolBar is a cCJToolbar
68665>            Set psTitle to "Data Entry Toolbar"
68666>
68666>            Object oClearToolItem is a cCJClearMenuItem
68668>                Set peControlStyle to xtpButtonIconAndCaption
68669>            End_Object
68670>
68670>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
68672>                Set peControlStyle to xtpButtonIconAndCaption
68673>            End_Object
68674>
68674>            Object oSaveToolItem is a cCJSaveMenuItem
68676>                Set peControlStyle to xtpButtonIconAndCaption
68677>                Set pbControlBeginGroup to True
68678>            End_Object
68679>
68679>            Object oDeleteToolItem is a cCJDeleteMenuItem
68681>                Set peControlStyle to xtpButtonIconAndCaption
68682>            End_Object
68683>
68683>        End_Object
68684>
68684>        Object oEditToolBar is a cCJToolbar
68686>            Set psTitle to "Edit Toolbar"
68687>
68687>            Object oCutToolbarItem is a cCJCutMenuItem
68689>            End_Object
68690>
68690>            Object oCopyToolbarItem is a cCJCopyMenuItem
68692>            End_Object
68693>
68693>            Object oPasteToolbarItem is a cCJPasteMenuItem
68695>            End_Object
68696>
68696>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
68698>                Set pbControlBeginGroup to True
68699>            End_Object
68700>
68700>        End_Object
68701>
68701>        Object oRememberToolbar is a cCJToolbar
68703>            Set psTitle to C_$Remember
68704>
68704>            Object oRememberItems is a cCJMenuItem
68706>
68706>                Set peControlType to xtpControlPopup
68707>                Set peControlStyle to xtpButtonCaption
68708>                Set psCaption to C_$Remember
68709>                
68709>                Object oMenuItem is a cCJRememberFieldMenuItem
68711>                    Set peControlStyle to xtpButtonIconAndCaption
68712>                End_Object
68713>                
68713>                Object oMenuItem is a cCJRememberLastFieldMenuItem
68715>                    Set peControlStyle to xtpButtonIconAndCaption
68716>                End_Object
68717>                
68717>                Object oMenuItem is a cCJUnRememberFieldMenuItem
68719>                    Set peControlStyle to xtpButtonIconAndCaption
68720>                End_Object
68721>                
68721>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
68723>                    Set peControlStyle to xtpButtonIconAndCaption
68724>                End_Object
68725>
68725>            End_Object
68726>            
68726>        End_Object
68727>        
68727>        Object oStatusBar is a cCJStatusBar
68729>
68729>            Object oStatusPane1 is a cCJStatusBarPane
68731>                Set piID to sbpIDIdlePane
68732>                Set pbStyleStretch to True
68733>            End_Object
68734>
68734>            Object oStatusPane2 is a cCJStatusBarPane
68736>                Set phoViewPane to Self
68737>                Set pbStyleStretch to True
68738>            End_Object
68739>
68739>        End_Object
68740>
68740>    End_Object
68741>
68741>    Object oClientArea is a ClientArea
68743>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\StdAbout.pkg)
68743>>>// This provides a quick and simple way to create an about package for a program.
68743>>>// You need to create a message inside you client area called Activate_About.
68743>>>// Within this message you should send the message DoAbout passing needed
68743>>>// string information.
68743>>>//
68743>>>//       Procedure Activate_About
68743>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
68743>>>//       End_Procedure
68743>>>//    where: sTitle =     Name of application. If none provided, uses caption
68743>>>//                        bar title
68743>>>//           sVersion   = Version Line. If none provided, will be blank
68743>>>//           sCopyRight = Copyright Line. If none provided, will be blank
68743>>>//           sAuthor    = Author name, blank if none provided
68743>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
68743>>>//                        is used.
68743>>>// It is expected that you will place this in your own object package. For
68743>>>// example an order about package may look like this:
68743>>>//
68743>>>//   // OrderAbout.pkg
68743>>>//   Use StdAbout.pkg
68743>>>//   Procedure Activate_About
68743>>>//      String sTitle sCopyright sVersion sAuthor
68743>>>//      Move "My Order Entry System" to sTitle
68743>>>//      Move "Version 2.1" to sVersion
68743>>>//      Move "Copyright xxxx, Super Software Inc." to sCopyright
68743>>>//      Move "John Smith"  to sAuthor
68743>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
68743>>>//   end_procedure
68743>>>//   // end of file.
68743>>>
68743>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Dfabout.pkg)
68743>>>>>Use LanguageText.pkg
68743>>>>>Use Windows.pkg
68743>>>>>Use DFbitmap.pkg
68743>>>>>Use GlobalFunctionsProcedures.pkg
68743>>>>>Use cTextEdit.pkg
68743>>>>>Use tWinStructs.pkg
68743>>>>>
68743>>>>>Use cli.pkg
68743>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 19.1\Pkg\DFBTRDRV.PKG)
68743>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
68743>>>>>>>// Notice      : This package contains constants and commands, used to call
68743>>>>>>>//               specific functions in the DFBTRDRV.
68743>>>>>>>Use Ui
68743>>>>>>>//
68743>>>>>>>// Driver Indentification
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>// Driver attributes
68743>>>>>>>//
68743>>>>>>>// Call_Driver functions ID's
68743>>>>>>>//
68743>>>>>>>//
68743>>>>>>>// DFBTRFN_CONVERT_FILE options
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// DFBTRFN_SET_OWNER options
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to create all vars which may be needed
68743>>>>>>>// in other commands.
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to set the owner of a Btrieve file.
68743>>>>>>>// File must have been opened.
68743>>>>>>>// Filenumber needs to be passed.
68743>>>>>>>// To clear set the owner to "".
68743>>>>>>>// Examples:
68743>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
68743>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
68743>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
68743>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
68743>>>>>>>// To clear:
68743>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to parse DFBTR_SET_OWNVER
68743>>>>>>>// options.
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to parse for Callback
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to clear the owner of a Btrieve file.
68743>>>>>>>// File must have been opened.
68743>>>>>>>// Filenumber needs to be passed.
68743>>>>>>>// Examples:
68743>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to add a owner name to the internal list of ownernames
68743>>>>>>>// which will be tries when opening files.
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to remove all owners from the internal list of ownernames
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to set the owner name to be used when opening the DDF files.
68743>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
68743>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
68743>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to change the transaction type.
68743>>>>>>>// Valid types are:
68743>>>>>>>//     DFBTRTT_NONE
68743>>>>>>>//     DFBTRTT_EXCLUSIVE
68743>>>>>>>//     DFBTRTT_CONCURRENT
68743>>>>>>>//
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to get the current transaction type.
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to set explicit_locking
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to get explicit locking
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>//
68743>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
68743>>>>>>>//
68743>>>>>>>
68743>>>>>>>// Purpose: An instance of this class can be used as a broker object to
68743>>>>>>>//          call several Dfbtrdrv releated methods.
68743>>>>>>>
68743>>>>>>>Class cDFBtrDrvHandler is an Array
68744>>>>>>>    
68744>>>>>>>    Procedure Construct_Object Integer iImage
68746>>>>>>>        Forward Send Construct_object iImage
68748>>>>>>>        
68748>>>>>>>        Property String  psDriverID "DFBTRDRV"
68749>>>>>>>    End_Procedure
68750>>>>>>>    
68750>>>>>>>    //  The revsion of a Dfbtrdrv Connectivity Kit
68750>>>>>>>    //
68750>>>>>>>    
68750>>>>>>>    Function CKRevision Returns String
68752>>>>>>>        String  sDriverID
68752>>>>>>>        String  sRevision
68752>>>>>>>        String  sVoid
68752>>>>>>>        Integer iRetval
68752>>>>>>>        
68752>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68752>>>>>>>        // This error would otherwise be raised when we have an older
68752>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68752>>>>>>>        Send Ignore_error to Error_object_Id 20491
68753>>>>>>>        Get psDriverID to sDriverID
68754>>>>>>>        Move (Repeat(" ", 255)) to sRevision
68755>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
68760>>>>>>>        Send Trap_Error to Error_object_Id 20491
68761>>>>>>>        If (Trim(sRevision) = "") Begin
68763>>>>>>>            // Unable to get the revision. return all zeroes.
68763>>>>>>>            Move "0.0.0.0" to sRevision
68764>>>>>>>        End
68764>>>>>>>>
68764>>>>>>>        Function_Return sRevision
68765>>>>>>>    End_Function
68766>>>>>>>    
68766>>>>>>>    Function CkUsesUri Returns Integer
68768>>>>>>>        String  sDriverID
68768>>>>>>>        String  sVoid1
68768>>>>>>>        String  sVoid2
68768>>>>>>>        Integer iRetval
68768>>>>>>>        
68768>>>>>>>        Get psDriverID to sDriverID
68769>>>>>>>        
68769>>>>>>>        Move 0 to iRetval
68770>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68770>>>>>>>        // This error would otherwise be raised when we have an older
68770>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
68770>>>>>>>        Send Ignore_error to Error_object_Id 20491
68771>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
68776>>>>>>>        Send Trap_Error to Error_object_Id 20491
68777>>>>>>>        
68777>>>>>>>        Function_Return iRetval
68778>>>>>>>    End_Function
68779>>>>>>>    
68779>>>>>>>    
68779>>>>>>>    
68779>>>>>>>    // Extract the Nth part of a a.b.c.d revsion string.
68779>>>>>>>    //
68779>>>>>>>    // Returns : The part version number or -1 if there is no such part number.
68779>>>>>>>    //
68779>>>>>>>    
68779>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
68781>>>>>>>        Integer iPartRev
68781>>>>>>>        Integer iCurrentPart
68781>>>>>>>        Integer iSeparatorPos
68781>>>>>>>        
68781>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
68784>>>>>>>        
68784>>>>>>>        Move 0 to iCurrentPart
68785>>>>>>>        Repeat
68785>>>>>>>>
68785>>>>>>>            Move (Pos(".", sRevision)) to iSeparatorPos
68786>>>>>>>            If (iSeparatorPos > 0) Begin
68788>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) to iPartRev
68789>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) to sRevision
68790>>>>>>>                Increment iCurrentPart
68791>>>>>>>            End
68791>>>>>>>>
68791>>>>>>>            Else If (sRevision <> "") Begin
68794>>>>>>>                Move sRevision to iPartRev
68795>>>>>>>                Move "" to sRevision
68796>>>>>>>                Increment iCurrentPart
68797>>>>>>>            End
68797>>>>>>>>
68797>>>>>>>            Else ;                Move -1 to iPartRev
68799>>>>>>>        Until (iCurrentPart >= iPartNum or iPartRev = -1)
68801>>>>>>>        
68801>>>>>>>        Function_Return iPartRev
68802>>>>>>>    End_Function
68803>>>>>>>    
68803>>>>>>>    
68803>>>>>>>    
68803>>>>>>>    //
68803>>>>>>>    //  Returns the major revision of the CK
68803>>>>>>>    //
68803>>>>>>>    
68803>>>>>>>    Function CKMajorRevision Returns Integer
68805>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
68806>>>>>>>    End_Function
68807>>>>>>>    
68807>>>>>>>    
68807>>>>>>>    
68807>>>>>>>    //  Returns the minor revision of the CK
68807>>>>>>>    //
68807>>>>>>>    
68807>>>>>>>    Function CKMinorRevision Returns Integer
68809>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
68810>>>>>>>    End_Function
68811>>>>>>>    
68811>>>>>>>    
68811>>>>>>>    //  Returns the release revision of the CK
68811>>>>>>>    //
68811>>>>>>>    
68811>>>>>>>    Function CKReleaseRevision Returns Integer
68813>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
68814>>>>>>>    End_Function
68815>>>>>>>    
68815>>>>>>>    
68815>>>>>>>    //  Returns the major revision of the CK
68815>>>>>>>    //
68815>>>>>>>    
68815>>>>>>>    Function CKBuildRevision Returns Integer
68817>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
68818>>>>>>>    End_Function
68819>>>>>>>    
68819>>>>>>>    
68819>>>>>>>    //  Determines if the CK conforms to a passed minimal revsion.
68819>>>>>>>    //
68819>>>>>>>    
68819>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
68821>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_Return (True)
68824>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
68827>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_Return (True)
68830>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
68833>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_Return (True)
68836>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) and iBuild <= CKBuildRevision(Current_object)) ;                    Function_Return (True)
68840>>>>>>>            End
68840>>>>>>>>
68840>>>>>>>        End
68840>>>>>>>>
68840>>>>>>>        
68840>>>>>>>        Function_Return (False)
68841>>>>>>>    End_Function
68842>>>>>>>    
68842>>>>>>>    //   Functions to query the Pervasive.SQL version:
68842>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
68842>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
68842>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
68842>>>>>>>    //
68842>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
68842>>>>>>>    //   in the following format:
68842>>>>>>>    //       <version>.<revision>.<type>
68842>>>>>>>    //   possible values for <type>:
68842>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
68842>>>>>>>    //         server using Workgroup authentication mode
68842>>>>>>>    //       C for client cache engine
68842>>>>>>>    //       D for DOS workstation
68842>>>>>>>    //       N for client Requester
68842>>>>>>>    //       S for NetWare server
68842>>>>>>>    //       T for 32-bit Windows server engine
68842>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
68842>>>>>>>    //
68842>>>>>>>    //   example:
68842>>>>>>>    //       8.50.T
68842>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
68842>>>>>>>    //   32-bits Windows server.
68842>>>>>>>    //
68842>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
68842>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
68842>>>>>>>    //
68842>>>>>>>    //   If the version information is not available or can not be obtained
68842>>>>>>>    //   the functions will return "0.0.0"
68842>>>>>>>    
68842>>>>>>>    //  Returns the version information of the
68842>>>>>>>    //           Pervasive.SQL Client requester.
68842>>>>>>>    
68842>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
68844>>>>>>>        
68844>>>>>>>        String  sDriverID
68844>>>>>>>        String  sVersion
68844>>>>>>>        String  sVoid
68844>>>>>>>        Integer iRetval
68844>>>>>>>        
68844>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68844>>>>>>>        // This error would otherwise be raised when we have an older
68844>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68844>>>>>>>        Send Ignore_error to Error_object_Id 20491
68845>>>>>>>        Get psDriverID to sDriverID
68846>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68847>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68852>>>>>>>        Send Trap_Error to Error_object_Id 20491
68853>>>>>>>        If (Trim(sVersion) = "") Begin
68855>>>>>>>            // Unable to get the revision. return all zeroes.
68855>>>>>>>            Move "0.0.0" to sVersion
68856>>>>>>>        End
68856>>>>>>>>
68856>>>>>>>        Function_Return sVersion
68857>>>>>>>    End_Function
68858>>>>>>>    
68858>>>>>>>    //           Pervasive.SQL Engine
68858>>>>>>>    
68858>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
68860>>>>>>>        
68860>>>>>>>        String  sDriverID
68860>>>>>>>        String  sVersion
68860>>>>>>>        String  sVoid
68860>>>>>>>        Integer iRetval
68860>>>>>>>        
68860>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68860>>>>>>>        // This error would otherwise be raised when we have an older
68860>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68860>>>>>>>        Send Ignore_error to Error_object_Id 20491
68861>>>>>>>        Get psDriverID to sDriverID
68862>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68863>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68868>>>>>>>        Send Trap_Error to Error_object_Id 20491
68869>>>>>>>        If (Trim(sVersion) = "") Begin
68871>>>>>>>            // Unable to get the revision. return all zeroes.
68871>>>>>>>            Move "0.0.0" to sVersion
68872>>>>>>>        End
68872>>>>>>>>
68872>>>>>>>        Function_Return sVersion
68873>>>>>>>    End_Function
68874>>>>>>>    
68874>>>>>>>    //  Returns the version information of the
68874>>>>>>>    //           Pervasive.SQL Server Engine
68874>>>>>>>    
68874>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
68876>>>>>>>        
68876>>>>>>>        String  sDriverID
68876>>>>>>>        String  sVersion
68876>>>>>>>        String  sVoid
68876>>>>>>>        Integer iRetval
68876>>>>>>>        
68876>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68876>>>>>>>        // This error would otherwise be raised when we have an older
68876>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68876>>>>>>>        Send Ignore_error to Error_object_Id 20491
68877>>>>>>>        Get psDriverID to sDriverID
68878>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68879>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68884>>>>>>>        Send Trap_Error to Error_object_Id 20491
68885>>>>>>>        If (Trim(sVersion) = "") Begin
68887>>>>>>>            // Unable to get the revision. return all zeroes.
68887>>>>>>>            Move "0.0.0" to sVersion
68888>>>>>>>        End
68888>>>>>>>>
68888>>>>>>>        Function_Return sVersion
68889>>>>>>>    End_Function
68890>>>>>>>    
68890>>>>>>>End_Class
68891>>>>>>>
68891>>>>>>>
68891>>>>>Use MSSqldrv.pkg
Including file: MSSqldrv.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\MSSqldrv.pkg)
68891>>>>>>>//     Package that declares MS SQL driver constants and functions.
68891>>>>>>>//     This package can be used by developers who want to add Data Access
68891>>>>>>>//     MS SQL Client specific code to a DataFlex application.
68891>>>>>>>
68891>>>>>>>Use Cli.pkg
68891>>>>>>>Use SQL.pkg
68891>>>>>>>
68891>>>>>>>//   Driver Indentification
68891>>>>>>>
68891>>>>>>>//   Error number constants
68891>>>>>>>
68891>>>>>>>
68891>>>>>>>//   Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
68891>>>>>>>
68891>>>>>>>
68891>>>>>>>
68891>>>>>>>
68891>>>>>>>
68891>>>>>>>
68891>>>>>>>// SQL Server spcific types.
68891>>>>>>>Define SQL_SS_TIMESTAMPOFFSET   for   (-155) //SQL server datetimeoffset type */
68891>>>>>>>Define SQL_SS_TIME2             for   (-154) //SQL server time type */
68891>>>>>>>Define SQL_SS_XML               for   (-152) //SQL server xml type */
68891>>>>>>>Define SQL_SS_VARIANT           for   (-150) //SQL server variant type */
68891>>>>>>>
68891>>>>>>>// SQL Server spcific types.
68891>>>>>>>Define SQL_TYPE_TIMESTAMP2      for   (-200) //SQL server datetime2 type */
68891>>>>>>>Define SQL_VARCHARMAX           for   (-201) //SQL server varchar(max) type */
68891>>>>>>>Define SQL_WVARCHARMAX          for   (-202) //SQL server wvarchar(max) type */
68891>>>>>>>Define SQL_VARBINARYMAX         for   (-203) //SQL server varbinary(max) type */
68891>>>>>>>Define SQL_TYPE_MONEY           for   (-204) //SQL server money type */
68891>>>>>>>Define SQL_TYPE_SMALLMONEY      for   (-205) //SQL server smallmoney type */
68891>>>>>>>Define SQL_TYPE_SMALLDATETIME   for   (-206) //SQL server smalldatetype type */
68891>>>>>>>
68891>>>>>>>
68891>>>>>>>//   MSSQL_SetConstraint <FileNum> <ConstraintText>
68891>>>>>>>//
68891>>>>>>>//     Setup a constraint for a file.
68891>>>>>>>
68891>>>>>>>
68891>>>>>>>Class cMSSQLHandler is a cCLIHandler
68892>>>>>>>    
68892>>>>>>>    Procedure Construct_Object
68894>>>>>>>        Forward Send Construct_Object
68896>>>>>>>        
68896>>>>>>>        Set psDriverID to MSSQLDRV_ID
68897>>>>>>>    End_Procedure
68898>>>>>>>    
68898>>>>>>>    
68898>>>>>>>    
68898>>>>>>>    //   Extract the list from the out connect string.
68898>>>>>>>    Function ExtractList String sOutConnStr Integer hoStore Returns Integer
68900>>>>>>>        String  sItem
68900>>>>>>>        Integer iStart
68900>>>>>>>        Integer iEnd
68900>>>>>>>        
68900>>>>>>>        If (hoStore = 0) ;            Move Current_object to hoStore
68903>>>>>>>        
68903>>>>>>>        Send Delete_Data to hoStore
68904>>>>>>>        Move (Pos("{", sOutConnStr)) to iStart
68905>>>>>>>        While (iStart > 0)
68909>>>>>>>            Move (Right(sOutConnStr, Length(sOutConnStr) - iStart)) to sOutConnStr
68910>>>>>>>            If (Left(sOutConnStr, 1) = "}") ;                Move 0 to iStart
68913>>>>>>>            Else Begin
68914>>>>>>>                Move (Pos(",", sOutConnStr)) to iStart
68915>>>>>>>                Move (Pos("}", sOutConnStr)) to iEnd
68916>>>>>>>                If ((iStart = 0) or (iEnd < iStart)) ;                    Move iEnd to iStart
68919>>>>>>>                
68919>>>>>>>                If (iStart > 0) ;                    Set Value of hoStore  (Item_Count(Current_Object)) to (Left(sOutConnStr, iStart - 1))
68922>>>>>>>                
68922>>>>>>>                If (iStart = iEnd) ;                    Move 0 to iStart
68925>>>>>>>            End
68925>>>>>>>>
68925>>>>>>>        Loop
68926>>>>>>>>
68926>>>>>>>        
68926>>>>>>>        Function_Return (Item_Count(hoStore))
68927>>>>>>>    End_Function
68928>>>>>>>    
68928>>>>>>>    
68928>>>>>>>    
68928>>>>>>>    //   Call the driver's browse connect function
68928>>>>>>>    Function BrowseConnect String sInConnStr Returns String
68930>>>>>>>        String  sDriver
68930>>>>>>>        String  sOutConnStr
68930>>>>>>>        Integer iArg
68930>>>>>>>        Integer iRetval
68930>>>>>>>        
68930>>>>>>>        Get psDriverID to sDriver
68931>>>>>>>        If (sDriver <> "") Begin
68933>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
68934>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
68939>>>>>>>        End
68939>>>>>>>>
68939>>>>>>>        
68939>>>>>>>        Function_Return sOutConnStr
68940>>>>>>>    End_Function// BrowseConnect
68941>>>>>>>    
68941>>>>>>>    
68941>>>>>>>    Function BrowseConnectLocal String sInConnStr Returns String
68943>>>>>>>        String  sDriver
68943>>>>>>>        String  sOutConnStr
68943>>>>>>>        Integer iArg
68943>>>>>>>        Integer iRetval
68943>>>>>>>        
68943>>>>>>>        Move 1 to iArg // Browses only local
68944>>>>>>>        
68944>>>>>>>        Get psDriverID to sDriver
68945>>>>>>>        If (sDriver <> "") Begin
68947>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
68948>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
68953>>>>>>>        End
68953>>>>>>>>
68953>>>>>>>        
68953>>>>>>>        Function_Return sOutConnStr
68954>>>>>>>    End_Function// BrowseConnect
68955>>>>>>>    
68955>>>>>>>    
68955>>>>>>>    Function EnumerateServersNetworkOrLocal Integer iNetworkLocal  Returns Integer
68957>>>>>>>        
68957>>>>>>>        String  sServerList
68957>>>>>>>        Integer iNumServers
68957>>>>>>>        Integer iDriver
68957>>>>>>>        Integer iClientVersion
68957>>>>>>>        String  sDriver
68957>>>>>>>        
68957>>>>>>>        Get DriverIndex MSSQLDRV_ID to iDriver
68958>>>>>>>        
68958>>>>>>>        If (iDriver) Begin
68960>>>>>>>            
68960>>>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iDriver to iClientVersion
68963>>>>>>>            
68963>>>>>>>            Get SqlServerClientDriverName iClientVersion to sDriver
68964>>>>>>>            
68964>>>>>>>            Move ("DRIVER={" + sDriver + "};") to sDriver
68965>>>>>>>            If (iNetworkLocal = 0) Begin
68967>>>>>>>                Get BrowseConnect sDriver to sServerList
68968>>>>>>>            End
68968>>>>>>>>
68968>>>>>>>            Else Begin
68969>>>>>>>                Get BrowseConnectLocal sDriver to sServerList
68970>>>>>>>            End
68970>>>>>>>>
68970>>>>>>>            Get ExtractList sServerList Current_object to iNumServers
68971>>>>>>>        End
68971>>>>>>>>
68971>>>>>>>        
68971>>>>>>>        Function_Return iNumServers
68972>>>>>>>        
68972>>>>>>>    End_Function
68973>>>>>>>    
68973>>>>>>>    //   Enumerate the available SQL Server database servers
68973>>>>>>>    //   This function will return all SQL Server instances on the network.
68973>>>>>>>    //   This may take a long time.
68973>>>>>>>    //   To enumerate only local SQL Server instances use EnumerateServersLocal
68973>>>>>>>    Function EnumerateServers Returns Integer
68975>>>>>>>        
68975>>>>>>>        Integer iNumServers
68975>>>>>>>        Integer iNetworkLocal
68975>>>>>>>        
68975>>>>>>>        Move 0 to iNetworkLocal // 0 = enumerate network servers
68976>>>>>>>        
68976>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
68977>>>>>>>        
68977>>>>>>>        Function_Return iNumServers
68978>>>>>>>        
68978>>>>>>>    End_Function
68979>>>>>>>    
68979>>>>>>>    
68979>>>>>>>    //   Enumerate the available SQL Server database servers
68979>>>>>>>    //   This function will return only return SQL Server instance on the local machine
68979>>>>>>>    //   To enumerate all SQL Server instances in a network use EnumerateServers
68979>>>>>>>    Function EnumerateServersLocal Returns Integer
68981>>>>>>>        
68981>>>>>>>        Integer iNumServers
68981>>>>>>>        Integer iNetworkLocal
68981>>>>>>>        
68981>>>>>>>        Move 1 to iNetworkLocal // 1 = enumerate local servers
68982>>>>>>>        
68982>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
68983>>>>>>>        
68983>>>>>>>        Function_Return iNumServers
68984>>>>>>>        
68984>>>>>>>    End_Function
68985>>>>>>>    
68985>>>>>>>    
68985>>>>>>>    
68985>>>>>>>    //   Enumerate database in a given server.
68985>>>>>>>    Function EnumerateDatabases String sServer String sUser String sPassWord Returns Integer
68987>>>>>>>        Integer hoSQL
68987>>>>>>>        String  sConnect
68987>>>>>>>        String  sDatabase
68987>>>>>>>        Integer hdbc
68987>>>>>>>        Integer hstmt
68987>>>>>>>        Integer iFetchResult
68987>>>>>>>        
68987>>>>>>>        If (Num_Arguments < 3) ;            Move "" to sPassWord
68990>>>>>>>        If (Num_Arguments < 2) ;            Move "" to sUser
68993>>>>>>>        
68993>>>>>>>        If (sUser <> "") ;            Move ("SERVER=" + Trim(sServer) + ";UID=" + Trim(sUser) + ";PWD=" + Trim(sPassword) + ";") to sConnect
68996>>>>>>>        Else ;            Move ("SERVER=" + Trim(sServer) + ";Trusted_Connection=yes") to sConnect
68998>>>>>>>        
68998>>>>>>>        Object oEnumDBSQLmanager is a cSQLHandleManager
69000>>>>>>>            Move Current_Object to hoSQL
69001>>>>>>>        End_Object
69002>>>>>>>        
69002>>>>>>>        If (hoSQL <> 0) Begin
69004>>>>>>>            Get SQLConnect of hoSQL "MSSQLDRV" sConnect to hdbc
69005>>>>>>>            If (hdbc <> 0) Begin
69007>>>>>>>                Get SQLOpen of hdbc to hstmt
69008>>>>>>>                If (hstmt <> 0) Begin
69010>>>>>>>                    //   We could do a direct select on the sysdatabases table but we use
69010>>>>>>>                    //   the stored procedure sp_database instead. SQL Server recommends this
69010>>>>>>>                    //   approach in case meta data might change, the stored procedure will
69010>>>>>>>                    //   stay the same.
69010>>>>>>>                    Send SQLSetProcedureName to hstmt "sp_databases"
69011>>>>>>>                    Send SQLCall to hstmt
69012>>>>>>>                    Repeat
69012>>>>>>>>
69012>>>>>>>                        Get SQLFetch of hstmt to iFetchResult
69013>>>>>>>                        If (iFetchResult <> 0) Begin
69015>>>>>>>                            Get SQLColumnValue of hstmt 1 to sDatabase
69016>>>>>>>                            Set Value  (Item_Count(Current_Object)) to sDatabase
69017>>>>>>>                        End
69017>>>>>>>>
69017>>>>>>>                    Until (iFetchResult = 0)
69019>>>>>>>                    
69019>>>>>>>                    Send SQLClose to hstmt
69020>>>>>>>                End
69020>>>>>>>>
69020>>>>>>>                Send SQLDisconnect to hdbc
69021>>>>>>>            End
69021>>>>>>>>
69021>>>>>>>        End
69021>>>>>>>>
69021>>>>>>>        Send Destroy_Object to hoSQL
69022>>>>>>>        
69022>>>>>>>        Function_Return (Item_Count(Current_Object))
69023>>>>>>>    End_Function
69024>>>>>>>    
69024>>>>>>>    
69024>>>>>>>    Function SqlServerClientVersionName Integer iClientVersion  Returns String
69026>>>>>>>        
69026>>>>>>>        String  sSqlServerClientVersionName
69026>>>>>>>        
69026>>>>>>>        
69026>>>>>>>        Case Begin
69026>>>>>>>            
69026>>>>>>>            Case (iClientVersion = SQLSERVER2017CLIENT)
69028>>>>>>>                Move SQLSERVER2017CLIENTNAME to sSqlServerClientVersionName
69029>>>>>>>                Case Break
69030>>>>>>>                
69030>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
69033>>>>>>>                Move SQLSERVER2016CLIENTNAME to sSqlServerClientVersionName
69034>>>>>>>                Case Break
69035>>>>>>>            
69035>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
69038>>>>>>>                Move SQLSERVER2014CLIENTNAME to sSqlServerClientVersionName
69039>>>>>>>                Case Break
69040>>>>>>>            
69040>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
69043>>>>>>>                Move SQLSERVER2012CLIENTNAME to sSqlServerClientVersionName
69044>>>>>>>                Case Break
69045>>>>>>>            
69045>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
69048>>>>>>>                Move SQLSERVER2008CLIENTNAME to sSqlServerClientVersionName
69049>>>>>>>                Case Break
69050>>>>>>>            
69050>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
69053>>>>>>>                Move SQLSERVER2005CLIENTNAME to sSqlServerClientVersionName
69054>>>>>>>                Case Break
69055>>>>>>>            
69055>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
69058>>>>>>>                Move SQLSERVER2000CLIENTNAME to sSqlServerClientVersionName
69059>>>>>>>                Case Break
69060>>>>>>>            
69060>>>>>>>            Case Else
69060>>>>>>>                Move SQLSERVERUNKNOWNCLIENTNAME to sSqlServerClientVersionName
69061>>>>>>>                
69061>>>>>>>        Case End
69061>>>>>>>        
69061>>>>>>>        
69061>>>>>>>        Function_Return sSqlServerClientVersionName
69062>>>>>>>        
69062>>>>>>>    End_Function
69063>>>>>>>
69063>>>>>>>
69063>>>>>>>    Function SqlServerClientDriverName Integer iClientVersion  Returns String
69065>>>>>>>        
69065>>>>>>>        String  sSqlServerClientDriverName
69065>>>>>>>        
69065>>>>>>>        Case Begin
69065>>>>>>>            
69065>>>>>>>            Case (iClientVersion = SQLSERVER2017CLIENT)
69067>>>>>>>                Move SQLSERVER2017DRVRSTR to sSqlServerClientDriverName
69068>>>>>>>                Case Break
69069>>>>>>>                
69069>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
69072>>>>>>>                Move SQLSERVER2016DRVRSTR to sSqlServerClientDriverName
69073>>>>>>>                Case Break
69074>>>>>>>            
69074>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
69077>>>>>>>                Move SQLSERVER2014DRVRSTR to sSqlServerClientDriverName
69078>>>>>>>                Case Break
69079>>>>>>>            
69079>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
69082>>>>>>>                Move SQLSERVER2012DRVRSTR to sSqlServerClientDriverName
69083>>>>>>>                Case Break
69084>>>>>>>            
69084>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
69087>>>>>>>                Move SQLSERVER2008DRVRSTR to sSqlServerClientDriverName
69088>>>>>>>                Case Break
69089>>>>>>>            
69089>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
69092>>>>>>>                Move SQLSERVER2005DRVRSTR to sSqlServerClientDriverName
69093>>>>>>>                Case Break
69094>>>>>>>            
69094>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
69097>>>>>>>                Move SQLSERVER2000DRVRSTR to sSqlServerClientDriverName
69098>>>>>>>                Case Break
69099>>>>>>>            
69099>>>>>>>            Case Else
69099>>>>>>>                Move SQLSERVER2000DRVRSTR to sSqlServerClientDriverName
69100>>>>>>>                
69100>>>>>>>        Case End
69100>>>>>>>        
69100>>>>>>>        
69100>>>>>>>        Function_Return sSqlServerClientDriverName
69101>>>>>>>        
69101>>>>>>>    End_Function
69102>>>>>>>    
69102>>>>>>>    
69102>>>>>>>End_Class
69103>>>>>>>
69103>>>>>>>
69103>>>>>
69103>>>>>
69103>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
69104>>>>>
69104>>>>>Register_Function phoWorkspace Returns Handle
69104>>>>>Register_Function Help_filename Returns String
69104>>>>>Register_Function GetHelpFile Returns String
69104>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
69104>>>>>
69104>>>>>//    This function reads the current username Of windows and returns that
69104>>>>>//    name or an text unknown user
69104>>>>>Function Network_User_Name for cDesktop Returns String
69106>>>>>    String sName
69106>>>>>    Integer iRetval iLength
69106>>>>>    
69106>>>>>    Move 0 to iLength
69107>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
69108>>>>>    Move (ZeroString(iLength)) to sName
69109>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
69110>>>>>    
69110>>>>>    If (iRetval = NO_ERROR) Begin
69112>>>>>        Function_Return (CString (sName))
69113>>>>>    End
69113>>>>>>
69113>>>>>    
69113>>>>>    Function_Return "User Unknown"
69114>>>>>End_Function
69115>>>>>
69115>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
69116>>>>>
69116>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
69117>>>>>
69117>>>>>Class SysinfoDisplay is a cTextEdit
69118>>>>>    Procedure Construct_Object
69120>>>>>        Forward Send Construct_Object
69122>>>>>        
69122>>>>>        Set Location to 6 6
69123>>>>>        Set Size to 110 255
69124>>>>>        Set Read_Only_State to True
69125>>>>>        Set pbWrap to False
69126>>>>>    End_Procedure
69127>>>>>    
69127>>>>>    //    This method will show the name Of the current directory in the system
69127>>>>>    //    information box
69127>>>>>    Procedure Show_Current_Directory
69129>>>>>        String sDir
69129>>>>>        
69129>>>>>        Get_Current_Directory to sDir
69130>>>>>        
69130>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
69131>>>>>    End_Procedure
69132>>>>>    
69132>>>>>    Procedure Show_Windows_Directory
69134>>>>>        String sWindir
69134>>>>>        
69134>>>>>        Get_Windows_Directory to sWindir
69135>>>>>        
69135>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
69136>>>>>    End_Procedure
69137>>>>>    
69137>>>>>    Procedure Show_Current_User
69139>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
69140>>>>>    End_Procedure
69141>>>>>    
69141>>>>>    Procedure Show_Number_Format
69143>>>>>        Integer iFormat
69143>>>>>        String sFormatText
69143>>>>>        
69143>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
69146>>>>>        Move (Character (iFormat)) to sFormatText
69147>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
69148>>>>>        
69148>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
69151>>>>>        Move (Character (iFormat)) to sFormatText
69152>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
69153>>>>>    End_Procedure
69154>>>>>    
69154>>>>>    Procedure Show_Filelist_Name
69156>>>>>        String sFilename
69156>>>>>        
69156>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
69159>>>>>        
69159>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
69160>>>>>        Send AppendTextLn ""
69161>>>>>    End_Procedure
69162>>>>>    
69162>>>>>    Procedure Show_Lock_Delay
69164>>>>>        Integer iLockdelay
69164>>>>>        
69164>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
69167>>>>>        
69167>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
69168>>>>>    End_Procedure
69169>>>>>    
69169>>>>>    Procedure Show_Lock_Timeout
69171>>>>>        Integer iLockTimeout
69171>>>>>        
69171>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
69174>>>>>        
69174>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
69175>>>>>    End_Procedure
69176>>>>>    
69176>>>>>    Procedure Show_Screen_Size
69178>>>>>        Integer iYscreensize iXscreensize
69178>>>>>        
69178>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) to iXscreensize
69179>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) to iYscreensize
69180>>>>>        
69180>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
69181>>>>>    End_Procedure
69182>>>>>    
69182>>>>>    Procedure Show_Page_Size
69184>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
69185>>>>>    End_Procedure
69186>>>>>    
69186>>>>>    Procedure Show_Date
69188>>>>>        Date dToday
69188>>>>>        
69188>>>>>        Move (CurrentDateTime()) to  dToday
69189>>>>>        
69189>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
69190>>>>>    End_Procedure
69191>>>>>    
69191>>>>>    Procedure Show_Date_Format
69193>>>>>        Integer iDateFormat
69193>>>>>        String sDateFormat
69193>>>>>        
69193>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
69196>>>>>        Case Begin
69196>>>>>            Case (iDateFormat = DF_DATE_USA)
69198>>>>>                Move C_$USA to sDateFormat
69199>>>>>                Case Break
69200>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
69203>>>>>                Move C_$European to sDateFormat
69204>>>>>                Case Break
69205>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
69208>>>>>                Move C_$Military to sDateFormat
69209>>>>>                Case Break
69210>>>>>            Case Else
69210>>>>>                Move C_$UnknownDateType to sDateFormat
69211>>>>>                Case Break
69212>>>>>        Case End
69212>>>>>        
69212>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
69213>>>>>    End_Procedure
69214>>>>>    
69214>>>>>    Procedure Show_Systemresources
69216>>>>>        tWinMemoryStatusEx MemoryStatusInfo
69216>>>>>        tWinMemoryStatusEx MemoryStatusInfo
69216>>>>>        Integer iRetval
69216>>>>>        
69216>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
69217>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
69218>>>>>        If (iRetval = 0) Begin
69220>>>>>            Move (ShowLastError ()) to iRetval
69221>>>>>        End
69221>>>>>>
69221>>>>>        
69221>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
69222>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
69223>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Integer ( Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0)))
69224>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Integer ( Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0)))
69225>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Integer ( Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0)))
69226>>>>>    End_Procedure
69227>>>>>    
69227>>>>>    Procedure Show_Registration
69229>>>>>        String sRegName
69229>>>>>        Integer iSN iMaxUsers
69229>>>>>        
69229>>>>>        Registration sRegName iSN
69230>>>>>>
69230>>>>>        
69230>>>>>        Get_Licensed_Max_Users to iMaxUsers
69231>>>>>        
69231>>>>>        Send AppendTextLn ""
69232>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
69233>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
69234>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
69235>>>>>    End_Procedure
69236>>>>>    
69236>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
69236>>>>>    // To the workspace object passing the an object and message To send back
69236>>>>>    // To this object. It is expected that the workspace object will send this
69236>>>>>    // message for every line Of information it wants displayed (passing the
69236>>>>>    // information To be displayed
69236>>>>>    Register_Procedure EnumerateWorkspaceData Handle hObjId Handle hmMessId
69236>>>>>    
69236>>>>>    Procedure Show_ServicePack
69238>>>>>        String sKey sVersionDescription sVersion
69238>>>>>        Handle hoRegistry
69238>>>>>        Boolean bExists bOpened
69238>>>>>        
69238>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
69239>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
69240>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
69241>>>>>        
69241>>>>>        Move C_DFVersionRegistryRoot to sKey
69242>>>>>        Get KeyExists of hoRegistry sKey to bExists
69243>>>>>        If (bExists) Begin
69245>>>>>            Get OpenKey of hoRegistry sKey to bOpened
69246>>>>>            If (bOpened) Begin
69248>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
69249>>>>>                If (bExists) Begin
69251>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
69252>>>>>                End
69252>>>>>>
69252>>>>>                
69252>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
69253>>>>>                If (bExists) Begin
69255>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
69256>>>>>                End
69256>>>>>>
69256>>>>>                Send CloseKey of hoRegistry
69257>>>>>            End
69257>>>>>>
69257>>>>>        End
69257>>>>>>
69257>>>>>        Send Destroy of hoRegistry
69258>>>>>        
69258>>>>>        If (sVersionDescription <> "") Begin
69260>>>>>            Send AppendTextLn (sVersionDescription * "-" * sVersion)
69261>>>>>            Send AppendTextLn ""
69262>>>>>        End
69262>>>>>>
69262>>>>>    End_Procedure
69263>>>>>    
69263>>>>>    
69263>>>>>    Procedure Show_WorkspaceInformation
69265>>>>>        Integer hoWorkspace
69265>>>>>        
69265>>>>>        If (ghoApplication <> 0) Begin
69267>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
69268>>>>>            If (hoWorkspace <> 0) Begin
69270>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
69271>>>>>                Send AppendTextLn ""
69272>>>>>            End
69272>>>>>>
69272>>>>>        End
69272>>>>>>
69272>>>>>    End_Procedure
69273>>>>>    
69273>>>>>    // If connection ids are used, we will send the message EnumerateConnections
69273>>>>>    // to the connection manager object passing the an object and message to send
69273>>>>>    // back to this object. It is expected that the connection manager object will
69273>>>>>    // send this message for every line Of information it wants displayed (passing
69273>>>>>    // the information To be displayed
69273>>>>>    Register_Procedure EnumerateConnections Integer hObjId Integer hmMessId
69273>>>>>    
69273>>>>>    Procedure Show_ConnectionIdInformation
69275>>>>>        If (ghoConnection > 0) Begin
69277>>>>>            Send AppendTextLn ""
69278>>>>>            Send EnumerateConnections of ghoConnection Self (RefProc(AppendTextLn))
69279>>>>>        End
69279>>>>>>
69279>>>>>    End_Procedure
69280>>>>>    
69280>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
69282>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
69283>>>>>    End_Function
69284>>>>>    
69284>>>>>    Procedure Show_Versions
69286>>>>>        Integer iVersion iRevision iBuild
69286>>>>>        
69286>>>>>        Version_Information iVersion iRevision iBuild
69288>>>>>        
69288>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
69289>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
69290>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
69291>>>>>    End_Procedure
69292>>>>>    
69292>>>>>    Function CKRevisionNumber String sDriverID Returns String
69294>>>>>        Handle hoCLIHandler
69294>>>>>        Handle hoDFBtrDrvHandler
69294>>>>>        String sCKRevision
69294>>>>>        
69294>>>>>        
69294>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
69296>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
69297>>>>>            Set psDriverID of hoCLIHandler to sDriverID
69298>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
69299>>>>>            Send Destroy of hoCLIHandler
69300>>>>>        End
69300>>>>>>
69300>>>>>        Else Begin
69301>>>>>            If (sDriverID = "DFBTRDRV") Begin
69303>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
69304>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
69305>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
69306>>>>>                Send Destroy of hoDFBtrDrvHandler
69307>>>>>            End
69307>>>>>>
69307>>>>>        End
69307>>>>>>
69307>>>>>        
69307>>>>>        Function_Return sCKRevision
69308>>>>>    End_Function
69309>>>>>    
69309>>>>>    
69309>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
69311>>>>>        
69311>>>>>        If (sDriverID = "DATAFLEX") Begin
69313>>>>>            Function_Return False
69314>>>>>        End
69314>>>>>>
69314>>>>>        
69314>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
69315>>>>>    End_Function
69316>>>>>    
69316>>>>>    
69316>>>>>    Procedure Show_Drivers
69318>>>>>        String sCurrentDriver sRevNumber
69318>>>>>        String sLoadedDrivers sClientDriver
69318>>>>>        Integer iNumberOfDrivers iCount iClientVersion iMSSQLIndex
69318>>>>>        Boolean bOK
69318>>>>>        Handle hoMsqlDrv
69318>>>>>        
69318>>>>>        Move "" to sLoadedDrivers
69319>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
69322>>>>>        For iCount from 1 to iNumberOfDrivers
69328>>>>>>
69328>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
69331>>>>>            If (sLoadedDrivers <> "") Begin
69333>>>>>                Move (Append (sLoadedDrivers, ", ")) to sLoadedDrivers
69334>>>>>            End
69334>>>>>>
69334>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
69335>>>>>            If (bOK) Begin
69337>>>>>                If (sCurrentDriver = "MSSQLDRV") Begin
69339>>>>>                    Move iCount to iMSSQLIndex
69340>>>>>                End
69340>>>>>>
69340>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
69341>>>>>                // if mssqldrv, show the client number
69341>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
69342>>>>>            End
69342>>>>>>
69342>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) to sLoadedDrivers
69343>>>>>        Loop
69344>>>>>>
69344>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
69345>>>>>        If (iMSSQLIndex>0) Begin
69347>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iMSSQLIndex to iClientVersion
69350>>>>>            Get Create (RefClass(cMSSQLHandler)) to hoMsqlDrv
69351>>>>>            Get SqlServerClientVersionName of hoMsqlDrv iClientVersion to sClientDriver
69352>>>>>            Send Destroy of hoMsqlDrv
69353>>>>>            Send AppendTextLn (SFormat("MSSQLDRV Client Version: %1", sClientDriver))
69354>>>>>        End
69354>>>>>>
69354>>>>>    End_Procedure
69355>>>>>    
69355>>>>>    Procedure Show_HelpFile
69357>>>>>        String sHelpFile
69357>>>>>        Integer eHelpType
69357>>>>>        
69357>>>>>        If (ghoApplication <> 0) Begin
69359>>>>>            Get peHelpType of ghoApplication to eHelpType
69360>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
69362>>>>>                Get GetHelpFile of ghoHtmlHelp to sHelpFile
69363>>>>>            End
69363>>>>>>
69363>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
69366>>>>>                Get Help_filename of Help_object_id to sHelpFile
69367>>>>>            End
69367>>>>>>
69367>>>>>            Else Begin
69368>>>>>                Move C_$ThereIsNoHelpfileDefined to sHelpFile
69369>>>>>            End
69369>>>>>>
69369>>>>>            
69369>>>>>            Send AppendTextLn ""
69370>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
69371>>>>>        End
69371>>>>>>
69371>>>>>    End_Procedure
69372>>>>>    
69372>>>>>    Procedure Show_EnterAsTab
69374>>>>>        Boolean bEnterKeyAsTabKey
69374>>>>>        String sText
69374>>>>>        
69374>>>>>        If (ghoApplication <> 0) Begin
69376>>>>>            Get pbEnterKeyAsTabKey of ghoApplication to bEnterKeyAsTabKey
69377>>>>>            If (bEnterKeyAsTabKey) Begin
69379>>>>>                Move "True" to sText
69380>>>>>            End
69380>>>>>>
69380>>>>>            Else Begin
69381>>>>>                Move "False" to sText
69382>>>>>            End
69382>>>>>>
69382>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
69383>>>>>        End
69383>>>>>>
69383>>>>>    End_Procedure
69384>>>>>    
69384>>>>>    //    During activation we will remove the old information and add the newly
69384>>>>>    //    found systeminformation
69384>>>>>    Procedure Add_Focus Integer hoRoot
69386>>>>>        Forward Send Add_Focus hoRoot
69388>>>>>        
69388>>>>>        Send Delete_Data
69389>>>>>        
69389>>>>>        Set Changed_State to False
69390>>>>>        Set Read_Only_State to True
69391>>>>>        
69391>>>>>        Send Show_ServicePack
69392>>>>>        Send Show_Versions
69393>>>>>        Send Show_Drivers
69394>>>>>        If (ghoConnection <> 0) Begin
69396>>>>>            Send Show_ConnectionIdInformation
69397>>>>>        End
69397>>>>>>
69397>>>>>        Send Show_HelpFile
69398>>>>>        Send Show_Current_Directory
69399>>>>>        Send Show_Filelist_Name
69400>>>>>        If (ghoApplication <> 0) Begin
69402>>>>>            Send Show_WorkSpaceInformation // added To show WS info
69403>>>>>        End
69403>>>>>>
69403>>>>>        Send Show_Current_User
69404>>>>>        Send Show_Windows_Directory
69405>>>>>        Send Show_Screen_Size
69406>>>>>        Send Show_Page_Size
69407>>>>>        Send Show_EnterAsTab
69408>>>>>        Send Show_Number_Format
69409>>>>>        Send Show_Date_Format
69410>>>>>        Send Show_Lock_Delay
69411>>>>>        Send Show_Lock_Timeout
69412>>>>>        Send Show_Date
69413>>>>>        Send Show_Systemresources
69414>>>>>        Send Show_Registration
69415>>>>>        Send Beginning_of_Data
69416>>>>>        
69416>>>>>        Set Icon to 'default.ico'
69417>>>>>    End_Procedure
69418>>>>>End_Class
69419>>>>>
69419>>>>>Class SysInfoDialog is a ModalPanel
69420>>>>>    Procedure Construct_Object
69422>>>>>        Forward Send Construct_Object
69424>>>>>        
69424>>>>>        Set Label to C_$SystemInformation
69425>>>>>        Set Size to 140 267
69426>>>>>        Set piMinSize to 140 267
69427>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69428>>>>>        Set Border_Style to Border_Thick
69429>>>>>        
69429>>>>>        Object oSysinfoDisplay is a SysInfoDisplay
69431>>>>>            Set peAnchors to anAll
69432>>>>>        End_Object
69433>>>>>        
69433>>>>>        Object oCloseButton is a Button
69435>>>>>            Set Label to C_$Close
69436>>>>>            Set Location to 120 210
69437>>>>>            Set Message 0 to (Refproc (Close_Panel))
69438>>>>>            Set Default_State to True
69439>>>>>            Set peAnchors to anBottomRight
69440>>>>>        End_Object
69441>>>>>        
69441>>>>>        On_Key kCancel Send Close_Panel
69442>>>>>    End_Procedure
69443>>>>>End_Class
69444>>>>>
69444>>>>>Class AboutDialog is a ModalPanel
69445>>>>>    Procedure Construct_Object
69447>>>>>        String sVdfRootDir
69447>>>>>        
69447>>>>>        Forward Send Construct_Object
69449>>>>>        
69449>>>>>        Set Label to C_$About
69450>>>>>        Set Size to 89 212
69451>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69452>>>>>        
69452>>>>>        Object oSysInfoDialog is a SysInfoDialog
69454>>>>>        End_Object
69455>>>>>        
69455>>>>>        Object oBox is a Container3d
69457>>>>>            Set Border_Style to Border_StaticEdge
69458>>>>>            Set Size to 63 202
69459>>>>>            Set Location to 4 5
69460>>>>>            
69460>>>>>            Object oAboutGraphic is a BitmapContainer
69462>>>>>                Set Border_Style to Border_None
69463>>>>>                Set Bitmap_Style to Bitmap_Center
69464>>>>>                Set Size to 48 48
69465>>>>>                Set Location to 7 2
69466>>>>>            End_Object
69467>>>>>            
69467>>>>>            Object oProductName is a TextBox
69469>>>>>                Set Label to C_$ProductName
69470>>>>>                Set Size to 10 45
69471>>>>>                Set Location to 8 53
69472>>>>>            End_Object
69473>>>>>            
69473>>>>>            Object oVersion is a TextBox
69475>>>>>                Set Label to C_$Version
69476>>>>>                Set Size to 10 25
69477>>>>>                Set Location to 21 53
69478>>>>>            End_Object
69479>>>>>            
69479>>>>>            Object oCopyright is a TextBox
69481>>>>>                Set Label to C_$Copyright
69482>>>>>                Set Size to 10 31
69483>>>>>                Set Location to 34 53
69484>>>>>            End_Object
69485>>>>>            
69485>>>>>            Object oAuthor is a TextBox
69487>>>>>                Set Label to C_$Author
69488>>>>>                Set Size to 10 22
69489>>>>>                Set Location to 46 53
69490>>>>>            End_Object
69491>>>>>        End_Object
69492>>>>>        
69492>>>>>        Object oOKButton is a Button
69494>>>>>            On_Item C_$OK Send Close_Panel
69495>>>>>            Set Size to 14 50
69496>>>>>            Set Location to 71 157
69497>>>>>        End_Object
69498>>>>>        
69498>>>>>        Object oSysInfoButton is a Button
69500>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
69501>>>>>            Set Size to 14 50
69502>>>>>            Set Location to 71 101
69503>>>>>        End_Object
69504>>>>>        
69504>>>>>        On_Key Kcancel Send KeyAction of oOKButton
69505>>>>>        
69505>>>>>        Set Logo to "DacAbout.bmp"  // square bitmaps Of 42x42 work best
69506>>>>>    End_Procedure
69507>>>>>    
69507>>>>>    Procedure Set ProductName String sProductName
69509>>>>>        Set Label of oProductName to sProductName
69510>>>>>    End_Procedure
69511>>>>>    
69511>>>>>    Procedure Set Version String sVersion
69513>>>>>        Set Label of oVersion to sVersion
69514>>>>>    End_Procedure
69515>>>>>    
69515>>>>>    Procedure Set Copyright String sCopyright
69517>>>>>        Set Label of oCopyright to sCopyright
69518>>>>>    End_Procedure
69519>>>>>    
69519>>>>>    Procedure Set Author String sAuthor
69521>>>>>        Set Label of oAuthor to sAuthor
69522>>>>>    End_Procedure
69523>>>>>    
69523>>>>>    Procedure Set Logo String sLogo
69525>>>>>        // square bitmaps Of 42x42 work best
69525>>>>>        Set Bitmap of oAboutGraphic to sLogo
69526>>>>>    End_Procedure
69527>>>>>    
69527>>>>>    Procedure Show_Sysinfo
69529>>>>>        Send Popup_Modal of oSysinfoDialog
69530>>>>>    End_Procedure
69531>>>>>    
69531>>>>>    Procedure End_Construct_Object
69533>>>>>        Handle hoVersionInfo
69533>>>>>        Boolean bIncluded
69533>>>>>        Integer iMajor iMinor iRelease iBuild
69533>>>>>        String sLabel
69533>>>>>        
69533>>>>>        Get Label of oVersion to sLabel
69534>>>>>        If (sLabel = C_$VERSION) Begin
69536>>>>>            // set it To the version info Of the program, if available
69536>>>>>            If (ghoApplication <> 0) Begin
69538>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
69539>>>>>                If (hoVersionInfo <> 0) Begin
69541>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
69542>>>>>                    If (bIncluded) Begin
69544>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
69545>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
69546>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
69547>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
69548>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
69549>>>>>                        Set Version to sLabel
69550>>>>>                    End
69550>>>>>>
69550>>>>>                End
69550>>>>>>
69550>>>>>            End
69550>>>>>>
69550>>>>>        End
69550>>>>>>
69550>>>>>        
69550>>>>>        Forward Send End_Construct_Object
69552>>>>>    End_Procedure
69553>>>>>End_Class
69554>>>
69554>>>//  This is the default message. It is expected that you will
69554>>>//  create your own message to override this
69554>>>Procedure Activate_About
69557>>>    Send DoAbout "" "" "" "" ""
69558>>>End_Procedure
69559>>>
69559>>>//  It is expected that you will send this message (most
69559>>>//  likely from Activate_About. This creates an about object, activates it
69559>>>//  and destroys it when done. It is not exepected that you will augment this.
69559>>>Procedure DoAbout String sTitle String sVersion String sCopyRight String sAuthor String sBitmap
69562>>>    Integer hoObj hoMain
69562>>>    
69562>>>    // create object
69562>>>    Object About is an AboutDialog
69564>>>        // if no title passed use the label of the main panel
69564>>>        // (if a main panel exists).
69564>>>        If (sTitle = "") Begin
69566>>>            Get Main_Window of desktop to hoMain
69567>>>            If hoMain ;                Get Label of hoMain to sTitle
69570>>>        End
69570>>>>
69570>>>        Set productname to sTitle
69571>>>        Set version     to sVersion
69572>>>        Set copyright   to sCopyRight
69573>>>        Set author      to sAuthor
69574>>>        If (sBitmap <> '') ;            Set logo to sBitMap // square bitmaps of 42x42 work best
69577>>>        Move Self to hoObj // object Id
69578>>>    End_Object
69579>>>    Send Popup   of hoObj    // popup the about object
69580>>>    Send Destroy of hoObj // when done, it will be destroyed
69581>>>End_Procedure
69582>>>
69582>        Use EmpEntry.vw
Including file: EmpEntry.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\EmpEntry.vw)
69582>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\EmpEntry.vw
69582>>>// EmpEntry
69582>>>//
69582>>>
69582>>>Use DFClient.pkg
69582>>>Use DFEntry.pkg
69582>>>
69582>>>Use cEmployeeDataDictionary.dd
Including file: cEmployeeDataDictionary.dd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\cEmployeeDataDictionary.dd)
69582>>>>>Use DataDict.pkg
69582>>>>>
69582>>>>>Open Employee
Including file: Employee.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\Employee.fd)
69584>>>>>Open PageHeader
Including file: PageHeader.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\PageHeader.fd)
69586>>>>>Open system
Including file: system.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\system.fd)
69588>>>>>
69588>>>>>Register_Object Employee_sl
69588>>>>>
69588>>>>>Class cEmployeeDataDictionary is a DataDictionary
69589>>>>>    
69589>>>>>    Procedure Construct_Object
69591>>>>>        Forward Send Construct_Object
69593>>>>>        Set Main_File to Employee.File_Number
69594>>>>>
69594>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69595>>>>>
69595>>>>>        Set Add_Client_File to PageHeader.File_Number
69596>>>>>
69596>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69597>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69598>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69599>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69600>>>>>
69600>>>>>        Set Field_Auto_Increment Field Employee.id to File_Field system.employee_id
69601>>>>>        Set Field_Prompt_Object Field Employee.id to Employee_sl
69602>>>>>
69602>>>>>    End_Procedure
69603>>>>>
69603>>>>>End_Class
69604>>>>>
69604>>>>>Use Employee.sl
Including file: Employee.sl    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\Employee.sl)
69604>>>>>>>// Employee.sl
69604>>>>>>>// Employee Lookup List
69604>>>>>>>
69604>>>>>>>Use DFClient.pkg
69604>>>>>>>Use cDbCJGridPromptList.pkg
69604>>>>>>>Use cDbCJGridColumn.pkg
69604>>>>>>>Use Windows.pkg
69604>>>>>>>
69604>>>>>>>Use cEmployeeDataDictionary.dd
69604>>>>>>>
69604>>>>>>>CD_Popup_Object Employee_sl is a dbModalPanel
69622>>>>>>>>
69622>>>>>>>    Set Location to 5 5
69623>>>>>>>    Set Size to 134 288
69624>>>>>>>    Set Label To "Employee Lookup List"
69625>>>>>>>    Set Border_Style to Border_Thick
69626>>>>>>>    Set Minimize_Icon to False
69627>>>>>>>
69627>>>>>>>
69627>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
69629>>>>>>>    End_Object 
69630>>>>>>>
69630>>>>>>>    Set Main_DD To oEmployee_DD
69631>>>>>>>    Set Server  To oEmployee_DD
69632>>>>>>>
69632>>>>>>>
69632>>>>>>>
69632>>>>>>>    Object oSelList is a cDbCJGridPromptList
69634>>>>>>>        Set Size to 105 278
69635>>>>>>>        Set Location to 5 5
69636>>>>>>>        Set peAnchors to anAll
69637>>>>>>>        Set psLayoutSection to "Employee_sl_oSelList"
69638>>>>>>>        Set Ordering to 1
69639>>>>>>>        Set pbAutoServer to True
69640>>>>>>>
69640>>>>>>>        Object oEmployee_id is a cDbCJGridColumn
69642>>>>>>>            Entry_Item Employee.id
69643>>>>>>>            Set piWidth to 46
69644>>>>>>>            Set psCaption to "id"
69645>>>>>>>        End_Object 
69646>>>>>>>
69646>>>>>>>        Object oEmployee_name is a cDbCJGridColumn
69648>>>>>>>            Entry_Item Employee.name
69649>>>>>>>            Set piWidth to 250
69650>>>>>>>            Set psCaption to "name"
69651>>>>>>>        End_Object 
69652>>>>>>>
69652>>>>>>>        Object oEmployee_id_card is a cDbCJGridColumn
69654>>>>>>>            Entry_Item Employee.id_card
69655>>>>>>>            Set piWidth to 150
69656>>>>>>>            Set psCaption to "id card"
69657>>>>>>>        End_Object 
69658>>>>>>>
69658>>>>>>>
69658>>>>>>>    End_Object 
69659>>>>>>>
69659>>>>>>>    Object oOk_bn is a Button
69661>>>>>>>        Set Label to "&Ok"
69662>>>>>>>        Set Location to 115 125
69663>>>>>>>        Set peAnchors to anBottomRight
69664>>>>>>>
69664>>>>>>>        Procedure OnClick
69667>>>>>>>            Send OK of oSelList
69668>>>>>>>        End_Procedure
69669>>>>>>>
69669>>>>>>>    End_Object 
69670>>>>>>>
69670>>>>>>>    Object oCancel_bn is a Button
69672>>>>>>>        Set Label to "&Cancel"
69673>>>>>>>        Set Location to 115 179
69674>>>>>>>        Set peAnchors to anBottomRight
69675>>>>>>>
69675>>>>>>>        Procedure OnClick
69678>>>>>>>            Send Cancel of oSelList
69679>>>>>>>        End_Procedure
69680>>>>>>>
69680>>>>>>>    End_Object 
69681>>>>>>>
69681>>>>>>>    Object oSearch_bn is a Button
69683>>>>>>>        Set Label to "&Search..."
69684>>>>>>>        Set Location to 115 233
69685>>>>>>>        Set peAnchors to anBottomRight
69686>>>>>>>
69686>>>>>>>        Procedure OnClick
69689>>>>>>>            Send Search of oSelList
69690>>>>>>>        End_Procedure
69691>>>>>>>
69691>>>>>>>    End_Object 
69692>>>>>>>
69692>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
69693>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
69694>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
69695>>>>>>>
69695>>>>>>>
69695>>>>>>>CD_End_Object // Employee_sl
69697>>>>>>>>
69697>>>
69697>>>ACTIVATE_VIEW Activate_oEmpEntry FOR oEmpEntry
69707>>>>
69707>>>Object oEmpEntry is a dbView
69709>>>    Set Location to 5 5
69710>>>    Set Size to 240 452
69711>>>    Set Label To "EmpEntry"
69712>>>    Set Border_Style to Border_Thick
69713>>>
69713>>>
69713>>>    Object oEmployee_DD is a cEmployeeDataDictionary
69715>>>    End_Object 
69716>>>
69716>>>    Set Main_DD To oEmployee_DD
69717>>>    Set Server  To oEmployee_DD
69718>>>
69718>>>
69718>>>
69718>>>    Object oEmployeeid is a dbForm
69720>>>        Entry_Item Employee.id
69721>>>        Set Size to 12 34
69722>>>        Set Location to 5 13
69723>>>        Set peAnchors to anTopLeftRight
69724>>>        Set Label to "id"
69725>>>        Set Label_Justification_mode to jMode_Left
69726>>>        Set Label_Col_Offset to 8
69727>>>        Set Label_row_Offset to 0
69728>>>    End_Object 
69729>>>
69729>>>    Object oEmployeename is a dbForm
69731>>>        Entry_Item Employee.name
69732>>>        Set Size to 12 250
69733>>>        Set Location to 5 72
69734>>>        Set peAnchors to anTopRight
69735>>>        Set Label to "name"
69736>>>        Set Label_Justification_mode to jMode_Left
69737>>>        Set Label_Col_Offset to 20
69738>>>        Set Label_row_Offset to 0
69739>>>    End_Object 
69740>>>
69740>>>    Object oEmployeeid_card is a dbForm
69742>>>        Entry_Item Employee.id_card
69743>>>        Set Size to 12 96
69744>>>        Set Location to 5 351
69745>>>        Set peAnchors to anTopRight
69746>>>        Set Label to "id card"
69747>>>        Set Label_Justification_mode to jMode_Left
69748>>>        Set Label_Col_Offset to 24
69749>>>        Set Label_row_Offset to 0
69750>>>    End_Object
69751>>>    
69751>>>    Object oDetailGrid is a cDbCJGrid
69753>>>        Set Size to 447 348
69754>>>        Set Location to 73 5
69755>>>        Set Server to oEmployee_DD
69756>>>        Set Ordering to 1
69757>>>        Set peAnchors to anAll
69758>>>        Set psLayoutSection to "oEmployeeEntry_oDetailGrid"
69759>>>        Set pbAllowInsertRow to False
69760>>>        Set pbHeaderPrompts to True
69761>>>        
69761>>>        
69761>>>        
69761>>>        Object oEmployeeId is a cDbCJGridColumn
69763>>>        Entry_Item Employee.id
69764>>>        Set piWidth to 78
69765>>>        Set psCaption to "Azonosito"
69766>>>        End_Object
69767>>>        
69767>>>        
69767>>>        
69767>>>        Object oEmployeeName is a cDbCJGridColumn
69769>>>        Entry_Item Employee.name
69770>>>        Set piWidth to 115
69771>>>        Set psCaption to "Nv"
69772>>>        End_Object
69773>>>        
69773>>>        
69773>>>        
69773>>>        Object oEmployeeIdCard is a cDbCJGridColumn
69775>>>        Entry_Item Employee.id_card
69776>>>        Set piWidth to 387
69777>>>        Set psCaption to "Szemlyig."
69778>>>        End_Object
69779>>>
69779>>>
69779>>>
69779>>>    End_Object
69780>>>    
69780>>>End_Object 
69781>        Use LineEntry.vw
Including file: LineEntry.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\LineEntry.vw)
69781>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\LineEntry.vw
69781>>>// LineEntry
69781>>>//
69781>>>
69781>>>Use DFClient.pkg
69781>>>Use DFEntry.pkg
69781>>>
69781>>>Use cLineDataDictionary.dd
Including file: cLineDataDictionary.dd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\cLineDataDictionary.dd)
69781>>>>>Use DataDict.pkg
69781>>>>>
69781>>>>>Open Line
Including file: Line.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\Line.fd)
69783>>>>>Open PageHeader
69785>>>>>Open system
69787>>>>>
69787>>>>>Object oTypeValid is a DescriptionValidationTable
69789>>>>>    Procedure Fill_List
69792>>>>>        Forward Send Fill_List
69794>>>>>        Send Add_Table_Value "Type A" "Type A"
69795>>>>>        Send Add_Table_Value "Type B" "Type B"
69796>>>>>        Send Add_Table_Value "Type C" "Type C"
69797>>>>>        Send Add_Table_Value "Type D" "Type D"
69798>>>>>        Send Add_Table_Value "Type E" "Type E"
69799>>>>>    End_Procedure
69800>>>>>End_Object
69801>>>>>
69801>>>>>Register_Object Line_sl
69801>>>>>
69801>>>>>Class cLineDataDictionary is a DataDictionary
69802>>>>>    
69802>>>>>    Procedure Construct_Object
69804>>>>>        Forward Send Construct_Object
69806>>>>>        Set Main_File to Line.File_Number
69807>>>>>
69807>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69808>>>>>
69808>>>>>        Set Add_Client_File to PageHeader.File_Number
69809>>>>>
69809>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69810>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69811>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69812>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69813>>>>>
69813>>>>>        Set Field_Auto_Increment Field Line.id to File_Field system.line_id
69814>>>>>        Set Field_Prompt_Object Field Line.id to Line_sl
69815>>>>>
69815>>>>>        Set Field_Value_Table Field Line.type to oTypeValid
69816>>>>>
69816>>>>>    End_Procedure
69817>>>>>
69817>>>>>End_Class
69818>>>>>
69818>>>>>Use Line.sl
Including file: Line.sl    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\Line.sl)
69818>>>>>>>// Line.sl
69818>>>>>>>// Line Lookup List
69818>>>>>>>
69818>>>>>>>Use DFClient.pkg
69818>>>>>>>Use cDbCJGridPromptList.pkg
69818>>>>>>>Use cDbCJGridColumn.pkg
69818>>>>>>>Use Windows.pkg
69818>>>>>>>
69818>>>>>>>Use cLineDataDictionary.dd
69818>>>>>>>
69818>>>>>>>CD_Popup_Object Line_sl is a dbModalPanel
69836>>>>>>>>
69836>>>>>>>    Set Location to 5 5
69837>>>>>>>    Set Size to 134 72
69838>>>>>>>    Set Label To "Line Lookup List"
69839>>>>>>>    Set Border_Style to Border_Thick
69840>>>>>>>    Set Minimize_Icon to False
69841>>>>>>>
69841>>>>>>>
69841>>>>>>>    Object oLine_DD is a cLineDataDictionary
69843>>>>>>>    End_Object 
69844>>>>>>>
69844>>>>>>>    Set Main_DD To oLine_DD
69845>>>>>>>    Set Server  To oLine_DD
69846>>>>>>>
69846>>>>>>>
69846>>>>>>>
69846>>>>>>>    Object oSelList is a cDbCJGridPromptList
69848>>>>>>>        Set Size to 105 62
69849>>>>>>>        Set Location to 5 5
69850>>>>>>>        Set peAnchors to anAll
69851>>>>>>>        Set psLayoutSection to "Line_sl_oSelList"
69852>>>>>>>        Set Ordering to 1
69853>>>>>>>        Set pbAutoServer to True
69854>>>>>>>
69854>>>>>>>        Object oLine_id is a cDbCJGridColumn
69856>>>>>>>            Entry_Item Line.id
69857>>>>>>>            Set piWidth to 46
69858>>>>>>>            Set psCaption to "id"
69859>>>>>>>        End_Object 
69860>>>>>>>
69860>>>>>>>        Object oLine_type is a cDbCJGridColumn
69862>>>>>>>            Entry_Item Line.type
69863>>>>>>>            Set piWidth to 40
69864>>>>>>>            Set psCaption to "type"
69865>>>>>>>        End_Object 
69866>>>>>>>
69866>>>>>>>
69866>>>>>>>    End_Object 
69867>>>>>>>
69867>>>>>>>    Object oOk_bn is a Button
69869>>>>>>>        Set Label to "&Ok"
69870>>>>>>>        Set Location to 115 -91
69871>>>>>>>        Set peAnchors to anBottomRight
69872>>>>>>>
69872>>>>>>>        Procedure OnClick
69875>>>>>>>            Send OK of oSelList
69876>>>>>>>        End_Procedure
69877>>>>>>>
69877>>>>>>>    End_Object 
69878>>>>>>>
69878>>>>>>>    Object oCancel_bn is a Button
69880>>>>>>>        Set Label to "&Cancel"
69881>>>>>>>        Set Location to 115 -37
69882>>>>>>>        Set peAnchors to anBottomRight
69883>>>>>>>
69883>>>>>>>        Procedure OnClick
69886>>>>>>>            Send Cancel of oSelList
69887>>>>>>>        End_Procedure
69888>>>>>>>
69888>>>>>>>    End_Object 
69889>>>>>>>
69889>>>>>>>    Object oSearch_bn is a Button
69891>>>>>>>        Set Label to "&Search..."
69892>>>>>>>        Set Location to 115 17
69893>>>>>>>        Set peAnchors to anBottomRight
69894>>>>>>>
69894>>>>>>>        Procedure OnClick
69897>>>>>>>            Send Search of oSelList
69898>>>>>>>        End_Procedure
69899>>>>>>>
69899>>>>>>>    End_Object 
69900>>>>>>>
69900>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
69901>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
69902>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
69903>>>>>>>
69903>>>>>>>
69903>>>>>>>CD_End_Object // Line_sl
69905>>>>>>>>
69905>>>
69905>>>ACTIVATE_VIEW Activate_oLineEntry FOR oLineEntry
69915>>>>
69915>>>Object oLineEntry is a dbView
69917>>>    Set Location to 5 5
69918>>>    Set Size to 22 138
69919>>>    Set Label To "LineEntry"
69920>>>    Set Border_Style to Border_Thick
69921>>>
69921>>>
69921>>>    Object oLine_DD is a cLineDataDictionary
69923>>>    End_Object 
69924>>>
69924>>>    Set Main_DD To oLine_DD
69925>>>    Set Server  To oLine_DD
69926>>>
69926>>>
69926>>>
69926>>>    Object oLineid is a dbForm
69928>>>        Entry_Item Line.id
69929>>>        Set Size to 12 55
69930>>>        Set Location to 5 13
69931>>>        Set peAnchors to anTopLeftRight
69932>>>        Set Label to "id"
69933>>>        Set Label_Justification_mode to jMode_Left
69934>>>        Set Label_Col_Offset to 8
69935>>>        Set Label_row_Offset to 0
69936>>>    End_Object 
69937>>>
69937>>>    Object oLinetype is a dbForm
69939>>>        Entry_Item Line.type
69940>>>        Set Size to 12 44
69941>>>        Set Location to 5 88
69942>>>        Set peAnchors to anTopRight
69943>>>        Set Label to "type"
69944>>>        Set Label_Justification_mode to jMode_Left
69945>>>        Set Label_Col_Offset to 16
69946>>>        Set Label_row_Offset to 0
69947>>>    End_Object 
69948>>>
69948>>>
69948>>>End_Object 
69949>        Use PageHeaderEntry.vw
Including file: PageHeaderEntry.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageHeaderEntry.vw)
69949>>>// C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageHeaderEntry.vw
69949>>>// PageHeaderEntry
69949>>>//
69949>>>
69949>>>Use DFClient.pkg
69949>>>Use DFEntry.pkg
69949>>>Use DfTabDlg.pkg
69949>>>
69949>>>Use cEmployeeDataDictionary.dd
69949>>>Use cLineDataDictionary.dd
69949>>>Use cPageHeaderDataDictionary.dd
Including file: cPageHeaderDataDictionary.dd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\cPageHeaderDataDictionary.dd)
69949>>>>>Use DataDict.pkg
69949>>>>>
69949>>>>>Open PageHeader
69951>>>>>Open Employee
69953>>>>>Open Line
69955>>>>>Open system
69957>>>>>Open PageFooter
Including file: PageFooter.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\PageFooter.fd)
69959>>>>>
69959>>>>>Register_Object PageHeader_sl
69959>>>>>
69959>>>>>Class cPageHeaderDataDictionary is a DataDictionary
69960>>>>>    
69960>>>>>    Procedure Construct_Object
69962>>>>>        Forward Send Construct_Object
69964>>>>>        Set Main_File to PageHeader.File_Number
69965>>>>>
69965>>>>>        Set Add_Client_File to PageFooter.File_Number
69966>>>>>
69966>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69967>>>>>
69967>>>>>        Set Add_Server_File to Employee.File_Number
69968>>>>>        Set Add_Server_File to Line.File_Number
69969>>>>>
69969>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69970>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69971>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69972>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69973>>>>>
69973>>>>>        Set Field_Auto_Increment Field PageHeader.id to File_Field system.page_header_id
69974>>>>>        Set Field_Prompt_Object Field PageHeader.id to PageHeader_sl
69975>>>>>
69975>>>>>    End_Procedure
69976>>>>>    
69976>>>>>    Procedure OnConstrain
69978>>>>>        Constrain PageHeader.Date Between "2020/1/1" and "2023/1/1"
69982>>>>>    End_Procedure
69983>>>>>
69983>>>>>End_Class
69984>>>>>
69984>>>>>Use PageHeader.sl
Including file: PageHeader.sl    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageHeader.sl)
69984>>>>>>>// PageHeader.sl
69984>>>>>>>// PageHeader Lookup List
69984>>>>>>>
69984>>>>>>>Use DFClient.pkg
69984>>>>>>>Use cDbCJGridPromptList.pkg
69984>>>>>>>Use cDbCJGridColumn.pkg
69984>>>>>>>Use Windows.pkg
69984>>>>>>>
69984>>>>>>>Use cEmployeeDataDictionary.dd
69984>>>>>>>Use cLineDataDictionary.dd
69984>>>>>>>Use cPageHeaderDataDictionary.dd
69984>>>>>>>
69984>>>>>>>CD_Popup_Object PageHeader_sl is a dbModalPanel
70002>>>>>>>>
70002>>>>>>>    Set Location to 5 5
70003>>>>>>>    Set Size to 134 126
70004>>>>>>>    Set Label To "PageHeader Lookup List"
70005>>>>>>>    Set Border_Style to Border_Thick
70006>>>>>>>    Set Minimize_Icon to False
70007>>>>>>>
70007>>>>>>>
70007>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
70009>>>>>>>    End_Object 
70010>>>>>>>
70010>>>>>>>    Object oLine_DD is a cLineDataDictionary
70012>>>>>>>    End_Object 
70013>>>>>>>
70013>>>>>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
70015>>>>>>>        Set DDO_Server To oEmployee_DD
70016>>>>>>>        Set DDO_Server To oLine_DD
70017>>>>>>>    End_Object 
70018>>>>>>>
70018>>>>>>>    Set Main_DD To oPageHeader_DD
70019>>>>>>>    Set Server  To oPageHeader_DD
70020>>>>>>>
70020>>>>>>>
70020>>>>>>>
70020>>>>>>>    Object oSelList is a cDbCJGridPromptList
70022>>>>>>>        Set Size to 105 116
70023>>>>>>>        Set Location to 5 5
70024>>>>>>>        Set peAnchors to anAll
70025>>>>>>>        Set psLayoutSection to "PageHeader_sl_oSelList"
70026>>>>>>>        Set Ordering to 1
70027>>>>>>>        Set pbAutoServer to True
70028>>>>>>>
70028>>>>>>>        Object oPageHeader_id is a cDbCJGridColumn
70030>>>>>>>            Entry_Item PageHeader.id
70031>>>>>>>            Set piWidth to 46
70032>>>>>>>            Set psCaption to "id"
70033>>>>>>>        End_Object 
70034>>>>>>>
70034>>>>>>>        Object oEmployee_id is a cDbCJGridColumn
70036>>>>>>>            Entry_Item Employee.id
70037>>>>>>>            Set piWidth to 81
70038>>>>>>>            Set psCaption to "employee id"
70039>>>>>>>        End_Object 
70040>>>>>>>
70040>>>>>>>        Object oLine_id is a cDbCJGridColumn
70042>>>>>>>            Entry_Item Line.id
70043>>>>>>>            Set piWidth to 48
70044>>>>>>>            Set psCaption to "line id"
70045>>>>>>>        End_Object 
70046>>>>>>>
70046>>>>>>>
70046>>>>>>>    End_Object 
70047>>>>>>>
70047>>>>>>>    Object oOk_bn is a Button
70049>>>>>>>        Set Label to "&Ok"
70050>>>>>>>        Set Location to 115 -37
70051>>>>>>>        Set peAnchors to anBottomRight
70052>>>>>>>
70052>>>>>>>        Procedure OnClick
70055>>>>>>>            Send OK of oSelList
70056>>>>>>>        End_Procedure
70057>>>>>>>
70057>>>>>>>    End_Object 
70058>>>>>>>
70058>>>>>>>    Object oCancel_bn is a Button
70060>>>>>>>        Set Label to "&Cancel"
70061>>>>>>>        Set Location to 115 17
70062>>>>>>>        Set peAnchors to anBottomRight
70063>>>>>>>
70063>>>>>>>        Procedure OnClick
70066>>>>>>>            Send Cancel of oSelList
70067>>>>>>>        End_Procedure
70068>>>>>>>
70068>>>>>>>    End_Object 
70069>>>>>>>
70069>>>>>>>    Object oSearch_bn is a Button
70071>>>>>>>        Set Label to "&Search..."
70072>>>>>>>        Set Location to 115 71
70073>>>>>>>        Set peAnchors to anBottomRight
70074>>>>>>>
70074>>>>>>>        Procedure OnClick
70077>>>>>>>            Send Search of oSelList
70078>>>>>>>        End_Procedure
70079>>>>>>>
70079>>>>>>>    End_Object 
70080>>>>>>>
70080>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
70081>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
70082>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
70083>>>>>>>
70083>>>>>>>
70083>>>>>>>CD_End_Object // PageHeader_sl
70085>>>>>>>>
70085>>>Use MonthCalendarPrompt.dg
Including file: MonthCalendarPrompt.dg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\MonthCalendarPrompt.dg)
70085>>>>>// Month Calendar Prompt dialog
70085>>>>>Use cMonthCalendarPrompt.pkg
Including file: cMonthCalendarPrompt.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cMonthCalendarPrompt.pkg)
70085>>>>>>>Use cMonthCalendar.pkg
Including file: cMonthCalendar.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cMonthCalendar.pkg)
70085>>>>>>>>>Use Windows.pkg
70085>>>>>>>>>Use Commctrl.pkg
70085>>>>>>>>>Use tWinStructs.pkg
70085>>>>>>>>>Use cWinControlEx.pkg
Including file: cWinControlEx.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cWinControlEx.pkg)
70085>>>>>>>>>>>Use cWinControl.pkg
Including file: cWinControl.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cWinControl.pkg)
70085>>>>>>>>>>>>>Use Windows.pkg
70085>>>>>>>>>>>>>
70085>>>>>>>>>>>>>// Key State Masks for Mouse Messages
70085>>>>>>>>>>>>>
70085>>>>>>>>>>>>>Define MK_LBUTTON  for |CI$0001
70085>>>>>>>>>>>>>Define MK_RBUTTON  for |CI$0002
70085>>>>>>>>>>>>>Define MK_SHIFT    for |CI$0004
70085>>>>>>>>>>>>>Define MK_CONTROL  for |CI$0008
70085>>>>>>>>>>>>>Define MK_MBUTTON  for |CI$0010
70085>>>>>>>>>>>>>Define MK_XBUTTON1 for |CI$0020
70085>>>>>>>>>>>>>Define MK_XBUTTON2 for |CI$0040
70085>>>>>>>>>>>>>
70085>>>>>>>>>>>>>Enum_List // Mouse Key Flags
70085>>>>>>>>>>>>>    Define mkLeft    for MK_LBUTTON
70085>>>>>>>>>>>>>    Define mkMiddle  for MK_MBUTTON
70085>>>>>>>>>>>>>    Define mkRight   for MK_RBUTTON
70085>>>>>>>>>>>>>    Define mkX1      for MK_XBUTTON1
70085>>>>>>>>>>>>>    Define mkX2      for MK_XBUTTON2
70085>>>>>>>>>>>>>    Define mkShift   for MK_SHIFT
70085>>>>>>>>>>>>>    Define mkControl for MK_CONTROL
70085>>>>>>>>>>>>>End_Enum_List
70085>>>>>>>>>>>>>
70085>>>>>>>>>>>>>Enum_List // Mouse Buttons. Used in OnMouseXXX messages
70085>>>>>>>>>>>>>    Define mbLeft
70085>>>>>>>>>>>>>    Define mbMiddle
70085>>>>>>>>>>>>>    Define mbRight
70085>>>>>>>>>>>>>    Define mbX1
70085>>>>>>>>>>>>>    Define mbX2
70085>>>>>>>>>>>>>End_Enum_List
70085>>>>>>>>>>>>>
70085>>>>>>>>>>>>>Class cWinControl is a DfBaseControl
70086>>>>>>>>>>>>>    Procedure Construct_Object
70088>>>>>>>>>>>>>        Forward Send Construct_Object
70090>>>>>>>>>>>>>        Property Integer private_pbEnabled True
70091>>>>>>>>>>>>>        Property Integer private_pbVisible True
70092>>>>>>>>>>>>>    End_Procedure
70093>>>>>>>>>>>>>    
70093>>>>>>>>>>>>>    Procedure End_Construct_Object
70095>>>>>>>>>>>>>        Forward Send End_Construct_Object
70097>>>>>>>>>>>>>        
70097>>>>>>>>>>>>>        Set External_Message WM_LBUTTONDOWN   to msg_OnWmLButtonDown
70098>>>>>>>>>>>>>        Set External_Message WM_MBUTTONDOWN   to msg_OnWmMButtonDown
70099>>>>>>>>>>>>>        Set External_Message WM_RBUTTONDOWN   to msg_OnWmRButtonDown
70100>>>>>>>>>>>>>        Set External_Message WM_LBUTTONUP     to msg_OnWmLButtonUp
70101>>>>>>>>>>>>>        Set External_Message WM_MBUTTONUP     to msg_OnWmMButtonUp
70102>>>>>>>>>>>>>        Set External_Message WM_RBUTTONUP     to msg_OnWmRButtonUp
70103>>>>>>>>>>>>>        Set External_Message WM_LBUTTONDBLCLK to msg_OnWmLButtonDblClk
70104>>>>>>>>>>>>>        Set External_Message WM_MBUTTONDBLCLK to msg_OnWmMButtonDblClk
70105>>>>>>>>>>>>>        Set External_Message WM_RBUTTONDBLCLK to msg_OnWmRButtonDblClk
70106>>>>>>>>>>>>>        Set External_Message WM_MOUSEMOVE     to msg_OnWmMouseMove
70107>>>>>>>>>>>>>    End_Procedure
70108>>>>>>>>>>>>>    
70108>>>>>>>>>>>>>    Procedure Notify Longptr wParam Longptr lParam
70110>>>>>>>>>>>>>        //Intentionally cancelled
70110>>>>>>>>>>>>>    End_Procedure
70111>>>>>>>>>>>>>    
70111>>>>>>>>>>>>>    Procedure Command Integer wParam Integer lParam
70113>>>>>>>>>>>>>        //Intentionally cancelled
70113>>>>>>>>>>>>>    End_Procedure
70114>>>>>>>>>>>>>    
70114>>>>>>>>>>>>>    Procedure DoRecreateWindow
70116>>>>>>>>>>>>>        // Recreates the window
70116>>>>>>>>>>>>>        If (Window_Handle(Self)) Begin
70118>>>>>>>>>>>>>            // attempt to do this without disturbing the focus tree.
70118>>>>>>>>>>>>>            Send Page_delete // prior to 8.3 this was Send Page_Object 0
70119>>>>>>>>>>>>>            Send Page 1      //                       Send Page_Object 1
70120>>>>>>>>>>>>>        End
70120>>>>>>>>>>>>>>
70120>>>>>>>>>>>>>    End_Procedure
70121>>>>>>>>>>>>>    
70121>>>>>>>>>>>>>    Procedure DoUpdateWindow
70123>>>>>>>>>>>>>        // Forces windows to update the window by bypassing WM_PAINT
70123>>>>>>>>>>>>>        Handle hWnd
70123>>>>>>>>>>>>>        
70123>>>>>>>>>>>>>        Get Window_Handle to hWnd
70124>>>>>>>>>>>>>        If hWnd ;            Move (UpdateWindow(hWnd)) to hWnd
70127>>>>>>>>>>>>>    End_Procedure
70128>>>>>>>>>>>>>    
70128>>>>>>>>>>>>>    Procedure Page Integer iState
70130>>>>>>>>>>>>>        Set Window_Style to WS_DISABLED (private_pbEnabled(Self) =False)
70131>>>>>>>>>>>>>        Set Window_Style to WS_VISIBLE (private_pbVisible(Self))
70132>>>>>>>>>>>>>        Forward Send Page iState
70134>>>>>>>>>>>>>    End_Procedure
70135>>>>>>>>>>>>>    
70135>>>>>>>>>>>>>    Procedure OnWmLButtonUp Integer wParam Integer lParam
70137>>>>>>>>>>>>>        Integer x y eButton
70137>>>>>>>>>>>>>        
70137>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70138>>>>>>>>>>>>>        Move (Low(lParam)) to x
70139>>>>>>>>>>>>>        
70139>>>>>>>>>>>>>        Send OnMouseUp mbLeft x y wParam
70140>>>>>>>>>>>>>    End_Procedure
70141>>>>>>>>>>>>>    
70141>>>>>>>>>>>>>    Procedure OnWmMButtonUp Integer wParam Integer lParam
70143>>>>>>>>>>>>>        Integer x y eButton
70143>>>>>>>>>>>>>        
70143>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70144>>>>>>>>>>>>>        Move (Low(lParam)) to x
70145>>>>>>>>>>>>>        
70145>>>>>>>>>>>>>        Send OnMouseUp mbMiddle x y wParam
70146>>>>>>>>>>>>>    End_Procedure
70147>>>>>>>>>>>>>    
70147>>>>>>>>>>>>>    Procedure OnWmRButtonUp Integer wParam Integer lParam
70149>>>>>>>>>>>>>        Integer x y eButton
70149>>>>>>>>>>>>>        
70149>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70150>>>>>>>>>>>>>        Move (Low(lParam)) to x
70151>>>>>>>>>>>>>        
70151>>>>>>>>>>>>>        Send OnMouseUp mbRight x y wParam
70152>>>>>>>>>>>>>    End_Procedure
70153>>>>>>>>>>>>>    
70153>>>>>>>>>>>>>    Procedure OnWmLButtonDown Integer wParam Integer lParam
70155>>>>>>>>>>>>>        Integer x y eButton fKeys
70155>>>>>>>>>>>>>        
70155>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70156>>>>>>>>>>>>>        Move (Low(lParam)) to x
70157>>>>>>>>>>>>>        
70157>>>>>>>>>>>>>        Send OnMouseDown mbLeft x y wParam
70158>>>>>>>>>>>>>    End_Procedure
70159>>>>>>>>>>>>>    Procedure OnWmMButtonDown Integer wParam Integer lParam
70161>>>>>>>>>>>>>        Integer x y eButton
70161>>>>>>>>>>>>>        
70161>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70162>>>>>>>>>>>>>        Move (Low(lParam)) to x
70163>>>>>>>>>>>>>        
70163>>>>>>>>>>>>>        Send OnMouseDown mbMiddle x y wParam
70164>>>>>>>>>>>>>    End_Procedure
70165>>>>>>>>>>>>>    Procedure OnWmRButtonDown Integer wParam Integer lParam
70167>>>>>>>>>>>>>        Integer x y eButton
70167>>>>>>>>>>>>>        
70167>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70168>>>>>>>>>>>>>        Move (Low(lParam)) to x
70169>>>>>>>>>>>>>        
70169>>>>>>>>>>>>>        Send OnMouseDown mbRight x y wParam
70170>>>>>>>>>>>>>    End_Procedure
70171>>>>>>>>>>>>>    
70171>>>>>>>>>>>>>    Procedure OnWmLButtonDblClk Integer wParam Integer lParam
70173>>>>>>>>>>>>>        Integer x y eButton
70173>>>>>>>>>>>>>        
70173>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70174>>>>>>>>>>>>>        Move (Low(lParam)) to x
70175>>>>>>>>>>>>>        
70175>>>>>>>>>>>>>        Send OnMouseDoubleClick mbLeft x y wParam
70176>>>>>>>>>>>>>    End_Procedure
70177>>>>>>>>>>>>>    Procedure OnWmMButtonDblClk Integer wParam Integer lParam
70179>>>>>>>>>>>>>        Integer x y eButton
70179>>>>>>>>>>>>>        
70179>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70180>>>>>>>>>>>>>        Move (Low(lParam)) to x
70181>>>>>>>>>>>>>        
70181>>>>>>>>>>>>>        Send OnMouseDoubleClick mbMiddle x y wParam
70182>>>>>>>>>>>>>    End_Procedure
70183>>>>>>>>>>>>>    Procedure OnWmRButtonDblClk Integer wParam Integer lParam
70185>>>>>>>>>>>>>        Integer x y eButton
70185>>>>>>>>>>>>>        
70185>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70186>>>>>>>>>>>>>        Move (Low(lParam)) to x
70187>>>>>>>>>>>>>        
70187>>>>>>>>>>>>>        Send OnMouseDoubleClick mbRight x y wParam
70188>>>>>>>>>>>>>    End_Procedure
70189>>>>>>>>>>>>>    
70189>>>>>>>>>>>>>    Procedure OnWmMouseMove Integer wParam Integer lParam
70191>>>>>>>>>>>>>        Integer x y eButton
70191>>>>>>>>>>>>>        
70191>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70192>>>>>>>>>>>>>        Move (Low(lParam)) to x
70193>>>>>>>>>>>>>        
70193>>>>>>>>>>>>>        Send OnMouseMove x y wParam
70194>>>>>>>>>>>>>    End_Procedure
70195>>>>>>>>>>>>>    
70195>>>>>>>>>>>>>    Procedure OnMouseDown Integer eButton Integer x Integer y Integer fKeys
70197>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70197>>>>>>>>>>>>>        //String sButton
70197>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70197>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70197>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70197>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70197>>>>>>>>>>>>>        
70197>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
70197>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
70197>>>>>>>>>>>>>        //Showln 'OnMouseDown ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70197>>>>>>>>>>>>>    End_Procedure
70198>>>>>>>>>>>>>    
70198>>>>>>>>>>>>>    Procedure OnMouseUp Integer eButton Integer x Integer y Integer fKeys
70200>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70200>>>>>>>>>>>>>        //String sButton
70200>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70200>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70200>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70200>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70200>>>>>>>>>>>>>        
70200>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
70200>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
70200>>>>>>>>>>>>>        //Showln 'OnMouseUp ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70200>>>>>>>>>>>>>    End_Procedure
70201>>>>>>>>>>>>>    
70201>>>>>>>>>>>>>    Procedure OnMouseDoubleClick Integer eButton Integer x Integer y Integer fKeys
70203>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70203>>>>>>>>>>>>>        //String sButton
70203>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70203>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70203>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70203>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70203>>>>>>>>>>>>>        
70203>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
70203>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
70203>>>>>>>>>>>>>        //Showln 'OnMouseDblClk ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70203>>>>>>>>>>>>>    End_Procedure
70204>>>>>>>>>>>>>    
70204>>>>>>>>>>>>>    Procedure OnMouseMove Integer x Integer y Integer fKeys
70206>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70206>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70206>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70206>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70206>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70206>>>>>>>>>>>>>        
70206>>>>>>>>>>>>>        //Showln 'OnMouseMove ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70206>>>>>>>>>>>>>    End_Procedure
70207>>>>>>>>>>>>>    
70207>>>>>>>>>>>>>    Procedure Set pbEnabled Boolean bEnabled
70209>>>>>>>>>>>>>        Handle hWnd
70209>>>>>>>>>>>>>        
70209>>>>>>>>>>>>>        If (bEnabled <> private_pbEnabled(Self)) Begin
70211>>>>>>>>>>>>>            Set private_pbEnabled to bEnabled
70212>>>>>>>>>>>>>            Get Window_Handle to hWnd
70213>>>>>>>>>>>>>            If hWnd ;                Move (EnableWindow(hWnd, bEnabled)) to hWnd
70216>>>>>>>>>>>>>        End
70216>>>>>>>>>>>>>>
70216>>>>>>>>>>>>>    End_Procedure
70217>>>>>>>>>>>>>    Function pbEnabled Returns Boolean
70219>>>>>>>>>>>>>        Function_Return (private_pbEnabled(Self))
70220>>>>>>>>>>>>>    End_Function
70221>>>>>>>>>>>>>    
70221>>>>>>>>>>>>>    Procedure Set pbVisible Boolean bVisible
70223>>>>>>>>>>>>>        Handle  hWnd
70223>>>>>>>>>>>>>        Integer iVoid
70223>>>>>>>>>>>>>        
70223>>>>>>>>>>>>>        If (bVisible <> private_pbVisible(Self)) Begin
70225>>>>>>>>>>>>>            Set private_pbVisible to bVisible
70226>>>>>>>>>>>>>            Get Window_Handle to hWnd
70227>>>>>>>>>>>>>            If hWnd ;                Move (ShowWindow(hWnd, If (bVisible, SW_SHOWNA, SW_HIDE))) to iVoid
70230>>>>>>>>>>>>>        End
70230>>>>>>>>>>>>>>
70230>>>>>>>>>>>>>    End_Procedure
70231>>>>>>>>>>>>>    Function pbVisible Returns Boolean
70233>>>>>>>>>>>>>        Function_Return (private_pbVisible(Self))
70234>>>>>>>>>>>>>    End_Function
70235>>>>>>>>>>>>>    
70235>>>>>>>>>>>>>End_Class
70236>>>>>>>>>>>// This adds proper navigation and default button support for
70236>>>>>>>>>>>// external classes
70236>>>>>>>>>>>
70236>>>>>>>>>>>Class cWinControlEx is a cWinControl
70237>>>>>>>>>>>    Import_Class_Protocol Standard_Form_Mixin
70238>>>>>>>>>>>    Procedure Construct_Object
70240>>>>>>>>>>>        Forward Send Construct_Object
70242>>>>>>>>>>>        Send define_standard_Form_Mixin
70243>>>>>>>>>>>    End_Procedure
70244>>>>>>>>>>>    
70244>>>>>>>>>>>    Function item_count Integer iItem Returns Integer
70246>>>>>>>>>>>        Function_Return 1
70247>>>>>>>>>>>    End_Function
70248>>>>>>>>>>>    
70248>>>>>>>>>>>    Procedure External_SetFocus
70250>>>>>>>>>>>        Send notify_focus_change 1
70251>>>>>>>>>>>    End_Procedure
70252>>>>>>>>>>>    
70252>>>>>>>>>>>    Procedure External_KillFocus
70254>>>>>>>>>>>        Send notify_focus_change 0
70255>>>>>>>>>>>    End_Procedure
70256>>>>>>>>>>>    
70256>>>>>>>>>>>    Procedure End_Construct_Object
70258>>>>>>>>>>>        Forward Send End_Construct_Object
70260>>>>>>>>>>>        Set External_Message WM_SETFOCUS  to External_SetFocus
70261>>>>>>>>>>>        Set External_Message WM_KILLFOCUS to External_KillFocus
70262>>>>>>>>>>>    End_Procedure
70263>>>>>>>>>>>    
70263>>>>>>>>>>>End_Class
70264>>>>>>>>>>>
70264>>>>>>>>>
70264>>>>>>>>>Class cMonthCalendar is a cWinControlEx
70265>>>>>>>>>    Procedure Construct_Object
70267>>>>>>>>>        Integer iResult
70267>>>>>>>>>        tWinInitCommonControlsEX InitCC
70267>>>>>>>>>        tWinInitCommonControlsEX InitCC
70267>>>>>>>>>        
70267>>>>>>>>>        Forward Send Construct_Object
70269>>>>>>>>>        
70269>>>>>>>>>        Move (SizeOfType (tWinInitCommonControlsEX)) to InitCC.dwSize
70270>>>>>>>>>        Move ICC_DATE_CLASSES to InitCC.dwICC
70271>>>>>>>>>        Move (InitCommonControlsEx(AddressOf(InitCC))) to iResult
70272>>>>>>>>>        
70272>>>>>>>>>        Set External_Class_Name 'cMonthCalendar' to 'SysMonthCal32'
70273>>>>>>>>>        Set External_Message WM_LBUTTONDBLCLK to msg_OnLButtonDblClick
70274>>>>>>>>>        
70274>>>>>>>>>        Set Border_Style to Border_Normal
70275>>>>>>>>>        
70275>>>>>>>>>        Property Boolean pbNoToday False
70276>>>>>>>>>        Property Boolean pbNoTodayCircle False
70277>>>>>>>>>        Property Boolean pbMultiSelect False
70278>>>>>>>>>        Property Boolean pbWeekNumbers False
70279>>>>>>>>>        Property Integer piMaxSelectedCount 90
70280>>>>>>>>>        
70280>>>>>>>>>        // this is minimum Dialog units required for a single picker rectangle
70280>>>>>>>>>        Property Integer piMinWidth 0
70281>>>>>>>>>        Property Integer piMinHeight 0
70282>>>>>>>>>        
70282>>>>>>>>>        // stores initial date before control is activated
70282>>>>>>>>>        Property Date pdPrivateDate
70283>>>>>>>>>        // if multi-select, this is the end range
70283>>>>>>>>>        Property Date pdPrivateDate2
70284>>>>>>>>>        
70284>>>>>>>>>    End_Procedure
70285>>>>>>>>>    
70285>>>>>>>>>    // returns control's value when single select
70285>>>>>>>>>    Function SelectedDate Returns Date
70287>>>>>>>>>        tWinSystemTime CurrentSystemTime
70287>>>>>>>>>        tWinSystemTime CurrentSystemTime
70287>>>>>>>>>        Integer iRetval
70287>>>>>>>>>        DateTime dtSel
70287>>>>>>>>>        Handle hWnd
70287>>>>>>>>>        Get Window_Handle to hWnd
70288>>>>>>>>>        If (hWnd) Begin
70290>>>>>>>>>            Move (WindowsMessage (MCM_GETCURSEL, 0, AddressOf (CurrentSystemTime))) to iRetval
70291>>>>>>>>>            Move (DateSetDay(dtSel,CurrentSystemTime.wDay)) to dtSel
70292>>>>>>>>>            Move (DateSetMonth(dtSel,CurrentSystemTime.wMonth)) to dtSel
70293>>>>>>>>>            Move (DateSetYear(dtSel,CurrentSystemTime.wYear)) to dtSel
70294>>>>>>>>>        End
70294>>>>>>>>>>
70294>>>>>>>>>        Else Begin
70295>>>>>>>>>            Get pdPrivateDate to dtSel
70296>>>>>>>>>        End
70296>>>>>>>>>>
70296>>>>>>>>>        Function_Return (Date(dtSel))
70297>>>>>>>>>    End_Function
70298>>>>>>>>>    
70298>>>>>>>>>    // returns control's values when multi select
70298>>>>>>>>>    Function SelectedDateRange Returns Date[]
70300>>>>>>>>>        tWinSystemTime[2] CurrentSystemTime
70300>>>>>>>>>        tWinSystemTime[2] CurrentSystemTime
70301>>>>>>>>>        Integer iRetval
70301>>>>>>>>>        DateTime dtSel1 dtsel2
70301>>>>>>>>>        Date[] dtSel
70302>>>>>>>>>        Handle hWnd
70302>>>>>>>>>        Get Window_Handle to hWnd
70303>>>>>>>>>        If (hWnd) Begin
70305>>>>>>>>>            Move (WindowsMessage (MCM_GETSELRANGE, 0, AddressOf (CurrentSystemTime))) to iRetval
70306>>>>>>>>>            
70306>>>>>>>>>            Move (DateSetDay(dtSel1,CurrentSystemTime[0].wDay)) to dtSel1
70307>>>>>>>>>            Move (DateSetMonth(dtSel1,CurrentSystemTime[0].wMonth)) to dtSel1
70308>>>>>>>>>            Move (DateSetYear(dtSel1,CurrentSystemTime[0].wYear)) to dtSel1
70309>>>>>>>>>            
70309>>>>>>>>>            Move (DateSetDay(dtSel2,CurrentSystemTime[1].wDay)) to dtSel2
70310>>>>>>>>>            Move (DateSetMonth(dtSel2,CurrentSystemTime[1].wMonth)) to dtSel2
70311>>>>>>>>>            Move (DateSetYear(dtSel2,CurrentSystemTime[1].wYear)) to dtSel2
70312>>>>>>>>>            
70312>>>>>>>>>            Move dtSel1 to dtSel[0]
70313>>>>>>>>>            Move dtsel2 to dtSel[1]
70314>>>>>>>>>        End
70314>>>>>>>>>>
70314>>>>>>>>>        Else Begin
70315>>>>>>>>>            Get pdPrivateDate to dtSel[0]
70316>>>>>>>>>            Get pdPrivateDate2 to dtSel[1]
70317>>>>>>>>>        End
70317>>>>>>>>>>
70317>>>>>>>>>        Function_Return dtSel
70318>>>>>>>>>    End_Function
70319>>>>>>>>>    
70319>>>>>>>>>    // Set control's value when single select
70319>>>>>>>>>    Procedure SetSelectedDate Date dDate
70321>>>>>>>>>        tWinSystemTime CurrentSystemTime
70321>>>>>>>>>        tWinSystemTime CurrentSystemTime
70321>>>>>>>>>        Integer iRetval
70321>>>>>>>>>        Handle hWnd
70321>>>>>>>>>        
70321>>>>>>>>>        Get Window_Handle to hWnd
70322>>>>>>>>>        Set pdPrivateDate to dDate
70323>>>>>>>>>        If (hWnd) Begin
70325>>>>>>>>>            Move (DateGetDay(dDate)) to CurrentSystemTime.wDay
70326>>>>>>>>>            Move (DateGetMonth(dDate)) to CurrentSystemTime.wMonth
70327>>>>>>>>>            Move (DateGetYear(dDate)) to CurrentSystemTime.wYear
70328>>>>>>>>>            
70328>>>>>>>>>            Move (WindowsMessage (MCM_SETCURSEL, 0, AddressOf (CurrentSystemTime))) to iRetval
70329>>>>>>>>>        End
70329>>>>>>>>>>
70329>>>>>>>>>    End_Procedure
70330>>>>>>>>>    
70330>>>>>>>>>    // Set control's values when multi select
70330>>>>>>>>>    Procedure SetSelectedDateRange Date dDate Date dDate2
70332>>>>>>>>>        tWinSystemTime[] CurrentSystemTime
70332>>>>>>>>>        tWinSystemTime[] CurrentSystemTime
70333>>>>>>>>>        Integer iRetval
70333>>>>>>>>>        Handle hWnd
70333>>>>>>>>>        
70333>>>>>>>>>        Get Window_Handle to hWnd
70334>>>>>>>>>        Set pdPrivateDate to dDate
70335>>>>>>>>>        Set pdPrivateDate2 to dDate2
70336>>>>>>>>>        If (hWnd) Begin
70338>>>>>>>>>            Move (DateGetDay(dDate)) to CurrentSystemTime[0].wDay
70339>>>>>>>>>            Move (DateGetMonth(dDate)) to CurrentSystemTime[0].wMonth
70340>>>>>>>>>            Move (DateGetYear(dDate)) to CurrentSystemTime[0].wYear
70341>>>>>>>>>            
70341>>>>>>>>>            Move (DateGetDay(dDate2)) to CurrentSystemTime[1].wDay
70342>>>>>>>>>            Move (DateGetMonth(dDate2)) to CurrentSystemTime[1].wMonth
70343>>>>>>>>>            Move (DateGetYear(dDate2)) to CurrentSystemTime[1].wYear
70344>>>>>>>>>            
70344>>>>>>>>>            Move (WindowsMessage (MCM_SETSELRANGE, 0, AddressOf (CurrentSystemTime))) to iRetval
70345>>>>>>>>>        End
70345>>>>>>>>>>
70345>>>>>>>>>    End_Procedure
70346>>>>>>>>>    
70346>>>>>>>>>    // augment to set dates from control, so they can be accessed after the control is closed
70346>>>>>>>>>    Procedure Remove_Object
70348>>>>>>>>>        Date[] SelDate
70349>>>>>>>>>        If (pbMultiSelect(Self)) Begin
70351>>>>>>>>>            Get SelectedDateRange to SelDate
70352>>>>>>>>>            Set pdPrivateDate2 to SelDate[1]
70353>>>>>>>>>        End
70353>>>>>>>>>>
70353>>>>>>>>>        Else Begin
70354>>>>>>>>>            Get SelectedDate to SelDate[0]
70355>>>>>>>>>        End
70355>>>>>>>>>>
70355>>>>>>>>>        Set pdPrivateDate to SelDate[0]
70356>>>>>>>>>        Forward Send Remove_Object
70358>>>>>>>>>    End_Procedure
70359>>>>>>>>>    
70359>>>>>>>>>    Procedure Page Integer iState
70361>>>>>>>>>        Integer iRetval iSize iHeight iWidth
70361>>>>>>>>>        tWinRect WindowRect
70361>>>>>>>>>        tWinRect WindowRect
70361>>>>>>>>>        Date dDate dDate2
70361>>>>>>>>>        Handle hWnd
70361>>>>>>>>>        Integer  iMaxSelectedCount
70361>>>>>>>>>        Boolean bNoToday bWeekNumbers bMultiSelect bNoTodayCircle
70361>>>>>>>>>        
70361>>>>>>>>>        If (iState<>1) Begin
70363>>>>>>>>>            Forward Send Page iState
70365>>>>>>>>>            Procedure_Return
70366>>>>>>>>>        End
70366>>>>>>>>>>
70366>>>>>>>>>        
70366>>>>>>>>>        Set Icon to 'ActionCalendar.ico'
70367>>>>>>>>>        
70367>>>>>>>>>        Get pbNoToday to bNoToday
70368>>>>>>>>>        Get pbNoTodayCircle to bNoTodayCircle
70369>>>>>>>>>        Get pbMultiSelect to bMultiSelect
70370>>>>>>>>>        Get pbWeekNumbers to bWeekNumbers
70371>>>>>>>>>        Get piMaxSelectedCount to iMaxSelectedCount
70372>>>>>>>>>        
70372>>>>>>>>>        Set Window_Style MCS_MULTISELECT to bMultiSelect
70373>>>>>>>>>        Set Window_Style MCS_NOTODAY to bNoToday
70374>>>>>>>>>        Set Window_Style MCS_NOTODAYCIRCLE to bNoTodayCircle
70375>>>>>>>>>        Set Window_Style MCS_WEEKNUMBERS to bWeekNumbers
70376>>>>>>>>>        Forward Send Page iState
70378>>>>>>>>>        
70378>>>>>>>>>        Get Window_Handle to hWnd
70379>>>>>>>>>        // support double click
70379>>>>>>>>>        Move (SetClassLongPtr(hWnd,GCL_STYLE,CS_DBLCLKS ior CS_GLOBALCLASS)) to iRetval
70380>>>>>>>>>        // set range when multi select
70380>>>>>>>>>        Move (WindowsMessage(MCM_SETMAXSELCOUNT,iMaxSelectedCount,0)) to iRetval
70381>>>>>>>>>        
70381>>>>>>>>>        // store minimum size for calendar control and set the size to this by default
70381>>>>>>>>>        Move (WindowsMessage (MCM_GETMINREQRECT, 0, AddressOf(WindowRect))) to iRetval
70382>>>>>>>>>        Get GuiToDialog WindowRect.bottom WindowRect.right to iSize
70383>>>>>>>>>        Move (Hi(iSize)) to iHeight
70384>>>>>>>>>        Move (Low(iSize)) to iWidth
70385>>>>>>>>>        Set piMinWidth to iWidth
70386>>>>>>>>>        Set piMinHeight to iHeight
70387>>>>>>>>>        Set Size to iHeight iWidth
70388>>>>>>>>>        
70388>>>>>>>>>        // now that we are activated set starting date or date range
70388>>>>>>>>>        Get pdPrivateDate to dDate
70389>>>>>>>>>        If (pbMultiSelect(Self)) Begin
70391>>>>>>>>>            Get pdPrivateDate2 to dDate2
70392>>>>>>>>>            Send SetSelectedDateRange dDate dDate2
70393>>>>>>>>>        End
70393>>>>>>>>>>
70393>>>>>>>>>        Else Begin
70394>>>>>>>>>            Send SetSelectedDate dDate
70395>>>>>>>>>        End
70395>>>>>>>>>>
70395>>>>>>>>>    End_Procedure
70396>>>>>>>>>    
70396>>>>>>>>>    Procedure Notify Longptr wParam Longptr lParam
70398>>>>>>>>>        Integer iRetval
70398>>>>>>>>>        DateTime dtSel dtSel2
70398>>>>>>>>>        tWintagNMSelChange CalenderInfo
70398>>>>>>>>>        tWintagNMSelChange CalenderInfo
70398>>>>>>>>>        Boolean bMulti
70398>>>>>>>>>        
70398>>>>>>>>>        Move (MemCopy (AddressOf (CalenderInfo), lParam, SizeOfType (tWintagNMSelChange))) to iRetval
70399>>>>>>>>>        If (CalenderInfo.nmHdr.code = MCN_SELCHANGE) Begin
70401>>>>>>>>>            Get pbMultiSelect to bMulti
70402>>>>>>>>>            Move (DateSetDay(dtSel,CalenderInfo.stSelStart.wDay)) to dtSel
70403>>>>>>>>>            Move (DateSetMonth(dtSel,CalenderInfo.stSelStart.wMonth)) to dtSel
70404>>>>>>>>>            Move (DateSetYear(dtSel,CalenderInfo.stSelStart.wYear)) to dtSel
70405>>>>>>>>>            If bMulti Begin
70407>>>>>>>>>                Move (DateSetDay(dtSel,CalenderInfo.stSelEnd.wDay)) to dtSel2
70408>>>>>>>>>                Move (DateSetMonth(dtSel,CalenderInfo.stSelEnd.wMonth)) to dtSel2
70409>>>>>>>>>                Move (DateSetYear(dtSel,CalenderInfo.stSelEnd.wYear)) to dtSel2
70410>>>>>>>>>            End
70410>>>>>>>>>>
70410>>>>>>>>>            Send OnChange (Date(dtSel)) (Date(dtSel2))
70411>>>>>>>>>        End
70411>>>>>>>>>>
70411>>>>>>>>>    End_Procedure
70412>>>>>>>>>    
70412>>>>>>>>>    // sent whenever there is a selection change within the calendar
70412>>>>>>>>>    Procedure OnChange Date dDate Date dDate2
70414>>>>>>>>>    End_Procedure
70415>>>>>>>>>    
70415>>>>>>>>>    // sent when a click occurs in the calendar
70415>>>>>>>>>    Procedure OnClick
70417>>>>>>>>>    End_Procedure
70418>>>>>>>>>    
70418>>>>>>>>>    // sent when a double click occurs in the calendar
70418>>>>>>>>>    Procedure OnDoubleClick
70420>>>>>>>>>    End_Procedure
70421>>>>>>>>>    
70421>>>>>>>>>    // sends OnClick if the double click is on a calendar day
70421>>>>>>>>>    Procedure OnLButtonDblClick Integer wParam Integer lParam
70423>>>>>>>>>        Boolean bDayHit
70423>>>>>>>>>        Get MonthDayHit to bDayHit
70424>>>>>>>>>        If bDayHit Begin
70426>>>>>>>>>            Send OnDoubleClick
70427>>>>>>>>>        End
70427>>>>>>>>>>
70427>>>>>>>>>    End_Procedure
70428>>>>>>>>>    
70428>>>>>>>>>    // sends OnClick if the click is on a calendar day
70428>>>>>>>>>    Procedure OnWmLButtonUp Integer wParam Integer lParam
70430>>>>>>>>>        Boolean bDayHit
70430>>>>>>>>>        Get MonthDayHit to bDayHit
70431>>>>>>>>>        If bDayHit Begin
70433>>>>>>>>>            Send OnClick
70434>>>>>>>>>        End
70434>>>>>>>>>>
70434>>>>>>>>>    End_Procedure
70435>>>>>>>>>    
70435>>>>>>>>>    // returns true if the month calander is up and the mouse is over a day
70435>>>>>>>>>    Function MonthDayHit Returns Boolean
70437>>>>>>>>>        UInteger iRet
70437>>>>>>>>>        Move (WindowsMessage( MCM_GETCURRENTVIEW, 0, 0)) to iRet
70438>>>>>>>>>        If (iRet=MCMV_MONTH) Begin
70440>>>>>>>>>            Get HitTest to iRet
70441>>>>>>>>>            Function_Return (iRet=MCHT_CALENDARDATE)
70442>>>>>>>>>        End
70442>>>>>>>>>>
70442>>>>>>>>>        Function_Return False
70443>>>>>>>>>    End_Function
70444>>>>>>>>>    
70444>>>>>>>>>    // return what was hit in the control
70444>>>>>>>>>    Function HitTest Returns UInteger
70446>>>>>>>>>        tWinMCHitTestInfo HitInfo
70446>>>>>>>>>        tWinMCHitTestInfo HitInfo
70446>>>>>>>>>        Handle hWnd iRet
70446>>>>>>>>>        Integer iVoid
70446>>>>>>>>>        Pointer lpPt
70446>>>>>>>>>        tWinPoint Pt
70446>>>>>>>>>        tWinPoint Pt
70446>>>>>>>>>        Get Window_Handle to hWnd
70447>>>>>>>>>        Move (AddressOf(Pt)) to lpPt
70448>>>>>>>>>        Move (GetCursorPos(lpPt)) to iVoid
70449>>>>>>>>>        Move (ScreenToClient(hWnd, lpPt)) to iVoid
70450>>>>>>>>>        Move Pt to HitInfo.Pt
70451>>>>>>>>>        Move (SizeOfType(tWinMCHitTestInfo)) to HitInfo.cbSize
70452>>>>>>>>>        Move (WindowsMessage(MCM_HITTEST, 0, AddressOf(HitInfo))) to iRet
70453>>>>>>>>>        Function_Return HitInfo.uHit
70454>>>>>>>>>    End_Function
70455>>>>>>>>>    
70455>>>>>>>>>End_Class
70456>>>>>>>
70456>>>>>>>// peMouseSelectOk choices
70456>>>>>>>Enum_List
70456>>>>>>>    Define msoClick
70456>>>>>>>    Define msoDblClick
70456>>>>>>>    Define msoNone
70456>>>>>>>End_Enum_List
70456>>>>>>>
70456>>>>>>>// It is expected that this class will only be used inside of ModalPanel and
70456>>>>>>>// will be used as a prompt object component in a framework style application.
70456>>>>>>>// If you wish to Use a month calendar in some other non prompt situation,
70456>>>>>>>// use cMonthCalendar
70456>>>>>>>
70456>>>>>>>Class cMonthCalendarPrompt is a cMonthCalendar
70457>>>>>>>    
70457>>>>>>>    Procedure Construct_Object
70459>>>>>>>        
70459>>>>>>>        Forward Send Construct_Object
70461>>>>>>>        
70461>>>>>>>        Property Integer peUpdateMode umPromptValue
70462>>>>>>>        
70462>>>>>>>        Property Integer peMouseSelectOk msoClick
70463>>>>>>>        
70463>>>>>>>        Property Date pdSeedValue
70464>>>>>>>        
70464>>>>>>>        // if multi-select, this is the end range
70464>>>>>>>        Property Date pdSeedValue2
70465>>>>>>>        
70465>>>>>>>        Property Handle phmPromptUpdateCallback 0
70466>>>>>>>        
70466>>>>>>>        Property Integer phoInvokingObject
70467>>>>>>>        
70467>>>>>>>        Property Integer peStoredUpdateMode
70468>>>>>>>        Property Handle  phmStoredPromptUpdateCallback
70469>>>>>>>        Property Boolean pbStoredWeekNumbers
70470>>>>>>>        Property Boolean pbStoredNoToday
70471>>>>>>>        Property Boolean pbStoredNoTodayCircle
70472>>>>>>>        Property Boolean pbStoredMultiSelect
70473>>>>>>>        Property Integer piStoredMaxSelectedCount
70474>>>>>>>        Property Integer peStoredpeMouseSelectOk
70475>>>>>>>        
70475>>>>>>>        // internally set by list
70475>>>>>>>        // these must be set upon closing the list and can be used for manual list updates
70475>>>>>>>        Property Boolean pbCanceled
70476>>>>>>>        
70476>>>>>>>    End_Procedure
70477>>>>>>>    
70477>>>>>>>    Procedure OnStoreDefaults
70479>>>>>>>        Integer iVal
70479>>>>>>>        Boolean bVal
70479>>>>>>>        
70479>>>>>>>        Get peUpdateMode to iVal
70480>>>>>>>        Set peStoredUpdateMode to iVal
70481>>>>>>>        
70481>>>>>>>        Get phmPromptUpdateCallback to iVal
70482>>>>>>>        Set phmStoredPromptUpdateCallback to iVal
70483>>>>>>>        
70483>>>>>>>        Get pbMultiSelect to bVal
70484>>>>>>>        Set pbStoredMultiSelect to bVal
70485>>>>>>>        
70485>>>>>>>        Get pbNoToday to bVal
70486>>>>>>>        Set pbStoredNoToday to bVal
70487>>>>>>>        
70487>>>>>>>        Get pbNoTodayCircle to bVal
70488>>>>>>>        Set pbStoredNoTodayCircle to bVal
70489>>>>>>>        
70489>>>>>>>        Get pbWeekNumbers to bVal
70490>>>>>>>        Set pbStoredWeekNumbers to bVal
70491>>>>>>>        
70491>>>>>>>        Get piMaxSelectedCount to iVal
70492>>>>>>>        Set piStoredMaxSelectedCount to iVal
70493>>>>>>>        
70493>>>>>>>        Get peMouseSelectOk to iVal
70494>>>>>>>        Set peStoredpeMouseSelectOk to iVal
70495>>>>>>>        
70495>>>>>>>    End_Procedure
70496>>>>>>>    
70496>>>>>>>    Procedure OnRestoreDefaults
70498>>>>>>>        Integer iVal
70498>>>>>>>        Boolean bVal
70498>>>>>>>        
70498>>>>>>>        Get peStoredUpdateMode to iVal
70499>>>>>>>        Set peUpdateMode to iVal
70500>>>>>>>        
70500>>>>>>>        Get phmStoredPromptUpdateCallback to iVal
70501>>>>>>>        Set phmPromptUpdateCallback to iVal
70502>>>>>>>        
70502>>>>>>>        Get pbStoredMultiSelect to bVal
70503>>>>>>>        Set pbMultiSelect to bVal
70504>>>>>>>        
70504>>>>>>>        Get pbStoredNoToday to bVal
70505>>>>>>>        Set pbNoToday to bVal
70506>>>>>>>        
70506>>>>>>>        Get pbStoredNoTodayCircle to bVal
70507>>>>>>>        Set pbNoTodayCircle to bVal
70508>>>>>>>        
70508>>>>>>>        Get pbStoredWeekNumbers to bVal
70509>>>>>>>        Set pbWeekNumbers to bVal
70510>>>>>>>        
70510>>>>>>>        Get piStoredMaxSelectedCount to iVal
70511>>>>>>>        Set piMaxSelectedCount to iVal
70512>>>>>>>        
70512>>>>>>>        Get peStoredpeMouseSelectOk to iVal
70513>>>>>>>        Set peMouseSelectOk to iVal
70514>>>>>>>        
70514>>>>>>>    End_Procedure
70515>>>>>>>    
70515>>>>>>>    Procedure Add_Focus Handle hoParent Returns Integer
70517>>>>>>>        Integer eMode
70517>>>>>>>        Set pbCanceled to True // assume cancel unless changed
70518>>>>>>>        Get peUpdateMode to eMode
70519>>>>>>>        If (eMode<>umPromptNonInvoking) Begin
70521>>>>>>>            Send OnStoreDefaults
70522>>>>>>>        End
70522>>>>>>>>
70522>>>>>>>        Send InitializePrompt
70523>>>>>>>        Forward Send Add_Focus hoParent
70525>>>>>>>    End_Procedure
70526>>>>>>>    
70526>>>>>>>    // augment to send OnRestoreDefaults.
70526>>>>>>>    Procedure Release_Focus
70528>>>>>>>        Integer eUpdateMode
70528>>>>>>>        Get peUpdateMode to eUpdateMode
70529>>>>>>>        Forward Send Release_Focus
70531>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70533>>>>>>>            Send OnRestoreDefaults
70534>>>>>>>        End
70534>>>>>>>>
70534>>>>>>>    End_Procedure
70535>>>>>>>    
70535>>>>>>>    // This is only called in a successful close
70535>>>>>>>    Procedure ClosePrompt
70537>>>>>>>        Handle hoInvokingObject
70537>>>>>>>        Handle hmCallBack
70537>>>>>>>        Integer eUpdateMode
70537>>>>>>>        Date[] dDates
70538>>>>>>>        
70538>>>>>>>        Set pbCanceled to False
70539>>>>>>>        
70539>>>>>>>        Get peUpdateMode to eUpdateMode
70540>>>>>>>        // if non-invoking there is by definition, no move value out
70540>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70542>>>>>>>            
70542>>>>>>>            If (eUpdateMode=umPromptValue) Begin
70544>>>>>>>                Send OnMoveValueOutByValue
70545>>>>>>>            End
70545>>>>>>>>
70545>>>>>>>            Else If (eUpdateMode=umPromptCustom) Begin
70548>>>>>>>                Send OnMoveValueOutByCustom
70549>>>>>>>            End
70549>>>>>>>>
70549>>>>>>>            Get phmPromptUpdateCallback to hmCallBack
70550>>>>>>>            If hmCallBack Begin
70552>>>>>>>                Get phoInvokingObject to hoInvokingObject
70553>>>>>>>                If (pbMultiSelect(Self)) Begin
70555>>>>>>>                    Get SelectedDateRange to dDates
70556>>>>>>>                    Send hmCallBack of hoInvokingObject Self dDates[0] dDates[1]
70557>>>>>>>                    
70557>>>>>>>                End
70557>>>>>>>>
70557>>>>>>>                Else Begin
70558>>>>>>>                    Get SelectedDate to dDates[0]
70559>>>>>>>                    Send hmCallBack of hoInvokingObject Self dDates[0]
70560>>>>>>>                End
70560>>>>>>>>
70560>>>>>>>            End
70560>>>>>>>>
70560>>>>>>>        End
70560>>>>>>>>
70560>>>>>>>        
70560>>>>>>>        Send Close_Panel
70561>>>>>>>    End_Procedure
70562>>>>>>>    
70562>>>>>>>    Procedure OnMoveValueOutByValue
70564>>>>>>>        Handle hoInvokingObject
70564>>>>>>>        Date dSelDate
70564>>>>>>>        Boolean bMulti
70564>>>>>>>        // we can only do an automatic move value out with
70564>>>>>>>        // single select. If multi-select you will probably want to
70564>>>>>>>        // use a callback method (hmCallBack) to update the values.
70564>>>>>>>        Get pbMultiSelect to bMulti
70565>>>>>>>        If (not(bMulti)) Begin
70567>>>>>>>            Get SelectedDate to dSelDate
70568>>>>>>>            Get phoInvokingObject to hoInvokingObject
70569>>>>>>>            Set Value of hoInvokingObject to dSelDate
70570>>>>>>>            Set Item_Changed_State of hoInvokingObject to True
70571>>>>>>>        End
70571>>>>>>>>
70571>>>>>>>    End_Procedure
70572>>>>>>>    
70572>>>>>>>    Procedure OnMoveValueOutByCustom
70574>>>>>>>    End_Procedure
70575>>>>>>>    
70575>>>>>>>    // called before the list is activated.
70575>>>>>>>    Procedure InitializePrompt
70577>>>>>>>        Handle hoInvokingObject
70577>>>>>>>        Integer eUpdateMode
70577>>>>>>>        Boolean bMulti
70577>>>>>>>        Date dValue
70577>>>>>>>        
70577>>>>>>>        Get peUpdateMode to eUpdateMode
70578>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70580>>>>>>>            
70580>>>>>>>            Get Focus of Desktop to hoInvokingObject
70581>>>>>>>            If (hoInvokingObject<=Desktop) Begin
70583>>>>>>>                Error DFERR_PROGRAM "Calendar Prompt has no invoking object"
70584>>>>>>>>
70584>>>>>>>                Procedure_Return
70585>>>>>>>            End
70585>>>>>>>>
70585>>>>>>>            
70585>>>>>>>            Set phoInvokingObject to hoInvokingObject
70586>>>>>>>            Send Prompt_Callback to hoInvokingObject Self
70587>>>>>>>            Get peUpdateMode to eUpdateMode
70588>>>>>>>        End
70588>>>>>>>>
70588>>>>>>>        
70588>>>>>>>        Get pdSeedValue to dValue
70589>>>>>>>        Get pbMultiSelect to bMulti
70590>>>>>>>        If (not(bMulti) and eUpdateMode=umPromptValue and dValue=0) Begin
70592>>>>>>>            Get Value of hoInvokingObject to dValue
70593>>>>>>>            Set pdSeedValue to dValue
70594>>>>>>>        End
70594>>>>>>>>
70594>>>>>>>        Send OnSeedData
70595>>>>>>>        Set pdSeedValue to 0
70596>>>>>>>        Set pdSeedValue2 to 0
70597>>>>>>>    End_Procedure
70598>>>>>>>    
70598>>>>>>>    Procedure OnSeedData
70600>>>>>>>        Boolean bMulti
70600>>>>>>>        Date dValue dValue2
70600>>>>>>>        Integer iMax iRange
70600>>>>>>>        DateTime dt1 dt2
70600>>>>>>>        Get pbMultiSelect to bMulti
70601>>>>>>>        Get pdSeedValue to dValue
70602>>>>>>>        If (not(bMulti)) Begin
70604>>>>>>>            // if no date, use current date
70604>>>>>>>            If (dValue=0) Begin
70606>>>>>>>                Move (CurrentDateTime()) to dValue
70607>>>>>>>            End
70607>>>>>>>>
70607>>>>>>>            Send SetSelectedDate dValue
70608>>>>>>>        End
70608>>>>>>>>
70608>>>>>>>        Else Begin
70609>>>>>>>            Get pdSeedValue2 to dValue2
70610>>>>>>>            // if no dates, use current date
70610>>>>>>>            If (dValue=0 and dValue2=0) Begin
70612>>>>>>>                Move (CurrentDateTime()) to dValue
70613>>>>>>>            End
70613>>>>>>>>
70613>>>>>>>            // if only one date, make that the range
70613>>>>>>>            If (dValue=0) Begin
70615>>>>>>>                Move dValue2 to dValue
70616>>>>>>>            End
70616>>>>>>>>
70616>>>>>>>            Else If (dValue2=0) Begin
70619>>>>>>>                Move dValue to dValue2
70620>>>>>>>            End
70620>>>>>>>>
70620>>>>>>>            
70620>>>>>>>            // test for valid range
70620>>>>>>>            Get piMaxSelectedCount to iMax
70621>>>>>>>            Move dValue to dt1
70622>>>>>>>            Move dValue2 to dt2
70623>>>>>>>            Move (SpanTotalDays(dt1 - dt2)) to iRange
70624>>>>>>>            If (iRange>iMax) Begin
70626>>>>>>>                Error DFERR_OPERATOR (SFormat(C_$DateRangeExceeded,iMax))
70627>>>>>>>>
70627>>>>>>>                Move dValue to dValue2
70628>>>>>>>            End
70628>>>>>>>>
70628>>>>>>>            
70628>>>>>>>            Send SetSelectedDateRange dValue dValue2
70629>>>>>>>        End
70629>>>>>>>>
70629>>>>>>>    End_Procedure
70630>>>>>>>    
70630>>>>>>>    Procedure OnDoubleClick
70632>>>>>>>        Integer eSelectOn
70632>>>>>>>        Get peMouseSelectOk to eSelectOn
70633>>>>>>>        If (eSelectOn=msoDblClick) Begin
70635>>>>>>>            Send Ok
70636>>>>>>>        End
70636>>>>>>>>
70636>>>>>>>    End_Procedure
70637>>>>>>>    
70637>>>>>>>    Procedure OnClick
70639>>>>>>>        Integer eSelectOn
70639>>>>>>>        Get peMouseSelectOk to eSelectOn
70640>>>>>>>        If (eSelectOn=msoClick) Begin
70642>>>>>>>            Send Ok
70643>>>>>>>        End
70643>>>>>>>>
70643>>>>>>>    End_Procedure
70644>>>>>>>    
70644>>>>>>>    Procedure Ok Returns Integer
70646>>>>>>>        Send ClosePrompt
70647>>>>>>>    End_Procedure
70648>>>>>>>    
70648>>>>>>>    Procedure Cancel Returns Integer
70650>>>>>>>        Send Close_Panel
70651>>>>>>>    End_Procedure
70652>>>>>>>    
70652>>>>>>>End_Class
70653>>>>>Use Dfclient.pkg
70653>>>>>
70653>>>>>Cd_Popup_Object oMonthCalendarPrompt is a ModalPanel
70671>>>>>>
70671>>>>>    Set Location to 10 10
70672>>>>>    Set Size to 145 145
70673>>>>>    // resizable
70673>>>>>    Set Border_Style to Border_Thick
70674>>>>>    
70674>>>>>    Set Label to C_$DateSelector
70675>>>>>    
70675>>>>>    Set piMinSize to 0 0 // set this dynamically // 145 145
70676>>>>>    Set piMaxSize to 310 460
70677>>>>>    
70677>>>>>    // tells us if this been activated and sized yet
70677>>>>>    Property Boolean pbSizeInited False
70679>>>>>    
70679>>>>>    Object oCalendar is a cMonthCalendarPrompt
70681>>>>>        Set Size to 120 135 // not real size, will be assigned
70682>>>>>        Set Location to 5 5
70683>>>>>        Set Border_Style to Border_None
70684>>>>>    End_Object
70685>>>>>    
70685>>>>>    Object oOKButton is a Button
70687>>>>>        Set Label to C_$OK
70688>>>>>        Set Default_State to True
70689>>>>>        Set Location to 129 34
70690>>>>>        Set peAnchors to anBottomRight
70691>>>>>        
70691>>>>>        Procedure OnClick
70694>>>>>            Send Ok of oCalendar
70695>>>>>        End_Procedure
70696>>>>>    End_Object
70697>>>>>    
70697>>>>>    Object oCancelButton is a Button
70699>>>>>        Set Label to C_$Cancel
70700>>>>>        Set Location to 129 89
70701>>>>>        Set peAnchors to anBottomRight
70702>>>>>        
70702>>>>>        Procedure OnClick
70705>>>>>            Send Cancel of oCalendar
70706>>>>>        End_Procedure
70707>>>>>    End_Object
70708>>>>>    
70708>>>>>    Procedure OnResize
70711>>>>>        Integer iSize iHeight iWidth iMinSize
70711>>>>>        Boolean bInited
70711>>>>>        
70711>>>>>        Get piMinHeight of oCalendar to iHeight
70712>>>>>        // when 0, the control has not yet been created. Nothing to do.
70712>>>>>        If (iHeight=0) Begin
70714>>>>>            Procedure_Return
70715>>>>>        End
70715>>>>>>
70715>>>>>        
70715>>>>>        Get pbSizeInited to bInited
70716>>>>>        
70716>>>>>        Get piMinWidth of oCalendar to iWidth
70717>>>>>        Get piMinSize to iMinSize
70718>>>>>        // Minumum size of panel - add 1 to each to each for wiggle room
70718>>>>>        Move (iHeight+25+1) to iHeight
70719>>>>>        Move (iWidth+10+1) to iWidth
70720>>>>>        
70720>>>>>        Set piMinSize to iHeight iWidth
70721>>>>>        
70721>>>>>        If (not(bInited))  Begin
70723>>>>>            Set Size to iHeight iWidth
70724>>>>>            Set pbSizeInited to True
70725>>>>>        End
70725>>>>>>
70725>>>>>        Else Begin
70726>>>>>            Send Adjust_Logicals
70727>>>>>            Get Size to iSize
70728>>>>>            If (Hi(iSize)<iHeight or Low(iSize)<iWidth) Begin
70730>>>>>                Set Size to (iHeight max Hi(iSize)) (iWidth max Low(iSize))
70731>>>>>                Get Size to iSize
70732>>>>>            End
70732>>>>>>
70732>>>>>            Set Size of oCalendar to (Hi(iSize) - 25) (Low(iSize) - 10)
70733>>>>>        End
70733>>>>>>
70733>>>>>        
70733>>>>>    End_Procedure
70734>>>>>    
70734>>>>>    Procedure Add_Focus Handle hoParent Returns Integer
70737>>>>>        Forward Send Add_Focus hoParent
70739>>>>>        Send OnResize
70740>>>>>    End_Procedure
70741>>>>>    
70741>>>>>    On_Key kCancel Send KeyAction to oCancelButton
70742>>>>>    
70742>>>>>Cd_End_Object
70744>>>>>>
70744>>>>>
70744>>>
70744>>>ACTIVATE_VIEW Activate_oPageHeaderEntry FOR oPageHeaderEntry
70754>>>>
70754>>>Object oPageHeaderEntry is a dbView
70756>>>    Set Location to 5 5
70757>>>    Set Size to 107 420
70758>>>    Set Label To "PageHeaderEntry"
70759>>>    Set Border_Style to Border_Thick
70760>>>
70760>>>
70760>>>    Object oEmployee_DD is a cEmployeeDataDictionary
70762>>>    End_Object 
70763>>>
70763>>>    Object oLine_DD is a cLineDataDictionary
70765>>>    End_Object 
70766>>>
70766>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
70768>>>        Set DDO_Server To oEmployee_DD
70769>>>        Set DDO_Server To oLine_DD
70770>>>    End_Object 
70771>>>
70771>>>    Set Main_DD To oPageHeader_DD
70772>>>    Set Server  To oPageHeader_DD
70773>>>
70773>>>
70773>>>
70773>>>    Object oPageHeaderid is a dbForm
70775>>>        Entry_Item PageHeader.id
70776>>>        Set Size to 12 34
70777>>>        Set Location to 5 21
70778>>>        Set peAnchors to anTopLeftRight
70779>>>        Set Label to "id"
70780>>>        Set Label_Justification_mode to jMode_Left
70781>>>        Set Label_Col_Offset to 16
70782>>>        Set Label_row_Offset to 0
70783>>>    End_Object 
70784>>>
70784>>>    Object oEmployeeid is a dbForm
70786>>>        Entry_Item Employee.id
70787>>>        Set Size to 12 34
70788>>>        Set Location to 5 101
70789>>>        Set peAnchors to anTopRight
70790>>>        Set Label to "employee id"
70791>>>        Set Label_Justification_mode to jMode_Left
70792>>>        Set Label_Col_Offset to 41
70793>>>        Set Label_row_Offset to 0
70794>>>    End_Object 
70795>>>
70795>>>    Object oLineid is a dbForm
70797>>>        Entry_Item Line.id
70798>>>        Set Size to 12 34
70799>>>        Set Location to 5 161
70800>>>        Set peAnchors to anTopRight
70801>>>        Set Label to "line id"
70802>>>        Set Label_Justification_mode to jMode_Left
70803>>>        Set Label_Col_Offset to 21
70804>>>        Set Label_row_Offset to 0
70805>>>    End_Object 
70806>>>
70806>>>    Object oPageHeaderdate is a dbForm
70808>>>        Entry_Item PageHeader.date
70809>>>        Set Size to 12 66
70810>>>        Set Location to 19 21
70811>>>        Set peAnchors to anTopLeftRight
70812>>>        Set Label to "date"
70813>>>        Set Label_Justification_mode to jMode_Left
70814>>>        Set Label_Col_Offset to 16
70815>>>        Set Label_row_Offset to 0
70816>>>        Constrain PageHeader.Date Between "1/1/2020" and "12/31/2022"
70820>>>        Set Prompt_Object to oMonthCalendarPrompt
70821>>>        Set Prompt_Button_Mode to PB_PromptOn
70822>>>        Procedure OnExitObject
70825>>>            Date dDateSelected
70825>>>            
70825>>>            Get File_Field_Current_Value of oPageHeader_DD File_Field PageHeader.Date to dDateSelected
70826>>>            
70826>>>            If (dDateSelected < "1/1/2020" or dDateSelected > "12/31/2022" ) Begin
70828>>>                Send Info_Box "Date must be between 1/1/2020 and 12/31/2022"
70829>>>            End
70829>>>>
70829>>>            
70829>>>        End_Procedure
70830>>>    End_Object 
70831>>>
70831>>>    Object oPageHeaderhours is a dbForm
70833>>>        Entry_Item PageHeader.hours
70834>>>        Set Size to 12 34
70835>>>        Set Location to 19 112
70836>>>        Set peAnchors to anTopRight
70837>>>        Set Label to "hours"
70838>>>        Set Label_Justification_mode to jMode_Left
70839>>>        Set Label_Col_Offset to 20
70840>>>        Set Label_row_Offset to 0
70841>>>    End_Object 
70842>>>
70842>>>    Object oTabDialog is a dbTabDialog
70844>>>        Set Size to 61 410
70845>>>        Set Location to 41 5
70846>>>        Set peAnchors to anTopLeftRight
70847>>>
70847>>>        Object oTabPage1 is a dbTabPage
70849>>>            Set Label to "Tab Page Label"
70850>>>
70850>>>            Object oLinetype is a dbForm
70852>>>                Entry_Item Line.type
70853>>>                Set Size to 12 250
70854>>>                Set Location to 10 25
70855>>>                Set peAnchors to anTopLeftRight
70856>>>                Set Label to "type"
70857>>>                Set Label_Justification_mode to jMode_Left
70858>>>                Set Label_Col_Offset to 20
70859>>>                Set Label_row_Offset to 0
70860>>>            End_Object 
70861>>>
70861>>>            Object oEmployeename is a dbForm
70863>>>                Entry_Item Employee.name
70864>>>                Set Size to 12 250
70865>>>                Set Location to 24 25
70866>>>                Set peAnchors to anTopLeftRight
70867>>>                Set Label to "name"
70868>>>                Set Label_Justification_mode to jMode_Left
70869>>>                Set Label_Col_Offset to 20
70870>>>                Set Label_row_Offset to 0
70871>>>            End_Object 
70872>>>
70872>>>            Object oEmployeeid_card is a dbForm
70874>>>                Entry_Item Employee.id_card
70875>>>                Set Size to 12 96
70876>>>                Set Location to 24 304
70877>>>                Set peAnchors to anTopRight
70878>>>                Set Label to "id card"
70879>>>                Set Label_Justification_mode to jMode_Left
70880>>>                Set Label_Col_Offset to 24
70881>>>                Set Label_row_Offset to 0
70882>>>            End_Object 
70883>>>
70883>>>        End_Object 
70884>>>
70884>>>    End_Object 
70885>>>
70885>>>
70885>>>End_Object 
70886>        Use ShoeEntry.vw
Including file: ShoeEntry.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\ShoeEntry.vw)
70886>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\ShoeEntry.vw
70886>>>// ShoeEntry
70886>>>//
70886>>>
70886>>>Use DFClient.pkg
70886>>>Use DFEntry.pkg
70886>>>
70886>>>Use cShoeDataDictionary.dd
Including file: cShoeDataDictionary.dd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\cShoeDataDictionary.dd)
70886>>>>>Use DataDict.pkg
70886>>>>>
70886>>>>>Open Shoe
Including file: Shoe.fd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\Shoe.fd)
70888>>>>>Open system
70890>>>>>Open PageFooter
70892>>>>>
70892>>>>>Register_Object Shoe_sl
70892>>>>>
70892>>>>>Class cShoeDataDictionary is a DataDictionary
70893>>>>>    
70893>>>>>    Procedure Construct_Object
70895>>>>>        Forward Send Construct_Object
70897>>>>>        Set Main_File to Shoe.File_Number
70898>>>>>
70898>>>>>        Set Add_Client_File to PageFooter.File_Number
70899>>>>>
70899>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
70900>>>>>
70900>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
70901>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
70902>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
70903>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
70904>>>>>
70904>>>>>        Set Field_Auto_Increment Field Shoe.id to File_Field system.shoe_id
70905>>>>>        Set Field_Prompt_Object Field Shoe.id to Shoe_sl
70906>>>>>
70906>>>>>        Set Field_Prompt_Object Field Shoe.name to Shoe_sl
70907>>>>>
70907>>>>>        Set Field_Prompt_Object Field Shoe.price to Shoe_sl
70908>>>>>
70908>>>>>    End_Procedure
70909>>>>>
70909>>>>>End_Class
70910>>>>>
70910>>>>>Use Shoe.sl
Including file: Shoe.sl    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\Shoe.sl)
70910>>>>>>>// Shoe.sl
70910>>>>>>>// Shoe Lookup List
70910>>>>>>>
70910>>>>>>>Use DFClient.pkg
70910>>>>>>>Use cDbCJGridPromptList.pkg
70910>>>>>>>Use cDbCJGridColumn.pkg
70910>>>>>>>Use Windows.pkg
70910>>>>>>>
70910>>>>>>>Use cShoeDataDictionary.dd
70910>>>>>>>
70910>>>>>>>CD_Popup_Object Shoe_sl is a dbModalPanel
70928>>>>>>>>
70928>>>>>>>    Set Location to 5 5
70929>>>>>>>    Set Size to 134 272
70930>>>>>>>    Set Label To "Shoe Lookup List"
70931>>>>>>>    Set Border_Style to Border_Thick
70932>>>>>>>    Set Minimize_Icon to False
70933>>>>>>>
70933>>>>>>>
70933>>>>>>>    Object oShoe_DD is a cShoeDataDictionary
70935>>>>>>>    End_Object 
70936>>>>>>>
70936>>>>>>>    Set Main_DD To oShoe_DD
70937>>>>>>>    Set Server  To oShoe_DD
70938>>>>>>>
70938>>>>>>>
70938>>>>>>>
70938>>>>>>>    Object oSelList is a cDbCJGridPromptList
70940>>>>>>>        Set Size to 105 262
70941>>>>>>>        Set Location to 5 5
70942>>>>>>>        Set peAnchors to anAll
70943>>>>>>>        Set psLayoutSection to "Shoe_sl_oSelList"
70944>>>>>>>        Set Ordering to 1
70945>>>>>>>        Set pbAutoServer to True
70946>>>>>>>
70946>>>>>>>        Object oShoe_id is a cDbCJGridColumn
70948>>>>>>>            Entry_Item Shoe.id
70949>>>>>>>            Set piWidth to 60
70950>>>>>>>            Set psCaption to "id"
70951>>>>>>>        End_Object 
70952>>>>>>>
70952>>>>>>>        Object oShoe_name is a cDbCJGridColumn
70954>>>>>>>            Entry_Item Shoe.name
70955>>>>>>>            Set piWidth to 250
70956>>>>>>>            Set psCaption to "name"
70957>>>>>>>        End_Object 
70958>>>>>>>
70958>>>>>>>        Object oShoe_price is a cDbCJGridColumn
70960>>>>>>>            Entry_Item Shoe.price
70961>>>>>>>            Set piWidth to 110
70962>>>>>>>            Set psCaption to "price"
70963>>>>>>>        End_Object 
70964>>>>>>>
70964>>>>>>>
70964>>>>>>>    End_Object 
70965>>>>>>>
70965>>>>>>>    Object oOk_bn is a Button
70967>>>>>>>        Set Label to "&Ok"
70968>>>>>>>        Set Location to 115 109
70969>>>>>>>        Set peAnchors to anBottomRight
70970>>>>>>>
70970>>>>>>>        Procedure OnClick
70973>>>>>>>            Send OK of oSelList
70974>>>>>>>        End_Procedure
70975>>>>>>>
70975>>>>>>>    End_Object 
70976>>>>>>>
70976>>>>>>>    Object oCancel_bn is a Button
70978>>>>>>>        Set Label to "&Cancel"
70979>>>>>>>        Set Location to 115 163
70980>>>>>>>        Set peAnchors to anBottomRight
70981>>>>>>>
70981>>>>>>>        Procedure OnClick
70984>>>>>>>            Send Cancel of oSelList
70985>>>>>>>        End_Procedure
70986>>>>>>>
70986>>>>>>>    End_Object 
70987>>>>>>>
70987>>>>>>>    Object oSearch_bn is a Button
70989>>>>>>>        Set Label to "&Search..."
70990>>>>>>>        Set Location to 115 217
70991>>>>>>>        Set peAnchors to anBottomRight
70992>>>>>>>
70992>>>>>>>        Procedure OnClick
70995>>>>>>>            Send Search of oSelList
70996>>>>>>>        End_Procedure
70997>>>>>>>
70997>>>>>>>    End_Object 
70998>>>>>>>
70998>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
70999>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
71000>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
71001>>>>>>>
71001>>>>>>>
71001>>>>>>>CD_End_Object // Shoe_sl
71003>>>>>>>>
71003>>>
71003>>>ACTIVATE_VIEW Activate_oShoeEntry FOR oShoeEntry
71013>>>>
71013>>>Object oShoeEntry is a dbView
71015>>>    Set Location to 5 5
71016>>>    Set Size to 22 430
71017>>>    Set Label To "ShoeEntry"
71018>>>    Set Border_Style to Border_Thick
71019>>>
71019>>>
71019>>>    Object oShoe_DD is a cShoeDataDictionary
71021>>>    End_Object 
71022>>>
71022>>>    Set Main_DD To oShoe_DD
71023>>>    Set Server  To oShoe_DD
71024>>>
71024>>>
71024>>>
71024>>>    Object oShoeid is a dbForm
71026>>>        Entry_Item Shoe.id
71027>>>        Set Size to 12 42
71028>>>        Set Location to 5 13
71029>>>        Set peAnchors to anTopLeftRight
71030>>>        Set Label to "id"
71031>>>        Set Label_Justification_mode to jMode_Left
71032>>>        Set Label_Col_Offset to 8
71033>>>        Set Label_row_Offset to 0
71034>>>    End_Object 
71035>>>
71035>>>    Object oShoename is a dbForm
71037>>>        Entry_Item Shoe.name
71038>>>        Set Size to 12 250
71039>>>        Set Location to 5 80
71040>>>        Set peAnchors to anTopRight
71041>>>        Set Label to "name"
71042>>>        Set Label_Justification_mode to jMode_Left
71043>>>        Set Label_Col_Offset to 20
71044>>>        Set Label_row_Offset to 0
71045>>>    End_Object 
71046>>>
71046>>>    Object oShoeprice is a dbForm
71048>>>        Entry_Item Shoe.price
71049>>>        Set Size to 12 72
71050>>>        Set Location to 5 353
71051>>>        Set peAnchors to anTopRight
71052>>>        Set Label to "price"
71053>>>        Set Label_Justification_mode to jMode_Left
71054>>>        Set Label_Col_Offset to 18
71055>>>        Set Label_row_Offset to 0
71056>>>    End_Object 
71057>>>
71057>>>
71057>>>End_Object 
71058>        Use PageFooterEntry.vw
Including file: PageFooterEntry.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageFooterEntry.vw)
71058>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\PageFooterEntry.vw
71058>>>// PageFooterEntry
71058>>>//
71058>>>
71058>>>Use DFClient.pkg
71058>>>Use DFEntry.pkg
71058>>>Use DfTabDlg.pkg
71058>>>
71058>>>Use cEmployeeDataDictionary.dd
71058>>>Use cLineDataDictionary.dd
71058>>>Use cPageHeaderDataDictionary.dd
71058>>>Use cShoeDataDictionary.dd
71058>>>Use cPageFooterDataDictionary.dd
Including file: cPageFooterDataDictionary.dd    (C:\Users\szerg\Documents\jubilant-octo-umbrella\DDSrc\cPageFooterDataDictionary.dd)
71058>>>>>Use DataDict.pkg
71058>>>>>
71058>>>>>Open PageFooter
71060>>>>>Open PageHeader
71062>>>>>Open Shoe
71064>>>>>Open system
71066>>>>>
71066>>>>>Register_Object PageFooter_sl
71066>>>>>
71066>>>>>Class cPageFooterDataDictionary is a DataDictionary
71067>>>>>    
71067>>>>>    Procedure Construct_Object
71069>>>>>        Forward Send Construct_Object
71071>>>>>        Set Main_File to PageFooter.File_Number
71072>>>>>
71072>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
71073>>>>>
71073>>>>>        Set Add_Server_File to PageHeader.File_Number
71074>>>>>        Set Add_Server_File to Shoe.File_Number
71075>>>>>
71075>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
71076>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
71077>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
71078>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
71079>>>>>
71079>>>>>        Set Field_Auto_Increment Field PageFooter.id to File_Field system.page_footer_id
71080>>>>>        Set Field_Prompt_Object Field PageFooter.id to PageFooter_sl
71081>>>>>
71081>>>>>        Set Field_Option Field PageFooter.price DD_DISPLAYONLY to True
71082>>>>>
71082>>>>>    End_Procedure
71083>>>>>
71083>>>>>End_Class
71084>>>>>
71084>>>>>Use PageFooter.sl
Including file: PageFooter.sl    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageFooter.sl)
71084>>>>>>>// PageFooter.sl
71084>>>>>>>// PageFooter Lookup List
71084>>>>>>>
71084>>>>>>>Use DFClient.pkg
71084>>>>>>>Use cDbCJGridPromptList.pkg
71084>>>>>>>Use cDbCJGridColumn.pkg
71084>>>>>>>Use Windows.pkg
71084>>>>>>>
71084>>>>>>>Use cEmployeeDataDictionary.dd
71084>>>>>>>Use cLineDataDictionary.dd
71084>>>>>>>Use cPageHeaderDataDictionary.dd
71084>>>>>>>Use cShoeDataDictionary.dd
71084>>>>>>>Use cPageFooterDataDictionary.dd
71084>>>>>>>
71084>>>>>>>CD_Popup_Object PageFooter_sl is a dbModalPanel
71102>>>>>>>>
71102>>>>>>>    Set Location to 5 5
71103>>>>>>>    Set Size to 134 141
71104>>>>>>>    Set Label To "PageFooter Lookup List"
71105>>>>>>>    Set Border_Style to Border_Thick
71106>>>>>>>    Set Minimize_Icon to False
71107>>>>>>>
71107>>>>>>>
71107>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
71109>>>>>>>    End_Object 
71110>>>>>>>
71110>>>>>>>    Object oLine_DD is a cLineDataDictionary
71112>>>>>>>    End_Object 
71113>>>>>>>
71113>>>>>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
71115>>>>>>>        Set DDO_Server To oEmployee_DD
71116>>>>>>>        Set DDO_Server To oLine_DD
71117>>>>>>>    End_Object 
71118>>>>>>>
71118>>>>>>>    Object oShoe_DD is a cShoeDataDictionary
71120>>>>>>>    End_Object 
71121>>>>>>>
71121>>>>>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
71123>>>>>>>        Set DDO_Server To oPageHeader_DD
71124>>>>>>>        Set DDO_Server To oShoe_DD
71125>>>>>>>    End_Object 
71126>>>>>>>
71126>>>>>>>    Set Main_DD To oPageFooter_DD
71127>>>>>>>    Set Server  To oPageFooter_DD
71128>>>>>>>
71128>>>>>>>
71128>>>>>>>
71128>>>>>>>    Object oSelList is a cDbCJGridPromptList
71130>>>>>>>        Set Size to 105 131
71131>>>>>>>        Set Location to 5 5
71132>>>>>>>        Set peAnchors to anAll
71133>>>>>>>        Set psLayoutSection to "PageFooter_sl_oSelList"
71134>>>>>>>        Set Ordering to 1
71135>>>>>>>        Set pbAutoServer to True
71136>>>>>>>
71136>>>>>>>        Object oPageFooter_id is a cDbCJGridColumn
71138>>>>>>>            Entry_Item PageFooter.id
71139>>>>>>>            Set piWidth to 46
71140>>>>>>>            Set psCaption to "id"
71141>>>>>>>        End_Object 
71142>>>>>>>
71142>>>>>>>        Object oPageHeader_id is a cDbCJGridColumn
71144>>>>>>>            Entry_Item PageHeader.id
71145>>>>>>>            Set piWidth to 95
71146>>>>>>>            Set psCaption to "page header id"
71147>>>>>>>        End_Object 
71148>>>>>>>
71148>>>>>>>        Object oShoe_id is a cDbCJGridColumn
71150>>>>>>>            Entry_Item Shoe.id
71151>>>>>>>            Set piWidth to 60
71152>>>>>>>            Set psCaption to "shoe id"
71153>>>>>>>        End_Object 
71154>>>>>>>
71154>>>>>>>
71154>>>>>>>    End_Object 
71155>>>>>>>
71155>>>>>>>    Object oOk_bn is a Button
71157>>>>>>>        Set Label to "&Ok"
71158>>>>>>>        Set Location to 115 -22
71159>>>>>>>        Set peAnchors to anBottomRight
71160>>>>>>>
71160>>>>>>>        Procedure OnClick
71163>>>>>>>            Send OK of oSelList
71164>>>>>>>        End_Procedure
71165>>>>>>>
71165>>>>>>>    End_Object 
71166>>>>>>>
71166>>>>>>>    Object oCancel_bn is a Button
71168>>>>>>>        Set Label to "&Cancel"
71169>>>>>>>        Set Location to 115 32
71170>>>>>>>        Set peAnchors to anBottomRight
71171>>>>>>>
71171>>>>>>>        Procedure OnClick
71174>>>>>>>            Send Cancel of oSelList
71175>>>>>>>        End_Procedure
71176>>>>>>>
71176>>>>>>>    End_Object 
71177>>>>>>>
71177>>>>>>>    Object oSearch_bn is a Button
71179>>>>>>>        Set Label to "&Search..."
71180>>>>>>>        Set Location to 115 86
71181>>>>>>>        Set peAnchors to anBottomRight
71182>>>>>>>
71182>>>>>>>        Procedure OnClick
71185>>>>>>>            Send Search of oSelList
71186>>>>>>>        End_Procedure
71187>>>>>>>
71187>>>>>>>    End_Object 
71188>>>>>>>
71188>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
71189>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
71190>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
71191>>>>>>>
71191>>>>>>>
71191>>>>>>>CD_End_Object // PageFooter_sl
71193>>>>>>>>
71193>>>
71193>>>ACTIVATE_VIEW Activate_oPageFooterEntry FOR oPageFooterEntry
71203>>>>
71203>>>Object oPageFooterEntry is a dbView
71205>>>    Set Location to 5 5
71206>>>    Set Size to 79 445
71207>>>    Set Label To "PageFooterEntry"
71208>>>    Set Border_Style to Border_Thick
71209>>>
71209>>>
71209>>>    Object oEmployee_DD is a cEmployeeDataDictionary
71211>>>    End_Object 
71212>>>
71212>>>    Object oLine_DD is a cLineDataDictionary
71214>>>    End_Object 
71215>>>
71215>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
71217>>>        Set DDO_Server To oEmployee_DD
71218>>>        Set DDO_Server To oLine_DD
71219>>>    End_Object 
71220>>>
71220>>>    Object oShoe_DD is a cShoeDataDictionary
71222>>>    End_Object 
71223>>>
71223>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
71225>>>        Set DDO_Server To oPageHeader_DD
71226>>>        Set DDO_Server To oShoe_DD
71227>>>    End_Object 
71228>>>
71228>>>    Set Main_DD To oPageFooter_DD
71229>>>    Set Server  To oPageFooter_DD
71230>>>
71230>>>
71230>>>
71230>>>    Object oPageFooterid is a dbForm
71232>>>        Entry_Item PageFooter.id
71233>>>        Set Size to 12 34
71234>>>        Set Location to 5 13
71235>>>        Set peAnchors to anTopLeftRight
71236>>>        Set Label to "id"
71237>>>        Set Label_Justification_mode to jMode_Left
71238>>>        Set Label_Col_Offset to 8
71239>>>        Set Label_row_Offset to 0
71240>>>    End_Object 
71241>>>
71241>>>    Object oPageHeaderid is a dbForm
71243>>>        Entry_Item PageHeader.id
71244>>>        Set Size to 12 34
71245>>>        Set Location to 5 119
71246>>>        Set peAnchors to anTopRight
71247>>>        Set Label to "page header id"
71248>>>        Set Label_Justification_mode to jMode_Left
71249>>>        Set Label_Col_Offset to 49
71250>>>        Set Label_row_Offset to 0
71251>>>    End_Object 
71252>>>
71252>>>    Object oShoeid is a dbForm
71254>>>        Entry_Item Shoe.id
71255>>>        Set Size to 12 42
71256>>>        Set Location to 5 202
71257>>>        Set peAnchors to anTopRight
71258>>>        Set Label to "shoe id"
71259>>>        Set Label_Justification_mode to jMode_Left
71260>>>        Set Label_Col_Offset to 25
71261>>>        Set Label_row_Offset to 0
71262>>>    End_Object 
71263>>>
71263>>>    Object oTabDialog is a dbTabDialog
71265>>>        Set Size to 47 435
71266>>>        Set Location to 27 5
71267>>>        Set peAnchors to anTopLeftRight
71268>>>
71268>>>        Object oTabPage1 is a dbTabPage
71270>>>            Set Label to "Tab Page Label"
71271>>>
71271>>>            Object oPageHeaderid is a dbForm
71273>>>                Entry_Item PageHeader.id
71274>>>                Set Size to 12 34
71275>>>                Set Location to 10 13
71276>>>                Set peAnchors to anTopLeftRight
71277>>>                Set Label to "id"
71278>>>                Set Label_Justification_mode to jMode_Left
71279>>>                Set Label_Col_Offset to 8
71280>>>                Set Label_row_Offset to 0
71281>>>            End_Object 
71282>>>
71282>>>            Object oEmployeeid is a dbForm
71284>>>                Entry_Item Employee.id
71285>>>                Set Size to 12 34
71286>>>                Set Location to 10 93
71287>>>                Set peAnchors to anTopRight
71288>>>                Set Label to "employee id"
71289>>>                Set Label_Justification_mode to jMode_Left
71290>>>                Set Label_Col_Offset to 41
71291>>>                Set Label_row_Offset to 0
71292>>>            End_Object 
71293>>>
71293>>>            Object oLineid is a dbForm
71295>>>                Entry_Item Line.id
71296>>>                Set Size to 12 34
71297>>>                Set Location to 10 153
71298>>>                Set peAnchors to anTopRight
71299>>>                Set Label to "line id"
71300>>>                Set Label_Justification_mode to jMode_Left
71301>>>                Set Label_Col_Offset to 21
71302>>>                Set Label_row_Offset to 0
71303>>>            End_Object 
71304>>>
71304>>>        End_Object 
71305>>>
71305>>>        Object oTabPage2 is a dbTabPage
71307>>>            Set Label to "Tab Page Label"
71308>>>
71308>>>            Object oShoeid is a dbForm
71310>>>                Entry_Item Shoe.id
71311>>>                Set Size to 12 42
71312>>>                Set Location to 10 13
71313>>>                Set peAnchors to anTopLeftRight
71314>>>                Set Label to "id"
71315>>>                Set Label_Justification_mode to jMode_Left
71316>>>                Set Label_Col_Offset to 8
71317>>>                Set Label_row_Offset to 0
71318>>>            End_Object 
71319>>>
71319>>>            Object oShoename is a dbForm
71321>>>                Entry_Item Shoe.name
71322>>>                Set Size to 12 250
71323>>>                Set Location to 10 80
71324>>>                Set peAnchors to anTopRight
71325>>>                Set Label to "name"
71326>>>                Set Label_Justification_mode to jMode_Left
71327>>>                Set Label_Col_Offset to 20
71328>>>                Set Label_row_Offset to 0
71329>>>            End_Object 
71330>>>
71330>>>            Object oShoeprice is a dbForm
71332>>>                Entry_Item Shoe.price
71333>>>                Set Size to 12 72
71334>>>                Set Location to 10 353
71335>>>                Set peAnchors to anTopRight
71336>>>                Set Label to "price"
71337>>>                Set Label_Justification_mode to jMode_Left
71338>>>                Set Label_Col_Offset to 18
71339>>>                Set Label_row_Offset to 0
71340>>>            End_Object 
71341>>>
71341>>>        End_Object 
71342>>>
71342>>>    End_Object 
71343>>>    
71343>>>     Object oDetailGrid is a cDbCJGrid
71345>>>        
71345>>>        Set Size to 447 348
71346>>>        Set Location to 73 5
71347>>>        Set Server to oPageFooter_DD
71348>>>        Set Ordering to 1
71349>>>        Set peAnchors to anAll
71350>>>        Set psLayoutSection to "oPageFooterEntry_oDetailGrid"
71351>>>        Set pbAllowInsertRow to False
71352>>>        Set pbHeaderPrompts to True
71353>>>        
71353>>>        
71353>>>        
71353>>>        Object oFooteridGrid is a cDbCJGridColumn
71355>>>        Entry_Item PageFooter.id
71356>>>        Set piWidth to 78
71357>>>        Set psCaption to "Footer"
71358>>>        End_Object
71359>>>        
71359>>>        
71359>>>        
71359>>>        Object oHeaderidGrid is a cDbCJGridColumn
71361>>>        Entry_Item PageFooter.page_header_id
71362>>>        Set piWidth to 115
71363>>>        Set psCaption to "Header"
71364>>>        End_Object
71365>>>        
71365>>>        
71365>>>        
71365>>>        Object oShoeidGrid is a cDbCJGridColumn
71367>>>        Entry_Item PageFooter.shoe_id
71368>>>        Set piWidth to 387
71369>>>        Set psCaption to "Shoe"
71370>>>        End_Object
71371>>>
71371>>>
71371>>>
71371>>>    End_Object
71372>>>
71372>>>End_Object 
71373>        Use PageFooterEntry2.vw
Including file: PageFooterEntry2.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageFooterEntry2.vw)
71373>>>// C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageFooterEntry2.vw
71373>>>// PageFooterEntry2
71373>>>//
71373>>>
71373>>>Use DFClient.pkg
71373>>>Use DFEntry.pkg
71373>>>Use cDbCJGrid.pkg
71373>>>Use cDbCJGridColumn.pkg
71373>>>
71373>>>Use cEmployeeDataDictionary.dd
71373>>>Use cLineDataDictionary.dd
71373>>>Use cPageHeaderDataDictionary.dd
71373>>>Use cShoeDataDictionary.dd
71373>>>Use cPageFooterDataDictionary.dd
71373>>>
71373>>>ACTIVATE_VIEW Activate_oPageFooterEntry2 FOR oPageFooterEntry2
71383>>>>
71383>>>Object oPageFooterEntry2 is a dbView
71385>>>    Set Location to 5 5
71386>>>    Set Size to 132 370
71387>>>    Set Label To "PageFooterEntry2"
71388>>>    Set Border_Style to Border_Thick
71389>>>
71389>>>
71389>>>    Object oEmployee_DD is a cEmployeeDataDictionary
71391>>>    End_Object 
71392>>>
71392>>>    Object oLine_DD is a cLineDataDictionary
71394>>>    End_Object 
71395>>>
71395>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
71397>>>        Set DDO_Server To oEmployee_DD
71398>>>        Set DDO_Server To oLine_DD
71399>>>        // this lets you save a new parent DD from within child DD
71399>>>        Set Allow_Foreign_New_Save_State to True
71400>>>    End_Object 
71401>>>
71401>>>    Object oShoe_DD is a cShoeDataDictionary
71403>>>    End_Object 
71404>>>
71404>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
71406>>>        Set DDO_Server To oPageHeader_DD
71407>>>        Set DDO_Server To oShoe_DD
71408>>>        Set Constrain_File To PageHeader.File_Number
71409>>>    End_Object 
71410>>>
71410>>>    Set Main_DD To oPageHeader_DD
71411>>>    Set Server  To oPageHeader_DD
71412>>>
71412>>>
71412>>>
71412>>>    Object oPageHeaderid is a dbForm
71414>>>        Entry_Item PageHeader.id
71415>>>        Set Size to 12 204
71416>>>        Set Location to 5 21
71417>>>        Set peAnchors to anTopLeftRight
71418>>>        Set Label to "id"
71419>>>        Set Label_Justification_mode to jMode_Left
71420>>>        Set Label_Col_Offset to 16
71421>>>        Set Label_row_Offset to 0
71422>>>    End_Object 
71423>>>
71423>>>    Object oEmployeeid is a dbForm
71425>>>        Entry_Item Employee.id
71426>>>        Set Size to 12 34
71427>>>        Set Location to 5 271
71428>>>        Set peAnchors to anTopRight
71429>>>        Set Label to "employee id"
71430>>>        Set Label_Justification_mode to jMode_Left
71431>>>        Set Label_Col_Offset to 41
71432>>>        Set Label_row_Offset to 0
71433>>>    End_Object 
71434>>>
71434>>>    Object oLineid is a dbForm
71436>>>        Entry_Item Line.id
71437>>>        Set Size to 12 34
71438>>>        Set Location to 5 331
71439>>>        Set peAnchors to anTopRight
71440>>>        Set Label to "line id"
71441>>>        Set Label_Justification_mode to jMode_Left
71442>>>        Set Label_Col_Offset to 21
71443>>>        Set Label_row_Offset to 0
71444>>>    End_Object 
71445>>>
71445>>>    Object oPageHeaderdate is a dbForm
71447>>>        Entry_Item PageHeader.date
71448>>>        Set Size to 12 236
71449>>>        Set Location to 19 21
71450>>>        Set peAnchors to anTopLeftRight
71451>>>        Set Label to "date"
71452>>>        Set Label_Justification_mode to jMode_Left
71453>>>        Set Label_Col_Offset to 16
71454>>>        Set Label_row_Offset to 0
71455>>>    End_Object 
71456>>>
71456>>>    Object oPageHeaderhours is a dbForm
71458>>>        Entry_Item PageHeader.hours
71459>>>        Set Size to 12 34
71460>>>        Set Location to 19 282
71461>>>        Set peAnchors to anTopRight
71462>>>        Set Label to "hours"
71463>>>        Set Label_Justification_mode to jMode_Left
71464>>>        Set Label_Col_Offset to 20
71465>>>        Set Label_row_Offset to 0
71466>>>    End_Object 
71467>>>
71467>>>    Object oDetailGrid is a cDbCJGrid
71469>>>        Set Size to 86 354
71470>>>        Set Location to 41 5
71471>>>        Set Server to oPageFooter_DD
71472>>>        Set Ordering to 2
71473>>>        Set peAnchors to anAll
71474>>>        Set psLayoutSection to "oPageFooterEntry2_oDetailGrid"
71475>>>        Set pbAllowInsertRow to False
71476>>>        Set pbHeaderPrompts to True
71477>>>
71477>>>        Object oShoe_id is a cDbCJGridColumn
71479>>>            Entry_Item Shoe.id
71480>>>            Set piWidth to 122
71481>>>            Set psCaption to "shoe id"
71482>>>        End_Object 
71483>>>
71483>>>        Object oPageFooter_price is a cDbCJGridColumn
71485>>>            Entry_Item PageFooter.price
71486>>>            Set piWidth to 345
71487>>>            Set psCaption to "price"
71488>>>        End_Object 
71489>>>
71489>>>        Object oPageFooter_quantity is a cDbCJGridColumn
71491>>>            Entry_Item PageFooter.quantity
71492>>>            Set piWidth to 123
71493>>>            Set psCaption to "quantity"
71494>>>        End_Object 
71495>>>
71495>>>    End_Object 
71496>>>
71496>>>    //-----------------------------------------------------------------------
71496>>>    // Create custom confirmation messages for save and delete
71496>>>    // We must create the new functions and assign verify messages
71496>>>    // to them.
71496>>>    //-----------------------------------------------------------------------
71496>>>
71496>>>    Function ConfirmDeleteHeader Returns Boolean
71499>>>        Boolean bFail
71499>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
71500>>>        Function_Return bFail
71501>>>    End_Function 
71502>>>
71502>>>    // Only confirm on the saving of new records
71502>>>    Function ConfirmSaveHeader Returns Boolean
71505>>>        Boolean bNoSave bHasRecord
71505>>>        Handle  hoSrvr
71505>>>        Get Server to hoSrvr
71506>>>        Get HasRecord of hoSrvr to bHasRecord
71507>>>        If not bHasRecord Begin
71509>>>            Get Confirm "Save this NEW header?" to bNoSave
71510>>>        End
71510>>>>
71510>>>        Function_Return bNoSave
71511>>>    End_Function 
71512>>>
71512>>>    // Define alternate confirmation Messages
71512>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
71513>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
71514>>>    // Saves in header should not clear the view
71514>>>    Set Auto_Clear_Deo_State to False
71515>>>
71515>>>
71515>>>End_Object 
71516>        Use PageFooterEntry3.vw
Including file: PageFooterEntry3.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageFooterEntry3.vw)
71516>>>// C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageFooterEntry3.vw
71516>>>// PageFooterEntry3
71516>>>//
71516>>>
71516>>>Use DFClient.pkg
71516>>>Use DFEntry.pkg
71516>>>Use cDbCJGrid.pkg
71516>>>Use cDbCJGridColumn.pkg
71516>>>
71516>>>Use cEmployeeDataDictionary.dd
71516>>>Use cLineDataDictionary.dd
71516>>>Use cPageHeaderDataDictionary.dd
71516>>>Use cShoeDataDictionary.dd
71516>>>Use cPageFooterDataDictionary.dd
71516>>>
71516>>>ACTIVATE_VIEW Activate_oPageFooterEntry3 FOR oPageFooterEntry3
71526>>>>
71526>>>Object oPageFooterEntry3 is a dbView
71528>>>    Set Location to 5 5
71529>>>    Set Size to 112 200
71530>>>    Set Label To "PageFooterEntry3"
71531>>>    Set Border_Style to Border_Thick
71532>>>
71532>>>
71532>>>    Object oEmployee_DD is a cEmployeeDataDictionary
71534>>>    End_Object 
71535>>>
71535>>>    Object oLine_DD is a cLineDataDictionary
71537>>>    End_Object 
71538>>>
71538>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
71540>>>        Set DDO_Server To oEmployee_DD
71541>>>        Set DDO_Server To oLine_DD
71542>>>        // this lets you save a new parent DD from within child DD
71542>>>        Set Allow_Foreign_New_Save_State to True
71543>>>    End_Object 
71544>>>
71544>>>    Object oShoe_DD is a cShoeDataDictionary
71546>>>    End_Object 
71547>>>
71547>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
71549>>>        Set DDO_Server To oPageHeader_DD
71550>>>        Set DDO_Server To oShoe_DD
71551>>>        Set Constrain_File To PageHeader.File_Number
71552>>>    End_Object 
71553>>>
71553>>>    Set Main_DD To oPageHeader_DD
71554>>>    Set Server  To oPageHeader_DD
71555>>>
71555>>>
71555>>>
71555>>>    Object oPageHeaderid is a dbForm
71557>>>        Entry_Item PageHeader.id
71558>>>        Set Size to 12 34
71559>>>        Set Location to 5 21
71560>>>        Set peAnchors to anTopLeftRight
71561>>>        Set Label to "id"
71562>>>        Set Label_Justification_mode to jMode_Left
71563>>>        Set Label_Col_Offset to 16
71564>>>        Set Label_row_Offset to 0
71565>>>    End_Object 
71566>>>
71566>>>    Object oEmployeeid is a dbForm
71568>>>        Entry_Item Employee.id
71569>>>        Set Size to 12 34
71570>>>        Set Location to 5 101
71571>>>        Set peAnchors to anTopRight
71572>>>        Set Label to "employee id"
71573>>>        Set Label_Justification_mode to jMode_Left
71574>>>        Set Label_Col_Offset to 41
71575>>>        Set Label_row_Offset to 0
71576>>>    End_Object 
71577>>>
71577>>>    Object oLineid is a dbForm
71579>>>        Entry_Item Line.id
71580>>>        Set Size to 12 34
71581>>>        Set Location to 5 161
71582>>>        Set peAnchors to anTopRight
71583>>>        Set Label to "line id"
71584>>>        Set Label_Justification_mode to jMode_Left
71585>>>        Set Label_Col_Offset to 21
71586>>>        Set Label_row_Offset to 0
71587>>>    End_Object 
71588>>>
71588>>>    Object oPageHeaderdate is a dbForm
71590>>>        Entry_Item PageHeader.date
71591>>>        Set Size to 12 66
71592>>>        Set Location to 19 21
71593>>>        Set peAnchors to anTopLeftRight
71594>>>        Set Label to "date"
71595>>>        Set Label_Justification_mode to jMode_Left
71596>>>        Set Label_Col_Offset to 16
71597>>>        Set Label_row_Offset to 0
71598>>>    End_Object 
71599>>>
71599>>>    Object oPageHeaderhours is a dbForm
71601>>>        Entry_Item PageHeader.hours
71602>>>        Set Size to 12 34
71603>>>        Set Location to 19 112
71604>>>        Set peAnchors to anTopRight
71605>>>        Set Label to "hours"
71606>>>        Set Label_Justification_mode to jMode_Left
71607>>>        Set Label_Col_Offset to 20
71608>>>        Set Label_row_Offset to 0
71609>>>    End_Object 
71610>>>
71610>>>    Object oDetailGrid is a cDbCJGrid
71612>>>        Set Size to 66 148
71613>>>        Set Location to 41 5
71614>>>        Set Server to oPageFooter_DD
71615>>>        Set Ordering to 2
71616>>>        Set peAnchors to anAll
71617>>>        Set psLayoutSection to "oPageFooterEntry3_oDetailGrid"
71618>>>        Set pbAllowInsertRow to False
71619>>>        Set pbHeaderPrompts to True
71620>>>
71620>>>        Object oShoe_id is a cDbCJGridColumn
71622>>>            Entry_Item Shoe.id
71623>>>            Set piWidth to 60
71624>>>            Set psCaption to "shoe id"
71625>>>        End_Object 
71626>>>
71626>>>        Object oShoe_price is a cDbCJGridColumn
71628>>>            Entry_Item Shoe.price
71629>>>            Set piWidth to 110
71630>>>            Set psCaption to "price"
71631>>>        End_Object 
71632>>>
71632>>>        Object oPageFooter_quantity is a cDbCJGridColumn
71634>>>            Entry_Item PageFooter.quantity
71635>>>            Set piWidth to 60
71636>>>            Set psCaption to "quantity"
71637>>>        End_Object 
71638>>>
71638>>>    End_Object 
71639>>>
71639>>>    //-----------------------------------------------------------------------
71639>>>    // Create custom confirmation messages for save and delete
71639>>>    // We must create the new functions and assign verify messages
71639>>>    // to them.
71639>>>    //-----------------------------------------------------------------------
71639>>>
71639>>>    Function ConfirmDeleteHeader Returns Boolean
71642>>>        Boolean bFail
71642>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
71643>>>        Function_Return bFail
71644>>>    End_Function 
71645>>>
71645>>>    // Only confirm on the saving of new records
71645>>>    Function ConfirmSaveHeader Returns Boolean
71648>>>        Boolean bNoSave bHasRecord
71648>>>        Handle  hoSrvr
71648>>>        Get Server to hoSrvr
71649>>>        Get HasRecord of hoSrvr to bHasRecord
71650>>>        If not bHasRecord Begin
71652>>>            Get Confirm "Save this NEW header?" to bNoSave
71653>>>        End
71653>>>>
71653>>>        Function_Return bNoSave
71654>>>    End_Function 
71655>>>
71655>>>    // Define alternate confirmation Messages
71655>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
71656>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
71657>>>    // Saves in header should not clear the view
71657>>>    Set Auto_Clear_Deo_State to False
71658>>>
71658>>>
71658>>>End_Object 
71659>        Use ReportView.rv
Including file: ReportView.rv    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\ReportView.rv)
71659>>>// ReportView.rv
71659>>>// ReportView
71659>>>Register_Object oReport
71659>>>
71659>>>Use DFRptVw.pkg
71659>>>Use cWinReport2.pkg
Including file: cWinReport2.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cWinReport2.pkg)
71659>>>>>// defines support for Winprint2 cWinReport2 class
71659>>>>>
71659>>>>>
71659>>>>>Use DFRpt.pkg              // BasicReport RO Class for VDF
71659>>>>>Use WinPrint2.pkg          // WinPrint2 engine
Including file: Winprint2.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Winprint2.pkg)
71659>>>>>>>Use windows.pkg
71659>>>>>>>Use LanguageText.pkg
71659>>>>>>>Use DLL.pkg
71659>>>>>>>Use WinPrint2_Api.pkg
Including file: WinPrint2_API.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\WinPrint2_API.pkg)
71659>>>>>>>>>Use DLL.pkg
71659>>>>>>>>>
71659>>>>>>>>>External_Function WP_IsPrinterValid "IsPrinterValid" WinPrint.dll ;    Returns Boolean // True if the the current printer is a valid one. False, otherwise.
71660>>>>>>>>>
71660>>>>>>>>>External_Function WP_ArePrintersInstalled "ArePrintersInstalled" WinPrint.dll ; // determines whether at least one printer is installed    Returns Boolean // True, if a printer is installed, False if it is not.
71661>>>>>>>>>
71661>>>>>>>>>External_Function WP_ExecutePrinterSetupDialog "ExecutePrinterSetupDialog" WinPrint.dll ; // displays the "printer setup" dialog    Handle hWndParent; // window handle of the parent window    Returns Boolean // True if the OK button pressed; False, otherwise.
71662>>>>>>>>>
71662>>>>>>>>>External_Function WP_ExecutePrintDialog "ExecutePrintDialog" WinPrint.dll ; // displays the "Print" dialog    Handle hWndParent; // window handle of the parent window    Returns Boolean // True if the OK button pressed; False, otherwise.
71663>>>>>>>>>
71663>>>>>>>>>External_Function WP_GetCurrentDevice "GetCurrentDevice" WinPrint.dll ; // retrieves the name of the current printer device    Address aDevice ; // address of the string (255 chars) that will hold the device name upon return    Returns Boolean // True, if success; False if error occurred
71664>>>>>>>>>
71664>>>>>>>>>External_Function WP_GetPrintDialogFlags "GetPrintDialogFlags" WinPrint.dll ; // retrieves the current print options    Returns UInteger // array of flags representing print-related options that are currently set
71665>>>>>>>>>
71665>>>>>>>>>External_Function WP_GetUserDefinedPapersize "GetUserDefinedPapersize" WinPrint.dll ;  // gets the size of user-defined paper    Returns UInteger // // hi-word=length; lo-word=width
71666>>>>>>>>>
71666>>>>>>>>>External_Function WP_IsPrintDialogFlagSet "IsPrintDialogFlagSet" WinPrint.dll ; // determines whether a specific print-flag is set    UInteger iFlag ; // the printer flag    Returns Boolean // True, if the flag is set; False, if it isn't
71667>>>>>>>>>
71667>>>>>>>>>External_Function WP_SelectPrinter "SelectPrinter" WinPrint.dll ; // selects a printer programatically    String sDevice; // the name of the printer    Returns Boolean // True, if success; False, if error (such as an invalid printer name)
71668>>>>>>>>>
71668>>>>>>>>>External_Function WP_SetFirstPagePaperSource "SetFirstPagePaperSource"  WinPrint.dll ;    Integer iBin ; // the bim constant    Returns Boolean // True if success, false if error
71669>>>>>>>>>
71669>>>>>>>>>External_Function WP_SetNumberOfPrintCopies "SetNumberOfPrintCopies" WinPrint.dll ; // sets the number of copies to print    UInteger iNumCopies; // number of copies to make    Returns Boolean // Always True
71670>>>>>>>>>
71670>>>>>>>>>External_Function WP_SetSpecificPrintDialogFlag "SetSpecificPrintDialogFlag" WinPrint.dll; // Sets/unsets one printer flag    UInteger fFlag; // printer flag    Returns Boolean // True, if success; False if error occurred
71671>>>>>>>>>
71671>>>>>>>>>External_Function WP_SetPrintDialogFlags "SetPrintDialogFlags" WinPrint.dll; // Sets/unsets all printer flags in one call    UInteger fFlags; // printer flags    Returns Boolean // True, if success; False if error occurred
71672>>>>>>>>>
71672>>>>>>>>>External_Function WP_SetUserDefinedPapersize "SetUserDefinedPapersize" WinPrint.dll ;  // sets the size of user-defined paper    UInteger iPaperSize ; // hi-word=length; lo-word=width    Returns Boolean // True, if success; False if error occurred
71673>>>>>>>>>
71673>>>>>>>>>External_Function WP_SetFontStyle "SetFontStyle" WinPrint.dll ; // sets multiple font attributes    Integer iStyles ; // series of flags    Returns Boolean // always True
71674>>>>>>>>>
71674>>>>>>>>>External_Function WP_SetFontBold "SetFontBold" WinPrint.dll ; // toggles the bold attribute of the current font    Boolean bBold ; // True to switch bold attribute on; False to switch it off    Returns Boolean // always True
71675>>>>>>>>>
71675>>>>>>>>>External_Function WP_SetFontItalic "SetFontItalic" WinPrint.dll ; // toggles the italic attribute of the current font    Boolean bItalic ; // True to switch italic attribute on; False to switch it off    Returns Boolean  // always True
71676>>>>>>>>>
71676>>>>>>>>>External_Function WP_SetFontUnderline "SetFontUnderline" WinPrint.dll ; // toggles the underline attribute of the current font    Boolean bUnderline ; // True to switch underline attribute on; False to switch it off    Returns Boolean  // always True
71677>>>>>>>>>
71677>>>>>>>>>External_Function WP_SetFontStrikeout "SetFontStrikeout" WinPrint.dll ; // toggles the strikeout attribute of the current font    Boolean bStrikeout ; // True to switch strikeout attribute on; False to switch it off    Returns Boolean  // always True
71678>>>>>>>>>
71678>>>>>>>>>External_Function WP_SetFontColor "SetFontColor" WinPrint.dll ; // sets the color of the current font    Integer iColor ; // color of the font    Returns Boolean  // always True
71679>>>>>>>>>
71679>>>>>>>>>External_Function WP_SetFontHeight "SetFontHeight" WinPrint.dll ; // sets the height of the font    UInteger iHeight ; // height of the font in points (multiplied by 100. Eg 12.5 point should be sent as 1250)    Returns Boolean  // always True
71680>>>>>>>>>
71680>>>>>>>>>External_Function WP_SetFontName "SetFontName" WinPrint.dll ; // Sets the name of the font to use    String sFontName ; // name of the font to use    Returns Boolean  // always True
71681>>>>>>>>>
71681>>>>>>>>>External_Function WP_DrawBitmap "DrawBitmap" WinPrint.dll ; // Draws a bitmap (BMP, JPG)    String  sBitmap;                 // Name of the bitmap    Integer iLeft;                   // distance from left edge to draw bitmap    Integer iTop;                    // distance from top edge to draw bitmap    Integer iWidth;                  // width of the bitmap    Integer iHeight;                 // height of the bitmap    Boolean bUpdateCurrentPosition;  // after drawing, should the current position be updated?    Returns Boolean // True, if OK; False, if an error occurred.
71682>>>>>>>>>
71682>>>>>>>>>External_Function WP_DrawEllipse "DrawEllipse" WinPrint.dll ; // draws an elipse within a bounding rectangle    Integer iLeft;                   // distance from left edge to draw the ellipse    Integer iTop;                    // distance from top edge to draw the ellipse    Integer iWidth;                  // width of the bounding rectangle    Integer iHeight;                 // height of the bounding rectangle    Integer iBorderColor;            // color of the ellipse's edge    Integer iFillColor;              // internal color of the ellipse    Boolean  bFill;                  // should the ellipse be filled? (False=transparent)    UInteger iThickness;             // thickness of the elipse    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the ellipse be drawn on future soft-page breaks?    Returns Boolean // True, if OK; False, if an error occurred.
71683>>>>>>>>>
71683>>>>>>>>>External_Function WP_DrawLine "DrawLine" WinPrint.dll ; // draws a line from the current position    Integer iLeft;                   // distance from left edge to draw the line    Integer iTop;                    // distance from top edge to draw the line    Integer iLength;                 // length of the line    Boolean  bHorizontal;            // draw horizontal? (False=vertical)    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Returns Boolean // True, if OK; False, if an error occurred.
71684>>>>>>>>>
71684>>>>>>>>>External_Function WP_DrawRectangle "DrawRectangle" WinPrint.dll ; // draws a rectangle    Integer iLeft;                   // distance from left edge to draw the rectangle    Integer iTop;                    // distance from top edge to draw the rectangle    Integer iWidth;                  // width of the rectangle    Integer iHeight;                 // height of the rectangle    Integer iBorderColor;            // color of the rectangle's border    Integer iFillColor;              // internal color of the rectangle    Boolean  bFill;                  // should the rectangle be filled? (False=transparent)    UInteger iThickness;             // thickness of the rectangle's border    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the rectangle be drawn on future soft-page breaks?    Returns Boolean // True, if OK; False, if an error occurred.
71685>>>>>>>>>
71685>>>>>>>>>External_Function WP_DrawXYLine "DrawXYLine" WinPrint.dll ; // draws a line between two points    Integer iLeftStart;              // distance from left edge to draw from    Integer iTopStart;               // distance from top edge to draw from    Integer iLeftEnd;                // distance from left edge to draw to    Integer iTopEnd;                 // distance from top edge to draw to    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the line be drawn on future soft-page breaks?    Returns Boolean // True, if OK; False, if an error occurred.
71686>>>>>>>>>
71686>>>>>>>>>External_Function WP_SetAbsoluteMargins "SetAbsoluteMargins" WinPrint.dll ; // modifies the top/bottom non-printable margin    UInteger iTop;      // the top margin offset    UInteger iBottom;   // the bottom margin offset    Boolean  bAllPages; // should all pages be affected? True=AllPages; False=first page only    Returns Boolean // always True
71687>>>>>>>>>
71687>>>>>>>>>External_Function WP_SetMargins "SetMargins" WinPrint.dll ; // Sets the user-margins    UInteger iLeft;   // the left margin    UInteger iTop;    // the top margin    UInteger iRight;  // the right margin    UInteger iBottom; // the bottom margin    Returns Boolean // always True
71688>>>>>>>>>
71688>>>>>>>>>External_Function WP_CreateDiagram "CreateDiagram" WinPrint.dll ; // Creates a new diagram    UInteger eType;       // type of diagram (Bar, Line, Pie)    UInteger eEffect;     // how it is drawn (2d or 3d, etc)    UInteger iWidth;      // width of the diagram    UInteger iHeight;     // height of the diagram    Boolean  bDrawXyAxis; // draw the xy-axis (for bar charts only)?    Returns Handle // unique id for the diagram used in other diagram funtions
71689>>>>>>>>>
71689>>>>>>>>>External_Function WP_AddDiagramEntry "AddDiagramEntry" WinPrint.dll ; // Adds an item into a diagram    Handle   hDiagram;          // diagram handle returned by CreateDiagram()    String   sValueDescription; // description of the item    String   sValue;            // value of the item    Integer iBorderColor;       // color of the item's border    Integer iFillColor;         // color of the item's interior    Boolean  bFilled;           // should the item be drawn filled (with iFillColor), or transparent?    UInteger iNumDecimals;      // Number of decimals in the sValue argument    UInteger eValueOrPercent;   // How the value should be displayed (as value or percentage, etc)    Boolean  bExploded;         // should the value be "pulled out" (pie charts only)    Returns Boolean // True, if success; False, if error
71690>>>>>>>>>
71690>>>>>>>>>External_Function WP_DrawDiagram "DrawDiagram" WinPrint.dll ; // draws a diagram    Handle   hDiagram;               // diagram handle returned by CreateDiagram()    UInteger iLeft;                  // x-coordinate to draw the diagram    UInteger iTop;                   // y-coordinate to draw the diagram    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Returns Boolean // True, if success; False, if error
71691>>>>>>>>>
71691>>>>>>>>>External_Function WP_LockDiagram "LockDiagram" WinPrint.dll ; // Locks a diagram so that no more entries can be added    Handle hDiagram; // diagram handle returned by CreateDiagram()    Returns Boolean // True, if success; False, if error
71692>>>>>>>>>
71692>>>>>>>>>External_Function WP_SetDiagramCaption "SetDiagramCaption" WinPrint.dll ; // Sets the caption of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sCaption; // the diagram's caption    Returns Boolean // True, if success; False, if error
71693>>>>>>>>>
71693>>>>>>>>>External_Function WP_SetDiagramXText "SetDiagramXText" WinPrint.dll ; // Sets the horizontal label of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sText;    // the diagram's horizonal label    Returns Boolean // True, if success; False, if error
71694>>>>>>>>>
71694>>>>>>>>>External_Function WP_SetDiagramYText "SetDiagramYText" WinPrint.dll ; // Sets the vertical label of a diagram    Handle  hDiagram;      // diagram handle returned by CreateDiagram()    String  sText;         // the diagram's vertical label    Boolean bVerticalText; // should the text be drawn vertically (False=horizontally)    Returns Boolean // True, if success; False, if error
71695>>>>>>>>>
71695>>>>>>>>>External_Function WP_BeginHeader "BeginHeader" WinPrint.dll ; // creates a new header    UInteger iHeaderType; // the type of header    UInteger iSubHeaderNum; // for subheaders, then number (1-0)    Returns Boolean // always True
71696>>>>>>>>>
71696>>>>>>>>>External_Function WP_EndHeader "EndHeader" WinPrint.dll ; // declares the end of the current header    Returns Boolean // always True
71697>>>>>>>>>
71697>>>>>>>>>External_Function WP_SetExtraLineCheck "SetExtraLineCheck" WinPrint.dll ; // forces a soft page break if header plus number of lines don't fit on page    UInteger iNumLines; // number of lines in addition to header required before forcing a soft page-break    Returns Boolean; // always True    
71698>>>>>>>>>External_Function WP_SetHeaderFrame "SetHeaderFrame" WinPrint.dll ; // sets the style, color and frame of a header    UInteger eFrame;     // style of frame (margin-to-margin, etc)    Integer iColor;      // color of the frame's edge    UInteger iThickness; // thickness of the frame    Integer iFillCol;    // the internal color of the frame (only used if bBilled=True)    Boolean  bFilled;    // True, if the frame should be filled with the iFillColor (False=Transparent)    Returns Boolean // Always True
71699>>>>>>>>>
71699>>>>>>>>>External_Function WP_SetHeaderMargin "SetHeaderMargin" WinPrint.dll ; // Sets a margin of space on the inside and outside of the current header    UInteger eType;      // Specifies which margin areas is being set.    Integer  iSize;      // Size of the margin setting in the current report metrics    Returns Boolean  // False if document is not started
71700>>>>>>>>>
71700>>>>>>>>>External_Function WP_SetHeaderPlacement "SetHeaderPlacement" WinPrint.dll ; // placement (left, center or right) of the header    UInteger ePlacement; // placed left, center or right    Returns Boolean //always True
71701>>>>>>>>>
71701>>>>>>>>>External_Function WP_SetHeaderWrap "SetHeaderWrap" WinPrint.dll ; // determines whether the current header is drawn on soft page-breaks    Boolean bWrap; // True, to wrap onto following pages; False, for current page only    Returns Boolean // always True
71702>>>>>>>>>
71702>>>>>>>>>External_Function WP_WriteHeader "WriteHeader" WinPrint.dll ; // writes a header to the current page    UInteger eHeaderType;   // type of header    UInteger iSubHeaderNum; // for subheaders, the number (1-9)    Returns Boolean // True, if success; False, if error
71703>>>>>>>>>
71703>>>>>>>>>External_Function WP_RGBToDFPrintColor "RGBToDFPrintColor" WinPrint.dll ; // converts R, G, and B values into a composite color that WinPrint expects    UInteger iRed;   // red component (1-255)    UInteger iGreen; // green component (1-255)    UInteger iBlue;  // blue component (1-255)    Returns Integer // composite color
71704>>>>>>>>>
71704>>>>>>>>>External_Function WP_GetMetrics "GetMetrics" WinPrint.dll ; // gets the current unit of measurement    Returns UInteger // unit of measurement (Inch or CM)
71705>>>>>>>>>
71705>>>>>>>>>External_Function WP_SetMetrics "SetMetrics" WinPrint.dll ; // sets the unit of measurement    UInteger eMetrics; // Inch or CM    Returns Boolean // always True
71706>>>>>>>>>
71706>>>>>>>>>External_Function WP_ClearDocument "ClearDocument" WinPrint.dll ; // clears the resources of the document from memory    Returns Boolean // always True
71707>>>>>>>>>
71707>>>>>>>>>External_Function WP_NewDocument "NewDocument" WinPrint.dll ; // starts a new document, but preserves the printer settings    Boolean bAutoPreview ; // Should the Previewer be displayed immediately    Returns Boolean // True, if success; False, if an error occurred
71708>>>>>>>>>
71708>>>>>>>>>External_Function WP_EndDocument "EndDocument" WinPrint.dll ; // Indicates that the document is finished    Returns Boolean // always True
71709>>>>>>>>>
71709>>>>>>>>>External_Function WP_ClearPrinter "ClearPrinter" WinPrint.dll ; // clears all printer and document resources    Returns Boolean // True, if success; False, if an error occurred
71710>>>>>>>>>
71710>>>>>>>>>External_Function WP_ConfirmLines "ConfirmLines" WinPrint.dll ; // ensures that a specified number of lines will fit on the page; if not, a soft page-break is performed automatically    UInteger iNumLines; // number of lines that must fit on the page    Returns Boolean // True, if success; False, if an error occurred
71711>>>>>>>>>
71711>>>>>>>>>External_Function WP_CreatePage "CreatePage" WinPrint.dll ; // creates a new page of specified columns    UInteger iNumColumns; // number of columns (zero= no columns)    Returns UInteger; // page number that was created    
71712>>>>>>>>>External_Function WP_PreviewDocument "PreviewDocument" WinPrint.dll ; // previews the current document    Boolean bPrintDialog; // Determines whether the Print Dialog (range, etc) is displayed when the "print" button is clicked in the preview window.    Boolean bPrintSetup;  // Determines whether the Print Setup button is enabled (allows to change orientation, etc)    Boolean bPrint;       // Determines whether the Print button is enabled    Returns Handle // non-zero = hViewerProcess; zero= error
71713>>>>>>>>>
71713>>>>>>>>>External_Function WP_ClosePreview "ClosePreview" WinPrint.dll ; // closes the preview window    Returns Boolean // True, if closed; False, if an error occurred (such as it not being already open)
71714>>>>>>>>>
71714>>>>>>>>>External_Function WP_PrintDocument "PrintDocument" WinPrint.dll ; // prints the current document    Handle hWndParent; // window handle of object to use for any modal output    Returns Boolean // True, if success; False, if an error occurred
71715>>>>>>>>>
71715>>>>>>>>>External_Function WP_SetAlign "SetAlign" WinPrint.dll ; // align future text    UInteger eAlign; // left, center or right    Returns Boolean // always True
71716>>>>>>>>>
71716>>>>>>>>>External_Function WP_WriteText "WriteText" WinPrint.dll ; // write text to the current position or column    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iColumnNum;        // number of the column to write to (zero=no column, use current position)    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncating    Returns Boolean // True, if success; False, if an error occurred
71717>>>>>>>>>
71717>>>>>>>>>External_Function WP_WriteTextAtPosition "WriteTextAtPosition" WinPrint.dll ; // writes text to a specific position    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iPosition;         // horizontal position to write the text    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncating    Returns Boolean // True, if success; False, if an error occurred
71718>>>>>>>>>
71718>>>>>>>>>External_Function WP_SetProgressCaption "SetProgressCaption" WinPrint.dll ;    String sProgressCaption ;    Returns Boolean
71719>>>>>>>>>
71719>>>>>>>>>External_Function WP_SetReportTitle     "SetReportTitle"     WinPrint.dll ;    String sCaption ;    Returns Boolean
71720>>>>>>>>>
71720>>>>>>>>>External_Function WP_ViewerWantsToClose "ViewerWantsToClose" WinPrint.dll ;    Returns Integer
71721>>>>>>>>>
71721>>>>>>>>>External_Function WP_DisplayMessageBox  "DisplayMessageBox"  WinPrint.dll ;    String sCaption String sText ;    Returns Integer
71722>>>>>>>>>
71722>>>>>>>>>External_Function WP_GetViewerWindow "GetViewerWindow" Winprint.dll ;    Returns Handle
71723>>>>>>>>>
71723>>>>>>>>>External_Function WP_GetDocumentStatus "GetDocumentStatus" Winprint.dll ;    Returns Integer // returns dsNotStarted, dsStarted, or dsFinished
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>Use WinPrint_Constants.pkg
Including file: Winprint_Constants.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Winprint_Constants.pkg)
71724>>>>>>>>>// Constants used by Winprint1 and Winprint 2
71724>>>>>>>>>
71724>>>>>>>>>// Define Winprint Constants
71724>>>>>>>>>
71724>>>>>>>>>Enum_List // Metrics
71724>>>>>>>>>    Define WPM_CM
71724>>>>>>>>>    Define WPM_INCH
71724>>>>>>>>>End_Enum_List
71724>>>>>>>>>
71724>>>>>>>>>// values returns by GetDocumentStatus
71724>>>>>>>>>Enum_List
71724>>>>>>>>>    Define dsNotStarted for 0 // The document is cleared or has never started
71724>>>>>>>>>    Define dsStarted    for 1 // The document has been created, but is not finished.
71724>>>>>>>>>    Define dsFinished   for 2 // The document is completed, and is currently valid
71724>>>>>>>>>End_Enum_List
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>// Fonts/Align
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>// Header position on page
71724>>>>>>>>>
71724>>>>>>>>>// Header frame types
71724>>>>>>>>>
71724>>>>>>>>>// Header Margin
71724>>>>>>>>>
71724>>>>>>>>>// Header page breake/wrap
71724>>>>>>>>>
71724>>>>>>>>>// Headers
71724>>>>>>>>>
71724>>>>>>>>>// RGB colors for WinPrint
71724>>>>>>>>>// If you want to define more colors, use the function DFGetDFColor.
71724>>>>>>>>>// Default
71724>>>>>>>>>// Dark
71724>>>>>>>>>// Same as magenta, i will leav them becauce they exist in ver 1.0
71724>>>>>>>>>
71724>>>>>>>>>// Graphics
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>// PD flags for print setup/dialog
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>>>
71724>>>>>>>Use Rgb.pkg
71724>>>>>>>Use GlobalFunctionsProcedures.pkg
71724>>>>>>>
71724>>>>>>>Define INFINITE for -1
71724>>>>>>>Define WAIT_TIMEOUT for |CI$00000102
71724>>>>>>>
71724>>>>>>>
71724>>>>>>>Define QS_KEY            for |CI$0001
71724>>>>>>>Define QS_MOUSEMOVE      for |CI$0002
71724>>>>>>>Define QS_MOUSEBUTTON    for |CI$0004
71724>>>>>>>Define QS_POSTMESSAGE    for |CI$0008
71724>>>>>>>Define QS_TIMER          for |CI$0010
71724>>>>>>>Define QS_PAINT          for |CI$0020
71724>>>>>>>Define QS_SENDMESSAGE    for |CI$0040
71724>>>>>>>Define QS_HOTKEY         for |CI$0080
71724>>>>>>>Define QS_ALLPOSTMESSAGE for |CI$0100
71724>>>>>>>Define QS_MOUSE          for (QS_MOUSEMOVE ior QS_MOUSEBUTTON)
71724>>>>>>>Define QS_INPUT          for (QS_MOUSE ior QS_KEY)
71724>>>>>>>Define QS_ALLEVENTS      for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY)
71724>>>>>>>Define QS_ALLINPUT       for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY ior QS_SENDMESSAGE)
71724>>>>>>>
71724>>>>>>>External_Function WaitForSingleObject "WaitForSingleObject" Kernel32.dll Handle hHandle DWord dwMilliseconds Returns DWord
71725>>>>>>>External_Function GetCurrentProcessId "GetCurrentProcessId" Kernel32.dll Returns DWord
71726>>>>>>>External_Function GetCurrentProcess "GetCurrentProcess" Kernel32.dll Returns Handle
71727>>>>>>>
71727>>>>>>>External_Function MsgWaitForMultipleObjects "MsgWaitForMultipleObjects" User32.dll ;    DWord nCount;             // number of handles in the object handle array    Address pHandles;     // pointer to the object-handle array    Boolean fWaitAll;     // wait for all or wait for one    DWord dwMilliseconds; // time-out interval in milliseconds    DWord dwWakeMask;     // type of input events to wait for    Returns DWord
71728>>>>>>>
71728>>>>>>>Use GlobalFunctionsProcedures.pkg
71728>>>>>>>
71728>>>>>>>Class cWinPrint2 is a cObject
71729>>>>>>>    Procedure Construct_Object
71731>>>>>>>        Forward Send construct_object
71733>>>>>>>        
71733>>>>>>>        // internal properties
71733>>>>>>>        Property Integer DFCurrent_Color       0
71734>>>>>>>        Property String  DFCurrent_OutPut      "WinPrint"
71735>>>>>>>        Property Integer DFCurrent_Diagram     0
71736>>>>>>>        Property Integer DFCurrent_HeaderType  0
71737>>>>>>>        Property Integer DFCurrent_HeaderNr    0
71738>>>>>>>        Property Number  DFCurrent_FontSize    10
71739>>>>>>>        Property String  DFCurrent_Font        "Arial"
71740>>>>>>>        
71740>>>>>>>        // Default values for margins 2.53 CM = 1 inch
71740>>>>>>>        Property Number  DFLeft_Margin    2.53
71741>>>>>>>        Property Number  DFTop_Margin     2.53
71742>>>>>>>        Property Number  DFright_Margin   2.53
71743>>>>>>>        Property Number  DFBottom_Margin  2.53
71744>>>>>>>        
71744>>>>>>>        // If WP1 this defaults to false. In 2, it is true which means that the print job
71744>>>>>>>        // dialog appears when you hitprint in previewer.
71744>>>>>>>        Property Integer PrintDlgInPreview   1
71745>>>>>>>        // This does nothing in Wp2 (because you can't to this anyway)
71745>>>>>>>        Property Integer EnablePrintSetupFromPreview  True
71746>>>>>>>        Property Integer EnablePrintFromPreview  1
71747>>>>>>>        
71747>>>>>>>        // is the GUI Suspended. This is privately maintained and is used
71747>>>>>>>        // to figure out if a preview panel is up or not
71747>>>>>>>        Property Integer pbIsSuspended False
71748>>>>>>>        
71748>>>>>>>        Object oDFColorArray is an Array
71750>>>>>>>            //Moved into array
71750>>>>>>>            Set Value  0  to RGB_WHITE
71751>>>>>>>            Set Value  1  to RGB_RED
71752>>>>>>>            Set Value  2  to RGB_BLUE
71753>>>>>>>            Set Value  3  to RGB_GREEN
71754>>>>>>>            Set Value  4  to RGB_YELLOW
71755>>>>>>>            Set Value  5  to RGB_GREY
71756>>>>>>>            Set Value  6  to RGB_CYAN
71757>>>>>>>            Set Value  7  to RGB_MAGENTA
71758>>>>>>>            Set Value  8  to RGB_DRED
71759>>>>>>>            Set Value  9  to RGB_DBLUE
71760>>>>>>>            Set Value  10 to RGB_DGREEN
71761>>>>>>>            Set Value  11 to RGB_DYELLOW
71762>>>>>>>            Set Value  12 to RGB_DGREY
71763>>>>>>>            Set Value  13 to RGB_DCYAN
71764>>>>>>>            Set Value  14 to RGB_DMAGENTA
71765>>>>>>>            Set Value  15 to RGB_BLACK
71766>>>>>>>        End_Object
71767>>>>>>>        
71767>>>>>>>        Object oDiagramArray is an Array
71769>>>>>>>        End_Object
71770>>>>>>>        
71770>>>>>>>    End_Procedure
71771>>>>>>>    
71771>>>>>>>    Function ViewerWantsToClose Returns Boolean
71773>>>>>>>        Function_Return (WP_ViewerWantsToClose())
71774>>>>>>>    End_Function
71775>>>>>>>    
71775>>>>>>>    Function IsViewerActive Returns Boolean
71777>>>>>>>        Function_Return (WP_GetViewerWindow()<>0)
71778>>>>>>>    End_Function
71779>>>>>>>    
71779>>>>>>>    Function IsPrinterValid Returns Boolean
71781>>>>>>>        Function_Return (WP_IsPrinterValid()<>0)
71782>>>>>>>    End_Function
71783>>>>>>>    
71783>>>>>>>    Function ArePrintersInstalled Returns Boolean
71785>>>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
71786>>>>>>>    End_Function
71787>>>>>>>    
71787>>>>>>>    
71787>>>>>>>    // returns docucument state: dsNotStarted, dsStarted, dsFinished
71787>>>>>>>    Function DocumentStatus Returns Integer
71789>>>>>>>        Function_Return (WP_GetDocumentStatus())
71790>>>>>>>    End_Function
71791>>>>>>>    
71791>>>>>>>    // Might still be called from report class. Leave dummy stub
71791>>>>>>>    Procedure DFZeroCounters
71793>>>>>>>    End_Procedure
71794>>>>>>>    
71794>>>>>>>    //
71794>>>>>>>    Function DFNewPage Integer Columns Returns Integer
71796>>>>>>>        Integer iPageNum
71796>>>>>>>        // This returns a page number used in report object....(this may change)
71796>>>>>>>        Move (WP_CreatePage(Columns)) to iPageNum
71797>>>>>>>        If (iPageNum=0) Begin
71799>>>>>>>            Error DFERR_WINPRINT DFPrintError900
71800>>>>>>>>
71800>>>>>>>        End
71800>>>>>>>>
71800>>>>>>>        Function_Return iPageNum
71801>>>>>>>    End_Function
71802>>>>>>>    
71802>>>>>>>    //Return handle to use for winprint dialog. If main_window
71802>>>>>>>    //   exists, use it. Else, get object's handle
71802>>>>>>>    Function Report_Window_Handle Returns Handle
71804>>>>>>>        Handle hWnd
71804>>>>>>>        Handle hoObj
71804>>>>>>>        Get Focus of desktop to hoObj // start with the focus
71805>>>>>>>        Move (gOwnerWindowHandle(hoObj)) to hWnd // global function finds the right handle for us
71806>>>>>>>        Function_Return hWnd
71807>>>>>>>    End_Function
71808>>>>>>>    
71808>>>>>>>    
71808>>>>>>>    //
71808>>>>>>>    Function DFPrintDialog Returns Boolean
71810>>>>>>>        Handle hwnd
71810>>>>>>>        Boolean bOk
71810>>>>>>>        
71810>>>>>>>        Get Report_Window_Handle to hWnd
71811>>>>>>>        Move (WP_ExecutePrintDialog(hwnd)) to bOk
71812>>>>>>>        
71812>>>>>>>        Function_Return bOk
71813>>>>>>>    End_Function
71814>>>>>>>    
71814>>>>>>>    
71814>>>>>>>    // You can only invoke the print setup if the report is cleared. If you try to to do this in
71814>>>>>>>    //    the wrong state you will get an error.
71814>>>>>>>    Function DFPrintSetupDialog Returns Boolean
71816>>>>>>>        Handle hwnd
71816>>>>>>>        Boolean bOk
71816>>>>>>>        Integer iStatus
71816>>>>>>>        Get ArePrintersInstalled to bOk
71817>>>>>>>        If not bOk Begin
71819>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
71820>>>>>>>>
71820>>>>>>>        End
71820>>>>>>>>
71820>>>>>>>        Else Begin
71821>>>>>>>            Get DocumentStatus to iStatus
71822>>>>>>>            
71822>>>>>>>            If (iStatus=dsNotStarted) Begin
71824>>>>>>>                Get Report_Window_Handle to hWnd
71825>>>>>>>                Move (WP_ExecutePrinterSetupDialog(hwnd)) to bOk
71826>>>>>>>                
71826>>>>>>>                // test that the selected printer is valid....
71826>>>>>>>                If bOK Begin
71828>>>>>>>                    Get IsPrinterValid to bOk // if printer not valid, it's not ok
71829>>>>>>>                    If not bOk Begin
71831>>>>>>>                        Error DFERR_WINPRINT DFPrintError936  // could not select a valid printer
71832>>>>>>>>
71832>>>>>>>                    End
71832>>>>>>>>
71832>>>>>>>                End
71832>>>>>>>>
71832>>>>>>>            End
71832>>>>>>>>
71832>>>>>>>            Else Begin
71833>>>>>>>                Error DFERR_WINPRINT DFPrintError966      // cannot change printer when report is active
71834>>>>>>>>
71834>>>>>>>            End
71834>>>>>>>>
71834>>>>>>>        End
71834>>>>>>>>
71834>>>>>>>        Function_Return bOk
71835>>>>>>>    End_Function
71836>>>>>>>    
71836>>>>>>>    
71836>>>>>>>    // Provided for backwards compatibility. DFPrintSetupDialog is more flexible because it returns a
71836>>>>>>>    //    false if cancel was selected.
71836>>>>>>>    Procedure DFPrintSetup
71838>>>>>>>        Boolean bOk
71838>>>>>>>        Get DFPrintSetupDialog to bOk
71839>>>>>>>    End_Procedure
71840>>>>>>>    
71840>>>>>>>    // This invokes the print job dialog, prints the report, then clears the report document.
71840>>>>>>>    //    This should be called after the report is complete.
71840>>>>>>>    Procedure DFPrint
71842>>>>>>>        Integer bOk
71842>>>>>>>        Get DFPrintDialog to bOk
71843>>>>>>>        If bOk Begin
71845>>>>>>>            Send DFPrintDoc
71846>>>>>>>            Send DFClearDoc
71847>>>>>>>        End
71847>>>>>>>>
71847>>>>>>>    End_Procedure
71848>>>>>>>    
71848>>>>>>>    Procedure DFSuspendGui Boolean bSuspend
71850>>>>>>>        If (bSuspend<>pbIsSuspended(Self)) Begin
71852>>>>>>>            Send SuspendGui of Desktop bSuspend
71853>>>>>>>            Set pbIsSuspended to bSuspend
71854>>>>>>>        End
71854>>>>>>>>
71854>>>>>>>    End_Procedure
71855>>>>>>>    
71855>>>>>>>    // this is protected so that the queue is only pumped if the
71855>>>>>>>    // gui is suspended.
71855>>>>>>>    Procedure PumpMsgQueue
71857>>>>>>>        If (pbIsSuspended(Self)) Begin
71859>>>>>>>            Send PumpMsgQueue of desktop // permit painting
71860>>>>>>>        End
71860>>>>>>>>
71860>>>>>>>    End_Procedure
71861>>>>>>>    
71861>>>>>>>    
71861>>>>>>>    // This does a modeless preview. This is what you'd want during
71861>>>>>>>    //    report generation and it may be what you want for report viewing.
71861>>>>>>>    Procedure DFPreviewNoWait
71863>>>>>>>        Boolean bOk
71863>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
71863>>>>>>>        Integer iStatus
71863>>>>>>>        Get PrintDlgInPreview to bPrntDlg
71864>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
71865>>>>>>>        Get EnablePrintFromPreview to bPrint
71866>>>>>>>        Get DocumentStatus to iStatus
71867>>>>>>>        If (iStatus=dsStarted) Begin
71869>>>>>>>            Send DfSuspendGui True
71870>>>>>>>        End
71870>>>>>>>>
71870>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) to bOk
71871>>>>>>>        If not bOk Begin
71873>>>>>>>            Error DFERR_WINPRINT DFPrintError901
71874>>>>>>>>
71874>>>>>>>            Send DfSuspendGui False
71875>>>>>>>        End
71875>>>>>>>>
71875>>>>>>>    End_Procedure
71876>>>>>>>    
71876>>>>>>>    
71876>>>>>>>    // This does a modal preview. You might want this for report
71876>>>>>>>    //    viewing as the program knows when the viewer is closed
71876>>>>>>>    // Note that this is a private message and it was never intended that this
71876>>>>>>>    // should be used. We expect winprint reports to use modeless viewers.
71876>>>>>>>    Procedure DFPreviewWait
71878>>>>>>>        Handle hViewerProcess
71878>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
71878>>>>>>>        Integer iRetVal
71878>>>>>>>        Handle hwMain hMain
71878>>>>>>>        
71878>>>>>>>        Get PrintDlgInPreview to bPrntDlg
71879>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
71880>>>>>>>        Get EnablePrintFromPreview to bPrint
71881>>>>>>>        
71881>>>>>>>        Send DfSuspendGui True
71882>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) to hViewerProcess
71883>>>>>>>        
71883>>>>>>>        If (hViewerProcess = 0) Begin
71885>>>>>>>            Error DFERR_WINPRINT DFPrintError901
71886>>>>>>>>
71886>>>>>>>        End
71886>>>>>>>>
71886>>>>>>>        Else Begin
71887>>>>>>>            // We need to wait for either the Viewer to close, or a WM_PAINT message in the thread's queue...
71887>>>>>>>            Repeat
71887>>>>>>>>
71887>>>>>>>                Move (MsgWaitForMultipleObjects(1, AddressOf(hViewerProcess), False, INFINITE, QS_PAINT)) to iRetVal
71888>>>>>>>                Send PumpMsgQueue // permit painting
71889>>>>>>>            Until (iRetVal = 0) // 0 means that the viewer process terminated
71891>>>>>>>        End
71891>>>>>>>>
71891>>>>>>>        Send DfSuspendGui False
71892>>>>>>>        
71892>>>>>>>        // Do what we can to force VDF application to the top.
71892>>>>>>>        // As 12.0 dfSuspendGUI actually properly disables the underlying windows. When the viewer
71892>>>>>>>        // is closed it cannot give the focus back to this so it goes elsewhere. This will force it
71892>>>>>>>        // back.
71892>>>>>>>        
71892>>>>>>>        Get main_window of desktop to hMain
71893>>>>>>>        If hMain Begin
71895>>>>>>>            Get window_handle of hMain to hwMain
71896>>>>>>>            If hwMain Begin
71898>>>>>>>                If (GetForegroundWindow()<>hwMain) Begin
71900>>>>>>>                    Move (SetForegroundWindow(hwMain)) to hwMain
71901>>>>>>>                End
71901>>>>>>>>
71901>>>>>>>            End
71901>>>>>>>>
71901>>>>>>>        End
71901>>>>>>>>
71901>>>>>>>        
71901>>>>>>>    End_Procedure
71902>>>>>>>    
71902>>>>>>>    Procedure DfPreview
71904>>>>>>>        Send DfPreviewNoWait
71905>>>>>>>    End_Procedure
71906>>>>>>>    
71906>>>>>>>    
71906>>>>>>>    //
71906>>>>>>>    Procedure DFPrintDoc
71908>>>>>>>        Handle hwnd
71908>>>>>>>        Boolean bOk
71908>>>>>>>        Get Report_Window_Handle to hWnd
71909>>>>>>>        Move (WP_PrintDocument(hwnd)) to bOk
71910>>>>>>>        
71910>>>>>>>        If not bOk Begin
71912>>>>>>>            Error DFERR_WINPRINT DFPrintError902
71913>>>>>>>>
71913>>>>>>>        End
71913>>>>>>>>
71913>>>>>>>    End_Procedure
71914>>>>>>>    
71914>>>>>>>    
71914>>>>>>>    //
71914>>>>>>>    Procedure DFClearDoc
71916>>>>>>>        Boolean bOk
71916>>>>>>>        Get ArePrintersInstalled to bOk
71917>>>>>>>        If bOk Begin
71919>>>>>>>            Move (WP_ClearDocument()) to bOk
71920>>>>>>>            Send DFSuspendGUI False
71921>>>>>>>            If not bOk Begin
71923>>>>>>>                Error DFERR_WINPRINT DFPrintError903 // error number right?
71924>>>>>>>>
71924>>>>>>>            End
71924>>>>>>>>
71924>>>>>>>        End
71924>>>>>>>>
71924>>>>>>>    End_Procedure
71925>>>>>>>    
71925>>>>>>>    Procedure DFNewDoc Boolean bAutoPreview
71927>>>>>>>        Boolean bOk
71927>>>>>>>        // this is the most likely place we will encounter when we start a report. Check for
71927>>>>>>>        // printers and return an explicit error to make it easy to identify the error
71927>>>>>>>        Get ArePrintersInstalled to bOk
71928>>>>>>>        If not bOk Begin
71930>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
71931>>>>>>>>
71931>>>>>>>        End
71931>>>>>>>>
71931>>>>>>>        Else Begin
71932>>>>>>>            Send DfClearDoc // a new doc should always start with a clear
71933>>>>>>>            If bAutoPreview ;                Send DFSuspendGUI True
71936>>>>>>>            Move (WP_NewDocument(bAutoPreview)) to bOk
71937>>>>>>>            
71937>>>>>>>            If not bOk Begin
71939>>>>>>>                Error DFERR_WINPRINT DFPrintError902  // could not print document
71940>>>>>>>>
71940>>>>>>>                Send DFSuspendGUI False
71941>>>>>>>            End
71941>>>>>>>>
71941>>>>>>>        End
71941>>>>>>>>
71941>>>>>>>    End_Procedure
71942>>>>>>>    
71942>>>>>>>    //
71942>>>>>>>    Procedure DFSetFont String sFontName
71944>>>>>>>        Boolean bOk
71944>>>>>>>        Move (WP_SetFontName(sFontName)) to bOk
71945>>>>>>>        
71945>>>>>>>        If not bOK Begin
71947>>>>>>>            Error DFERR_WINPRINT DFPrintError904
71948>>>>>>>>
71948>>>>>>>        End
71948>>>>>>>>
71948>>>>>>>    End_Procedure
71949>>>>>>>    
71949>>>>>>>    
71949>>>>>>>    //
71949>>>>>>>    Procedure DFSetFontSize Integer iHeight Integer iWidth
71951>>>>>>>        Boolean bOk
71951>>>>>>>        // note that width is ignored in new implementation
71951>>>>>>>        Move (WP_SetFontHeight(iHeight)) to bOk
71952>>>>>>>        
71952>>>>>>>        If not bOK Begin
71954>>>>>>>            Error DFERR_WINPRINT  DFPrintError905
71955>>>>>>>>
71955>>>>>>>        End
71955>>>>>>>>
71955>>>>>>>    End_Procedure
71956>>>>>>>    
71956>>>>>>>    
71956>>>>>>>    //
71956>>>>>>>    Procedure DFSetFontStyle DWord dwStyle
71958>>>>>>>        Boolean bOk
71958>>>>>>>        Move (WP_SetFontStyle(dwStyle)) to bOk
71959>>>>>>>        
71959>>>>>>>        If not bOK Begin
71961>>>>>>>            Error DFERR_WINPRINT DFPrintError906
71962>>>>>>>>
71962>>>>>>>        End
71962>>>>>>>>
71962>>>>>>>    End_Procedure
71963>>>>>>>    
71963>>>>>>>    
71963>>>>>>>    //
71963>>>>>>>    Procedure DFSetUnderline Boolean bUnderline
71965>>>>>>>        Boolean bOk
71965>>>>>>>        
71965>>>>>>>        Move (WP_SetFontUnderline(bUnderline)) to bOk
71966>>>>>>>        
71966>>>>>>>        If not bOK Begin
71968>>>>>>>            Error DFERR_WINPRINT DFPrintError907
71969>>>>>>>>
71969>>>>>>>        End
71969>>>>>>>>
71969>>>>>>>    End_Procedure
71970>>>>>>>    
71970>>>>>>>    
71970>>>>>>>    //
71970>>>>>>>    Procedure DFSetBold Boolean bBold
71972>>>>>>>        Boolean bOk
71972>>>>>>>        
71972>>>>>>>        Move (WP_SetFontBold(bBold)) to bOk
71973>>>>>>>        
71973>>>>>>>        If not bOK Begin
71975>>>>>>>            Error DFERR_WINPRINT DFPrintError908
71976>>>>>>>>
71976>>>>>>>        End
71976>>>>>>>>
71976>>>>>>>    End_Procedure
71977>>>>>>>    
71977>>>>>>>    
71977>>>>>>>    //
71977>>>>>>>    Procedure DFSetItalic Boolean bItalic
71979>>>>>>>        Boolean bOk
71979>>>>>>>        
71979>>>>>>>        Move (WP_SetFontItalic(bItalic)) to bOk
71980>>>>>>>        
71980>>>>>>>        If not bOK Begin
71982>>>>>>>            Error DFERR_WINPRINT DFPrintError909
71983>>>>>>>>
71983>>>>>>>        End
71983>>>>>>>>
71983>>>>>>>    End_Procedure
71984>>>>>>>    
71984>>>>>>>    
71984>>>>>>>    //
71984>>>>>>>    Procedure DFSetStrikeout Boolean bStrikeout
71986>>>>>>>        Boolean bOk
71986>>>>>>>        
71986>>>>>>>        Move (WP_SetFontStrikeout(bStrikeout)) to bOk
71987>>>>>>>        
71987>>>>>>>        If not bOK Begin
71989>>>>>>>            Error DFERR_WINPRINT DFPrintError910
71990>>>>>>>>
71990>>>>>>>        End
71990>>>>>>>>
71990>>>>>>>    End_Procedure
71991>>>>>>>    
71991>>>>>>>    
71991>>>>>>>    //
71991>>>>>>>    Procedure DFSetMargins Number nLeft Number nTop Number nRight Number nBottom
71993>>>>>>>        Boolean bOk
71993>>>>>>>        Integer iLeft iRight iTop iBottom
71993>>>>>>>        
71993>>>>>>>        Move (nLeft   * 100) to iLeft
71994>>>>>>>        Move (nRight  * 100) to iRight
71995>>>>>>>        Move (nTop    * 100) to iTop
71996>>>>>>>        Move (nBottom * 100) to iBottom
71997>>>>>>>        
71997>>>>>>>        Move (WP_SetMargins(iLeft,iTop,iRight,iBottom)) to bOk
71998>>>>>>>        
71998>>>>>>>        If bOk Begin
72000>>>>>>>            Set DFLeft_Margin   to nLeft
72001>>>>>>>            Set DFTop_Margin    to nTop
72002>>>>>>>            Set DFRight_Margin  to nRight
72003>>>>>>>            Set DFBottom_Margin to nBottom
72004>>>>>>>        End
72004>>>>>>>>
72004>>>>>>>        Else Begin
72005>>>>>>>            Error DFERR_WINPRINT DFPrintError911
72006>>>>>>>>
72006>>>>>>>        End
72006>>>>>>>>
72006>>>>>>>    End_Procedure
72007>>>>>>>    
72007>>>>>>>    
72007>>>>>>>    //
72007>>>>>>>    Procedure DFSetLeftMargin Number nLeft
72009>>>>>>>        Number  nTop nRight nBottom
72009>>>>>>>        Get DFTop_Margin    to nTop
72010>>>>>>>        Get DFRight_Margin  to nRight
72011>>>>>>>        Get DFBottom_Margin to nBottom
72012>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
72013>>>>>>>    End_Procedure
72014>>>>>>>    
72014>>>>>>>    
72014>>>>>>>    //
72014>>>>>>>    Procedure DFSetRightMargin Number nRight
72016>>>>>>>        Number  nLeft nTop nBottom
72016>>>>>>>        Get DFLeft_Margin   to nLeft
72017>>>>>>>        Get DFTop_Margin    to nTop
72018>>>>>>>        Get DFBottom_Margin to nBottom
72019>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
72020>>>>>>>    End_Procedure
72021>>>>>>>    
72021>>>>>>>    
72021>>>>>>>    //
72021>>>>>>>    Procedure DFSetTopMargin Number nTop
72023>>>>>>>        Number  nLeft nRight nBottom
72023>>>>>>>        Get DFLeft_Margin   to nLeft
72024>>>>>>>        Get DFRight_Margin  to nRight
72025>>>>>>>        Get DFBottom_Margin to nBottom
72026>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
72027>>>>>>>    End_Procedure
72028>>>>>>>    
72028>>>>>>>    
72028>>>>>>>    //
72028>>>>>>>    Procedure DFSetBottomMargin Number nBottom
72030>>>>>>>        Number  nLeft nTop nRight
72030>>>>>>>        Get DFLeft_Margin   to nLeft
72031>>>>>>>        Get DFTop_Margin    to nTop
72032>>>>>>>        Get DFRight_Margin  to nRight
72033>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
72034>>>>>>>    End_Procedure
72035>>>>>>>    
72035>>>>>>>    
72035>>>>>>>    //
72035>>>>>>>    Procedure DFWriteText String sText Integer iStyle Integer iColumn Integer iDecimal Boolean bNewLineAfterPrint
72037>>>>>>>        Boolean bOk
72037>>>>>>>        
72037>>>>>>>        Send DFSetFontStyle iStyle
72038>>>>>>>        Move (ToAnsi(sText)) to sText
72039>>>>>>>        Move (WP_WriteText(sText,bNewLineAfterPrint,iColumn,iDecimal,0)) to bOk
72040>>>>>>>        If not bOk Begin
72042>>>>>>>            Error DFERR_WINPRINT DFPrintError918
72043>>>>>>>>
72043>>>>>>>        End
72043>>>>>>>>
72043>>>>>>>        Send PumpMsgQueue // permit painting
72044>>>>>>>    End_Procedure
72045>>>>>>>    
72045>>>>>>>    //
72045>>>>>>>    Procedure DFWrite String sText DWord iStyle Integer iColumn Integer iDecimal Boolean bTrim
72047>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
72049>>>>>>>            Move (Rtrim(sText)) to sText
72050>>>>>>>        End
72050>>>>>>>>
72050>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal False
72051>>>>>>>    End_Procedure
72052>>>>>>>    
72052>>>>>>>    //
72052>>>>>>>    Procedure DFWriteLn String sText DWord iStyle Integer iColumn Integer iDecimal Boolean bTrim
72054>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
72056>>>>>>>            Move (Rtrim(sText)) to sText
72057>>>>>>>        End
72057>>>>>>>>
72057>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal True
72058>>>>>>>    End_Procedure
72059>>>>>>>    
72059>>>>>>>    
72059>>>>>>>    //
72059>>>>>>>    Procedure DFWriteTextAtPosition String sText Integer iStyle Number nPosition Integer iDecimal ;            Number nMaxLength Boolean bNewLineAfterPrint
72061>>>>>>>        Boolean bOk
72061>>>>>>>        Integer iPosition iMaxLength
72061>>>>>>>        Send DFSetFontStyle iStyle
72062>>>>>>>        Move (ToAnsi(sText)) to sText
72063>>>>>>>        Move (nPosition * 100) to iPosition
72064>>>>>>>        Move (nMaxLength * 100) to iMaxLength
72065>>>>>>>        Move (WP_WriteTextAtPosition(sText,bNewLineAfterPrint,iPosition,iDecimal,iMaxLength)) to bOk
72066>>>>>>>        If not bOk Begin
72068>>>>>>>            Error DFERR_WINPRINT DFPrintError922
72069>>>>>>>>
72069>>>>>>>        End
72069>>>>>>>>
72069>>>>>>>        Send PumpMsgQueue // permit painting
72070>>>>>>>    End_Procedure
72071>>>>>>>    
72071>>>>>>>    //
72071>>>>>>>    Procedure DFWritePos String sText Integer iStyle Number nPosition Integer iDecimal Number nMaxLength Boolean bTrim
72073>>>>>>>        Number nMax
72073>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
72075>>>>>>>            Move (Rtrim(sText)) to sText
72076>>>>>>>        End
72076>>>>>>>>
72076>>>>>>>        
72076>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
72079>>>>>>>        Else ;            Move nMaxLength to nMax
72081>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax False
72082>>>>>>>    End_Procedure
72083>>>>>>>    
72083>>>>>>>    //
72083>>>>>>>    Procedure DFWriteLnPos String sText Integer iStyle Number nPosition Integer iDecimal Number nMaxLength Boolean bTrim
72085>>>>>>>        Number nMax
72085>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
72087>>>>>>>            Move (Rtrim(sText)) to sText
72088>>>>>>>        End
72088>>>>>>>>
72088>>>>>>>        
72088>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
72091>>>>>>>        Else ;            Move nMaxLength to nMax
72093>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax True
72094>>>>>>>    End_Procedure
72095>>>>>>>    
72095>>>>>>>    Procedure DFSetMetrics String sMetrics
72097>>>>>>>        Integer eMetrics
72097>>>>>>>        // for backwards compatibility support both string names and integer enumerations
72097>>>>>>>        // it is better to use the enumeration value
72097>>>>>>>        If (sMetrics="INCH" or sMetrics="CM") Begin
72099>>>>>>>            Set DFCurrent_Metrics to sMetrics
72100>>>>>>>        End
72100>>>>>>>>
72100>>>>>>>        Else Begin
72101>>>>>>>            Move sMetrics to eMetrics
72102>>>>>>>            Move (WP_SetMetrics(eMetrics)) to eMetrics
72103>>>>>>>        End
72103>>>>>>>>
72103>>>>>>>    End_Procedure
72104>>>>>>>    
72104>>>>>>>    Function DFGetMetrics Returns Integer
72106>>>>>>>        Integer eMetrics
72106>>>>>>>        Move (WP_GetMetrics()) to eMetrics
72107>>>>>>>        Function_Return eMetrics
72108>>>>>>>    End_Function
72109>>>>>>>    
72109>>>>>>>    
72109>>>>>>>    // Properties Maintained for compatibility with old Winprint (obsolete)
72109>>>>>>>    Function DFCurrent_Metrics Returns String
72111>>>>>>>        Integer eMetrics
72111>>>>>>>        Get DFGetMetrics to eMetrics
72112>>>>>>>        Function_Return (If(eMetrics=WPM_INCH,"INCH","CM"))
72113>>>>>>>    End_Function
72114>>>>>>>    
72114>>>>>>>    Procedure Set DFCurrent_Metrics String sCMorINCH
72116>>>>>>>        Send DFSetMetrics (If(sCMorINCH="INCH", WPM_INCH, WPM_CM))
72117>>>>>>>    End_Procedure
72118>>>>>>>    
72118>>>>>>>    
72118>>>>>>>    
72118>>>>>>>    
72118>>>>>>>    
72118>>>>>>>    //
72118>>>>>>>    Procedure DFBeginHeaderType Integer iHeaderNr Integer eHeaderType
72120>>>>>>>        Boolean bOk
72120>>>>>>>        
72120>>>>>>>        If (eHeaderType=DFSubHeader or eHeaderType=DFSubTotal) Begin
72122>>>>>>>            // Do nothing for the moment
72122>>>>>>>        End
72122>>>>>>>>
72122>>>>>>>        Else ;            Move 0 to iHeaderNr // If the user made a mistake
72124>>>>>>>        
72124>>>>>>>        Set DFCurrent_HeaderType to eHeaderType
72125>>>>>>>        Set DFCurrent_HeaderNr   to iHeaderNr
72126>>>>>>>        
72126>>>>>>>        Move (WP_BeginHeader(eHeaderType, iHeaderNr)) to bOk
72127>>>>>>>        
72127>>>>>>>        If not bOk Begin
72129>>>>>>>            Error DFERR_WINPRINT DFPrintError925
72130>>>>>>>>
72130>>>>>>>        End
72130>>>>>>>>
72130>>>>>>>    End_Procedure
72131>>>>>>>    
72131>>>>>>>    
72131>>>>>>>    //
72131>>>>>>>    Procedure DFEndHeaderType
72133>>>>>>>        Boolean bOk
72133>>>>>>>        
72133>>>>>>>        Move (WP_EndHeader()) to bOk
72134>>>>>>>        
72134>>>>>>>        If not bOk Begin
72136>>>>>>>            Error DFERR_WINPRINT DFPrintError926
72137>>>>>>>>
72137>>>>>>>        End
72137>>>>>>>>
72137>>>>>>>    End_Procedure
72138>>>>>>>    
72138>>>>>>>    
72138>>>>>>>    //
72138>>>>>>>    Procedure DFWriteHeaderType Integer iHeaderNr Integer eHeaderType
72140>>>>>>>        Boolean bOk
72140>>>>>>>        Move (WP_WriteHeader(eHeaderType, iHeaderNr)) to bOk
72141>>>>>>>        If not bOk Begin
72143>>>>>>>            Error DFERR_WINPRINT DFPrintError927
72144>>>>>>>>
72144>>>>>>>        End
72144>>>>>>>>
72144>>>>>>>    End_Procedure
72145>>>>>>>    
72145>>>>>>>    
72145>>>>>>>    //
72145>>>>>>>    Procedure DFHeaderPosition Integer ePlace
72147>>>>>>>        Boolean bOk
72147>>>>>>>        
72147>>>>>>>        Move (WP_SetHeaderPlacement(ePlace)) to bOk
72148>>>>>>>        
72148>>>>>>>        If not bOk Begin
72150>>>>>>>            Error DFERR_WINPRINT DFPrintError929
72151>>>>>>>>
72151>>>>>>>        End
72151>>>>>>>>
72151>>>>>>>    End_Procedure
72152>>>>>>>    
72152>>>>>>>    
72152>>>>>>>    //
72152>>>>>>>    Procedure DFHeaderFrameType Integer eFrame Integer iColor Number nWeight;            Integer iFillColor Boolean bFillFrame
72154>>>>>>>        Integer iWeight
72154>>>>>>>        Boolean bOk
72154>>>>>>>        
72154>>>>>>>        Move (nWeight*100) to iWeight
72155>>>>>>>        
72155>>>>>>>        Move (WP_SetHeaderFrame(eFrame,iColor,iWeight,iFillColor,bFillFrame)) to bOk
72156>>>>>>>        
72156>>>>>>>        If not bOk Begin
72158>>>>>>>            Error DFERR_WINPRINT DFPrintError930
72159>>>>>>>>
72159>>>>>>>        End
72159>>>>>>>>
72159>>>>>>>    End_Procedure
72160>>>>>>>    
72160>>>>>>>    Procedure DFHeaderMargin Integer eType Number nSize
72162>>>>>>>        Boolean bOk
72162>>>>>>>        Integer iSize
72162>>>>>>>        
72162>>>>>>>        Move (nSize * 100) to iSize
72163>>>>>>>        
72163>>>>>>>        Move (WP_SetHeaderMargin(eType, iSize)) to bOk
72164>>>>>>>        
72164>>>>>>>        If not bOk Begin
72166>>>>>>>            Error DFERR_WINPRINT DFPrintError930
72167>>>>>>>>
72167>>>>>>>        End
72167>>>>>>>>
72167>>>>>>>    End_Procedure
72168>>>>>>>    
72168>>>>>>>    
72168>>>>>>>    //
72168>>>>>>>    Procedure DFHeaderWrap Integer eOnOff
72170>>>>>>>        Boolean bOk
72170>>>>>>>        
72170>>>>>>>        Move (WP_SetHeaderWrap(eOnOff)) to bOk
72171>>>>>>>        
72171>>>>>>>        If not bOk Begin
72173>>>>>>>            Error DFERR_WINPRINT DFPrintError931
72174>>>>>>>>
72174>>>>>>>        End
72174>>>>>>>>
72174>>>>>>>    End_Procedure
72175>>>>>>>    
72175>>>>>>>    //
72175>>>>>>>    Procedure DFWriteBMP String sFileName Number nStartX Number nStartY Number nHeight Number nWidth Boolean bUCp
72177>>>>>>>        Boolean bOk
72177>>>>>>>        Integer iStartX iStartY iHeight iWidth
72177>>>>>>>        
72177>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            Move nStartX to iStartX
72180>>>>>>>        Else ;            Move (nStartX*100) to iStartX
72182>>>>>>>        
72182>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            Move nStartY to iStartY
72185>>>>>>>        Else ;            Move (nStartY*100) to iStartY
72187>>>>>>>        
72187>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            Move nWidth to iWidth
72190>>>>>>>        Else ;            Move (nWidth*100) to iWidth
72192>>>>>>>        
72192>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            Move nHeight to iHeight
72195>>>>>>>        Else ;            Move (nHeight*100) to iHeight
72197>>>>>>>        
72197>>>>>>>        Get_File_Path sFileName to sFileName
72198>>>>>>>        Move (WP_DrawBitmap(sFileName,iStartX,iStartY,iWidth,iHeight,bUCp)) to bOk
72199>>>>>>>        
72199>>>>>>>        If not bOk Begin
72201>>>>>>>            Error DFERR_WINPRINT DFPrintError932
72202>>>>>>>>
72202>>>>>>>        End
72202>>>>>>>>
72202>>>>>>>    End_Procedure
72203>>>>>>>    
72203>>>>>>>    
72203>>>>>>>    //
72203>>>>>>>    Procedure DFHeaderLineCheck Integer iLines
72205>>>>>>>        Boolean bOk
72205>>>>>>>        
72205>>>>>>>        Move (WP_SetExtraLineCheck(iLines)) to bOk
72206>>>>>>>        
72206>>>>>>>        If not bOk Begin
72208>>>>>>>            Error DFERR_WINPRINT DFPrintError934
72209>>>>>>>>
72209>>>>>>>        End
72209>>>>>>>>
72209>>>>>>>    End_Procedure
72210>>>>>>>    
72210>>>>>>>    
72210>>>>>>>    //
72210>>>>>>>    Procedure DFPrintFlags Integer Flags
72212>>>>>>>        Boolean bOk
72212>>>>>>>        
72212>>>>>>>        Move (WP_SetPrintDialogFlags(Flags)) to bOk
72213>>>>>>>        
72213>>>>>>>        If not bOk Begin
72215>>>>>>>            Error DFERR_WINPRINT DFPrintError935
72216>>>>>>>>
72216>>>>>>>        End
72216>>>>>>>>
72216>>>>>>>    End_Procedure
72217>>>>>>>    
72217>>>>>>>    
72217>>>>>>>    // obsolete and maintained for winprint-I backwards compatibility (maybe should be removed)
72217>>>>>>>    //
72217>>>>>>>    Procedure DFSelectPrinter String sDriver String sDevice String sPort Boolean bUpdate
72219>>>>>>>        Send DFSetDevice sDevice
72220>>>>>>>    End_Procedure
72221>>>>>>>    
72221>>>>>>>    // Preferred usage for WinprintII
72221>>>>>>>    Procedure DFSetDevice String sDevice
72223>>>>>>>        Boolean bOk
72223>>>>>>>        
72223>>>>>>>        Move (WP_SelectPrinter(sDevice)) to bOk
72224>>>>>>>        
72224>>>>>>>        If not bOk Begin
72226>>>>>>>            Error DFERR_WINPRINT DFPrintError936
72227>>>>>>>>
72227>>>>>>>        End
72227>>>>>>>>
72227>>>>>>>    End_Procedure
72228>>>>>>>    
72228>>>>>>>    Procedure DFPrinterBinFirstPage Integer eBin
72230>>>>>>>        Boolean bOk
72230>>>>>>>        
72230>>>>>>>        Move (WP_SetFirstPagePaperSource(eBin)) to bOk
72231>>>>>>>        
72231>>>>>>>        If not bOk Begin
72233>>>>>>>            Error DFERR_WINPRINT DFPrintError937
72234>>>>>>>>
72234>>>>>>>        End
72234>>>>>>>>
72234>>>>>>>    End_Procedure
72235>>>>>>>    
72235>>>>>>>    
72235>>>>>>>    //
72235>>>>>>>    Function DFGetDFColor Integer iRed Integer iGreen Integer iBlue Returns Integer
72237>>>>>>>        Integer iColor
72237>>>>>>>        
72237>>>>>>>        Move (WP_RGBToDFPrintColor(iRed,iGreen,iBlue)) to iColor
72238>>>>>>>        
72238>>>>>>>        If (iColor=0) Begin
72240>>>>>>>            Error DFERR_WINPRINT DFPrintError938
72241>>>>>>>>
72241>>>>>>>        End
72241>>>>>>>>
72241>>>>>>>        Function_Return iColor
72242>>>>>>>    End_Function
72243>>>>>>>    
72243>>>>>>>    
72243>>>>>>>    //
72243>>>>>>>    Procedure DFSetDFColor DWord dwColor
72245>>>>>>>        Integer bOk
72245>>>>>>>        
72245>>>>>>>        Move (WP_SetFontColor(dwColor)) to bOk
72246>>>>>>>        
72246>>>>>>>        If not bOk Begin
72248>>>>>>>            Error DFERR_WINPRINT DFPrintError939
72249>>>>>>>>
72249>>>>>>>        End
72249>>>>>>>>
72249>>>>>>>    End_Procedure
72250>>>>>>>    
72250>>>>>>>    
72250>>>>>>>    //
72250>>>>>>>    Procedure DFSetTopBottom Number nTop Number nBottom Boolean bAllPages
72252>>>>>>>        Boolean bOk
72252>>>>>>>        Integer iTop iBottom
72252>>>>>>>        
72252>>>>>>>        Move (nTop*100)    to iTop
72253>>>>>>>        Move (nBottom*100) to iBottom
72254>>>>>>>        
72254>>>>>>>        Move (WP_SetAbsoluteMargins(iTop,iBottom,bAllPages)) to bOk
72255>>>>>>>        
72255>>>>>>>        If not bOk Begin
72257>>>>>>>            Error DFERR_WINPRINT DFPrintError940
72258>>>>>>>>
72258>>>>>>>        End
72258>>>>>>>>
72258>>>>>>>    End_Procedure
72259>>>>>>>    
72259>>>>>>>    
72259>>>>>>>    //
72259>>>>>>>    Procedure DFSetJMode Integer eAlign
72261>>>>>>>        Boolean bOk
72261>>>>>>>        
72261>>>>>>>        Move (WP_SetAlign(eAlign)) to bOk
72262>>>>>>>        
72262>>>>>>>        If not bOk Begin
72264>>>>>>>            Error DFERR_WINPRINT DFPrintError941
72265>>>>>>>>
72265>>>>>>>        End
72265>>>>>>>>
72265>>>>>>>    End_Procedure
72266>>>>>>>    
72266>>>>>>>    
72266>>>>>>>    //
72266>>>>>>>    Procedure DFWriteEllip Number nStartX Number nStartY Number nHeight Number nWidth ;            DWord dwBColor DWord dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
72268>>>>>>>        
72268>>>>>>>        Boolean bOk
72268>>>>>>>        Integer iWeight
72268>>>>>>>        Integer iStartX iStartY iHeight iWidth
72268>>>>>>>        
72268>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            Move nStartX to iStartX
72271>>>>>>>        Else ;            Move (nStartX*100) to iStartX
72273>>>>>>>        
72273>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            Move nStartY to iStartY
72276>>>>>>>        Else ;            Move (nStartY*100) to iStartY
72278>>>>>>>        
72278>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            Move nWidth to iWidth
72281>>>>>>>        Else ;            Move (nWidth*100) to iWidth
72283>>>>>>>        
72283>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            Move nHeight to iHeight
72286>>>>>>>        Else ;            Move (nHeight*100) to iHeight
72288>>>>>>>        
72288>>>>>>>        Move (nWeight*100) to iWeight
72289>>>>>>>        
72289>>>>>>>        
72289>>>>>>>        Move (WP_DrawEllipse(iStartX,iStartY,iWidth,iHeight,;            dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) to bOk
72290>>>>>>>        
72290>>>>>>>        If not bOk Begin
72292>>>>>>>            Error DFERR_WINPRINT DFPrintError942
72293>>>>>>>>
72293>>>>>>>        End
72293>>>>>>>>
72293>>>>>>>    End_Procedure
72294>>>>>>>    
72294>>>>>>>    
72294>>>>>>>    
72294>>>>>>>    
72294>>>>>>>    //
72294>>>>>>>    Procedure DFWriteRect Number nStartX Number nStartY Number nHeight Number nWidth;            DWord dwBColor DWord dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
72296>>>>>>>        
72296>>>>>>>        Boolean bOk
72296>>>>>>>        Integer iWeight
72296>>>>>>>        Integer iStartX iStartY iHeight iWidth
72296>>>>>>>        
72296>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            Move nStartX to iStartX
72299>>>>>>>        Else ;            Move (nStartX*100) to iStartX
72301>>>>>>>        
72301>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            Move nStartY to iStartY
72304>>>>>>>        Else ;            Move (nStartY*100) to iStartY
72306>>>>>>>        
72306>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            Move nWidth to iWidth
72309>>>>>>>        Else ;            Move (nWidth*100) to iWidth
72311>>>>>>>        
72311>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            Move nHeight to iHeight
72314>>>>>>>        Else ;            Move (nHeight*100) to iHeight
72316>>>>>>>        
72316>>>>>>>        Move (nWeight*100) to iWeight
72317>>>>>>>        
72317>>>>>>>        Move (WP_DrawRectangle(iStartX,iStartY,iWidth,iHeight,;            dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) to bOk
72318>>>>>>>        
72318>>>>>>>        If not bOk Begin
72320>>>>>>>            Error DFERR_WINPRINT DFPrintError944
72321>>>>>>>>
72321>>>>>>>        End
72321>>>>>>>>
72321>>>>>>>    End_Procedure
72322>>>>>>>    
72322>>>>>>>    
72322>>>>>>>    
72322>>>>>>>    
72322>>>>>>>    //
72322>>>>>>>    Procedure DFLineCheck Integer iLines
72324>>>>>>>        Boolean bOk
72324>>>>>>>        
72324>>>>>>>        Move (WP_ConfirmLines(iLines)) to bOk
72325>>>>>>>        
72325>>>>>>>        If not bOk Begin
72327>>>>>>>            Error DFERR_WINPRINT DFPrintError946
72328>>>>>>>>
72328>>>>>>>        End
72328>>>>>>>>
72328>>>>>>>    End_Procedure
72329>>>>>>>    
72329>>>>>>>    
72329>>>>>>>    //
72329>>>>>>>    Procedure DFCreateDiagram Integer eType Integer eFx Number nHeight Number nWidth Integer bXyAxis
72331>>>>>>>        Handle hDiagram
72331>>>>>>>        Integer iWidth iHeight
72331>>>>>>>        
72331>>>>>>>        Move (nHeight*100) to iHeight
72332>>>>>>>        Move (nWidth*100)  to iWidth
72333>>>>>>>        
72333>>>>>>>        Set DFCurrent_Color to 0
72334>>>>>>>        
72334>>>>>>>        Move (WP_CreateDiagram(eType,eFx,iWidth,iHeight,bXyAxis)) to hDiagram
72335>>>>>>>        
72335>>>>>>>        If (hDiagram) Begin
72337>>>>>>>            Error DFERR_WINPRINT DFPrintError947
72338>>>>>>>>
72338>>>>>>>        End
72338>>>>>>>>
72338>>>>>>>        Else Begin
72339>>>>>>>            Set DFCurrent_Diagram to hDiagram
72340>>>>>>>        End
72340>>>>>>>>
72340>>>>>>>    End_Procedure
72341>>>>>>>    
72341>>>>>>>    
72341>>>>>>>    //
72341>>>>>>>    Procedure DFDiagram_Item Handle hDiagram String sLabel Number nValue;            DWord dwBColor DWord dwFColor Integer eFill;            Integer iDec Integer eValueOrPercent Integer eExt
72343>>>>>>>        
72343>>>>>>>        Boolean bOk
72343>>>>>>>        Integer iCurrColor iValue
72343>>>>>>>        
72343>>>>>>>        If (dwFColor = -1) Begin
72345>>>>>>>            Get DFCurrent_Color to iCurrColor
72346>>>>>>>            Increment iCurrColor
72347>>>>>>>            If (iCurrColor>15) ;                Move 1 to iCurrColor
72350>>>>>>>            Set DFCurrent_Color to iCurrColor
72351>>>>>>>            Get DFGetColor iCurrColor to dwFColor
72352>>>>>>>        End
72352>>>>>>>>
72352>>>>>>>        
72352>>>>>>>        Move (nValue *100) to iValue
72353>>>>>>>        
72353>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
72354>>>>>>>        
72354>>>>>>>        Move (WP_AddDiagramEntry(hDiagram,sLabel,iValue,dwBColor,dwFColor,eFill,iDec,eValueorPercent,eExt)) to bOk
72355>>>>>>>        
72355>>>>>>>        If not bOk Begin
72357>>>>>>>            Error DFERR_WINPRINT DFPrintError948
72358>>>>>>>>
72358>>>>>>>        End
72358>>>>>>>>
72358>>>>>>>    End_Procedure
72359>>>>>>>    
72359>>>>>>>    
72359>>>>>>>    //
72359>>>>>>>    Procedure DFLockDiagram Handle hDiagram
72361>>>>>>>        Boolean bOk
72361>>>>>>>        
72361>>>>>>>        Move (WP_LockDiagram(hDiagram)) to bOk
72362>>>>>>>        
72362>>>>>>>        If not bOk Begin
72364>>>>>>>            Error DFERR_WINPRINT DFPrintError949
72365>>>>>>>>
72365>>>>>>>        End
72365>>>>>>>>
72365>>>>>>>    End_Procedure
72366>>>>>>>    
72366>>>>>>>    
72366>>>>>>>    
72366>>>>>>>    //
72366>>>>>>>    Procedure DFDrawDiagram Handle hDiagram Number nYPos Number nXPos Boolean bUCp
72368>>>>>>>        Boolean bOk
72368>>>>>>>        Integer iXPos
72368>>>>>>>        Integer iYPos
72368>>>>>>>        
72368>>>>>>>        Move (nXPos*100) to iXPos
72369>>>>>>>        Move (nYPos*100) to iYPos
72370>>>>>>>        
72370>>>>>>>        If (nYPos = -999) ;            Move -999 to iYPos
72373>>>>>>>        
72373>>>>>>>        Move (WP_DrawDiagram(hDiagram,iXPos,iYPos,bUCp)) to bOk
72374>>>>>>>        
72374>>>>>>>        If not bOk Begin
72376>>>>>>>            Error DFERR_WINPRINT DFPrintError950
72377>>>>>>>>
72377>>>>>>>        End
72377>>>>>>>>
72377>>>>>>>    End_Procedure
72378>>>>>>>    
72378>>>>>>>    
72378>>>>>>>    
72378>>>>>>>    //
72378>>>>>>>    Procedure DFDiagramLabel Handle hDiagram String sLabel
72380>>>>>>>        Boolean bOk
72380>>>>>>>        Integer iLabelLen
72380>>>>>>>        
72380>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
72381>>>>>>>        
72381>>>>>>>        Move (WP_SetDiagramCaption(hDiagram,sLabel)) to bOk
72382>>>>>>>        
72382>>>>>>>        If not bOk Begin
72384>>>>>>>            Error DFERR_WINPRINT DFPrintError952
72385>>>>>>>>
72385>>>>>>>        End
72385>>>>>>>>
72385>>>>>>>    End_Procedure
72386>>>>>>>    
72386>>>>>>>    
72386>>>>>>>    //
72386>>>>>>>    Procedure DFDiagramXLabel Handle hDiagram String sLabel
72388>>>>>>>        Boolean bOk
72388>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
72389>>>>>>>        
72389>>>>>>>        Move (WP_SetDiagramXText(hDiagram,sLabel)) to bOk
72390>>>>>>>        
72390>>>>>>>        If not bOk Begin
72392>>>>>>>            Error DFERR_WINPRINT DFPrintError953
72393>>>>>>>>
72393>>>>>>>        End
72393>>>>>>>>
72393>>>>>>>    End_Procedure
72394>>>>>>>    
72394>>>>>>>    
72394>>>>>>>    //
72394>>>>>>>    Procedure DFDiagramYLabel Handle hDiagram String sLabel Boolean bVertical
72396>>>>>>>        Boolean bOk
72396>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
72397>>>>>>>        
72397>>>>>>>        Move (WP_SetDiagramYText(hDiagram,sLabel,bVertical)) to bOk
72398>>>>>>>        
72398>>>>>>>        If not bOk Begin
72400>>>>>>>            Error DFERR_WINPRINT DFPrintError954
72401>>>>>>>>
72401>>>>>>>        End
72401>>>>>>>>
72401>>>>>>>    End_Procedure
72402>>>>>>>    
72402>>>>>>>    
72402>>>>>>>    //
72402>>>>>>>    Procedure DFWriteXYLine Number nStartX Number nStartY Number nStopX Number nStopY;            DWord dwColor Number nWeight Boolean bWrap Boolean bUCp
72404>>>>>>>        
72404>>>>>>>        Boolean bOk
72404>>>>>>>        Integer iStartX iStartY iStopX iStopY
72404>>>>>>>        Integer iWeight
72404>>>>>>>        
72404>>>>>>>        Move (nStartX*100)  to iStartX
72405>>>>>>>        Move (nStartY*100)  to iStartY
72406>>>>>>>        Move (nStopX*100)   to iStopX
72407>>>>>>>        Move (nStopY*100)   to iStopY
72408>>>>>>>        
72408>>>>>>>        Move (nWeight*100) to iWeight
72409>>>>>>>        
72409>>>>>>>        If (nStopY  = -998) ;            Move -998 to iStopY
72412>>>>>>>        If (nStopX  = -998) ;            Move -998 to iStopX
72415>>>>>>>        
72415>>>>>>>        If (nStartY  = -999) ;            Move -999 to iStartY
72418>>>>>>>        If (nStartX  = -999) ;            Move -999 to iStartX
72421>>>>>>>        
72421>>>>>>>        Move (WP_DrawXYLine(iStartX,iStartY,iStopX,iStopY,dwColor,iWeight,bUCp,bWrap)) to bOk
72422>>>>>>>        
72422>>>>>>>        If not bOk Begin
72424>>>>>>>            Error DFERR_WINPRINT DFPrintError955
72425>>>>>>>>
72425>>>>>>>        End
72425>>>>>>>>
72425>>>>>>>    End_Procedure
72426>>>>>>>    
72426>>>>>>>    
72426>>>>>>>    //
72426>>>>>>>    Procedure DFWriteLine Number nStartX Number nStartY Number nLength;            Boolean bHorizontal DWord dwColor Number nWeight Boolean bUCp
72428>>>>>>>        
72428>>>>>>>        Boolean bOk
72428>>>>>>>        Integer iStartX iStartY iLength
72428>>>>>>>        Integer iWeight
72428>>>>>>>        
72428>>>>>>>        Move (nStartX*100)  to iStartX
72429>>>>>>>        Move (nStartY*100)  to iStartY
72430>>>>>>>        Move (nLength*100)  to iLength
72431>>>>>>>        Move (nWeight*100)  to iWeight
72432>>>>>>>        
72432>>>>>>>        If (nStartY = -999) ;            Move -999 to iStartY
72435>>>>>>>        If (nStartX = -999) ;            Move -999 to iStartX
72438>>>>>>>        If (nLength = -998) ;            Move -998 to iLength
72441>>>>>>>        
72441>>>>>>>        Move (WP_DrawLine(iSTartX,iStartY,iLength,bHorizontal,dwColor,iWeight,bUCp)) to bOk
72442>>>>>>>        
72442>>>>>>>        If not bOk Begin
72444>>>>>>>            Error DFERR_WINPRINT DFPrintError956
72445>>>>>>>>
72445>>>>>>>        End
72445>>>>>>>>
72445>>>>>>>    End_Procedure
72446>>>>>>>    
72446>>>>>>>    
72446>>>>>>>    //
72446>>>>>>>    Procedure DFClearPrinter
72448>>>>>>>        Boolean bOk
72448>>>>>>>        
72448>>>>>>>        Move (WP_ClearPrinter()) to bOk
72449>>>>>>>        
72449>>>>>>>        If not bOk Begin
72451>>>>>>>            Error DFERR_WINPRINT DFPrintError957
72452>>>>>>>>
72452>>>>>>>        End
72452>>>>>>>>
72452>>>>>>>    End_Procedure
72453>>>>>>>    
72453>>>>>>>    
72453>>>>>>>    
72453>>>>>>>    //
72453>>>>>>>    Function DFGetCurrentDevice Returns String
72455>>>>>>>        Boolean bOk
72455>>>>>>>        String  sDFStr
72455>>>>>>>        Address pDFStr
72455>>>>>>>        
72455>>>>>>>        Move (Repeat( Character(0), 255 )) to sDFStr
72456>>>>>>>        Move (AddressOf(sDFStr)) to pDFStr
72457>>>>>>>        
72457>>>>>>>        Move (WP_GetCurrentDevice(pDFStr)) to bOk
72458>>>>>>>        
72458>>>>>>>        If not bOk Begin
72460>>>>>>>            Error DFERR_WINPRINT DFPrintError959
72461>>>>>>>>
72461>>>>>>>        End
72461>>>>>>>>
72461>>>>>>>        
72461>>>>>>>        Move (CString(sDFStr)) to sDFStr
72462>>>>>>>        Function_Return sDFStr
72463>>>>>>>    End_Function
72464>>>>>>>    
72464>>>>>>>    
72464>>>>>>>    // Note: DfGetCurrentPort and DFGetCurrentDriver do not exist in winprint2. Trying to
72464>>>>>>>    //       use these will result in a runtime error (which is good - don't use them)
72464>>>>>>>    
72464>>>>>>>    
72464>>>>>>>    //
72464>>>>>>>    Function DFGetPrintDialogFlags Returns DWord
72466>>>>>>>        DWord dwRetVal
72466>>>>>>>        
72466>>>>>>>        Move (WP_GetPrintDialogFlags()) to dwRetVal
72467>>>>>>>        
72467>>>>>>>        Function_Return dwRetVal
72468>>>>>>>    End_Function
72469>>>>>>>    
72469>>>>>>>    
72469>>>>>>>    //
72469>>>>>>>    // Returns PRN_TRUE=  if the flag is set     (1)
72469>>>>>>>    // Returns PRN_FALSE= If the flag not is set (0)
72469>>>>>>>    //
72469>>>>>>>    Function DFCheckPrintDialogFlag DWord dwPDFlag Returns Boolean
72471>>>>>>>        Boolean bIsSet
72471>>>>>>>        
72471>>>>>>>        Move (WP_IsPrintDialogFlagSet(dwPDFlag)) to bIsSet
72472>>>>>>>        
72472>>>>>>>        Function_Return bIsSet
72473>>>>>>>    End_Function
72474>>>>>>>    
72474>>>>>>>    
72474>>>>>>>    //
72474>>>>>>>    Procedure DFSetSpecPrintFlag DWord dwPDFlag
72476>>>>>>>        Boolean bOk
72476>>>>>>>        
72476>>>>>>>        Move (WP_SetSpecificPrintDialogFlag(dwPDFlag)) to bOk
72477>>>>>>>        
72477>>>>>>>        If not bOk Begin
72479>>>>>>>            Error DFERR_WINPRINT DFPrintError961
72480>>>>>>>>
72480>>>>>>>        End
72480>>>>>>>>
72480>>>>>>>    End_Procedure
72481>>>>>>>    
72481>>>>>>>    
72481>>>>>>>    //
72481>>>>>>>    Function DFGetUserDefinedLength Returns Number
72483>>>>>>>        Integer iRetVal
72483>>>>>>>        Number  nRetVal
72483>>>>>>>        
72483>>>>>>>        Move (WP_GetUserDefinedPapersize()) to iRetVal
72484>>>>>>>        
72484>>>>>>>        If (iRetVal=0) Begin
72486>>>>>>>            Error DFERR_WINPRINT DFPrintError962
72487>>>>>>>>
72487>>>>>>>            Function_Return 0
72488>>>>>>>        End
72488>>>>>>>>
72488>>>>>>>        
72488>>>>>>>        Move (Hi(iRetVal)) to nRetVal
72489>>>>>>>        Move (nRetVal/100) to nRetVal //Returns CM
72490>>>>>>>        
72490>>>>>>>        Function_Return nRetVal
72491>>>>>>>    End_Function
72492>>>>>>>    
72492>>>>>>>    
72492>>>>>>>    //
72492>>>>>>>    Function DFGetUserDefinedWidth Returns Number
72494>>>>>>>        Integer iRetVal
72494>>>>>>>        Number  nRetVal
72494>>>>>>>        
72494>>>>>>>        Move (WP_GetUserDefinedPapersize()) to iRetVal
72495>>>>>>>        
72495>>>>>>>        If (iRetVal=0) Begin
72497>>>>>>>            Error DFERR_WINPRINT DFPrintError963
72498>>>>>>>>
72498>>>>>>>            Function_Return 0
72499>>>>>>>        End
72499>>>>>>>>
72499>>>>>>>        
72499>>>>>>>        Move (Low(iRetVal)) to nRetVal
72500>>>>>>>        Move (nRetVal/100) to nRetVal //Returns CM
72501>>>>>>>        
72501>>>>>>>        Function_Return nRetVal
72502>>>>>>>    End_Function
72503>>>>>>>    
72503>>>>>>>    
72503>>>>>>>    // To be set in CM
72503>>>>>>>    Procedure DFSetUserDefinedPapersize Number nLength Number nWidth
72505>>>>>>>        Integer bOk
72505>>>>>>>        Integer iLength iWidth iSize
72505>>>>>>>        
72505>>>>>>>        Move (nLength*100) to iLength
72506>>>>>>>        Move (nWidth*100)  to iWidth
72507>>>>>>>        Move ((iLength*65536)+iWidth) to iSize
72508>>>>>>>        
72508>>>>>>>        Move (WP_SetUserDefinedPapersize(iSize)) to bOk
72509>>>>>>>        
72509>>>>>>>        If not bOk Begin
72511>>>>>>>            Error DFERR_WINPRINT DFPrintError964
72512>>>>>>>>
72512>>>>>>>        End
72512>>>>>>>>
72512>>>>>>>    End_Procedure
72513>>>>>>>    
72513>>>>>>>    Procedure DFSetNumberOfCopies Integer iNrOfCopies
72515>>>>>>>        Boolean bOk
72515>>>>>>>        
72515>>>>>>>        Move (WP_SetNumberOfPrintCopies(iNrOfCopies)) to bOk
72516>>>>>>>        
72516>>>>>>>        If not bOk Begin
72518>>>>>>>            Error DFERR_WINPRINT DFPrintError965
72519>>>>>>>>
72519>>>>>>>        End
72519>>>>>>>>
72519>>>>>>>    End_Procedure
72520>>>>>>>    
72520>>>>>>>    
72520>>>>>>>    
72520>>>>>>>    
72520>>>>>>>    // This procedures and functions are used when building 
72520>>>>>>>    // complex graphics when you need to change value of the
72520>>>>>>>    // current diagram, so you can mix diagrams within each 
72520>>>>>>>    // other.                                               
72520>>>>>>>    
72520>>>>>>>    
72520>>>>>>>    Function DFGetCurrentDiagram Returns Integer
72522>>>>>>>        Integer iRetVal
72522>>>>>>>        Get DFCurrent_Diagram to iRetVal
72523>>>>>>>        Function_Return iRetVal
72524>>>>>>>    End_Function
72525>>>>>>>    
72525>>>>>>>    Procedure DFSetCurrentDiagram Integer iDiagram
72527>>>>>>>        Set DFCurrent_Diagram to iDiagram
72528>>>>>>>    End_Procedure
72529>>>>>>>    
72529>>>>>>>    Procedure DFSetDiagramList Integer iItem Integer iDiagram
72531>>>>>>>        Set Value of oDiagramArray iItem to iDiagram
72532>>>>>>>    End_Procedure
72533>>>>>>>    
72533>>>>>>>    Function DFGetDiagramList Integer iItem Returns Integer
72535>>>>>>>        Integer iRetVal
72535>>>>>>>        Get Value of oDiagramArray iItem to iRetVal
72536>>>>>>>        Function_Return iRetVal
72537>>>>>>>    End_Function
72538>>>>>>>    
72538>>>>>>>    Procedure DFClearDiagramList
72540>>>>>>>        Send Delete_Data to oDiagramArray
72541>>>>>>>    End_Procedure
72542>>>>>>>    
72542>>>>>>>    
72542>>>>>>>    Function DFGetColor Integer iColor Returns DWord
72544>>>>>>>        DWord   dwRetVal
72544>>>>>>>        Get Value of oDFColorArray iColor to dwRetVal
72545>>>>>>>        Function_Return dwRetVal
72546>>>>>>>    End_Function
72547>>>>>>>    
72547>>>>>>>    Function DFGetCurrentColor Returns DWord
72549>>>>>>>        DWord   dwRetVal
72549>>>>>>>        Integer iCurrColor
72549>>>>>>>        
72549>>>>>>>        Get DFCurrent_Color to iCurrColor
72550>>>>>>>        Get DFGetColor iCurrColor to dwRetVal
72551>>>>>>>        
72551>>>>>>>        Function_Return dwRetVal
72552>>>>>>>    End_Function
72553>>>>>>>    
72553>>>>>>>    Procedure DFEndDocument
72555>>>>>>>        Integer iVoid
72555>>>>>>>        Move (WP_EndDocument()) to iVoid
72556>>>>>>>        Send DfSuspendGui False
72557>>>>>>>    End_Procedure
72558>>>>>>>    
72558>>>>>>>    Procedure DFClosePreview
72560>>>>>>>        Integer iVoid
72560>>>>>>>        Move (WP_ClosePreview()) to iVoid
72561>>>>>>>        Send DfSuspendGui False
72562>>>>>>>    End_Procedure
72563>>>>>>>    
72563>>>>>>>    Procedure SetProgressCaption String sCaption
72565>>>>>>>        Integer iVoid
72565>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
72566>>>>>>>        Move (WP_SetProgressCaption(sCaption)) to iVoid
72567>>>>>>>    End_Procedure
72568>>>>>>>    
72568>>>>>>>    Procedure SetReportTitle String sTitle
72570>>>>>>>        Integer iVoid
72570>>>>>>>        Move (ToAnsi(sTitle)) to sTitle
72571>>>>>>>        Move (WP_SetReportTitle(sTitle)) to iVoid
72572>>>>>>>    End_Procedure
72573>>>>>>>    
72573>>>>>>>    Function PreviewYesNoBox String sCaption String sText Returns Integer
72575>>>>>>>        Integer eResult
72575>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
72576>>>>>>>        Move (ToAnsi(sText))    to sText
72577>>>>>>>        Move (WP_DisplayMessageBox(sCaption, sText)) to eResult
72578>>>>>>>        Function_Return eResult
72579>>>>>>>    End_Function
72580>>>>>>>    
72580>>>>>>>    // internal function, used to extract different printer flags ranges based on
72580>>>>>>>    // the print flag integer. These flags use a decimal style of packing information
72580>>>>>>>    // where different printer options (paper, bin, etc) use different ranges and
72580>>>>>>>    // different steps. Everything above iTopVal is removed and everything that is not
72580>>>>>>>    // within the iStep range is removed.
72580>>>>>>>    Function PrintFlagRange Integer iTopVal Integer iStep Returns Integer
72582>>>>>>>        Integer iFgs iFg
72582>>>>>>>        Get DFGetPrintDialogFlags to iFg
72583>>>>>>>        Move (mod(iFg,iTopVal) / iStep * iStep ) to iFg
72584>>>>>>>        Function_Return iFg
72585>>>>>>>    End_Function
72586>>>>>>>    
72586>>>>>>>    Procedure DFSetPrinterPaper Integer ePaperType
72588>>>>>>>        Send DFSetSpecPrintFlag ePaperType
72589>>>>>>>    End_Procedure
72590>>>>>>>    
72590>>>>>>>    Function DFGetPrinterPaper Returns Integer //ePaperType
72592>>>>>>>        Integer ePaperType
72592>>>>>>>        Get PrintFlagRange 500 10 to ePaperType // 10-490 in steps of 10
72593>>>>>>>        Function_Return ePaperType
72594>>>>>>>    End_Function
72595>>>>>>>    
72595>>>>>>>    
72595>>>>>>>    Procedure DFSetPrinterBin Integer eBinType
72597>>>>>>>        Send DFSetSpecPrintFlag eBinType
72598>>>>>>>    End_Procedure
72599>>>>>>>    
72599>>>>>>>    Function DFGetPrinterBin Returns Integer //eBinType
72601>>>>>>>        Integer eBinType
72601>>>>>>>        Get PrintFlagRange 10000 500 to eBinType // 1000-9000 steps 500
72602>>>>>>>        Function_Return eBinType
72603>>>>>>>    End_Function
72604>>>>>>>    
72604>>>>>>>    
72604>>>>>>>    Procedure DFSetPrinterResolution Integer eResType
72606>>>>>>>        Send DFSetSpecPrintFlag eResType
72607>>>>>>>    End_Procedure
72608>>>>>>>    
72608>>>>>>>    Function DFGetPrinterResolution Returns Integer //eResType
72610>>>>>>>        Integer eResType
72610>>>>>>>        Get PrintFlagRange 50000 10000 to eResType // 10000-500000 steps 10000
72611>>>>>>>        Function_Return eResType
72612>>>>>>>    End_Function
72613>>>>>>>    
72613>>>>>>>    
72613>>>>>>>    Procedure DFSetLandscape Boolean bIsLandscape
72615>>>>>>>        Send DFSetSpecPrintFlag (If(bIsLandscape,DF_Landscape,DF_Portrait))
72616>>>>>>>    End_Procedure
72617>>>>>>>    
72617>>>>>>>    Function DFGetLandscape Returns Boolean // bIsLandscape
72619>>>>>>>        Boolean bIsLandscape
72619>>>>>>>        Get DFCheckPrintDialogFlag DF_Landscape to bIsLandscape
72620>>>>>>>        Function_Return bIsLandscape
72621>>>>>>>    End_Function
72622>>>>>>>    
72622>>>>>>>    Function RGBToWPColor Integer iRgb Returns Integer
72624>>>>>>>        Integer iRed iGreen iBlue
72624>>>>>>>        Integer iWPColor
72624>>>>>>>        Move (R_from_rgb(iRGB)) to iRed
72625>>>>>>>        Move (G_from_rgb(iRGB)) to iGreen
72626>>>>>>>        Move (B_from_rgb(iRGB)) to iBlue
72627>>>>>>>        Get DfGetDfColor iRed iGreen iBlue to iWPColor
72628>>>>>>>        Function_Return iWPColor
72629>>>>>>>    End_Function
72630>>>>>>>    
72630>>>>>>>    
72630>>>>>>>    
72630>>>>>>>End_Class
72631>>>>>>>
72631>>>>>>>Global_Variable Integer ghoWinPrint2
72631>>>>>>>
72631>>>>>>>Get Create of desktop U_cWinPrint2 to ghoWinPrint2
72632>>>>>Use Winprint_Commands.pkg  // commands used by this class
Including file: Winprint_Commands.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Winprint_Commands.pkg)
72632>>>>>>>// Commands used by Winprint (old and new).
72632>>>>>>>Global_Variable Integer WinPrintId  // Provide simple access to global object //JT
72632>>>>>>>Move 0 to WinPrintId
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// With the DFWRITE/LN commands you can use 1-3 arguments
72633>>>>>>>// 1. Not Required = Text
72633>>>>>>>// 2. Not Req. = FonstStyle
72633>>>>>>>// 3. Not Req. = Number of decimals
72633>>>>>>>//    !!! If you want to set decimals you MUST use all 3 arguments
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// With the WRITECOL/LN commands you can use 2-4 arguments
72633>>>>>>>// 1. Required = Text
72633>>>>>>>// 2. Required = Column to write to
72633>>>>>>>// 3. Not Req. = FonstStyle
72633>>>>>>>// 4. Not Req. = Number of decimals
72633>>>>>>>//    !!! If you want to set decimals you MUST use all 4 arguments
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// With the WWRITEPOS/LN commands you can use 2-4 arguments
72633>>>>>>>// 1. Required = Text
72633>>>>>>>// 2. Required = Position to start at from left margin. Depending
72633>>>>>>>//    on if DFCurrent_Metrics is set to CM or INCH
72633>>>>>>>// 3. Not Req. = FonstStyle
72633>>>>>>>// 4. Not Req. = Number of decimals
72633>>>>>>>//    !!! If you want to set decimals you MUST use all 4 arguments
72633>>>>>>>// 5. Max length (0 means no max)
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// Following command sets the font and remains active until
72633>>>>>>>// you change to another font
72633>>>>>>>// 1. Required = A valid Windows font
72633>>>>>>>//
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// With the WFontsize command you can use 1-2 arguments
72633>>>>>>>// 1. Required = Hi
72633>>>>>>>// 2. Not Req. = Wi
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// Following commands sets the margins of your document
72633>>>>>>>// 1. Required = Margin in CM or INCH depending in metrics
72633>>>>>>>//
72633>>>>>>>// You can also use the procedure DFSetMargins to set all
72633>>>>>>>// margins at the same time.
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFBeginHeader creates a headertype of your choise
72633>>>>>>>// 1. Required = HeaderType
72633>>>>>>>// 2. Not Req. = Headernumber
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFEndHeader endns a header section. And prints the header.
72633>>>>>>>// Headers can NOT be nested
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFHeaderPos
72633>>>>>>>// 1. Required = Header position
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFHeaderFrame
72633>>>>>>>// 1. Required = Header frame type
72633>>>>>>>// 2. Not Req. = Weight of line
72633>>>>>>>// 3. Not Req. = line color        //RGB_??
72633>>>>>>>// 4. Not Reg. = Fill color        //RGB_??
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>// DFHeaderMargin (JvH)
72633>>>>>>>// 1. Required = Margin type
72633>>>>>>>//   HM_TOPOUTER    = 0   // margin above the top of the header's frame
72633>>>>>>>//   HM_TOPINNER    = 1   // margin below the top of the header's frame
72633>>>>>>>//   HM_BOTTOMINNER = 2   // margin above the bottom of the header's frame
72633>>>>>>>//   HM_BOTTOMOUTER = 3   // margin below the bottom of the header's frame
72633>>>>>>>// 2. Required = Size of margin
72633>>>>>>>//
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFHeaderWrap
72633>>>>>>>// 1. Required = On/Off
72633>>>>>>>// HDR_NOWRAP = 0
72633>>>>>>>// HDR_WRAP   = 1
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFHeaderLineCheck
72633>>>>>>>// 1. Required = Number of lines to check. Using last settings of font
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>// DFWriteBMP
72633>>>>>>>// 1. Required = Filename and path
72633>>>>>>>// 2. Required = Vertical start
72633>>>>>>>// 3. Required = Horizontal start
72633>>>>>>>// 4. Required = Height
72633>>>>>>>// 5. Required = Width
72633>>>>>>>// 6. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFWriteEllip
72633>>>>>>>// 1. Required = Vertical start
72633>>>>>>>// 2. Required = Horizontal start
72633>>>>>>>// 3. Required = Height
72633>>>>>>>// 4. Required = Width
72633>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72633>>>>>>>// 6. Not Req. = Weight of line
72633>>>>>>>// 7. Not Req. = Wrap to next page     //DFGR_NOWRAP,DFGR_WRAP
72633>>>>>>>// 8. Not Req. = Fill color            //RGB_??
72633>>>>>>>// 9. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFWriteRect
72633>>>>>>>// 1. Required = Vertical start
72633>>>>>>>// 2. Required = Horizontal start
72633>>>>>>>// 3. Required = Height
72633>>>>>>>// 4. Required = Width
72633>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72633>>>>>>>// 6. Not Req. = Weight of line
72633>>>>>>>// 7. Not Req. = Wrap to next page     //DFGR_NOWRAP,DFGR_WRAP
72633>>>>>>>// 8. Not Req. = Fill color            //RGB_??
72633>>>>>>>// 9. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFLineCheck
72633>>>>>>>// 1. Required = Number of lines to check. Using last settings of font
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFCreateDiagram
72633>>>>>>>// 1. Required = Type of diagram //DFGR_??
72633>>>>>>>// 2. Required = Type of effect  //DFGR_??
72633>>>>>>>// 3. Required = Height
72633>>>>>>>// 4. Required = Width
72633>>>>>>>// 5. Optional = Display XY Axis (true/false), valid ONLY for bar charts
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFWriteDiagram
72633>>>>>>>// 1. Required = Y-Position using current metrics //Constant can be used !!
72633>>>>>>>// 2. Required = X-Position using current metrics
72633>>>>>>>// 3. Optional = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFBeginDiagram
72633>>>>>>>// 1. Required = Type of diagram //DFGR_??
72633>>>>>>>// 2. Required = Type of effect  //DFGR_??
72633>>>>>>>// 3. Required = Y-Position using current metrics //Constant can be used !!
72633>>>>>>>// 4. Required = X-Position using current metrics
72633>>>>>>>// 5. Required = Height
72633>>>>>>>// 6. Required = Width
72633>>>>>>>// 7. Optional = Display XY Axis (true/false), valid ONLY for bar charts
72633>>>>>>>// 8. Optional = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFDiagram_Item
72633>>>>>>>// 1. Required = Value
72633>>>>>>>// 2. Required = Label
72633>>>>>>>// 3. Not Req. = No value, Value or percent DFGR_NOVAL,DFGR_VAL,DFGR_PER
72633>>>>>>>// 4. Not Req. = Number of decimals
72633>>>>>>>// 5. Not Req. = Move slice in pie     //DFGR_IN, DFGR_OUT
72633>>>>>>>// 6. Not Reg. = Fill color            //RGB_??
72633>>>>>>>// 8. Not Req. = Boarder color         //RGB_??
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFEndDiagram
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFDiagramLabel
72633>>>>>>>// 1. Required = Label text (top)
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFDiagramXLabel
72633>>>>>>>// 1. Required = Label text (top)
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFDiagramYLabel
72633>>>>>>>// 1. Required    = Label text (top)
72633>>>>>>>// 2. Orientation = Vertical/Horizontal
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFWriteXYLine
72633>>>>>>>// 1. Required = Vertical start
72633>>>>>>>// 2. Required = Horizontal start
72633>>>>>>>// 3. Required = Vertical stopp
72633>>>>>>>// 4. Required = Horizontal stopp
72633>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72633>>>>>>>// 6. Not Req. = Weight of line
72633>>>>>>>// 7. Not Req. = Wrap to next page     //DFGR_NOWRAP,DFGR_WRAP
72633>>>>>>>// 8. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFWriteLine
72633>>>>>>>// 1. Required = Vertical start
72633>>>>>>>// 2. Required = Horizontal start
72633>>>>>>>// 3. Required = Length
72633>>>>>>>// 4. Not Req. = Horizontal/Vertical   //RGB_HORI RGB_VERT
72633>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72633>>>>>>>// 6. Not Req. = Weight of line
72633>>>>>>>// 7. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>>>// DFSetNumberOfCopies
72633>>>>>>>// 1. Required = Number of copies
72633>>>>>>>//
72633>>>>>>>
72633>>>>>>>
72633>>>>>
72633>>>>>Class cWinReport2 is a BasicReport
72634>>>>>    
72634>>>>>    Procedure Construct_Object
72636>>>>>        Forward Send construct_object
72638>>>>>        
72638>>>>>        Date Today
72638>>>>>        Sysdate Today
72639>>>>>        
72639>>>>>        // should use built in DF function CurrentDateTime()
72639>>>>>        Property Date  RptToday    Today
72640>>>>>        
72640>>>>>        Object RptTotal is an Array
72642>>>>>        End_Object
72643>>>>>        
72643>>>>>        // If true, report is output upon completion. Either preview
72643>>>>>        // or printer depending on output_device_mode
72643>>>>>        Property Boolean AutoOutput_State True
72644>>>>>        
72644>>>>>        // When a new page is created (DFNew_Page) and the number
72644>>>>>        // of columns is not passed, this is used.
72644>>>>>        Property Integer Print_Columns 0
72645>>>>>        
72645>>>>>        // This determines if a DFNew_Page should be executed when the
72645>>>>>        // report starts. In some rare cases, you would not want this to
72645>>>>>        // occur until a subheader
72645>>>>>        Property Boolean AutoNew_Page_State True
72646>>>>>        
72646>>>>>        // Output device (print or preview). Normally this is delegated to
72646>>>>>        // the report view.
72646>>>>>        //
72646>>>>>        
72646>>>>>        Property Integer Private.Output_Device_Mode PRINT_TO_UNDEFINED
72647>>>>>        
72647>>>>>        Property Handle phoWinPrint  ghoWinPrint2 // the report engine to use.
72648>>>>>        
72648>>>>>        // For now this is for testing.
72648>>>>>        Property Boolean pbModalViewer False
72649>>>>>        
72649>>>>>        Property Boolean pbMultiReports False
72650>>>>>        
72650>>>>>        Property Boolean pbFirstPagePrinted False
72651>>>>>        
72651>>>>>    End_Procedure
72652>>>>>    
72652>>>>>    // returns the current status of Winprint Document object. dsNotStarted, dsStarted, dsFinished
72652>>>>>    // note that the status can reflect a status from a different report. The winprint object is global.
72652>>>>>    Function DocumentStatus Returns Boolean
72654>>>>>        Integer iStatus
72654>>>>>        Get DocumentStatus of (phoWinprint(Self)) to iStatus
72655>>>>>        Function_Return iStatus
72656>>>>>    End_Function
72657>>>>>    
72657>>>>>    Function IsViewerActive Returns Boolean
72659>>>>>        Boolean bIsActive
72659>>>>>        Get IsViewerActive of (phoWinPrint(Self)) to bIsActive
72660>>>>>        Function_Return bIsActive
72661>>>>>    End_Function
72662>>>>>    
72662>>>>>    Function IsPrinterValid Returns Boolean
72664>>>>>        Function_Return (WP_IsPrinterValid()<>0)
72665>>>>>    End_Function
72666>>>>>    
72666>>>>>    Function ArePrintersInstalled Returns Boolean
72668>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
72669>>>>>    End_Function
72670>>>>>    
72670>>>>>    
72670>>>>>    // All subtotal commands use the outer main report. This makes it easier to keep
72670>>>>>    // track of these numbers
72670>>>>>    
72670>>>>>    Procedure Add_SubTotal Integer iCounter Number nData
72672>>>>>        Number nValue
72672>>>>>        Integer iObj
72672>>>>>        Move (RptTotal(Main_Report_Id(Self))) to iObj
72673>>>>>        Get Number_Value of iObj iCounter to nValue
72674>>>>>        Add nData to nValue
72675>>>>>        Set Array_Value of iObj iCounter to nValue
72676>>>>>    End_Procedure
72677>>>>>    
72677>>>>>    Procedure Clr_SubTotal Integer iCounter
72679>>>>>        Set Array_Value of (RptTotal(Main_Report_Id(Self))) iCounter to 0
72680>>>>>    End_Procedure
72681>>>>>    
72681>>>>>    Procedure Clr_AllSubTotals
72683>>>>>        Send Delete_Data of (RptTotal(Main_Report_Id(Self)))
72684>>>>>    End_Procedure
72685>>>>>    
72685>>>>>    Function Sum_SubTotal Integer iTotal Returns Number
72687>>>>>        Number nRetVal
72687>>>>>        Get Number_Value of (RptTotal(Main_Report_Id(Self))) iTotal to nRetVal
72688>>>>>        Function_Return nRetVal
72689>>>>>    End_Function
72690>>>>>    
72690>>>>>    //Return sub-total and clear accumulator
72690>>>>>    //
72690>>>>>    Function SubTotal Integer iTotal Returns Number
72692>>>>>        Number nRetVal
72692>>>>>        Get Sum_SubTotal  iTotal to nRetVal
72693>>>>>        Send Clr_SubTotal iTotal
72694>>>>>        Function_Return nRetVal
72695>>>>>    End_Function
72696>>>>>    
72696>>>>>    
72696>>>>>    // Note: Cols is optional. If no argument is passed it will use
72696>>>>>    //       the object's property Print_Columns (0 by default)
72696>>>>>    //
72696>>>>>    Procedure DFNew_Page Integer Cols
72698>>>>>        Integer PageNumber Columns
72698>>>>>        Boolean bFirstPagePrinted
72698>>>>>        // If no args passed used default setting
72698>>>>>        If (Num_Arguments=0) ;            Move (Print_Columns(Main_Report_id(Self))) to Columns
72701>>>>>        Else ;            Move Cols to Columns
72703>>>>>        Set Page_Feed   to -2   // No FormFeed
72704>>>>>        If (Child_Rpt_State(Self)) ;            Send DFNew_Page of (Main_Report_Id(Self)) Columns
72707>>>>>        Else Begin
72708>>>>>            // we only want to print report_header once. When report starts
72708>>>>>            // this is set true, after the first print it is false. You can set
72708>>>>>            // this to true before and explicit dfNew_page to force a header
72708>>>>>            Get pbFirstPagePrinted to bFirstPagePrinted
72709>>>>>            Get  DFNewPage of (phoWinPrint(Self)) Columns to PageNumber
72710>>>>>            If (PageNumber<>0) Begin // if 0, it failed
72712>>>>>                Set No_PageCheck_State to True
72713>>>>>                
72713>>>>>                //Top section
72713>>>>>                Send Page_Top
72714>>>>>                If not bFirstPagePrinted ;                    Send Report_Header
72717>>>>>                Send Page_Header
72718>>>>>                Send Page_Title
72719>>>>>                
72719>>>>>                Set New_Page_State to False
72720>>>>>                Set Page_End_State to False
72721>>>>>                Set No_PageCheck_State to False        // No longer Paging
72722>>>>>                Set pbFirstPagePrinted to True
72723>>>>>            End
72723>>>>>>
72723>>>>>        End
72723>>>>>>
72723>>>>>        
72723>>>>>        // Footer section
72723>>>>>        //
72723>>>>>        // DO NOT CHANGE THE ORDER OF BOTTOM SECTIONS !!!!!
72723>>>>>        //
72723>>>>>        
72723>>>>>        Send Page_Bottom
72724>>>>>        
72724>>>>>        // in WinPrint it is not possible to replace Page_Footer
72724>>>>>        // with Report_Footer. If you use Report_Footer you will
72724>>>>>        // have both Page_Footer and Report_Footer
72724>>>>>        //
72724>>>>>        //If LastTime eq 0 Send Page_Footer
72724>>>>>        //else             Send Report_Footer
72724>>>>>        
72724>>>>>        Send Page_Footer
72725>>>>>        Send Page_Total
72726>>>>>    End_Procedure
72727>>>>>    
72727>>>>>    Procedure Ending_Main_Report
72729>>>>>        Boolean bCancel bMultiReports
72729>>>>>        
72729>>>>>        Get Cancelled_state to bCancel
72730>>>>>        Get pbMultiReports to bMultiReports
72731>>>>>        
72731>>>>>        Forward Send Ending_Main_Report
72733>>>>>        
72733>>>>>        If bCancel Begin
72735>>>>>            Send DFEndDocument
72736>>>>>            Send DFClearDoc // this will also close the previewer
72737>>>>>        End
72737>>>>>>
72737>>>>>        Else Begin
72738>>>>>            Send Report_Footer
72739>>>>>            
72739>>>>>            // if multi-reports, we don't do an end of report yet. The programmer must
72739>>>>>            // manually end the report by sending EndMultiReport
72739>>>>>            If (not(bMultiReports)) Begin
72741>>>>>                Send EndWinPrintReport
72742>>>>>            End
72742>>>>>>
72742>>>>>            
72742>>>>>        End
72742>>>>>>
72742>>>>>        
72742>>>>>    End_Procedure
72743>>>>>    
72743>>>>>    // This must get called when you are running multiple reports (pbMultiReport).
72743>>>>>    // Send this when the last report is complete.
72743>>>>>    Procedure EndMultiReport
72745>>>>>        Send EndWinPrintReport
72746>>>>>    End_Procedure
72747>>>>>    
72747>>>>>    
72747>>>>>    Procedure EndWinPrintReport
72749>>>>>        Boolean bAutoOutput
72749>>>>>        Integer iStatus eMode
72749>>>>>        Get DocumentStatus to iStatus
72750>>>>>        If (iStatus<>dsStarted) ;            Procedure_Return
72753>>>>>        
72753>>>>>        // this tells winprint that the report is complete
72753>>>>>        Send DFEndDocument
72754>>>>>        // if auto-output we print or display automatically.
72754>>>>>        // for winprint2, if in preview mode you must do this so the previewer can enter
72754>>>>>        // a modal state (which it may or may not need to do).
72754>>>>>        Get AutoOutput_state to bAutoOutput
72755>>>>>        Get Output_device_mode to eMode
72756>>>>>        If (bAutoOutput or eMode=PRINT_TO_WINDOW) Begin
72758>>>>>            Send PrintReport
72759>>>>>            // if auto output, we assume that you are done when it is all over
72759>>>>>            // we only can do this with the modal viewer
72759>>>>>            If (bAutoOutput and pbModalViewer(Self)) Begin
72761>>>>>                Send DFClearDoc
72762>>>>>            End
72762>>>>>>
72762>>>>>        End
72762>>>>>>
72762>>>>>        
72762>>>>>    End_Procedure
72763>>>>>    
72763>>>>>    
72763>>>>>    Function Setup_Report Returns Integer
72765>>>>>        Integer iErr iStatus eMode
72765>>>>>        Boolean bActiveViewer bChildReport bMultiReports bOk
72765>>>>>        
72765>>>>>        Get Child_rpt_state to bChildReport
72766>>>>>        
72766>>>>>        If not bChildReport Begin
72768>>>>>            
72768>>>>>            // This makes sure that we are pointing to the new winprint2 engine object.
72768>>>>>            // normally this will be the new winprint, but it can be redirected
72768>>>>>            Get phoWinPrint to WinPrintID
72769>>>>>            
72769>>>>>            // winprint must have installed printer. If not installed, generate error and stop the report
72769>>>>>            Get ArePrintersInstalled to bOk
72770>>>>>            If not bOk Begin
72772>>>>>                Error DFERR_WINPRINT C_$NoInstalledPrinters
72773>>>>>>
72773>>>>>                Function_Return 1
72774>>>>>            End
72774>>>>>>
72774>>>>>            
72774>>>>>            // check if selected printer is valid. If not, generate error and stop the report
72774>>>>>            Get IsPrinterValid to bOk
72775>>>>>            If not bOk Begin
72777>>>>>                Error DFERR_WINPRINT DFPrintError936    // Could not select a valid printer
72778>>>>>>
72778>>>>>                Function_Return 1
72779>>>>>            End
72779>>>>>>
72779>>>>>            
72779>>>>>            // make sure it is ok to start a new report but try to be smart about it.
72779>>>>>            // if a report is active (dsstarted or dsFinished) check to see if it is
72779>>>>>            // finished w/ no viewer. If so, assume the user closed the report and is done
72779>>>>>            // so just clear the report. If a viewer is present, declare an error.
72779>>>>>            Get DocumentStatus to iStatus
72780>>>>>            Get pbMultiReports to bMultiReports
72781>>>>>            // multi-report only in-progress is multi and it is started
72781>>>>>            Move (bMultiReports and iStatus=dsStarted) to bMultiReports
72782>>>>>            If not bMultiReports Begin
72784>>>>>                If (iStatus<>dsNotStarted) Begin
72786>>>>>                    Get IsViewerActive to bActiveViewer
72787>>>>>                    If (iStatus=dsFinished and not(bActiveViewer)) Begin
72789>>>>>                        Send DfClearDoc
72790>>>>>                    End
72790>>>>>>
72790>>>>>                    Else Begin
72791>>>>>                        Error DFERR_WINPRINT DFPrintError967
72792>>>>>>
72792>>>>>                        Function_Return 1
72793>>>>>                    End
72793>>>>>>
72793>>>>>                End
72793>>>>>>
72793>>>>>                
72793>>>>>                // all new reports by default allow printing from viewer and they have the print job set up when you select print
72793>>>>>                // if you need to change these defaults, you can change these inside of Starting_main_report
72793>>>>>                // We only do this with non-multi-reports.
72793>>>>>                Send DFSetPrintDlgInPreview      True
72794>>>>>                Send DFSetEnablePrintFromPreview True
72795>>>>>                
72795>>>>>            End
72795>>>>>>
72795>>>>>            
72795>>>>>            // In the new winprint, this message is not needed and is a stub. For
72795>>>>>            // now it is in here for compatibility purposes
72795>>>>>            //You MUST always start a new report with this procedure
72795>>>>>            Send DFZeroCounters of (phoWinPrint(Self))
72796>>>>>            Send Clr_AllSubTotals
72797>>>>>            
72797>>>>>        End
72797>>>>>>
72797>>>>>        
72797>>>>>        Forward Get Setup_report to iErr
72799>>>>>        
72799>>>>>        If (iErr=0) Begin
72801>>>>>            If not bChildReport Begin
72803>>>>>                // if part of a multi-report we don't do a new doc
72803>>>>>                If not bMultiReports Begin
72805>>>>>                    Get Output_Device_Mode to eMode
72806>>>>>                    Send DFNewDoc of (phoWinPrint(Self))  (eMode = PRINT_TO_WINDOW) // pass True of display while printing
72807>>>>>                End
72807>>>>>>
72807>>>>>                // Do new page if not part of a multi-report and we say don't do a new page
72807>>>>>                If (not(bMultiReports) or AutoNew_Page_State(Self)) Begin
72809>>>>>                    Set pbFirstPagePrinted to False // tells new page that this is the first time for this report
72810>>>>>                    Send DFNew_page
72811>>>>>                End
72811>>>>>>
72811>>>>>            End
72811>>>>>>
72811>>>>>        End
72811>>>>>>
72811>>>>>        Function_Return iErr
72812>>>>>    End_Function
72813>>>>>    
72813>>>>>    
72813>>>>>    
72813>>>>>    // Cancel RO behavior - there is no device to close
72813>>>>>    //
72813>>>>>    Procedure Close_Output_Device
72815>>>>>    End_Procedure
72816>>>>>    
72816>>>>>    // Cancel RO Behavior
72816>>>>>    //
72816>>>>>    Procedure Initialize_Output_Device
72818>>>>>    End_Procedure
72819>>>>>    
72819>>>>>    
72819>>>>>    Function Output_Device_Mode Returns Integer
72821>>>>>        Integer hoId
72821>>>>>        String DevMode
72821>>>>>        Get Private.Output_Device_Mode to DevMode
72822>>>>>        If (DevMode=PRINT_TO_UNDEFINED) Begin
72824>>>>>            Get Report_View_Id to hoId
72825>>>>>            If hoID ;                Get OutPut_Device_Mode of hoID to DevMode
72828>>>>>            If (DevMode=PRINT_TO_UNDEFINED) ;                Move PRINT_TO_WINDOW to DevMode
72831>>>>>        End
72831>>>>>>
72831>>>>>        Function_Return DevMode
72832>>>>>    End_Function
72833>>>>>    
72833>>>>>    Procedure Set Output_Device_Mode Integer DevMode
72835>>>>>        Set Private.Output_Device_Mode to DevMode
72836>>>>>    End_Procedure
72837>>>>>    
72837>>>>>    // displays a metric ruler in .5 increments. This can be
72837>>>>>    // sent to make it easy to see how fields and labels should
72837>>>>>    // be moved for alignment.
72837>>>>>    //
72837>>>>>    Procedure ShowRuler
72839>>>>>        Integer i
72839>>>>>        Number n
72839>>>>>        For i from 0 to 30
72845>>>>>>
72845>>>>>            Send DFWritePos of (phoWinPrint(Self)) (String(i)) FONT_DEFAULT i -1 0
72846>>>>>            Move (i+.5) to n
72847>>>>>            Send DFWritePos of (phoWinPrint(Self)) "." FONT_DEFAULT n -1 0
72848>>>>>        Loop
72849>>>>>>
72849>>>>>        Send DFWriteLn of (phoWinPrint(Self)) ''  FONT_DEFAULT FONT_DEFAULT -1
72850>>>>>    End_Procedure
72851>>>>>    
72851>>>>>    // status panel related agumentations to handle the auto-previewer
72851>>>>>    
72851>>>>>    Procedure Update_Status String sVal
72853>>>>>        Integer eMode
72853>>>>>        Get Output_device_mode to eMode
72854>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72856>>>>>            Send SetProgressCaption  of (phoWinPrint(Self)) sVal
72857>>>>>        End
72857>>>>>>
72857>>>>>        Else Begin
72858>>>>>            Forward Send Update_Status sVal
72860>>>>>        End
72860>>>>>>
72860>>>>>    End_Procedure
72861>>>>>    
72861>>>>>    Procedure Start_Status
72863>>>>>        Integer eMode
72863>>>>>        String sTitle sCaption
72863>>>>>        Get Output_device_mode to eMode
72864>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72866>>>>>            Get Report_Caption to sCaption
72867>>>>>            Get Report_Title to sTitle
72868>>>>>            If (sTitle<>"" and sCaption<>"") Begin
72870>>>>>                Move ( sCaption- ":" * sTitle) to sTitle
72871>>>>>            End
72871>>>>>>
72871>>>>>            Else Begin
72872>>>>>                Move (sCaption - sTitle) to sTitle
72873>>>>>            End
72873>>>>>>
72873>>>>>            Send SetReportTitle of (phoWinPrint(Self)) sTitle
72874>>>>>        End
72874>>>>>>
72874>>>>>        Else Begin
72875>>>>>            Forward Send Start_status
72877>>>>>        End
72877>>>>>>
72877>>>>>    End_Procedure
72878>>>>>    
72878>>>>>    Procedure Resume_Status
72880>>>>>        Integer eMode
72880>>>>>        Get Output_device_mode to eMode
72881>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72883>>>>>            Send DfPreviewNoWait of (phoWinPrint(Self))
72884>>>>>        End
72884>>>>>>
72884>>>>>        Else Begin
72885>>>>>            Forward Send Resume_Status
72887>>>>>        End
72887>>>>>>
72887>>>>>    End_Procedure
72888>>>>>    
72888>>>>>    Procedure End_Status
72890>>>>>        Integer eMode
72890>>>>>        Get Output_device_mode to eMode
72891>>>>>        If (error_processing_state(Self)) Begin
72893>>>>>            Send DFClosePreview
72894>>>>>        End
72894>>>>>>
72894>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72896>>>>>        End
72896>>>>>>
72896>>>>>        Else Begin
72897>>>>>            Forward Send End_Status
72899>>>>>        End
72899>>>>>>
72899>>>>>    End_Procedure
72900>>>>>    
72900>>>>>    Function Report_Interrupt Returns Integer
72902>>>>>        Integer eStat
72902>>>>>        String sMess
72902>>>>>        Boolean bActiveViewer
72902>>>>>        Get IsViewerActive to bActiveViewer
72903>>>>>        If (Error_Check_State(Self)) Begin
72905>>>>>            Move C_$AnErrorWishToCancel to sMess
72906>>>>>        End
72906>>>>>>
72906>>>>>        Else Begin
72907>>>>>            Move  C_$CancelThisReport to sMess
72908>>>>>        End
72908>>>>>>
72908>>>>>        If bActiveViewer Begin
72910>>>>>            Get PreviewYesNoBox of (phoWinPrint(Self)) C_$ReportInterrupt sMess to eStat
72911>>>>>        End
72911>>>>>>
72911>>>>>        Else Begin
72912>>>>>            Move (YesNo_Box(sMess, C_$ReportInterrupt, MB_DEFBUTTON1)) to eStat
72913>>>>>        End
72913>>>>>>
72913>>>>>        
72913>>>>>        Function_Return (eStat=MBR_YES)
72914>>>>>        
72914>>>>>    End_Function
72915>>>>>    
72915>>>>>    Function Test_KeyPressed Returns Integer
72917>>>>>        Boolean bStop bError bActiveViewer
72917>>>>>        Integer eMode
72917>>>>>        // winreport will do this also, but this makes sure that this gets called
72917>>>>>        // for each body loop -- even if the body loop prints nothing
72917>>>>>        Send PumpMsgQueue of (phoWinPrint(Self)) // permit painting
72918>>>>>        Get IsViewerActive to bActiveViewer
72919>>>>>        Get Output_device_mode to eMode
72920>>>>>        If bActiveViewer Begin
72922>>>>>            Get ViewerWantsToClose of (phoWinPrint(Self)) to bStop
72923>>>>>            Get Error_Check_State to bError
72924>>>>>            If (bStop or bError) Begin
72926>>>>>                Get Report_Interrupt to bStop
72927>>>>>            End
72927>>>>>>
72927>>>>>        End
72927>>>>>>
72927>>>>>        Else Begin
72928>>>>>            Forward Get Test_KeyPressed to bStop
72930>>>>>            If (eMode=PRINT_TO_WINDOW and not(bStop)) Begin
72932>>>>>                Send DfPreviewNoWait
72933>>>>>            End
72933>>>>>>
72933>>>>>        End
72933>>>>>>
72933>>>>>        
72933>>>>>        Function_Return bStop
72934>>>>>    End_Function
72935>>>>>    
72935>>>>>    Procedure OnClosingView
72937>>>>>        Send DFClearDoc
72938>>>>>    End_Procedure
72939>>>>>    
72939>>>>>    
72939>>>>>    // Attempt to make this as intuitive as possible. You cannot invoke this when a
72939>>>>>    // report is active. If a report is not finished, you cannot do this.
72939>>>>>    // If a report is finsihed it may or may not have a viewer present.
72939>>>>>    // If a viewer is not present, we will clear the exising report (making the assumption
72939>>>>>    // that a modeless viewer was closed and the report will not be invoked again). If a viewer
72939>>>>>    // is active, we will pass this through to the winprint object which will show an error
72939>>>>>    
72939>>>>>    Function DFPrintSetupDialog Returns Boolean// invoke printer setup dialog
72941>>>>>        Integer iStatus
72941>>>>>        Boolean bActiveViewer bOk
72941>>>>>        // we must have printers installed for this to work
72941>>>>>        Get ArePrintersInstalled to bOk
72942>>>>>        If not bOk Begin
72944>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
72945>>>>>>
72945>>>>>        End
72945>>>>>>
72945>>>>>        Else Begin
72946>>>>>            Get DocumentStatus to iStatus
72947>>>>>            If (iStatus=dsFinished) Begin
72949>>>>>                Get IsViewerActive to bActiveViewer
72950>>>>>                If not bActiveViewer Begin
72952>>>>>                    Send DfClearDoc
72953>>>>>                End
72953>>>>>>
72953>>>>>            End
72953>>>>>>
72953>>>>>            // the winprint object will generate an error if the status is not dsNotStarted.
72953>>>>>            // we want those errors
72953>>>>>            Get DFPrintSetupDialog of (phoWinPrint(Self)) to bOk
72954>>>>>        End
72954>>>>>>
72954>>>>>        Function_Return bOk
72955>>>>>    End_Function
72956>>>>>    
72956>>>>>    // It is better to use DFPrintSetupDialog which tells you if the dialog was canceled
72956>>>>>    Procedure DFPrintSetup // invoke printer setup dialog
72958>>>>>        Boolean bOk
72958>>>>>        Get DFPrintSetupDialog to bOk
72959>>>>>    End_Procedure
72960>>>>>    
72960>>>>>    Procedure DFClearDoc // clear document, remove viewer
72962>>>>>        Send DFClearDoc of (phoWinPrint(Self))
72963>>>>>    End_Procedure
72964>>>>>    
72964>>>>>    Procedure DFEndDocument // tell winprint that the report is complete
72966>>>>>        Send DfEndDocument of (phoWinPrint(Self))
72967>>>>>    End_Procedure
72968>>>>>    
72968>>>>>    Procedure DFClosePreview //close the previewer, does not clear the document
72970>>>>>        Send DfClosePreview of (phoWinPrint(Self))
72971>>>>>    End_Procedure
72972>>>>>    
72972>>>>>    Procedure DFPrintDialog // popup print job dialog
72974>>>>>        Send DFPrintDialog of (phoWinPrint(Self))
72975>>>>>    End_Procedure
72976>>>>>    
72976>>>>>    Procedure DFPrint // print with printer dialog
72978>>>>>        Send DFPrint of (phoWinPrint(Self))
72979>>>>>    End_Procedure
72980>>>>>    
72980>>>>>    Procedure DFPrintDoc // print without printer dialog
72982>>>>>        Send DFPrintDoc of (phoWinPrint(Self))
72983>>>>>    End_Procedure
72984>>>>>    
72984>>>>>    Procedure DFPreviewWait // invoke previewer in modal mode
72986>>>>>        Send DFPreviewWait of (phoWinPrint(Self))
72987>>>>>    End_Procedure
72988>>>>>    
72988>>>>>    Procedure DFPreviewNoWait // invoke previwer in modeless mode
72990>>>>>        Send DFPreviewNoWait of (phoWinPrint(Self))
72991>>>>>    End_Procedure
72992>>>>>    
72992>>>>>    Procedure DFPreview // invokde previewer based on pbModalViewer property
72994>>>>>        Boolean bModalViewer
72994>>>>>        Get pbModalViewer to bModalViewer
72995>>>>>        If bModalViewer Begin
72997>>>>>            Send DFPreviewWait
72998>>>>>        End
72998>>>>>>
72998>>>>>        Else Begin
72999>>>>>            Send DFPreviewNoWait
73000>>>>>        End
73000>>>>>>
73000>>>>>    End_Procedure
73001>>>>>    
73001>>>>>    // Print report to appropriate device (printer, preview) based
73001>>>>>    // on output_device_mode
73001>>>>>    //
73001>>>>>    Procedure PrintReport
73003>>>>>        Integer eMode
73003>>>>>        Get OutPut_Device_Mode to eMode
73004>>>>>        If ((eMode=PRINT_TO_WINDOW) or (eMode=DEFERRED_PRINT_TO_WINDOW)) Begin
73006>>>>>            Send DFPreview
73007>>>>>        End
73007>>>>>>
73007>>>>>        Else If (eMode=PRINT_TO_PRINTER_NO_DIALOG) Begin
73010>>>>>            Send DFPrintDoc // print, no print job dialog
73011>>>>>        End
73011>>>>>>
73011>>>>>        Else Begin // (eMode=PRINT_TO_PRINTER)
73012>>>>>            Send DFPrint // print with print job dialog
73013>>>>>        End
73013>>>>>>
73013>>>>>    End_Procedure
73014>>>>>    
73014>>>>>    
73014>>>>>    Procedure DFSetPrinterPaper Integer ePaperType
73016>>>>>        Send DFSetPrinterPaper of (phoWinPrint(Self)) ePaperType
73017>>>>>    End_Procedure
73018>>>>>    
73018>>>>>    Function DFGetPrinterPaper Returns Integer //ePaperType
73020>>>>>        Integer ePaperType
73020>>>>>        Get DFGetPrinterPaper of (phoWinPrint(Self)) to ePaperType
73021>>>>>        Function_Return ePaperType
73022>>>>>    End_Function
73023>>>>>    
73023>>>>>    
73023>>>>>    Procedure DFSetPrinterBin Integer eBinType
73025>>>>>        Send DFSetPrinterBin of (phoWinPrint(Self)) eBinType
73026>>>>>    End_Procedure
73027>>>>>    
73027>>>>>    Function DFGetPrinterBin Returns Integer //eBinType
73029>>>>>        Integer eBinType
73029>>>>>        Get DFGetPrinterBin of (phoWinPrint(Self)) to eBinType
73030>>>>>        Function_Return eBinType
73031>>>>>    End_Function
73032>>>>>    
73032>>>>>    
73032>>>>>    Procedure DFSetPrinterResolution Integer eResType
73034>>>>>        Send DFSetPrinterResolution of (phoWinPrint(Self)) eResType
73035>>>>>    End_Procedure
73036>>>>>    
73036>>>>>    Function DFGetPrinterResolution Returns Integer //eResType
73038>>>>>        Boolean eResType
73038>>>>>        Get DFGetPrinterResolution of (phoWinPrint(Self)) to eResType
73039>>>>>        Function_Return eResType
73040>>>>>    End_Function
73041>>>>>    
73041>>>>>    
73041>>>>>    Procedure DFSetLandscape Boolean bIsLandscape
73043>>>>>        Send DFSetLandscape of (phoWinPrint(Self)) bIsLandscape
73044>>>>>    End_Procedure
73045>>>>>    
73045>>>>>    Function DFGetLandscape Returns Boolean // bIsLandscape
73047>>>>>        Boolean bIsLandscape
73047>>>>>        Get DFGetLandscape of (phoWinPrint(Self)) to bIsLandscape
73048>>>>>        Function_Return bIsLandscape
73049>>>>>    End_Function
73050>>>>>    
73050>>>>>    Procedure DFSetMetrics Integer eType
73052>>>>>        Send DFSetMetrics of (phoWinPrint(Self)) eType
73053>>>>>    End_Procedure
73054>>>>>    
73054>>>>>    Function DFGetMetrics Returns Integer
73056>>>>>        Integer eType
73056>>>>>        Get DFGetMetrics of (phoWinPrint(Self)) to eType
73057>>>>>        Function_Return eType
73058>>>>>    End_Function
73059>>>>>    
73059>>>>>    
73059>>>>>    Procedure DFSetPrintDlgInPreview Boolean bShowDialog
73061>>>>>        Set PrintDlgInPreview of (phoWinPrint(Self)) to bShowDialog
73062>>>>>    End_Procedure
73063>>>>>    
73063>>>>>    Function DFGetPrintDlgInPreview Returns Boolean
73065>>>>>        Boolean bShowDialog
73065>>>>>        Get PrintDlgInPreview of (phoWinPrint(Self)) to bShowDialog
73066>>>>>        Function_Return bShowDialog
73067>>>>>    End_Function
73068>>>>>    
73068>>>>>    
73068>>>>>    Procedure DFSetEnablePrintFromPreview Boolean bEnablePrint
73070>>>>>        Set EnablePrintFromPreview of (phoWinPrint(Self)) to bEnablePrint
73071>>>>>    End_Procedure
73072>>>>>    
73072>>>>>    Function DFGetEnablePrintFromPreview Returns Boolean
73074>>>>>        Boolean bEnablePrint
73074>>>>>        Get EnablePrintFromPreview of (phoWinPrint(Self)) to bEnablePrint
73075>>>>>        Function_Return bEnablePrint
73076>>>>>    End_Function
73077>>>>>    
73077>>>>>    
73077>>>>>    
73077>>>>>    Procedure DFSetMargins Number nLeft Number nTop Number nRight Number nBottom
73079>>>>>        Send DFSetMargins of (phoWinPrint(Self)) nLeft nTop nRight nBottom
73080>>>>>    End_Procedure
73081>>>>>    
73081>>>>>    Procedure DFSetTopBottom Number nTop Number nBottom Boolean bAllPages
73083>>>>>        Send DFSetTopBottom of (phoWinPrint(Self)) nTop nBottom bAllPages
73084>>>>>    End_Procedure
73085>>>>>    
73085>>>>>    
73085>>>>>    Procedure DFSetDevice String sPrinterName
73087>>>>>        Send DFSetDevice of (phoWinPrint(Self)) sPrinterName
73088>>>>>    End_Procedure
73089>>>>>    
73089>>>>>    Function DFGetCurrentDevice Returns String // sPrinterName
73091>>>>>        String sPrinterName
73091>>>>>        Get DFGetCurrentDevice of (phoWinPrint(Self)) to sPrinterName
73092>>>>>        Function_Return sPrinterName
73093>>>>>    End_Function
73094>>>>>    
73094>>>>>    
73094>>>>>    Procedure DFSetUserDefinedPapersize Number nLength Number nWidth
73096>>>>>        Send DFSetUserDefinedPapersize of (phoWinPrint(Self)) nLength nWidth
73097>>>>>    End_Procedure
73098>>>>>    
73098>>>>>    Function DFGetUserDefinedLength Returns Number
73100>>>>>        Number nSize
73100>>>>>        Get DFGetUserDefinedLength of (phoWinPrint(Self)) to nSize
73101>>>>>        Function_Return nSize
73102>>>>>    End_Function
73103>>>>>    
73103>>>>>    Function DFGetUserDefinedWidth Returns Number
73105>>>>>        Number nSize
73105>>>>>        Get DFGetUserDefinedWidth of (phoWinPrint(Self)) to nSize
73106>>>>>        Function_Return nSize
73107>>>>>    End_Function
73108>>>>>    
73108>>>>>    
73108>>>>>    Procedure DFSetNumberOfCopies Integer iCopies
73110>>>>>        Send DFSetNumberOfCopies of (phoWinPrint(Self)) iCopies
73111>>>>>    End_Procedure
73112>>>>>    
73112>>>>>    Procedure DFPrinterBinFirstPage Integer eBinType
73114>>>>>        Send DFPrinterBinFirstPage of (phoWinPrint(Self)) eBinType
73115>>>>>    End_Procedure
73116>>>>>    
73116>>>>>    Procedure DFClearPrinter
73118>>>>>        Send DFClearPrinter of (phoWinPrint(Self))
73119>>>>>    End_Procedure
73120>>>>>    
73120>>>>>    Function DFGetDFColor Integer iRed Integer iGreen Integer iBlue Returns Integer
73122>>>>>        Integer iWPColor
73122>>>>>        Get DFGetDFColor of (phoWinPrint(Self)) iRed iGreen iBlue to iWPColor
73123>>>>>        Function_Return iWPColor
73124>>>>>    End_Function
73125>>>>>    
73125>>>>>    Function RGBToWPColor Integer iRgb Returns Integer
73127>>>>>        Integer iWPColor
73127>>>>>        Get RGBToWPColor of (phoWinPrint(Self)) iRGB to iWPColor
73128>>>>>        Function_Return iWPColor
73129>>>>>    End_Function
73130>>>>>    
73130>>>>>    
73130>>>>>End_Class
73131>>>Use Windows.pkg
73131>>>
73131>>>Use cEmployeeDataDictionary.dd
73131>>>Use cLineDataDictionary.dd
73131>>>Use cPageHeaderDataDictionary.dd
73131>>>Use cShoeDataDictionary.dd
73131>>>Use cPageFooterDataDictionary.dd
73131>>>Use MonthCalendarPrompt.dg
73131>>>
73131>>>ACTIVATE_VIEW Activate_oReportView FOR oReportView
73141>>>>
73141>>>Object oReportView is a ReportView
73143>>>    Set Location to 20 59
73144>>>    Set Size to 180 202
73145>>>    Set Label To "ReportView"
73146>>>
73146>>>
73146>>>    Object oEmployee_DD is a cEmployeeDataDictionary
73148>>>    End_Object 
73149>>>
73149>>>    Object oLine_DD is a cLineDataDictionary
73151>>>    End_Object 
73152>>>
73152>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
73154>>>        Set DDO_Server To oEmployee_DD
73155>>>        Set DDO_Server To oLine_DD
73156>>>        Property Date pdStartdate
73158>>>        Property Date pdStopdate
73160>>>
73160>>>        Procedure OnConstrain 
73163>>>            Date dStart dStop
73163>>>
73163>>>            Get pdStartdate To dStart
73164>>>            Get pdStopdate To dStop
73165>>>
73165>>>            Case Begin
73165>>>                Case (dStart <> 0 and dStop <> 0)
73167>>>                    Constrain PageHeader.date between dStart and dStop
73171>>>                    Case Break
73172>>>                Case (dStart <> 0)
73175>>>                    Constrain PageHeader.date GE dStart
73177>>>                    Case Break
73178>>>                Case (dStop <> 0)
73181>>>                    Constrain PageHeader.date LE dStop
73183>>>            Case End
73183>>>        End_Procedure 
73184>>>    End_Object 
73185>>>
73185>>>    Object oShoe_DD is a cShoeDataDictionary
73187>>>        Property Number pnStartprice
73189>>>        Property Number pnStopprice
73191>>>
73191>>>        Procedure OnConstrain 
73194>>>            Number nStart nStop
73194>>>
73194>>>            Get pnStartprice To nStart
73195>>>            Get pnStopprice To nStop
73196>>>
73196>>>            Case Begin
73196>>>                Case (nStart <> 0 and nStop <> 0)
73198>>>                    Constrain Shoe.price between nStart and nStop
73202>>>                    Case Break
73203>>>                Case (nStart <> 0)
73206>>>                    Constrain Shoe.price GE nStart
73208>>>                    Case Break
73209>>>                Case (nStop <> 0)
73212>>>                    Constrain Shoe.price LE nStop
73214>>>            Case End
73214>>>        End_Procedure 
73215>>>    End_Object 
73216>>>
73216>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
73218>>>        Set DDO_Server To oPageHeader_DD
73219>>>        Set DDO_Server To oShoe_DD
73220>>>        Property Number pnStartquantity
73222>>>        Property Number pnStopquantity
73224>>>
73224>>>        Procedure OnConstrain 
73227>>>            Number nStart nStop
73227>>>
73227>>>            Get pnStartquantity To nStart
73228>>>            Get pnStopquantity To nStop
73229>>>
73229>>>            Case Begin
73229>>>                Case (nStart <> 0 and nStop <> 0)
73231>>>                    Constrain PageFooter.quantity between nStart and nStop
73235>>>                    Case Break
73236>>>                Case (nStart <> 0)
73239>>>                    Constrain PageFooter.quantity GE nStart
73241>>>                    Case Break
73242>>>                Case (nStop <> 0)
73245>>>                    Constrain PageFooter.quantity LE nStop
73247>>>            Case End
73247>>>        End_Procedure 
73248>>>    End_Object 
73249>>>
73249>>>    Set Main_DD To oPageFooter_DD
73250>>>
73250>>>
73250>>>
73250>>>    Object odateSelection is a Group
73252>>>        Set Size to 35 179
73253>>>        Set Location to 5 12
73254>>>        Set Label to "Select date"
73255>>>
73255>>>        Object oSelStart is a Form
73257>>>            Set Label to "From:"
73258>>>            Set Size to 12 60
73259>>>            Set Location to 13 30
73260>>>            Set Status_Help to "First value in selection range."
73261>>>            Set Label_Col_Offset to 2
73262>>>            Set Label_Justification_Mode to jMode_Right
73263>>>            Set Form_datatype to mask_date_window
73264>>>            Constrain PageHeader.Date Between "1/1/2020" and "12/31/2022"
73268>>>            Set Prompt_Object to oMonthCalendarPrompt
73269>>>            Set Prompt_Button_Mode to PB_PromptOn
73270>>>            Procedure OnExitObject
73273>>>                Date dDateSelected
73273>>>                
73273>>>                Get File_Field_Current_Value of oPageHeader_DD File_Field PageHeader.Date to dDateSelected
73274>>>                
73274>>>                If (dDateSelected < "1/1/2020" or dDateSelected > "12/31/2022" ) Begin
73276>>>                    Send Info_Box "Date must be between 1/1/2020 and 12/31/2022"
73277>>>                End
73277>>>>
73277>>>            
73277>>>            End_Procedure
73278>>>        End_Object 
73279>>>
73279>>>        Object oSelStop is a Form
73281>>>            Set Label to "To:"
73282>>>            Set Size to 12 60
73283>>>            Set Location to 13 111
73284>>>            Set Status_Help to "Last value in selection range."
73285>>>            Set Label_Col_Offset to 2
73286>>>            Set Label_Justification_Mode to jMode_Right
73287>>>            Set Form_datatype to mask_date_window
73288>>>            Constrain PageHeader.Date Between "1/1/2020" and "12/31/2022"
73292>>>            Set Prompt_Object to oMonthCalendarPrompt
73293>>>            Set Prompt_Button_Mode to PB_PromptOn
73294>>>            Procedure OnExitObject
73297>>>                Date dDateSelected
73297>>>                
73297>>>                Get File_Field_Current_Value of oPageHeader_DD File_Field PageHeader.Date to dDateSelected
73298>>>                
73298>>>                If (dDateSelected < "1/1/2020" or dDateSelected > "12/31/2022" ) Begin
73300>>>                    Send Info_Box "Date must be between 1/1/2020 and 12/31/2022"
73301>>>                End
73301>>>>
73301>>>            
73301>>>            End_Procedure
73302>>>        End_Object 
73303>>>
73303>>>
73303>>>        Function StartValue returns String
73306>>>            string sValue
73306>>>            Get Value of oSelStart to sValue
73307>>>            Function_return sValue
73308>>>        End_Function 
73309>>>
73309>>>        Function StopValue returns String
73312>>>            string sValue
73312>>>            Get Value of oSelStop to sValue
73313>>>            Function_return sValue
73314>>>        End_Function 
73315>>>
73315>>>    End_Object 
73316>>>    Object oquantitySelection is a Group
73318>>>        Set Size to 35 179
73319>>>        Set Location to 45 12
73320>>>        Set Label to "Select quantity"
73321>>>
73321>>>        Object oSelStart is a Form
73323>>>            Set Label to "From:"
73324>>>            Set Size to 12 60
73325>>>            Set Location to 13 30
73326>>>            Set Status_Help to "First value in selection range."
73327>>>            Set Label_Col_Offset to 2
73328>>>            Set Label_Justification_Mode to jMode_Right
73329>>>            Set Form_datatype to 0
73330>>>        End_Object 
73331>>>
73331>>>        Object oSelStop is a Form
73333>>>            Set Label to "To:"
73334>>>            Set Size to 12 60
73335>>>            Set Location to 13 111
73336>>>            Set Status_Help to "Last value in selection range."
73337>>>            Set Label_Col_Offset to 2
73338>>>            Set Label_Justification_Mode to jMode_Right
73339>>>            Set Form_datatype to 0
73340>>>        End_Object 
73341>>>
73341>>>
73341>>>        Function StartValue returns String
73344>>>            string sValue
73344>>>            Get Value of oSelStart to sValue
73345>>>            Function_return sValue
73346>>>        End_Function 
73347>>>
73347>>>        Function StopValue returns String
73350>>>            string sValue
73350>>>            Get Value of oSelStop to sValue
73351>>>            Function_return sValue
73352>>>        End_Function 
73353>>>
73353>>>    End_Object 
73354>>>    Object opriceSelection is a Group
73356>>>        Set Size to 35 179
73357>>>        Set Location to 85 12
73358>>>        Set Label to "Select price"
73359>>>
73359>>>        Object oSelStart is a Form
73361>>>            Set Label to "From:"
73362>>>            Set Size to 12 60
73363>>>            Set Location to 13 30
73364>>>            Set Status_Help to "First value in selection range."
73365>>>            Set Label_Col_Offset to 2
73366>>>            Set Label_Justification_Mode to jMode_Right
73367>>>            Set Form_datatype to 2
73368>>>        End_Object 
73369>>>
73369>>>        Object oSelStop is a Form
73371>>>            Set Label to "To:"
73372>>>            Set Size to 12 60
73373>>>            Set Location to 13 111
73374>>>            Set Status_Help to "Last value in selection range."
73375>>>            Set Label_Col_Offset to 2
73376>>>            Set Label_Justification_Mode to jMode_Right
73377>>>            Set Form_datatype to 2
73378>>>        End_Object 
73379>>>
73379>>>
73379>>>        Function StartValue returns String
73382>>>            string sValue
73382>>>            Get Value of oSelStart to sValue
73383>>>            Function_return sValue
73384>>>        End_Function 
73385>>>
73385>>>        Function StopValue returns String
73388>>>            string sValue
73388>>>            Get Value of oSelStop to sValue
73389>>>            Function_return sValue
73390>>>        End_Function 
73391>>>
73391>>>    End_Object 
73392>>>
73392>>>    Object oPrintTo is a RadioGroup
73394>>>        Set Size to 38 118
73395>>>        Set Location to 130 12
73396>>>        Set Label to "Send Report to"
73397>>>
73397>>>        Object oRadio1 is a Radio
73399>>>            Set Label to "Report Viewer"
73400>>>            Set Size to 10 61
73401>>>            Set Location to 12 6
73402>>>            Set Status_Help to "Prints the report to screen"
73403>>>        End_Object 
73404>>>
73404>>>        Object oRadio2 is a Radio
73406>>>            Set Label to "Printer"
73407>>>            Set Size to 10 42
73408>>>            Set Location to 24 6
73409>>>            Set Status_Help to "Prints the report to printer"
73410>>>        End_Object 
73411>>>
73411>>>
73411>>>        Function IsToPrinter Returns boolean
73414>>>            integer iRadio
73414>>>            Get Current_radio to iRadio
73415>>>            Function_return (iRadio=1)
73416>>>        End_Function 
73417>>>
73417>>>    End_Object 
73418>>>
73418>>>    Object oBtnPrint is a Button
73420>>>        Set Label to "Print"
73421>>>        Set Location to 125 140
73422>>>        Set Status_Help to "Print the Selected report"
73423>>>        Set Default_State to TRUE
73424>>>        Procedure OnClick
73427>>>            Send StartReport
73428>>>        End_Procedure
73429>>>    End_Object 
73430>>>
73430>>>    Object oBtnPrinterSetup is a Button
73432>>>        Set Label to "Printer Setup"
73433>>>        Set Location to 142 140
73434>>>        Set Status_Help to "Set up printer for report"
73435>>>        Procedure OnClick
73438>>>            Send DFPrintSetup of oReport
73439>>>        End_Procedure
73440>>>    End_Object 
73441>>>
73441>>>    Object oBtnCancel is a Button
73443>>>        Set Label to "Cancel"
73444>>>        Set Location to 159 140
73445>>>        Set Status_Help to "Close this Panel"
73446>>>        Procedure OnClick
73449>>>            Send Close_Panel
73450>>>        End_Procedure
73451>>>    End_Object 
73452>>>
73452>>>
73452>>>
73452>>>    Object oReport is a cWinReport2
73454>>>
73454>>>        Set Report_Title to "ReportView"
73455>>>
73455>>>        // Set DDO, Index and breaks for the report
73455>>>        Set Server to oPageFooter_DD
73456>>>        Set Ordering to 6
73457>>>        Report_Breaks PageFooter.page_header_id PageFooter.shoe_id
73472>>>
73472>>>        Function Starting_Main_Report Returns Integer
73475>>>            Boolean bErr
73475>>>            Send DFSetMetrics wpm_cm
73476>>>            Send DFSetmargins 1 1 1 1
73477>>>            //Send DFSetLandscape false // This can be used to force a page orientation
73477>>>            Forward Get Starting_Main_Report to bErr
73479>>>            Function_return bErr
73480>>>        End_Function 
73481>>>
73481>>>        // Page_Top is printed first at the top margin of each page
73481>>>        Procedure Page_Top 
73484>>>            string  sFont
73484>>>            integer iFontSize
73484>>>
73484>>>            Move "arial" to sFont
73485>>>            Move 10 to iFontSize
73486>>>
73486>>>            DFFont sFont
73487>>>            DFFontSize iFontSize
73488>>>            DFBeginHeader DFPageTop
73489>>>                DFHeaderFrame Hdr_NoFrame
73490>>>                DFHeaderPos   Hdr_Left
73491>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
73492>>>            DFEndHeader
73494>>>
73494>>>        End_Procedure 
73495>>>
73495>>>        // Report_Header is printed once in a report after Page_Top
73495>>>        //Procedure Report_Header
73495>>>        //    string  sFont
73495>>>        //    integer iFontSize
73495>>>        //    Move "arial" to sFont
73495>>>        //    Move 10 to iFontSize
73495>>>        //    DFFont sFont
73495>>>        //    DFFontSize iFontSize
73495>>>        //    DFBeginHeader  DFReportHeader
73495>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73495>>>        //        DFHeaderPos    Hdr_Left
73495>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73495>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
73495>>>        //    DFEndHeader
73495>>>        //End_Procedure
73495>>>
73495>>>        Procedure Page_Header 
73498>>>            integer iFill iBorder iStyle
73498>>>            string  sFont sReportTitle
73498>>>            integer iFontSize
73498>>>
73498>>>            Move "arial" to sFont
73499>>>            Move 16 to iFontSize
73500>>>            Move (Font_bold + rgb_White) to iStyle
73501>>>            Move (rgb_dGrey) to iFill
73502>>>            Move (rgb_dGrey) to iBorder
73503>>>            Get Report_Title to sReportTitle
73504>>>
73504>>>            DFFont sFont
73505>>>            DFFontSize iFontSize
73506>>>            DFBeginHeader DFPageHeader
73507>>>                DFHeaderPos   Hdr_Left
73508>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
73509>>>                DFWritelnPos sReportTitle 0.1 iStyle
73510>>>                DFHeaderMargin HM_BottomOuter 0.08
73511>>>            DFEndHeader
73513>>>
73513>>>        End_Procedure 
73514>>>
73514>>>        // Page_Title appears on every page after Page_Header
73514>>>        //Procedure Page_Title
73514>>>        //    string  sFont
73514>>>        //    integer iFontSize
73514>>>        //    Move "arial" to sFont
73514>>>        //    Move 10 to iFontSize
73514>>>        //    DFFont sFont
73514>>>        //    DFFontSize iFontSize
73514>>>        //    DFBeginHeader  DFPageTitle
73514>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73514>>>        //        DFHeaderPos    Hdr_Left
73514>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73514>>>        //        DFWrite     "Page_Title" (Font_Bold+Font_Center)
73514>>>        //    DFEndHeader
73514>>>        //End_Procedure
73514>>>
73514>>>        Procedure SubHeader1 
73517>>>            string  sFont 
73517>>>            integer iFontSize iStyle
73517>>>            integer iFill iBorder iHeaderStyle
73517>>>
73517>>>            Move "arial" to sFont
73518>>>            Move 10 to iFontSize
73519>>>            Move (Font_Bold + rgb_dBlue) to iStyle
73520>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
73521>>>            Move (rgb_dGrey) to iBorder
73522>>>            Get DFGetDFColor 242 242 242 to iFill
73523>>>
73523>>>            DFFont sFont
73524>>>            DFFontSize iFontSize
73525>>>            DFBeginHeader DFSubHeader 1
73526>>>                DFHeaderLineCheck 5
73527>>>                DFHeaderWrap   HDR_Wrap
73528>>>                DFHeaderPos    HDR_Left
73529>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
73530>>>                DFHeaderMargin hm_BottomOuter 0.08
73531>>>                DFHeaderMargin hm_TopInner    0.04
73532>>>                DFHeaderMargin hm_BottomInner 0.04
73533>>>
73533>>>                // display fields to be placed in this sub-header
73533>>>                DFWritePos "id:"                         0.1 iHeaderStyle -1 4.9
73534>>>                DFWritePos PageHeader.id                  5 (iStyle + Font_Right) 0
73535>>>                DFWriteLn
73536>>>                DFWritePos "employee id:"                0.1 iHeaderStyle -1 4.9
73537>>>                DFWritePos PageHeader.employee_id         5 (iStyle + Font_Right) 0
73538>>>                DFWriteLn
73539>>>                DFWritePos "line id:"                    0.1 iHeaderStyle -1 4.9
73540>>>                DFWritePos PageHeader.line_id             5 (iStyle + Font_Right) 0
73541>>>                DFWriteLn
73542>>>                DFWritePos "date:"                       0.1 iHeaderStyle -1 4.9
73543>>>                DFWritePos PageHeader.date                5 iStyle -1
73544>>>                DFWriteLn
73545>>>                DFWritePos "hours:"                      0.1 iHeaderStyle -1 4.9
73546>>>                DFWritePos PageHeader.hours               5 (iStyle + Font_Right) 0
73547>>>                DFWriteLn
73548>>>                DFWritePos "name:"                       0.1 iHeaderStyle -1 4.9
73549>>>                DFWritePos Employee.name                  5 iStyle -1
73550>>>                DFWriteLn
73551>>>
73551>>>            DFEndHeader
73553>>>
73553>>>        End_Procedure 
73554>>>
73554>>>        Procedure SubHeader2 
73557>>>            string  sFont 
73557>>>            integer iFontSize iStyle
73557>>>            integer iFill iBorder iHeaderStyle
73557>>>
73557>>>            Move "arial" to sFont
73558>>>            Move 10 to iFontSize
73559>>>            Move (Font_Bold + rgb_dBlue) to iStyle
73560>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
73561>>>            Move (rgb_dGrey) to iBorder
73562>>>            Get DFGetDFColor 242 242 242 to iFill
73563>>>
73563>>>            DFFont sFont
73564>>>            DFFontSize iFontSize
73565>>>            DFBeginHeader DFSubHeader 2
73566>>>                DFHeaderLineCheck 5
73567>>>                DFHeaderWrap   HDR_Wrap
73568>>>                DFHeaderPos    HDR_Left
73569>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
73570>>>                DFHeaderMargin hm_BottomOuter 0.08
73571>>>                DFHeaderMargin hm_TopInner    0.04
73572>>>                DFHeaderMargin hm_BottomInner 0.04
73573>>>
73573>>>                // display fields to be placed in this sub-header
73573>>>                DFWritePos "id:"                         0.1 iHeaderStyle -1 4.9
73574>>>                DFWritePos Shoe.id                        5 (iStyle + Font_Right) 0
73575>>>                DFWriteLn
73576>>>                DFWritePos "name:"                       0.1 iHeaderStyle -1 4.9
73577>>>                DFWritePos Shoe.name                      5 iStyle -1
73578>>>                DFWriteLn
73579>>>
73579>>>                // write the heading for the body section
73579>>>                DFFontSize 1 // create a very small space on top and below the horizontal bar
73580>>>                DFWriteLn
73581>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
73582>>>                DFWriteLn
73583>>>                DFFontSize iFontSize
73584>>>                DFWritePos "id"                           (0.08 + 0.85) (iHeaderStyle + Font_Right) -1 0.85
73585>>>                DFWritePos "page header id"               (1.01 + 3.58) (iHeaderStyle + Font_Right) -1 3.58
73586>>>                DFWritePos "shoe id"                      (4.67 + 1.79) (iHeaderStyle + Font_Right) -1 1.79
73587>>>                DFWritePos "quantity"                     (6.54 + 2.04) (iHeaderStyle + Font_Right) -1 2.04
73588>>>                DFWritePos "price"                        (8.66 + 2.34) (iHeaderStyle + Font_Right) -1 2.34
73589>>>                DFWriteLn
73590>>>
73590>>>            DFEndHeader
73592>>>
73592>>>        End_Procedure 
73593>>>
73593>>>        Procedure Body 
73596>>>            string  sFont 
73596>>>            integer iFontSize iStyle
73596>>>
73596>>>            Move "arial" to sFont
73597>>>            Move 10 to iFontSize
73598>>>            Move (font_default) to iStyle
73599>>>
73599>>>            DFFont sFont
73600>>>            DFFontSize iFontSize
73601>>>
73601>>>            DFWritePos PageFooter.id                  (0.08 + 0.85) (iStyle + Font_Right) 0 0.85
73602>>>            DFWritePos PageFooter.page_header_id      (1.01 + 3.58) (iStyle + Font_Right) 0 3.58
73603>>>            DFWritePos PageFooter.shoe_id             (4.67 + 1.79) (iStyle + Font_Right) 0 1.79
73604>>>            DFWritePos PageFooter.quantity            (6.54 + 2.04) (iStyle + Font_Right) 0 2.04
73605>>>            DFWritePos Shoe.price                     (8.66 + 2.34) (iStyle + Font_Right) 2 2.34
73606>>>            DFWriteLn
73607>>>
73607>>>        End_Procedure 
73608>>>
73608>>>        // Sub-totals appear at each break
73608>>>        //Procedure SubTotal2
73608>>>        //    string  sFont
73608>>>        //    integer iFontSize
73608>>>        //    Move "arial" to sFont
73608>>>        //    Move 10 to iFontSize
73608>>>        //    DFFont sFont
73608>>>        //    DFFontSize iFontSize
73608>>>        //    DFBeginHeader DFSubTotal
73608>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73608>>>        //        DFHeaderPos    Hdr_Left
73608>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73608>>>        //        DFWrite     "SubTotal2" (Font_Bold+Font_Center)
73608>>>        //    DFEndHeader
73608>>>        //End_Procedure
73608>>>
73608>>>        // Sub-totals appear at each break
73608>>>        //Procedure SubTotal1
73608>>>        //    string  sFont
73608>>>        //    integer iFontSize
73608>>>        //    Move "arial" to sFont
73608>>>        //    Move 10 to iFontSize
73608>>>        //    DFFont sFont
73608>>>        //    DFFontSize iFontSize
73608>>>        //    DFBeginHeader DFSubTotal
73608>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73608>>>        //        DFHeaderPos    Hdr_Left
73608>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73608>>>        //        DFWrite     "SubTotal1" (Font_Bold+Font_Center)
73608>>>        //    DFEndHeader
73608>>>        //End_Procedure
73608>>>
73608>>>        // Totals appear at the end of the report before Report_Footer
73608>>>        //Procedure Total
73608>>>        //    string  sFont
73608>>>        //    integer iFontSize
73608>>>        //    Move "arial" to sFont
73608>>>        //    Move 10 to iFontSize
73608>>>        //    DFFont sFont
73608>>>        //    DFFontSize iFontSize
73608>>>        //    DFBeginHeader  DFTotal
73608>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73608>>>        //        DFHeaderPos    Hdr_Left
73608>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73608>>>        //        DFWrite     "Total" (Font_Bold+Font_Center)
73608>>>        //    DFEndHeader
73608>>>        //End_Procedure
73608>>>
73608>>>        // Report_Footer is printed once on the last page before Page_Footer
73608>>>        //Procedure Report_Footer
73608>>>        //    string  sFont
73608>>>        //    integer iFontSize
73608>>>        //    Move "arial" to sFont
73608>>>        //    Move 10 to iFontSize
73608>>>        //    DFFont sFont
73608>>>        //    DFFontSize iFontSize
73608>>>        //    DFBeginHeader DFReportFooter
73608>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73608>>>        //        DFHeaderPos    Hdr_Left
73608>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73608>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
73608>>>        //    DFEndHeader
73608>>>        //End_Procedure
73608>>>
73608>>>        Procedure Page_Footer 
73611>>>            string sStart sStop sText
73611>>>            string  sFont 
73611>>>            integer iFontSize iStyle
73611>>>
73611>>>            Move "arial" to sFont
73612>>>            Move 10 to iFontSize
73613>>>            Move (font_default) to iStyle
73614>>>
73614>>>            DFFont sFont
73615>>>            DFFontSize iFontSize
73616>>>            DFBeginHeader DFPageFooter
73617>>>                DFHeaderFrame hdr_NoFrame
73618>>>                DFHeaderPos   hdr_Left
73619>>>
73619>>>                Get pdStartdate of oPageHeader_DD to sStart
73620>>>                Get pdStopdate  of oPageHeader_DD to sStop
73621>>>                Get SelectionCriteraDescription "PageHeader.date" sStart sStop to sText
73622>>>                If (sText<>"") begin
73624>>>                    DFWriteLnPos sText 0.1
73625>>>                end
73625>>>>
73625>>>
73625>>>                Get pnStartquantity of oPageFooter_DD to sStart
73626>>>                Get pnStopquantity  of oPageFooter_DD to sStop
73627>>>                Get SelectionCriteraDescription "PageFooter.quantity" sStart sStop to sText
73628>>>                If (sText<>"") begin
73630>>>                    DFWriteLnPos sText 0.1
73631>>>                end
73631>>>>
73631>>>
73631>>>                Get pnStartprice of oShoe_DD to sStart
73632>>>                Get pnStopprice  of oShoe_DD to sStop
73633>>>                Get SelectionCriteraDescription "Shoe.price" sStart sStop to sText
73634>>>                If (sText<>"") begin
73636>>>                    DFWriteLnPos sText 0.1
73637>>>                end
73637>>>>
73637>>>
73637>>>            DFEndHeader
73639>>>        End_Procedure 
73640>>>
73640>>>        // Page_Bottom is printed last at the bottom margin of each page
73640>>>        Procedure Page_Bottom 
73643>>>            string sFont
73643>>>            integer iFontSize iBorder iStyle
73643>>>            DateTime dtDT
73643>>>
73643>>>            Move (CurrentDateTime()) to dtDT
73644>>>
73644>>>            Move "arial" to sFont
73645>>>            Move 10 to iFontSize
73646>>>            Move (font_default) to iStyle
73647>>>            Move (rgb_dGrey) to iBorder
73648>>>
73648>>>            DFFont sFont
73649>>>            DFFontSize iFontSize
73650>>>            DFBeginHeader DFPageBottom
73651>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
73652>>>                DFHeaderPos Hdr_Left
73653>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
73654>>>            DFEndHeader
73656>>>
73656>>>        End_Procedure 
73657>>>
73657>>>        // Returns string with description of selection ranges
73657>>>        // Pass: Selection title, start value and end value. Return: description
73657>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
73660>>>            string sText
73660>>>            If (sStart=""  AND sStop="") ;                function_return ""
73663>>>            If (sStart="0" AND sStop="0") ;                function_return ""
73666>>>            If (sStart<>"" AND sStop<>"") begin
73668>>>                Move ("between" * sStart * "and" * sStop) to sText
73669>>>            end
73669>>>>
73669>>>            Else if (sStart > "") begin
73672>>>                Move ("starting at" * sStart) to sText
73673>>>            end
73673>>>>
73673>>>            Else if (sStop > "") begin
73676>>>                Move ("up to" * sStop) to sText
73677>>>            End
73677>>>>
73677>>>            function_return (sTitle * sText)
73678>>>        End_Function
73679>>>
73679>>>    End_Object 
73680>>>
73680>>>    Procedure StartReport 
73683>>>        Boolean bToPrinter
73683>>>        String sValue
73683>>>        Number nStart nStop
73683>>>        Date dStart dStop
73683>>>
73683>>>        // Set all selection critera properties
73683>>>        Get StartValue of odateSelection to sValue
73684>>>        Set pdStartdate of oPageHeader_DD To sValue
73685>>>
73685>>>        Get StopValue of odateSelection to sValue
73686>>>        Set pdStopdate of oPageHeader_DD To sValue
73687>>>
73687>>>        Get StartValue of oquantitySelection to sValue
73688>>>        Set pnStartquantity of oPageFooter_DD To sValue
73689>>>
73689>>>        Get StopValue of oquantitySelection to sValue
73690>>>        Set pnStopquantity of oPageFooter_DD To sValue
73691>>>
73691>>>        Get StartValue of opriceSelection to sValue
73692>>>        Set pnStartprice of oShoe_DD To sValue
73693>>>
73693>>>        Get StopValue of opriceSelection to sValue
73694>>>        Set pnStopprice of oShoe_DD To sValue
73695>>>
73695>>>
73695>>>        // determine if direct print
73695>>>        Get IsToPrinter of oPrintTo to bToPrinter
73696>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
73697>>>
73697>>>        // run the report
73697>>>        Send Run_Report of oReport
73698>>>
73698>>>    End_Procedure 
73699>>>
73699>>>End_Object 
73700>        Use PageFooterEntry4.vw
Including file: PageFooterEntry4.vw    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageFooterEntry4.vw)
73700>>>// C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\PageFooterEntry4.vw
73700>>>// PageFooterEntry4
73700>>>//
73700>>>
73700>>>Use DFClient.pkg
73700>>>Use DFEntry.pkg
73700>>>Use cDbCJGrid.pkg
73700>>>Use cDbCJGridColumn.pkg
73700>>>
73700>>>Use cEmployeeDataDictionary.dd
73700>>>Use cLineDataDictionary.dd
73700>>>Use cPageHeaderDataDictionary.dd
73700>>>Use cShoeDataDictionary.dd
73700>>>Use cPageFooterDataDictionary.dd
73700>>>
73700>>>ACTIVATE_VIEW Activate_oPageFooterEntry4 FOR oPageFooterEntry4
73710>>>>
73710>>>Object oPageFooterEntry4 is a dbView
73712>>>    Set Location to 5 5
73713>>>    Set Size to 112 200
73714>>>    Set Label To "PageFooterEntry4"
73715>>>    Set Border_Style to Border_Thick
73716>>>
73716>>>
73716>>>    Object oEmployee_DD is a cEmployeeDataDictionary
73718>>>    End_Object 
73719>>>
73719>>>    Object oLine_DD is a cLineDataDictionary
73721>>>    End_Object 
73722>>>
73722>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
73724>>>        Set DDO_Server To oEmployee_DD
73725>>>        Set DDO_Server To oLine_DD
73726>>>        // this lets you save a new parent DD from within child DD
73726>>>        Set Allow_Foreign_New_Save_State to True
73727>>>    End_Object 
73728>>>
73728>>>    Object oShoe_DD is a cShoeDataDictionary
73730>>>    End_Object 
73731>>>
73731>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
73733>>>        Set DDO_Server To oPageHeader_DD
73734>>>        Set DDO_Server To oShoe_DD
73735>>>        Set Constrain_File To PageHeader.File_Number
73736>>>    End_Object 
73737>>>
73737>>>    Set Main_DD To oPageHeader_DD
73738>>>    Set Server  To oPageHeader_DD
73739>>>
73739>>>
73739>>>
73739>>>    Object oPageHeaderid is a dbForm
73741>>>        Entry_Item PageHeader.id
73742>>>        Set Size to 12 34
73743>>>        Set Location to 5 21
73744>>>        Set peAnchors to anTopLeftRight
73745>>>        Set Label to "id"
73746>>>        Set Label_Justification_mode to jMode_Left
73747>>>        Set Label_Col_Offset to 16
73748>>>        Set Label_row_Offset to 0
73749>>>    End_Object 
73750>>>
73750>>>    Object oEmployeeid is a dbForm
73752>>>        Entry_Item Employee.id
73753>>>        Set Size to 12 34
73754>>>        Set Location to 5 101
73755>>>        Set peAnchors to anTopRight
73756>>>        Set Label to "employee id"
73757>>>        Set Label_Justification_mode to jMode_Left
73758>>>        Set Label_Col_Offset to 41
73759>>>        Set Label_row_Offset to 0
73760>>>    End_Object 
73761>>>
73761>>>    Object oLineid is a dbForm
73763>>>        Entry_Item Line.id
73764>>>        Set Size to 12 34
73765>>>        Set Location to 5 161
73766>>>        Set peAnchors to anTopRight
73767>>>        Set Label to "line id"
73768>>>        Set Label_Justification_mode to jMode_Left
73769>>>        Set Label_Col_Offset to 21
73770>>>        Set Label_row_Offset to 0
73771>>>    End_Object 
73772>>>
73772>>>    Object oPageHeaderdate is a dbForm
73774>>>        Entry_Item PageHeader.date
73775>>>        Set Size to 12 66
73776>>>        Set Location to 19 21
73777>>>        Set peAnchors to anTopLeftRight
73778>>>        Set Label to "date"
73779>>>        Set Label_Justification_mode to jMode_Left
73780>>>        Set Label_Col_Offset to 16
73781>>>        Set Label_row_Offset to 0
73782>>>    End_Object 
73783>>>
73783>>>    Object oPageHeaderhours is a dbForm
73785>>>        Entry_Item PageHeader.hours
73786>>>        Set Size to 12 34
73787>>>        Set Location to 19 112
73788>>>        Set peAnchors to anTopRight
73789>>>        Set Label to "hours"
73790>>>        Set Label_Justification_mode to jMode_Left
73791>>>        Set Label_Col_Offset to 20
73792>>>        Set Label_row_Offset to 0
73793>>>    End_Object 
73794>>>
73794>>>    Object oDetailGrid is a cDbCJGrid
73796>>>        Set Size to 66 148
73797>>>        Set Location to 41 5
73798>>>        Set Server to oPageFooter_DD
73799>>>        Set Ordering to 2
73800>>>        Set peAnchors to anAll
73801>>>        Set psLayoutSection to "oPageFooterEntry4_oDetailGrid"
73802>>>        Set pbAllowInsertRow to False
73803>>>        Set pbHeaderPrompts to True
73804>>>
73804>>>        Object oShoe_id is a cDbCJGridColumn
73806>>>            Entry_Item Shoe.id
73807>>>            Set piWidth to 60
73808>>>            Set psCaption to "shoe id"
73809>>>        End_Object 
73810>>>
73810>>>        Object oShoe_price is a cDbCJGridColumn
73812>>>            Entry_Item Shoe.price
73813>>>            Set piWidth to 110
73814>>>            Set psCaption to "price"
73815>>>        End_Object 
73816>>>
73816>>>        Object oPageFooter_quantity is a cDbCJGridColumn
73818>>>            Entry_Item PageFooter.quantity
73819>>>            Set piWidth to 60
73820>>>            Set psCaption to "quantity"
73821>>>        End_Object 
73822>>>
73822>>>    End_Object 
73823>>>
73823>>>    //-----------------------------------------------------------------------
73823>>>    // Create custom confirmation messages for save and delete
73823>>>    // We must create the new functions and assign verify messages
73823>>>    // to them.
73823>>>    //-----------------------------------------------------------------------
73823>>>
73823>>>    Function ConfirmDeleteHeader Returns Boolean
73826>>>        Boolean bFail
73826>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
73827>>>        Function_Return bFail
73828>>>    End_Function 
73829>>>
73829>>>    // Only confirm on the saving of new records
73829>>>    Function ConfirmSaveHeader Returns Boolean
73832>>>        Boolean bNoSave bHasRecord
73832>>>        Handle  hoSrvr
73832>>>        Get Server to hoSrvr
73833>>>        Get HasRecord of hoSrvr to bHasRecord
73834>>>        If not bHasRecord Begin
73836>>>            Get Confirm "Save this NEW header?" to bNoSave
73837>>>        End
73837>>>>
73837>>>        Function_Return bNoSave
73838>>>    End_Function 
73839>>>
73839>>>    // Define alternate confirmation Messages
73839>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
73840>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
73841>>>    // Saves in header should not clear the view
73841>>>    Set Auto_Clear_Deo_State to False
73842>>>
73842>>>
73842>>>End_Object 
73843>        Use ReportView2.rv
Including file: ReportView2.rv    (C:\Users\szerg\Documents\jubilant-octo-umbrella\AppSrc\ReportView2.rv)
73843>>>// ReportView2.rv
73843>>>// ReportView2
73843>>>Register_Object oReport
73843>>>
73843>>>Use DFRptVw.pkg
73843>>>Use cWinReport2.pkg
73843>>>Use Windows.pkg
73843>>>
73843>>>Use cEmployeeDataDictionary.dd
73843>>>Use cLineDataDictionary.dd
73843>>>Use cPageHeaderDataDictionary.dd
73843>>>Use cShoeDataDictionary.dd
73843>>>Use cPageFooterDataDictionary.dd
73843>>>
73843>>>ACTIVATE_VIEW Activate_oReportView2 FOR oReportView2
73853>>>>
73853>>>Object oReportView2 is a ReportView
73855>>>    Set Location to 6 6
73856>>>    Set Size to 180 202
73857>>>    Set Label To "ReportView2"
73858>>>
73858>>>
73858>>>    Object oEmployee_DD is a cEmployeeDataDictionary
73860>>>    End_Object 
73861>>>
73861>>>    Object oLine_DD is a cLineDataDictionary
73863>>>    End_Object 
73864>>>
73864>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
73866>>>        Set DDO_Server To oEmployee_DD
73867>>>        Set DDO_Server To oLine_DD
73868>>>        Property Date pdStartdate
73870>>>        Property Date pdStopdate
73872>>>
73872>>>        Procedure OnConstrain 
73875>>>            Date dStart dStop
73875>>>
73875>>>            Get pdStartdate To dStart
73876>>>            Get pdStopdate To dStop
73877>>>
73877>>>            Case Begin
73877>>>                Case (dStart <> 0 and dStop <> 0)
73879>>>                    Constrain PageHeader.date between dStart and dStop
73883>>>                    Case Break
73884>>>                Case (dStart <> 0)
73887>>>                    Constrain PageHeader.date GE dStart
73889>>>                    Case Break
73890>>>                Case (dStop <> 0)
73893>>>                    Constrain PageHeader.date LE dStop
73895>>>            Case End
73895>>>        End_Procedure 
73896>>>    End_Object 
73897>>>
73897>>>    Object oShoe_DD is a cShoeDataDictionary
73899>>>    End_Object 
73900>>>
73900>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
73902>>>        Set DDO_Server To oPageHeader_DD
73903>>>        Set DDO_Server To oShoe_DD
73904>>>        Property Number pnStartprice
73906>>>        Property Number pnStopprice
73908>>>        Property Number pnStartquantity
73910>>>        Property Number pnStopquantity
73912>>>
73912>>>        Procedure OnConstrain 
73915>>>            Number nStart nStop
73915>>>
73915>>>            Get pnStartprice To nStart
73916>>>            Get pnStopprice To nStop
73917>>>
73917>>>            Case Begin
73917>>>                Case (nStart <> 0 and nStop <> 0)
73919>>>                    Constrain PageFooter.price between nStart and nStop
73923>>>                    Case Break
73924>>>                Case (nStart <> 0)
73927>>>                    Constrain PageFooter.price GE nStart
73929>>>                    Case Break
73930>>>                Case (nStop <> 0)
73933>>>                    Constrain PageFooter.price LE nStop
73935>>>            Case End
73935>>>
73935>>>            Get pnStartquantity To nStart
73936>>>            Get pnStopquantity To nStop
73937>>>
73937>>>            Case Begin
73937>>>                Case (nStart <> 0 and nStop <> 0)
73939>>>                    Constrain PageFooter.quantity between nStart and nStop
73943>>>                    Case Break
73944>>>                Case (nStart <> 0)
73947>>>                    Constrain PageFooter.quantity GE nStart
73949>>>                    Case Break
73950>>>                Case (nStop <> 0)
73953>>>                    Constrain PageFooter.quantity LE nStop
73955>>>            Case End
73955>>>        End_Procedure 
73956>>>    End_Object 
73957>>>
73957>>>    Set Main_DD To oPageFooter_DD
73958>>>
73958>>>
73958>>>
73958>>>    Object odateSelection is a Group
73960>>>        Set Size to 35 179
73961>>>        Set Location to 5 12
73962>>>        Set Label to "Select date"
73963>>>
73963>>>        Object oSelStart is a Form
73965>>>            Set Label to "From:"
73966>>>            Set Size to 12 60
73967>>>            Set Location to 13 30
73968>>>            Set Status_Help to "First value in selection range."
73969>>>            Set Label_Col_Offset to 2
73970>>>            Set Label_Justification_Mode to jMode_Right
73971>>>            Set Form_datatype to mask_date_window
73972>>>        End_Object 
73973>>>
73973>>>        Object oSelStop is a Form
73975>>>            Set Label to "To:"
73976>>>            Set Size to 12 60
73977>>>            Set Location to 13 111
73978>>>            Set Status_Help to "Last value in selection range."
73979>>>            Set Label_Col_Offset to 2
73980>>>            Set Label_Justification_Mode to jMode_Right
73981>>>            Set Form_datatype to mask_date_window
73982>>>        End_Object 
73983>>>
73983>>>
73983>>>        Function StartValue returns String
73986>>>            string sValue
73986>>>            Get Value of oSelStart to sValue
73987>>>            Function_return sValue
73988>>>        End_Function 
73989>>>
73989>>>        Function StopValue returns String
73992>>>            string sValue
73992>>>            Get Value of oSelStop to sValue
73993>>>            Function_return sValue
73994>>>        End_Function 
73995>>>
73995>>>    End_Object 
73996>>>    Object opriceSelection is a Group
73998>>>        Set Size to 35 179
73999>>>        Set Location to 45 12
74000>>>        Set Label to "Select price"
74001>>>
74001>>>        Object oSelStart is a Form
74003>>>            Set Label to "From:"
74004>>>            Set Size to 12 60
74005>>>            Set Location to 13 30
74006>>>            Set Status_Help to "First value in selection range."
74007>>>            Set Label_Col_Offset to 2
74008>>>            Set Label_Justification_Mode to jMode_Right
74009>>>            Set Form_datatype to 2
74010>>>        End_Object 
74011>>>
74011>>>        Object oSelStop is a Form
74013>>>            Set Label to "To:"
74014>>>            Set Size to 12 60
74015>>>            Set Location to 13 111
74016>>>            Set Status_Help to "Last value in selection range."
74017>>>            Set Label_Col_Offset to 2
74018>>>            Set Label_Justification_Mode to jMode_Right
74019>>>            Set Form_datatype to 2
74020>>>        End_Object 
74021>>>
74021>>>
74021>>>        Function StartValue returns String
74024>>>            string sValue
74024>>>            Get Value of oSelStart to sValue
74025>>>            Function_return sValue
74026>>>        End_Function 
74027>>>
74027>>>        Function StopValue returns String
74030>>>            string sValue
74030>>>            Get Value of oSelStop to sValue
74031>>>            Function_return sValue
74032>>>        End_Function 
74033>>>
74033>>>    End_Object 
74034>>>    Object oquantitySelection is a Group
74036>>>        Set Size to 35 179
74037>>>        Set Location to 85 12
74038>>>        Set Label to "Select quantity"
74039>>>
74039>>>        Object oSelStart is a Form
74041>>>            Set Label to "From:"
74042>>>            Set Size to 12 60
74043>>>            Set Location to 13 30
74044>>>            Set Status_Help to "First value in selection range."
74045>>>            Set Label_Col_Offset to 2
74046>>>            Set Label_Justification_Mode to jMode_Right
74047>>>            Set Form_datatype to 0
74048>>>        End_Object 
74049>>>
74049>>>        Object oSelStop is a Form
74051>>>            Set Label to "To:"
74052>>>            Set Size to 12 60
74053>>>            Set Location to 13 111
74054>>>            Set Status_Help to "Last value in selection range."
74055>>>            Set Label_Col_Offset to 2
74056>>>            Set Label_Justification_Mode to jMode_Right
74057>>>            Set Form_datatype to 0
74058>>>        End_Object 
74059>>>
74059>>>
74059>>>        Function StartValue returns String
74062>>>            string sValue
74062>>>            Get Value of oSelStart to sValue
74063>>>            Function_return sValue
74064>>>        End_Function 
74065>>>
74065>>>        Function StopValue returns String
74068>>>            string sValue
74068>>>            Get Value of oSelStop to sValue
74069>>>            Function_return sValue
74070>>>        End_Function 
74071>>>
74071>>>    End_Object 
74072>>>
74072>>>    Object oPrintTo is a RadioGroup
74074>>>        Set Size to 38 118
74075>>>        Set Location to 130 12
74076>>>        Set Label to "Send Report to"
74077>>>
74077>>>        Object oRadio1 is a Radio
74079>>>            Set Label to "Report Viewer"
74080>>>            Set Size to 10 61
74081>>>            Set Location to 12 6
74082>>>            Set Status_Help to "Prints the report to screen"
74083>>>        End_Object 
74084>>>
74084>>>        Object oRadio2 is a Radio
74086>>>            Set Label to "Printer"
74087>>>            Set Size to 10 42
74088>>>            Set Location to 24 6
74089>>>            Set Status_Help to "Prints the report to printer"
74090>>>        End_Object 
74091>>>
74091>>>
74091>>>        Function IsToPrinter Returns boolean
74094>>>            integer iRadio
74094>>>            Get Current_radio to iRadio
74095>>>            Function_return (iRadio=1)
74096>>>        End_Function 
74097>>>
74097>>>    End_Object 
74098>>>
74098>>>    Object oBtnPrint is a Button
74100>>>        Set Label to "Print"
74101>>>        Set Location to 125 140
74102>>>        Set Status_Help to "Print the Selected report"
74103>>>        Set Default_State to TRUE
74104>>>        Procedure OnClick
74107>>>            Send StartReport
74108>>>        End_Procedure
74109>>>    End_Object 
74110>>>
74110>>>    Object oBtnPrinterSetup is a Button
74112>>>        Set Label to "Printer Setup"
74113>>>        Set Location to 142 140
74114>>>        Set Status_Help to "Set up printer for report"
74115>>>        Procedure OnClick
74118>>>            Send DFPrintSetup of oReport
74119>>>        End_Procedure
74120>>>    End_Object 
74121>>>
74121>>>    Object oBtnCancel is a Button
74123>>>        Set Label to "Cancel"
74124>>>        Set Location to 159 140
74125>>>        Set Status_Help to "Close this Panel"
74126>>>        Procedure OnClick
74129>>>            Send Close_Panel
74130>>>        End_Procedure
74131>>>    End_Object 
74132>>>
74132>>>
74132>>>
74132>>>    Object oReport is a cWinReport2
74134>>>
74134>>>        Set Report_Title to "ReportView2"
74135>>>
74135>>>        // Set DDO, Index and breaks for the report
74135>>>        Set Server to oPageFooter_DD
74136>>>        Set Ordering to 6
74137>>>        Report_Breaks PageFooter.page_header_id PageFooter.shoe_id
74152>>>
74152>>>        Function Starting_Main_Report Returns Integer
74155>>>            Boolean bErr
74155>>>            Send DFSetMetrics wpm_cm
74156>>>            Send DFSetmargins 1 1 1 1
74157>>>            //Send DFSetLandscape false // This can be used to force a page orientation
74157>>>            Forward Get Starting_Main_Report to bErr
74159>>>            Function_return bErr
74160>>>        End_Function 
74161>>>
74161>>>        // Page_Top is printed first at the top margin of each page
74161>>>        Procedure Page_Top 
74164>>>            string  sFont
74164>>>            integer iFontSize
74164>>>
74164>>>            Move "Times New Roman" to sFont
74165>>>            Move 10 to iFontSize
74166>>>
74166>>>            DFFont sFont
74167>>>            DFFontSize iFontSize
74168>>>            DFBeginHeader DFPageTop
74169>>>                DFHeaderFrame Hdr_NoFrame
74170>>>                DFHeaderPos   Hdr_Left
74171>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
74172>>>            DFEndHeader
74174>>>
74174>>>        End_Procedure 
74175>>>
74175>>>        // Report_Header is printed once in a report after Page_Top
74175>>>        //Procedure Report_Header
74175>>>        //    string  sFont
74175>>>        //    integer iFontSize
74175>>>        //    Move "Times New Roman" to sFont
74175>>>        //    Move 10 to iFontSize
74175>>>        //    DFFont sFont
74175>>>        //    DFFontSize iFontSize
74175>>>        //    DFBeginHeader  DFReportHeader
74175>>>        //        DFHeaderFrame  Hdr_Margins 0.01
74175>>>        //        DFHeaderPos    Hdr_Left
74175>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
74175>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
74175>>>        //    DFEndHeader
74175>>>        //End_Procedure
74175>>>
74175>>>        Procedure Page_Header 
74178>>>            integer iFill iBorder iStyle
74178>>>            string  sFont sReportTitle
74178>>>            integer iFontSize
74178>>>
74178>>>            Move "Times New Roman" to sFont
74179>>>            Move 16 to iFontSize
74180>>>            Move (Font_bold + rgb_White) to iStyle
74181>>>            Move (rgb_dGrey) to iFill
74182>>>            Move (rgb_dGrey) to iBorder
74183>>>            Get Report_Title to sReportTitle
74184>>>
74184>>>            DFFont sFont
74185>>>            DFFontSize iFontSize
74186>>>            DFBeginHeader DFPageHeader
74187>>>                DFHeaderPos   Hdr_Left
74188>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
74189>>>                DFWritelnPos sReportTitle 0.1 iStyle
74190>>>                DFHeaderMargin HM_BottomOuter 0.08
74191>>>            DFEndHeader
74193>>>
74193>>>        End_Procedure 
74194>>>
74194>>>        // Page_Title appears on every page after Page_Header
74194>>>        //Procedure Page_Title
74194>>>        //    string  sFont
74194>>>        //    integer iFontSize
74194>>>        //    Move "Times New Roman" to sFont
74194>>>        //    Move 10 to iFontSize
74194>>>        //    DFFont sFont
74194>>>        //    DFFontSize iFontSize
74194>>>        //    DFBeginHeader  DFPageTitle
74194>>>        //        DFHeaderFrame  Hdr_Margins 0.01
74194>>>        //        DFHeaderPos    Hdr_Left
74194>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
74194>>>        //        DFWrite     "Page_Title" (Font_Bold+Font_Center)
74194>>>        //    DFEndHeader
74194>>>        //End_Procedure
74194>>>
74194>>>        Procedure SubHeader1 
74197>>>            string  sFont 
74197>>>            integer iFontSize iStyle
74197>>>            integer iFill iBorder iHeaderStyle
74197>>>
74197>>>            Move "Times New Roman" to sFont
74198>>>            Move 10 to iFontSize
74199>>>            Move (Font_Bold + rgb_dBlue) to iStyle
74200>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
74201>>>            Move (rgb_dGrey) to iBorder
74202>>>            Get DFGetDFColor 242 242 242 to iFill
74203>>>
74203>>>            DFFont sFont
74204>>>            DFFontSize iFontSize
74205>>>            DFBeginHeader DFSubHeader 1
74206>>>                DFHeaderLineCheck 5
74207>>>                DFHeaderWrap   HDR_Wrap
74208>>>                DFHeaderPos    HDR_Left
74209>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
74210>>>                DFHeaderMargin hm_BottomOuter 0.08
74211>>>                DFHeaderMargin hm_TopInner    0.04
74212>>>                DFHeaderMargin hm_BottomInner 0.04
74213>>>
74213>>>                // display fields to be placed in this sub-header
74213>>>                DFWritePos "Header:"                         0.1 iHeaderStyle -1 4.9
74214>>>                DFWritePos PageHeader.id                  5 (iStyle + Font_Right) 0
74215>>>                DFWriteLn
74216>>>                DFWritePos "Date:"                       0.1 iHeaderStyle -1 4.9
74217>>>                DFWritePos PageHeader.date                5 iStyle -1
74218>>>                DFWriteLn
74219>>>                DFWritePos "Hours:"                      0.1 iHeaderStyle -1 4.9
74220>>>                DFWritePos PageHeader.hours               5 (iStyle + Font_Right) 0
74221>>>                DFWriteLn
74222>>>                DFWritePos "Line Type:"                       0.1 iHeaderStyle -1 4.9
74223>>>                DFWritePos Line.type                      5 iStyle -1
74224>>>                DFWriteLn
74225>>>                DFWritePos "Name:"                       0.1 iHeaderStyle -1 4.9
74226>>>                DFWritePos Employee.name                  5 iStyle -1
74227>>>                DFWriteLn
74228>>>
74228>>>            DFEndHeader
74230>>>
74230>>>        End_Procedure 
74231>>>
74231>>>        Procedure SubHeader2 
74234>>>            string  sFont 
74234>>>            integer iFontSize iStyle
74234>>>            integer iFill iBorder iHeaderStyle
74234>>>
74234>>>            Move "Times New Roman" to sFont
74235>>>            Move 10 to iFontSize
74236>>>            Move (Font_Bold + rgb_dBlue) to iStyle
74237>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
74238>>>            Move (rgb_dGrey) to iBorder
74239>>>            Get DFGetDFColor 242 242 242 to iFill
74240>>>
74240>>>            DFFont sFont
74241>>>            DFFontSize iFontSize
74242>>>            DFBeginHeader DFSubHeader 2
74243>>>                DFHeaderLineCheck 5
74244>>>                DFHeaderWrap   HDR_Wrap
74245>>>                DFHeaderPos    HDR_Left
74246>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
74247>>>                DFHeaderMargin hm_BottomOuter 0.08
74248>>>                DFHeaderMargin hm_TopInner    0.04
74249>>>                DFHeaderMargin hm_BottomInner 0.04
74250>>>
74250>>>                // display fields to be placed in this sub-header
74250>>>                DFWritePos "Shoe:"                       0.1 iHeaderStyle -1 4.9
74251>>>                DFWritePos Shoe.name                      5 iStyle -1
74252>>>                DFWriteLn
74253>>>
74253>>>                // write the heading for the body section
74253>>>                DFFontSize 1 // create a very small space on top and below the horizontal bar
74254>>>                DFWriteLn
74255>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
74256>>>                DFWriteLn
74257>>>                DFFontSize iFontSize
74258>>>                DFWritePos "Id"                           (0.08 + 0.85) (iHeaderStyle + Font_Right) -1 0.85
74259>>>                DFWritePos "Shoe Id"                      (1.01 + 1.79) (iHeaderStyle + Font_Right) -1 1.79
74260>>>                DFWritePos "Price"                        (2.88 + 2.34) (iHeaderStyle + Font_Right) -1 2.34
74261>>>                DFWritePos "Quantity"                     (5.3 + 2.04) (iHeaderStyle + Font_Right) -1 2.04
74262>>>                DFWriteLn
74263>>>
74263>>>            DFEndHeader
74265>>>
74265>>>        End_Procedure 
74266>>>        
74266>>>        //sum quantity
74266>>>        Number nCount
74266>>>
74266>>>        Procedure Body 
74269>>>            string  sFont 
74269>>>            integer iFontSize iStyle
74269>>>
74269>>>            Move "Times New Roman" to sFont
74270>>>            Move 10 to iFontSize
74271>>>            Move (font_default) to iStyle
74272>>>
74272>>>            DFFont sFont
74273>>>            DFFontSize iFontSize
74274>>>
74274>>>            DFWritePos PageFooter.id                  (0.08 + 0.85) (iStyle + Font_Right) 0 0.85
74275>>>            DFWritePos PageFooter.shoe_id             (1.01 + 1.79) (iStyle + Font_Right) 0 1.79
74276>>>            DFWritePos PageFooter.price               (2.88 + 2.34) (iStyle + Font_Right) 2 2.34
74277>>>            DFWritePos PageFooter.quantity            (5.3 + 2.04) (iStyle + Font_Right) 0 2.04
74278>>>            Move (PageFooter.quantity) to nCount
74279>>>            DFWriteLn
74280>>>
74280>>>        End_Procedure 
74281>>>
74281>>>        // Sub-totals appear at each break
74281>>>        //Procedure SubTotal2
74281>>>        //    string  sFont
74281>>>        //    integer iFontSize
74281>>>        //    Move "Times New Roman" to sFont
74281>>>        //    Move 10 to iFontSize
74281>>>        //    DFFont sFont
74281>>>        //    DFFontSize iFontSize
74281>>>        //    DFBeginHeader DFSubTotal
74281>>>        //        DFHeaderFrame  Hdr_Margins 0.01
74281>>>        //        DFHeaderPos    Hdr_Left
74281>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
74281>>>        //        DFWrite     "SubTotal2" (Font_Bold+Font_Center)
74281>>>        //    DFEndHeader
74281>>>        //End_Procedure
74281>>>
74281>>>        // Sub-totals appear at each break
74281>>>        //Procedure SubTotal1
74281>>>        //    string  sFont
74281>>>        //    integer iFontSize
74281>>>        //    Move "Times New Roman" to sFont
74281>>>        //    Move 10 to iFontSize
74281>>>        //    DFFont sFont
74281>>>        //    DFFontSize iFontSize
74281>>>        //    DFBeginHeader DFSubTotal
74281>>>        //        DFHeaderFrame  Hdr_Margins 0.01
74281>>>        //        DFHeaderPos    Hdr_Left
74281>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
74281>>>        //        DFWrite     "SubTotal1" (Font_Bold+Font_Center)
74281>>>        //    DFEndHeader
74281>>>        //End_Procedure
74281>>>
74281>>>        // Totals appear at the end of the report before Report_Footer
74281>>>        //Procedure Total
74281>>>        //    string  sFont
74281>>>        //    integer iFontSize
74281>>>        //    Move "Times New Roman" to sFont
74281>>>        //    Move 10 to iFontSize
74281>>>        //    DFFont sFont
74281>>>        //    DFFontSize iFontSize
74281>>>        //    DFBeginHeader  DFTotal
74281>>>        //        DFHeaderFrame  Hdr_Margins 0.01
74281>>>        //        DFHeaderPos    Hdr_Left
74281>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
74281>>>        //        DFWrite     "Total" (Font_Bold+Font_Center)
74281>>>        //    DFEndHeader
74281>>>        //End_Procedure
74281>>>
74281>>>        // Report_Footer is printed once on the last page before Page_Footer
74281>>>        //Procedure Report_Footer
74281>>>        //    string  sFont
74281>>>        //    integer iFontSize
74281>>>        //    Move "Times New Roman" to sFont
74281>>>        //    Move 10 to iFontSize
74281>>>        //    DFFont sFont
74281>>>        //    DFFontSize iFontSize
74281>>>        //    DFBeginHeader DFReportFooter
74281>>>        //        DFHeaderFrame  Hdr_Margins 0.01
74281>>>        //        DFHeaderPos    Hdr_Left
74281>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
74281>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
74281>>>        //    DFEndHeader
74281>>>        //End_Procedure
74281>>>
74281>>>        Procedure Page_Footer 
74284>>>            string sStart sStop sText
74284>>>            string  sFont 
74284>>>            integer iFontSize iStyle
74284>>>
74284>>>            Move "Times New Roman" to sFont
74285>>>            Move 10 to iFontSize
74286>>>            Move (font_default) to iStyle
74287>>>
74287>>>            DFFont sFont
74288>>>            DFFontSize iFontSize
74289>>>            DFBeginHeader DFPageFooter
74290>>>                DFHeaderFrame hdr_NoFrame
74291>>>                DFHeaderPos   hdr_Left
74292>>>
74292>>>                Get pdStartdate of oPageHeader_DD to sStart
74293>>>                Get pdStopdate  of oPageHeader_DD to sStop
74294>>>                Get SelectionCriteraDescription "PageHeader.date" sStart sStop to sText
74295>>>                If (sText<>"") begin
74297>>>                    DFWriteLnPos sText 0.1
74298>>>                end
74298>>>>
74298>>>
74298>>>                Get pnStartprice of oPageFooter_DD to sStart
74299>>>                Get pnStopprice  of oPageFooter_DD to sStop
74300>>>                Get SelectionCriteraDescription "PageFooter.price" sStart sStop to sText
74301>>>                If (sText<>"") begin
74303>>>                    DFWriteLnPos sText 0.1
74304>>>                end
74304>>>>
74304>>>
74304>>>                Get pnStartquantity of oPageFooter_DD to sStart
74305>>>                Get pnStopquantity  of oPageFooter_DD to sStop
74306>>>                Get SelectionCriteraDescription "PageFooter.quantity" sStart sStop to sText
74307>>>                If (sText<>"") begin
74309>>>                    DFWriteLnPos sText 0.1
74310>>>                end
74310>>>>
74310>>>
74310>>>            DFEndHeader
74312>>>        End_Procedure 
74313>>>
74313>>>        // Page_Bottom is printed last at the bottom margin of each page
74313>>>        Procedure Page_Bottom 
74316>>>            string sFont
74316>>>            integer iFontSize iBorder iStyle
74316>>>            DateTime dtDT
74316>>>
74316>>>            Move (CurrentDateTime()) to dtDT
74317>>>
74317>>>            Move "Times New Roman" to sFont
74318>>>            Move 10 to iFontSize
74319>>>            Move (font_default) to iStyle
74320>>>            Move (rgb_dGrey) to iBorder
74321>>>
74321>>>            DFFont sFont
74322>>>            DFFontSize iFontSize
74323>>>            DFBeginHeader DFPageBottom
74324>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
74325>>>                DFHeaderPos Hdr_Left
74326>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
74327>>>            DFEndHeader
74329>>>
74329>>>        End_Procedure 
74330>>>
74330>>>        // Returns string with description of selection ranges
74330>>>        // Pass: Selection title, start value and end value. Return: description
74330>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
74333>>>            string sText
74333>>>            If (sStart=""  AND sStop="") ;                function_return ""
74336>>>            If (sStart="0" AND sStop="0") ;                function_return ""
74339>>>            If (sStart<>"" AND sStop<>"") begin
74341>>>                Move ("between" * sStart * "and" * sStop) to sText
74342>>>            end
74342>>>>
74342>>>            Else if (sStart > "") begin
74345>>>                Move ("starting at" * sStart) to sText
74346>>>            end
74346>>>>
74346>>>            Else if (sStop > "") begin
74349>>>                Move ("up to" * sStop) to sText
74350>>>            End
74350>>>>
74350>>>            function_return (sTitle * sText)
74351>>>        End_Function
74352>>>
74352>>>    End_Object 
74353>>>
74353>>>    Procedure StartReport 
74356>>>        Boolean bToPrinter
74356>>>        String sValue
74356>>>        Number nStart nStop
74356>>>        Date dStart dStop
74356>>>
74356>>>        // Set all selection critera properties
74356>>>        Get StartValue of odateSelection to sValue
74357>>>        Set pdStartdate of oPageHeader_DD To sValue
74358>>>
74358>>>        Get StopValue of odateSelection to sValue
74359>>>        Set pdStopdate of oPageHeader_DD To sValue
74360>>>
74360>>>        Get StartValue of opriceSelection to sValue
74361>>>        Set pnStartprice of oPageFooter_DD To sValue
74362>>>
74362>>>        Get StopValue of opriceSelection to sValue
74363>>>        Set pnStopprice of oPageFooter_DD To sValue
74364>>>
74364>>>        Get StartValue of oquantitySelection to sValue
74365>>>        Set pnStartquantity of oPageFooter_DD To sValue
74366>>>
74366>>>        Get StopValue of oquantitySelection to sValue
74367>>>        Set pnStopquantity of oPageFooter_DD To sValue
74368>>>
74368>>>
74368>>>        // determine if direct print
74368>>>        Get IsToPrinter of oPrintTo to bToPrinter
74369>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
74370>>>
74370>>>        // run the report
74370>>>        Send Run_Report of oReport
74371>>>
74371>>>    End_Procedure 
74372>>>
74372>>>End_Object 
74373>
74373>        Procedure Activate_About
74376>            Send DoAbout "" "" "" "" ""
74377>        End_Procedure
74378>
74378>    End_Object
74379>
74379>End_Object
74380>
74380>Start_UI
74381>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 42700
Total Resources: 0
Total Commands : 74380
Total Windows  : 0
Total Pages    : 0
Static Data    : 435571
Message area   : 539230
Total Blocks   : 26857
