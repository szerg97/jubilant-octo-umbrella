Compiling Program: C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\Application.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 19.1\Pkg\dfallent.pkd)
67438>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJStandardCommandBarSystem.pkg)
67438>>>// these are all the packages used in a standard MDI menubar/toolbar system
67438>>>
67438>>>Use cCJCommandBarSystem.pkg
67438>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJStandardMenuItemClasses.pkg)
67438>>>>>Use Dfpanel.pkg
67438>>>>>Use cCJCommandBarSystem.pkg
67438>>>>>Use LanguageText.pkg
67438>>>>>
67438>>>>>
67438>>>>>Class cCJUndoMenuItem is a cCJMenuItem
67439>>>>>    
67439>>>>>    Procedure Construct_Object
67441>>>>>        Forward Send Construct_Object
67443>>>>>        Set psCaption   to C_$CaptionUndo
67444>>>>>        Set psToolTip to C_$ToolTipUndo
67445>>>>>        Set psDescription to C_$DescUndo
67446>>>>>        Set psImage to "ActionUndo.ico"
67447>>>>>        Set pbActiveUpdate to True
67448>>>>>        Set psCategory to C_$CategoryEdit
67449>>>>>        Set psShortcut to C_$Key_Ctrl_Z
67450>>>>>    End_Procedure
67451>>>>>    
67451>>>>>    Procedure OnExecute Variant vCommandBarControl
67453>>>>>        Send Undo of (focus(Self))
67454>>>>>    End_Procedure
67455>>>>>    
67455>>>>>    Function IsEnabled Returns Boolean
67457>>>>>        Boolean bEnabled
67457>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
67458>>>>>        Function_Return bEnabled
67459>>>>>    End_Function
67460>>>>>    
67460>>>>>End_Class
67461>>>>>
67461>>>>>
67461>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
67462>>>>>    
67462>>>>>    Procedure Construct_Object
67464>>>>>        Forward Send Construct_Object
67466>>>>>        Set psCaption   to C_$CaptionDelete
67467>>>>>        Set psToolTip to C_$ToolTipDelete
67468>>>>>        Set psDescription to C_$DescDelete
67469>>>>>        Set psImage to "actionDelete.ico"
67470>>>>>        Set psShortcut to C_$Key_Delete
67471>>>>>        Set pbActiveUpdate to True
67472>>>>>        Set psCategory to C_$CategoryEdit
67473>>>>>    End_Procedure
67474>>>>>    
67474>>>>>    
67474>>>>>    Procedure OnExecute Variant vCommandBarControl
67476>>>>>        Send Delete of (focus(Self))
67477>>>>>    End_Procedure
67478>>>>>    
67478>>>>>    Function IsEnabled Returns Boolean
67480>>>>>        Boolean bEnabled
67480>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
67481>>>>>        Function_Return bEnabled
67482>>>>>    End_Function
67483>>>>>    
67483>>>>>End_Class
67484>>>>>
67484>>>>>
67484>>>>>Class cCJCutMenuItem is a cCJMenuItem
67485>>>>>    
67485>>>>>    Procedure Construct_Object
67487>>>>>        Forward Send Construct_Object
67489>>>>>        Set psCaption   to C_$CaptionCut
67490>>>>>        Set psToolTip to C_$TooltipCut
67491>>>>>        Set psDescription to C_$DescCut
67492>>>>>        Set psImage to "actionCut.ico"
67493>>>>>        Set psShortcut to C_$Key_Ctrl_X
67494>>>>>        Set pbActiveUpdate to True
67495>>>>>        Set psCategory to C_$CategoryEdit
67496>>>>>    End_Procedure
67497>>>>>    
67497>>>>>    
67497>>>>>    Procedure OnExecute Variant vCommandBarControl
67499>>>>>        Send Cut of (focus(Self))
67500>>>>>    End_Procedure
67501>>>>>    
67501>>>>>    Function IsEnabled Returns Boolean
67503>>>>>        Boolean bEnabled
67503>>>>>        Get CanCut of (Focus(Self)) to bEnabled
67504>>>>>        Function_Return bEnabled
67505>>>>>    End_Function
67506>>>>>    
67506>>>>>End_Class
67507>>>>>
67507>>>>>
67507>>>>>Class cCJCopyMenuItem is a cCJMenuItem
67508>>>>>    
67508>>>>>    Procedure Construct_Object
67510>>>>>        Forward Send Construct_Object
67512>>>>>        Set psCaption   to C_$CaptionCopy
67513>>>>>        Set psToolTip to C_$ToolTipCopy
67514>>>>>        Set psDescription to C_$DescCopy
67515>>>>>        Set psImage to "actionCopy.ico"
67516>>>>>        Set psShortcut to C_$Key_Ctrl_C
67517>>>>>        Set pbActiveUpdate to True
67518>>>>>        Set psCategory to C_$CategoryEdit
67519>>>>>    End_Procedure
67520>>>>>    
67520>>>>>    
67520>>>>>    Procedure OnExecute Variant vCommandBarControl
67522>>>>>        Send Copy of (focus(Self))
67523>>>>>    End_Procedure
67524>>>>>    
67524>>>>>    Function IsEnabled Returns Boolean
67526>>>>>        Boolean bEnabled
67526>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
67527>>>>>        Function_Return bEnabled
67528>>>>>    End_Function
67529>>>>>    
67529>>>>>End_Class
67530>>>>>
67530>>>>>
67530>>>>>Class cCJPasteMenuItem is a cCJMenuItem
67531>>>>>    
67531>>>>>    Procedure Construct_Object
67533>>>>>        Forward Send Construct_Object
67535>>>>>        Set psCaption   to C_$CaptionPaste
67536>>>>>        Set psToolTip to C_$ToolTipPaste
67537>>>>>        Set psDescription to C_$DescPaste
67538>>>>>        Set psImage to "actionPaste.ico"
67539>>>>>        Set pbActiveUpdate to True
67540>>>>>        Set psShortcut to C_$Key_Ctrl_V
67541>>>>>        Set psCategory to C_$CategoryEdit
67542>>>>>    End_Procedure
67543>>>>>    
67543>>>>>    
67543>>>>>    Procedure OnExecute Variant vCommandBarControl
67545>>>>>        Send Paste of (focus(Self))
67546>>>>>    End_Procedure
67547>>>>>    
67547>>>>>    Function IsEnabled Returns Boolean
67549>>>>>        Boolean bEnabled
67549>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
67550>>>>>        Function_Return bEnabled
67551>>>>>    End_Function
67552>>>>>    
67552>>>>>End_Class
67553>>>>>
67553>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
67554>>>>>    
67554>>>>>    Procedure Construct_Object
67556>>>>>        Forward Send Construct_Object
67558>>>>>        Set psCaption   to C_$CaptionSelectAll
67559>>>>>        Set psToolTip to C_$ToolTipSelectAll
67560>>>>>        Set psDescription to C_$DescSelectAll
67561>>>>>        Set pbActiveUpdate to True
67562>>>>>        Set psShortcut to C_$Key_Ctrl_A
67563>>>>>        Set psCategory to C_$CategoryEdit
67564>>>>>    End_Procedure
67565>>>>>    
67565>>>>>    
67565>>>>>    Procedure OnExecute Variant vCommandBarControl
67567>>>>>        Send Select_All of (focus(Self))
67568>>>>>    End_Procedure
67569>>>>>    
67569>>>>>    Function IsEnabled Returns Boolean
67571>>>>>        Boolean bEnabled
67571>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
67572>>>>>        Function_Return bEnabled
67573>>>>>    End_Function
67574>>>>>    
67574>>>>>End_Class
67575>>>>>
67575>>>>>
67575>>>>>Class cCJExitMenuItem is a cCJMenuItem
67576>>>>>    
67576>>>>>    Procedure Construct_Object
67578>>>>>        Forward Send Construct_Object
67580>>>>>        Set psCaption to C_$CaptionExit
67581>>>>>        Set psToolTip to C_$ToolTipExit
67582>>>>>        Set psDescription to C_$ToolTipExit
67583>>>>>        Set psShortcut to C_$Key_Alt_F4
67584>>>>>        Set psCategory to C_$CategoryFile
67585>>>>>    End_Procedure
67586>>>>>    
67586>>>>>    Procedure OnExecute Variant vCommandBarControl
67588>>>>>        Send Exit_Application of Desktop
67589>>>>>    End_Procedure
67590>>>>>    
67590>>>>>End_Class
67591>>>>>
67591>>>>>Class cCJHelpMenuItem is a cCJMenuItem
67592>>>>>    
67592>>>>>    Procedure Construct_Object
67594>>>>>        Forward Send Construct_Object
67596>>>>>        Set psCaption to C_$CaptionHelp
67597>>>>>        Set psDescription to C_$ToolTipHelp
67598>>>>>        Set psToolTip to C_$DescHelp
67599>>>>>        Set psImage to "ActionHelp.ico"
67600>>>>>        Set psShortcut to "F1"
67601>>>>>        Set psCategory to C_$CategoryHelp
67602>>>>>    End_Procedure
67603>>>>>    
67603>>>>>    Procedure OnExecute Variant vCommandBarControl
67605>>>>>        Send Help of (Focus(Self))
67606>>>>>    End_Procedure
67607>>>>>    
67607>>>>>End_Class
67608>>>>>
67608>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
67609>>>>>    
67609>>>>>    Procedure Construct_Object
67611>>>>>        Forward Send Construct_Object
67613>>>>>        Set psCaption to C_$CaptionAddStatusbar
67614>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
67615>>>>>        Set psDescription to  C_$DescAddStatusbar
67616>>>>>        Set psCategory to C_$CategoryWindow
67617>>>>>    End_Procedure
67618>>>>>    
67618>>>>>    Procedure OnExecute Variant vCommandBarControl
67620>>>>>        Handle hoCommandBars hoClientArea
67620>>>>>        Get CommandBarSystemObject to hoCommandBars
67621>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67622>>>>>        If hoClientArea Begin
67624>>>>>            // the clientarea's parent panel has message
67624>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
67625>>>>>        End
67625>>>>>>
67625>>>>>    End_Procedure
67626>>>>>    
67626>>>>>    Function IsChecked Returns Boolean
67628>>>>>        Boolean bOn
67628>>>>>        Handle hoCommandBars hoClientArea
67628>>>>>        Get CommandBarSystemObject to hoCommandBars
67629>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67630>>>>>        If hoClientArea Begin
67632>>>>>            // the clientarea's parent panel has message
67632>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
67633>>>>>        End
67633>>>>>>
67633>>>>>        Function_Return bOn
67634>>>>>    End_Function
67635>>>>>End_Class
67636>>>>>
67636>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
67637>>>>>    
67637>>>>>    Procedure Construct_Object
67639>>>>>        Forward Send Construct_Object
67641>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
67642>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
67643>>>>>        Set psDescription to C_$DescAutoArrangeIcons
67644>>>>>        Set psCategory to C_$CategoryWindow
67645>>>>>    End_Procedure
67646>>>>>    
67646>>>>>    Procedure OnExecute Variant vCommandBarControl
67648>>>>>        Handle hoCommandBars hoClientArea
67648>>>>>        Get CommandBarSystemObject to hoCommandBars
67649>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67650>>>>>        If hoClientArea Begin
67652>>>>>            // the clientarea's parent panel has message
67652>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
67653>>>>>        End
67653>>>>>>
67653>>>>>    End_Procedure
67654>>>>>    
67654>>>>>    Function IsChecked Returns Boolean
67656>>>>>        Boolean bOn
67656>>>>>        Handle hoCommandBars hoClientArea
67656>>>>>        Get CommandBarSystemObject to hoCommandBars
67657>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67658>>>>>        If hoClientArea Begin
67660>>>>>            // the clientarea's parent panel has message
67660>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
67661>>>>>        End
67661>>>>>>
67661>>>>>        Function_Return bOn
67662>>>>>    End_Function
67663>>>>>End_Class
67664>>>>>
67664>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
67665>>>>>    
67665>>>>>    Procedure Construct_Object
67667>>>>>        Forward Send Construct_Object
67669>>>>>        Set psCaption to C_$CaptionRestoreMenus
67670>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
67671>>>>>        Set psDescription to C_$DescRestoreMenus
67672>>>>>        Set psCategory to C_$CategoryWindow
67673>>>>>    End_Procedure
67674>>>>>    
67674>>>>>    Procedure OnExecute Variant vCommandBarControl
67676>>>>>        Handle hoCommandBars
67676>>>>>        Get CommandBarSystemObject to hoCommandBars
67677>>>>>        Send RestoreLayout of hoCommandBars
67678>>>>>    End_Procedure
67679>>>>>    
67679>>>>>End_Class
67680>>>>>
67680>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
67681>>>>>    
67681>>>>>    Procedure Construct_Object
67683>>>>>        Forward Send Construct_Object
67685>>>>>        Set psCaption to C_$CaptionCascade
67686>>>>>        Set psToolTip to C_$ToolTipCascade
67687>>>>>        Set psDescription to  C_$DescCascade
67688>>>>>        Set psImage to "ActionCascade.ico"
67689>>>>>        Set psCategory to C_$CategoryWindow
67690>>>>>    End_Procedure
67691>>>>>    
67691>>>>>    Procedure OnExecute Variant vCommandBarControl
67693>>>>>        Handle hoCommandBars hoClientArea
67693>>>>>        Get CommandBarSystemObject to hoCommandBars
67694>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67695>>>>>        If hoClientArea Begin
67697>>>>>            Send Cascade_Windows of hoClientArea
67698>>>>>        End
67698>>>>>>
67698>>>>>    End_Procedure
67699>>>>>End_Class
67700>>>>>
67700>>>>>Class cCJTileHorizontally is a cCJMenuItem
67701>>>>>    
67701>>>>>    Procedure Construct_Object
67703>>>>>        Forward Send Construct_Object
67705>>>>>        Set psCaption to C_$CaptionTileHorizontally
67706>>>>>        Set psToolTip to C_$ToolTipTileHorizontally
67707>>>>>        Set psDescription to  C_$DescTileHorizontally
67708>>>>>        Set psImage to "ActionTileHorizontally.ico"
67709>>>>>        Set psCategory to C_$CategoryWindow
67710>>>>>    End_Procedure
67711>>>>>    
67711>>>>>    Procedure OnExecute Variant vCommandBarControl
67713>>>>>        Handle hoCommandBars hoClientArea
67713>>>>>        Get CommandBarSystemObject to hoCommandBars
67714>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67715>>>>>        If hoClientArea Begin
67717>>>>>            Send Tile_Windows_Horizontal of hoClientArea
67718>>>>>        End
67718>>>>>>
67718>>>>>    End_Procedure
67719>>>>>End_Class
67720>>>>>
67720>>>>>Class cCJTileVertically is a cCJMenuItem
67721>>>>>    
67721>>>>>    Procedure Construct_Object
67723>>>>>        Forward Send Construct_Object
67725>>>>>        Set psCaption to C_$CaptionTileVertically
67726>>>>>        Set psToolTip to C_$ToolTipTileVertically
67727>>>>>        Set psDescription to  C_$DescTileVertically
67728>>>>>        Set psImage to "ActionTileVertically.ico"
67729>>>>>        Set psCategory to C_$CategoryWindow
67730>>>>>    End_Procedure
67731>>>>>    
67731>>>>>    Procedure OnExecute Variant vCommandBarControl
67733>>>>>        Handle hoCommandBars hoClientArea
67733>>>>>        Get CommandBarSystemObject to hoCommandBars
67734>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67735>>>>>        If hoClientArea Begin
67737>>>>>            Send Tile_Windows_Vertical of hoClientArea
67738>>>>>        End
67738>>>>>>
67738>>>>>    End_Procedure
67739>>>>>End_Class
67740>>>>>
67740>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
67741>>>>>    
67741>>>>>    Procedure Construct_Object
67743>>>>>        Forward Send Construct_Object
67745>>>>>        Set psCaption to C_$CaptionMinimizeWindows
67746>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
67747>>>>>        Set psDescription to  C_$DescMinimizeWindows
67748>>>>>        Set psCategory to C_$CategoryWindow
67749>>>>>    End_Procedure
67750>>>>>    
67750>>>>>    Procedure OnExecute Variant vCommandBarControl
67752>>>>>        Handle hoCommandBars hoClientArea
67752>>>>>        Get CommandBarSystemObject to hoCommandBars
67753>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67754>>>>>        If hoClientArea Begin
67756>>>>>            // the clientarea's parent panel has message
67756>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
67757>>>>>        End
67757>>>>>>
67757>>>>>    End_Procedure
67758>>>>>End_Class
67759>>>>>
67759>>>>>
67759>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
67760>>>>>    
67760>>>>>    Procedure Construct_Object
67762>>>>>        Forward Send Construct_Object
67764>>>>>        Set psCaption to C_$CaptionRestoreWindows
67765>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
67766>>>>>        Set psDescription to  C_$DescRestoreWindows
67767>>>>>        Set psCategory to C_$CategoryWindow
67768>>>>>    End_Procedure
67769>>>>>    
67769>>>>>    Procedure OnExecute Variant vCommandBarControl
67771>>>>>        Handle hoCommandBars hoClientArea
67771>>>>>        Get CommandBarSystemObject to hoCommandBars
67772>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67773>>>>>        If hoClientArea Begin
67775>>>>>            // the clientarea's parent panel has message
67775>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
67776>>>>>        End
67776>>>>>>
67776>>>>>    End_Procedure
67777>>>>>End_Class
67778>>>>>
67778>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
67779>>>>>    
67779>>>>>    Procedure Construct_Object
67781>>>>>        Forward Send Construct_Object
67783>>>>>        Set psCaption to C_$CaptionArrangeIcons
67784>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
67785>>>>>        Set psDescription to  C_$DescArrangeIcons
67786>>>>>        Set psCategory to C_$CategoryWindow
67787>>>>>    End_Procedure
67788>>>>>    
67788>>>>>    Procedure OnExecute Variant vCommandBarControl
67790>>>>>        Handle hoCommandBars hoClientArea
67790>>>>>        Get CommandBarSystemObject to hoCommandBars
67791>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67792>>>>>        If hoClientArea Begin
67794>>>>>            Send Arrange_Icons of hoClientArea
67795>>>>>        End
67795>>>>>>
67795>>>>>    End_Procedure
67796>>>>>    
67796>>>>>End_Class
67797>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJAboutMenuItem.pkg)
67797>>>>>Use cCJCommandBarSystem.pkg
67797>>>>>Use LanguageText.pkg
67797>>>>>
67797>>>>>// It is expected that if you use this class that you provide an about object that is
67797>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
67797>>>>>// because you may wish to create your own custom about package.
67797>>>>>
67797>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
67798>>>>>
67798>>>>>    Procedure Construct_Object
67800>>>>>        Forward Send Construct_Object
67802>>>>>        Set psCaption to C_$CaptionAbout
67803>>>>>        Set psDescription to C_$ToolTipAbout
67804>>>>>        Set psToolTip to C_$DescAbout
67805>>>>>        Set psImage to "ActionAbout.ico"
67806>>>>>        Set psCategory to C_$CategoryHelp
67807>>>>>    End_Procedure
67808>>>>>    
67808>>>>>    Procedure OnExecute Variant vCommandBarControl
67810>>>>>        Handle hoCommandBars hoClientArea
67810>>>>>        Get CommandBarSystemObject to hoCommandBars
67811>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67812>>>>>        If hoClientArea Begin
67814>>>>>            Send Activate_About of hoClientArea
67815>>>>>        End
67815>>>>>>
67815>>>>>    End_Procedure
67816>>>>>
67816>>>>>End_Class
67817>>>>>
67817>>>>>
67817>>>Use cCJDeoMenuItemClasses.pkg
67817>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJMDIWindowsMenuItem.pkg)
67817>>>>>Use cCJCommandBarSystem.pkg
67817>>>>>
67817>>>>>Register_Function Client_ID Returns Integer
67817>>>>>
67817>>>>>// only used by cCJMDIWIndowsMenuItem
67817>>>>>Class cCJMDIWindowItem is a cCJMenuItem
67818>>>>>    
67818>>>>>    Procedure Construct_Object
67820>>>>>        Forward Send Construct_Object
67822>>>>>        Property Handle phWindow 0 // object id of view
67823>>>>>        Set pbControlFlagNoMovable to True
67824>>>>>        Set pbActiveUpdate to True
67825>>>>>    End_Procedure
67826>>>>>    
67826>>>>>    Procedure OnExecute Variant vCommandBarControl
67828>>>>>        Handle hWindow
67828>>>>>        Get phWindow to hWindow
67829>>>>>        Send Activate_View of hWindow
67830>>>>>    End_Procedure
67831>>>>>    
67831>>>>>End_Class
67832>>>>>
67832>>>>>
67832>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
67833>>>>>    
67833>>>>>    Procedure Construct_Object
67835>>>>>        Forward Send Construct_Object
67837>>>>>        Property Handle[] phArrayOfWindows
67838>>>>>        Set peControlType to xtpControlPopup
67839>>>>>        Set psCategory to C_$CategoryWindow
67840>>>>>    End_Procedure
67841>>>>>    
67841>>>>>    // This adds MDI windows to the existing menu items.
67841>>>>>    // This removes any existing windows menus and always adds a new set to the end
67841>>>>>    
67841>>>>>    Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
67843>>>>>        Handle  hClientArea hView
67843>>>>>        String  sLabel
67843>>>>>        Integer i iWindows
67843>>>>>        Handle[] hArrayOfWindows
67844>>>>>        Variant vItem
67844>>>>>        
67844>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
67844>>>>>        // also assume that destroying an action removes all menu instances of that action
67844>>>>>        Get phArrayOfWindows to hArrayOfWindows
67845>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
67846>>>>>        For i from 0 to (iWindows-1)
67852>>>>>>
67852>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
67853>>>>>        Loop
67854>>>>>>
67854>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
67855>>>>>        
67855>>>>>        // Add all views to this menu. Create the action and add the item
67855>>>>>        Move 0 to i
67856>>>>>        Get Client_Id to hClientArea // object id of client area
67857>>>>>        If (hClientArea > 0) Begin
67859>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
67860>>>>>            While (hView <> 0)
67864>>>>>                If (Active_State(hView)) Begin
67866>>>>>                    // create the action
67866>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
67867>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
67868>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
67869>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
67870>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
67872>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
67873>>>>>                    End
67873>>>>>>
67873>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
67874>>>>>                    If (i=0) Begin
67876>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
67877>>>>>                    End
67877>>>>>>
67877>>>>>                    // Create a menu item for this action
67877>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
67878>>>>>                    Increment i
67879>>>>>                End
67879>>>>>>
67879>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
67880>>>>>            Loop
67881>>>>>>
67881>>>>>        End
67881>>>>>>
67881>>>>>        
67881>>>>>        Set phArrayOfWindows to hArrayOfWindows
67882>>>>>        
67882>>>>>    End_Procedure
67883>>>>>    
67883>>>>>End_Class
67884>
67884>Object oHtmlHelp is a cHtmlHelp
67886>End_Object
67887>
67887>Object oApplication is a cApplication
67889>    Set peHelpType to htHtmlHelp
67890>
67890>    Object oConnection is a cConnection
67892>        Use LoginEncryption.pkg
Including file: LoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\LoginEncryption.pkg)
67892>>>Use cLoginEncryption.pkg
Including file: cLoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cLoginEncryption.pkg)
67892>>>>>Use cCryptographer.pkg
Including file: cCryptographer.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCryptographer.pkg)
67892>>>>>>>Use VdfBase.pkg
67892>>>>>>>
67892>>>>>>>Use CryptographerConstants.pkg
Including file: CryptographerConstants.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\CryptographerConstants.pkg)
67892>>>>>>>>>//   Author  : Ulbe Stellema
67892>>>>>>>>>// Algorithm classes
67892>>>>>>>>>Define ALG_CLASS_ANY                    for |CI$00000000 // (0)
67892>>>>>>>>>Define ALG_CLASS_SIGNATURE              for |CI$00002000 // (1 << 13)
67892>>>>>>>>>Define ALG_CLASS_MSG_ENCRYPT            for |CI$00004000 // (2 << 13)
67892>>>>>>>>>Define ALG_CLASS_DATA_ENCRYPT           for |CI$00006000 // (3 << 13)
67892>>>>>>>>>Define ALG_CLASS_HASH                   for |CI$00008000 // (4 << 13)
67892>>>>>>>>>Define ALG_CLASS_KEY_EXCHANGE           for |CI$0000A000 // (5 << 13)
67892>>>>>>>>>Define ALG_CLASS_ALL                    for |CI$0000E000 // (7 << 13)
67892>>>>>>>>>
67892>>>>>>>>>// Algorithm types
67892>>>>>>>>>Define ALG_TYPE_ANY                     for |CI$00000000 // (0)
67892>>>>>>>>>Define ALG_TYPE_DSS                     for |CI$00000200 // (1 << 9)
67892>>>>>>>>>Define ALG_TYPE_RSA                     for |CI$00000400 // (2 << 9)
67892>>>>>>>>>Define ALG_TYPE_BLOCK                   for |CI$00000600 // (3 << 9)
67892>>>>>>>>>Define ALG_TYPE_STREAM                  for |CI$00000800 // (4 << 9)
67892>>>>>>>>>Define ALG_TYPE_DH                      for |CI$00000A00 // (5 << 9)
67892>>>>>>>>>Define ALG_TYPE_SECURECHANNEL           for |CI$00000C00 // (6 << 9)
67892>>>>>>>>>
67892>>>>>>>>>// Generic sub-ids
67892>>>>>>>>>Define ALG_SID_ANY                      for |CI$00000000 // (0)
67892>>>>>>>>>
67892>>>>>>>>>// RSA sub-ids
67892>>>>>>>>>Define ALG_SID_RSA_ANY                  for 0
67892>>>>>>>>>Define ALG_SID_RSA_PKCS                 for 1
67892>>>>>>>>>Define ALG_SID_RSA_MSATWORK             for 2
67892>>>>>>>>>Define ALG_SID_RSA_ENTRUST              for 3
67892>>>>>>>>>Define ALG_SID_RSA_PGP                  for 4
67892>>>>>>>>>
67892>>>>>>>>>// DSS sub-ids
67892>>>>>>>>>Define ALG_SID_DSS_ANY                  for 0
67892>>>>>>>>>Define ALG_SID_DSS_PKCS                 for 1
67892>>>>>>>>>Define ALG_SID_DSS_DMS                  for 2
67892>>>>>>>>>
67892>>>>>>>>>// DES sub_ids
67892>>>>>>>>>Define ALG_SID_DES                      for 1
67892>>>>>>>>>Define ALG_SID_3DES                     for 3
67892>>>>>>>>>Define ALG_SID_DESX                     for 4
67892>>>>>>>>>Define ALG_SID_IDEA                     for 5
67892>>>>>>>>>Define ALG_SID_CAST                     for 6
67892>>>>>>>>>Define ALG_SID_SAFERSK64                for 7
67892>>>>>>>>>Define ALG_SID_SAFERSK128               for 8
67892>>>>>>>>>Define ALG_SID_3DES_112                 for 9
67892>>>>>>>>>Define ALG_SID_CYLINK_MEK               for 12
67892>>>>>>>>>Define ALG_SID_RC5                      for 13
67892>>>>>>>>>Define ALG_SID_AES_128                  for 14
67892>>>>>>>>>Define ALG_SID_AES_192                  for 15
67892>>>>>>>>>Define ALG_SID_AES_256                  for 16
67892>>>>>>>>>Define ALG_SID_AES                      for 17
67892>>>>>>>>>
67892>>>>>>>>>// Fortezza sub-ids
67892>>>>>>>>>Define ALG_SID_SKIPJACK                 for 10
67892>>>>>>>>>Define ALG_SID_TEK                      for 11
67892>>>>>>>>>
67892>>>>>>>>>// RC2 sub-ids
67892>>>>>>>>>Define ALG_SID_RC2                      for 2
67892>>>>>>>>>
67892>>>>>>>>>// Stream cipher sub-ids
67892>>>>>>>>>Define ALG_SID_RC4                      for 1
67892>>>>>>>>>Define ALG_SID_SEAL                     for 2
67892>>>>>>>>>
67892>>>>>>>>>// Diffie-Hellman sub-ids
67892>>>>>>>>>Define ALG_SID_DH_SANDF                 for 1
67892>>>>>>>>>Define ALG_SID_DH_EPHEM                 for 2
67892>>>>>>>>>Define ALG_SID_AGREED_KEY_ANY           for 3
67892>>>>>>>>>Define ALG_SID_KEA                      for 4
67892>>>>>>>>>
67892>>>>>>>>>// Hash sub ids
67892>>>>>>>>>Define ALG_SID_MD2                      for 1
67892>>>>>>>>>Define ALG_SID_MD4                      for 2
67892>>>>>>>>>Define ALG_SID_MD5                      for 3
67892>>>>>>>>>Define ALG_SID_SHA                      for 4
67892>>>>>>>>>Define ALG_SID_SHA1                     for 4
67892>>>>>>>>>Define ALG_SID_MAC                      for 5
67892>>>>>>>>>Define ALG_SID_RIPEMD                   for 6
67892>>>>>>>>>Define ALG_SID_RIPEMD160                for 7
67892>>>>>>>>>Define ALG_SID_SSL3SHAMD5               for 8
67892>>>>>>>>>Define ALG_SID_HMAC                     for 9
67892>>>>>>>>>Define ALG_SID_TLS1PRF                  for 10
67892>>>>>>>>>Define ALG_SID_HASH_REPLACE_OWF         for 11
67892>>>>>>>>>Define ALG_SID_SHA_256                  for 12
67892>>>>>>>>>Define ALG_SID_SHA_384                  for 13
67892>>>>>>>>>Define ALG_SID_SHA_512                  for 14
67892>>>>>>>>>
67892>>>>>>>>>// secure channel sub ids
67892>>>>>>>>>Define ALG_SID_SSL3_MASTER              for 1
67892>>>>>>>>>Define ALG_SID_SCHANNEL_MASTER_HASH     for 2
67892>>>>>>>>>Define ALG_SID_SCHANNEL_MAC_KEY         for 3
67892>>>>>>>>>Define ALG_SID_PCT1_MASTER              for 4
67892>>>>>>>>>Define ALG_SID_SSL2_MASTER              for 5
67892>>>>>>>>>Define ALG_SID_TLS1_MASTER              for 6
67892>>>>>>>>>Define ALG_SID_SCHANNEL_ENC_KEY         for 7
67892>>>>>>>>>
67892>>>>>>>>>// algorithm identifier definitions
67892>>>>>>>>>Define CALG_MD2                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD2)
67892>>>>>>>>>Define CALG_MD4                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD4)
67892>>>>>>>>>Define CALG_MD5                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD5)
67892>>>>>>>>>Define CALG_SHA                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA)
67892>>>>>>>>>Define CALG_SHA1                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA1)
67892>>>>>>>>>Define CALG_MAC                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MAC)
67892>>>>>>>>>Define CALG_RSA_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
67892>>>>>>>>>Define CALG_DSS_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_DSS ior ALG_SID_DSS_ANY)
67892>>>>>>>>>Define CALG_NO_SIGN                     for (ALG_CLASS_SIGNATURE ior ALG_TYPE_ANY ior ALG_SID_ANY)
67892>>>>>>>>>Define CALG_RSA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
67892>>>>>>>>>Define CALG_DES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DES)
67892>>>>>>>>>Define CALG_3DES_112                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES_112)
67892>>>>>>>>>Define CALG_3DES                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES)
67892>>>>>>>>>Define CALG_DESX                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DESX)
67892>>>>>>>>>Define CALG_RC2                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC2)
67892>>>>>>>>>Define CALG_RC4                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_RC4)
67892>>>>>>>>>Define CALG_SEAL                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_SEAL)
67892>>>>>>>>>Define CALG_DH_SF                       for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_SANDF)
67892>>>>>>>>>Define CALG_DH_EPHEM                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_EPHEM)
67892>>>>>>>>>Define CALG_AGREEDKEY_ANY               for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_AGREED_KEY_ANY)
67892>>>>>>>>>Define CALG_KEA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_KEA)
67892>>>>>>>>>Define CALG_HUGHES_MD5                  for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_ANY ior ALG_SID_MD5)
67892>>>>>>>>>Define CALG_SKIPJACK                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_SKIPJACK)
67892>>>>>>>>>Define CALG_TEK                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_TEK)
67892>>>>>>>>>Define CALG_CYLINK_MEK                  for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_CYLINK_MEK)
67892>>>>>>>>>Define CALG_SSL3_SHAMD5                 for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SSL3SHAMD5)
67892>>>>>>>>>Define CALG_SSL3_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL3_MASTER)
67892>>>>>>>>>Define CALG_SCHANNEL_MASTER_HASH        for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MASTER_HASH)
67892>>>>>>>>>Define CALG_SCHANNEL_MAC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MAC_KEY)
67892>>>>>>>>>Define CALG_SCHANNEL_ENC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_ENC_KEY)
67892>>>>>>>>>Define CALG_PCT1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_PCT1_MASTER)
67892>>>>>>>>>Define CALG_SSL2_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL2_MASTER)
67892>>>>>>>>>Define CALG_TLS1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_TLS1_MASTER)
67892>>>>>>>>>Define CALG_RC5                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC5)
67892>>>>>>>>>Define CALG_HMAC                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HMAC)
67892>>>>>>>>>Define CALG_TLS1PRF                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_TLS1PRF)
67892>>>>>>>>>Define CALG_HASH_REPLACE_OWF            for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HASH_REPLACE_OWF)
67892>>>>>>>>>Define CALG_AES_128                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_128)
67892>>>>>>>>>Define CALG_AES_192                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_192)
67892>>>>>>>>>Define CALG_AES_256                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_256)
67892>>>>>>>>>Define CALG_AES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES)
67892>>>>>>>>>Define CALG_SHA_256                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_256)
67892>>>>>>>>>Define CALG_SHA_384                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_384)
67892>>>>>>>>>Define CALG_SHA_512                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_512)
67892>>>>>>>>>
67892>>>>>>>>>// Providers
67892>>>>>>>>>Define MS_DEF_PROV                      for "Microsoft Base Cryptographic Provider v1.0"
67892>>>>>>>>>Define MS_ENHANCED_PROV                 for "Microsoft Enhanced Cryptographic Provider v1.0"
67892>>>>>>>>>Define MS_STRONG_PROV                   for "Microsoft Strong Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_RSA_SIG_PROV              for "Microsoft RSA Signature Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_RSA_SCHANNEL_PROV         for "Microsoft RSA SChannel Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DSS_PROV                  for "Microsoft Base DSS Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DSS_DH_PROV               for "Microsoft Base DSS and Diffie-Hellman Cryptographic Provider"
67892>>>>>>>>>Define MS_ENH_DSS_DH_PROV               for "Microsoft Enhanced DSS and Diffie-Hellman Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DH_SCHANNEL_PROV          for "Microsoft DH SChannel Cryptographic Provider"
67892>>>>>>>>>Define MS_SCARD_PROV                    for "Microsoft Base Smart Card Crypto Provider"
67892>>>>>>>>>Define MS_ENH_RSA_AES_PROV              for "Microsoft Enhanced RSA and AES Cryptographic Provider"
67892>>>>>>>>>
67892>>>>>>>>>// dwFlags definitions for CryptAcquireContext
67892>>>>>>>>>Define CRYPT_VERIFYCONTEXT              for |CI$F0000000
67892>>>>>>>>>Define CRYPT_NEWKEYSET                  for |CI$00000008
67892>>>>>>>>>Define CRYPT_DELETEKEYSET               for |CI$00000010
67892>>>>>>>>>Define CRYPT_MACHINE_KEYSET             for |CI$00000020
67892>>>>>>>>>Define CRYPT_SILENT                     for |CI$00000040
67892>>>>>>>>>
67892>>>>>>>>>// dwFlag definitions for CryptGenKey
67892>>>>>>>>>Define CRYPT_EXPORTABLE                 for |CI$00000001
67892>>>>>>>>>Define CRYPT_USER_PROTECTED             for |CI$00000002
67892>>>>>>>>>Define CRYPT_CREATE_SALT                for |CI$00000004
67892>>>>>>>>>Define CRYPT_UPDATE_KEY                 for |CI$00000008
67892>>>>>>>>>Define CRYPT_NO_SALT                    for |CI$00000010
67892>>>>>>>>>Define CRYPT_PREGEN                     for |CI$00000040
67892>>>>>>>>>Define CRYPT_RECIPIENT                  for |CI$00000010
67892>>>>>>>>>Define CRYPT_INITIATOR                  for |CI$00000040
67892>>>>>>>>>Define CRYPT_ONLINE                     for |CI$00000080
67892>>>>>>>>>Define CRYPT_SF                         for |CI$00000100
67892>>>>>>>>>Define CRYPT_CREATE_IV                  for |CI$00000200
67892>>>>>>>>>Define CRYPT_KEK                        for |CI$00000400
67892>>>>>>>>>Define CRYPT_DATA_KEY                   for |CI$00000800
67892>>>>>>>>>Define CRYPT_VOLATILE                   for |CI$00001000
67892>>>>>>>>>Define CRYPT_SGCKEY                     for |CI$00002000
67892>>>>>>>>>Define CRYPT_ARCHIVABLE                 for |CI$00004000
67892>>>>>>>>>
67892>>>>>>>>>// Provider types
67892>>>>>>>>>Define PROV_RSA_FULL                    for 1
67892>>>>>>>>>Define PROV_RSA_SIG                     for 2
67892>>>>>>>>>Define PROV_DSS                         for 3
67892>>>>>>>>>Define PROV_FORTEZZA                    for 4
67892>>>>>>>>>Define PROV_MS_EXCHANGE                 for 5
67892>>>>>>>>>Define PROV_SSL                         for 6
67892>>>>>>>>>Define PROV_RSA_SCHANNEL                for 12
67892>>>>>>>>>Define PROV_DSS_DH                      for 13
67892>>>>>>>>>Define PROV_EC_ECDSA_SIG                for 14
67892>>>>>>>>>Define PROV_EC_ECNRA_SIG                for 15
67892>>>>>>>>>Define PROV_EC_ECDSA_FULL               for 16
67892>>>>>>>>>Define PROV_EC_ECNRA_FULL               for 17
67892>>>>>>>>>Define PROV_DH_SCHANNEL                 for 18
67892>>>>>>>>>Define PROV_SPYRUS_LYNKS                for 20
67892>>>>>>>>>Define PROV_RNG                         for 21
67892>>>>>>>>>Define PROV_INTEL_SEC                   for 22
67892>>>>>>>>>Define PROV_REPLACE_OWF                 for 23
67892>>>>>>>>>Define PROV_RSA_AES                     for 24
67892>>>>>>>>>
67892>>>>>>>>>// KP_MODE
67892>>>>>>>>>// KP_MODE
67892>>>>>>>>>Define CRYPT_MODE_CBC                   for 1       // Cipher block chaining
67892>>>>>>>>>Define CRYPT_MODE_ECB                   for 2       // Electronic code book
67892>>>>>>>>>Define CRYPT_MODE_OFB                   for 3       // Output feedback mode
67892>>>>>>>>>Define CRYPT_MODE_CFB                   for 4       // Cipher feedback mode
67892>>>>>>>>>Define CRYPT_MODE_CTS                   for 5       // Ciphertext stealing mode
67892>>>>>>>>>Define CRYPT_MODE_CBCI                  for 6       // ANSI CBC Interleaved
67892>>>>>>>>>Define CRYPT_MODE_CFBP                  for 7       // ANSI CFB Pipelined
67892>>>>>>>>>Define CRYPT_MODE_OFBP                  for 8       // ANSI OFB Pipelined
67892>>>>>>>>>Define CRYPT_MODE_CBCOFM                for 9       // ANSI CBC + OF Masking
67892>>>>>>>>>Define CRYPT_MODE_CBCOFMI               for 10      // ANSI CBC + OFM Interleaved
67892>>>>>>>>>
67892>>>>>>>>>// dwParam definitions for CryptGetKeyParam
67892>>>>>>>>>Define KP_IV                            for 1       // Initialization vector
67892>>>>>>>>>Define KP_SALT                          for 2       // Salt value
67892>>>>>>>>>Define KP_PADDING                       for 3       // Padding values
67892>>>>>>>>>Define KP_MODE                          for 4       // Mode of the cipher
67892>>>>>>>>>Define KP_MODE_BITS                     for 5       // Number of bits to feedback
67892>>>>>>>>>Define KP_PERMISSIONS                   for 6       // Key permissions DWORD
67892>>>>>>>>>Define KP_ALGID                         for 7       // Key algorithm
67892>>>>>>>>>Define KP_BLOCKLEN                      for 8       // Block size of the cipher
67892>>>>>>>>>Define KP_KEYLEN                        for 9       // Length of key in bits
67892>>>>>>>>>Define KP_SALT_EX                       for 10      // Length of salt in bytes
67892>>>>>>>>>Define KP_P                             for 11      // DSS/Diffie-Hellman P value
67892>>>>>>>>>Define KP_G                             for 12      // DSS/Diffie-Hellman G value
67892>>>>>>>>>Define KP_Q                             for 13      // DSS Q value
67892>>>>>>>>>Define KP_X                             for 14      // Diffie-Hellman X value
67892>>>>>>>>>Define KP_Y                             for 15      // Y value
67892>>>>>>>>>Define KP_RA                            for 16      // Fortezza RA value
67892>>>>>>>>>Define KP_RB                            for 17      // Fortezza RB value
67892>>>>>>>>>Define KP_INFO                          for 18      // for putting information into an RSA envelope
67892>>>>>>>>>Define KP_EFFECTIVE_KEYLEN              for 19      // setting and getting RC2 effective key length
67892>>>>>>>>>Define KP_SCHANNEL_ALG                  for 20      // for setting the Secure Channel algorithms
67892>>>>>>>>>Define KP_CLIENT_RANDOM                 for 21      // for setting the Secure Channel client random data
67892>>>>>>>>>Define KP_SERVER_RANDOM                 for 22      // for setting the Secure Channel server random data
67892>>>>>>>>>Define KP_RP                            for 23
67892>>>>>>>>>Define KP_PRECOMP_MD5                   for 24
67892>>>>>>>>>Define KP_PRECOMP_SHA                   for 25
67892>>>>>>>>>Define KP_CERTIFICATE                   for 26      // for setting Secure Channel certificate data (PCT1)
67892>>>>>>>>>Define KP_CLEAR_KEY                     for 27      // for setting Secure Channel clear key data (PCT1)
67892>>>>>>>>>Define KP_PUB_EX_LEN                    for 28
67892>>>>>>>>>Define KP_PUB_EX_VAL                    for 29
67892>>>>>>>>>Define KP_KEYVAL                        for 30
67892>>>>>>>>>Define KP_ADMIN_PIN                     for 31
67892>>>>>>>>>Define KP_KEYEXCHANGE_PIN               for 32
67892>>>>>>>>>Define KP_SIGNATURE_PIN                 for 33
67892>>>>>>>>>Define KP_PREHASH                       for 34
67892>>>>>>>>>Define KP_ROUNDS                        for 35
67892>>>>>>>>>Define KP_OAEP_PARAMS                   for 36      // for setting OAEP params on RSA keys
67892>>>>>>>>>Define KP_CMS_KEY_INFO                  for 37
67892>>>>>>>>>Define KP_CMS_DH_KEY_INFO               for 38
67892>>>>>>>>>Define KP_PUB_PARAMS                    for 39      // for setting public parameters
67892>>>>>>>>>Define KP_VERIFY_PARAMS                 for 40      // for verifying DSA and DH parameters
67892>>>>>>>>>Define KP_HIGHEST_VERSION               for 41      // for TLS protocol version setting
67892>>>>>>>>>Define KP_GET_USE_COUNT                 for 42      // for use with PP_CRYPT_COUNT_KEY_USE contexts
67892>>>>>>>>>
67892>>>>>>>>>// dwParam definitions for CryptGetHashParam
67892>>>>>>>>>Define HP_ALGID                         for |CI$0001  // Hash algorithm
67892>>>>>>>>>Define HP_HASHVAL                       for |CI$0002  // Hash value
67892>>>>>>>>>Define HP_HASHSIZE                      for |CI$0004  // Hash value size
67892>>>>>>>>>Define HP_HMAC_INFO                     for |CI$0005  // information for creating an HMA
67892>>>>>>>>>
67892>>>>>>>>>// key BLOB types
67892>>>>>>>>>Define KEYSTATEBLOB                     for |CI$0C
67892>>>>>>>>>Define OPAQUEKEYBLOB                    for |CI$09
67892>>>>>>>>>Define PLAINTEXTKEYBLOB                 for |CI$08
67892>>>>>>>>>Define PRIVATEKEYBLOB                   for |CI$07
67892>>>>>>>>>Define PUBLICKEYBLOB                    for |CI$06
67892>>>>>>>>>Define PUBLICKEYBLOBEX                  for |CI$0A
67892>>>>>>>>>Define SIMPLEBLOB                       for |CI$01
67892>>>>>>>>>Define SYMMETRICWRAPKEYBLOB             for |CI$0B
67892>>>>>>>>>
67892>>>>>>>>>Define CUR_BLOB_VERSION                 for 2
67892>>>>>>>>>
67892>>>>>>>>>//  Structure cryptimportkey
67892>>>>>>>>>Struct PUBLICKEYSTRUC
67892>>>>>>>>>    UChar    bType
67892>>>>>>>>>    UChar    bVersion
67892>>>>>>>>>    UShort   reserved
67892>>>>>>>>>    UInteger aiKeyAlg
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>Struct tPLAINTEXTKEYBLOB
67892>>>>>>>>>    PUBLICKEYSTRUC hdr
67892>>>>>>>>>    PUBLICKEYSTRUC hdr
67892>>>>>>>>>    UInteger       dwKeySize
67892>>>>>>>>>//    UChar[]        rgbKeyData
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>//  Structure for specifying the inner and outer strings when calculating HMAC hash (use with CryptSetHashParam)
67892>>>>>>>>>Struct HMAC_INFO
67892>>>>>>>>>    UInteger HashAlgid
67892>>>>>>>>>    Pointer pbInnerString
67892>>>>>>>>>    DWord cbInnerString
67892>>>>>>>>>    Pointer pbOuterString
67892>>>>>>>>>    DWord cbOuterString
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>External_Function CryptAcquireContext "CryptAcquireContextA" advapi32.dll ;    Pointer phProv ;    Pointer szContainer ;    Pointer szProvider ;    Integer dwProvType ;    Integer dwFlags ;    Returns Boolean
67893>>>>>>>>>
67893>>>>>>>>>External_Function CryptReleaseContext "CryptReleaseContext" advapi32.dll ;    Handle hProv ;    Integer dwFlags ;    Returns Boolean
67894>>>>>>>>>
67894>>>>>>>>>External_Function CryptCreateHash "CryptCreateHash" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hKey ;    Integer dwFlags ;    Pointer phHash ;    Returns Boolean
67895>>>>>>>>>
67895>>>>>>>>>External_Function CryptDestroyHash "CryptDestroyHash" advapi32.dll ;    Handle hHash ;    Returns Boolean
67896>>>>>>>>>
67896>>>>>>>>>External_Function CryptHashData "CryptHashData" advapi32.dll ;    Handle hHash ;    Pointer pbData ;    Integer dwDataLen ;    Integer dwFlags ;    Returns Boolean
67897>>>>>>>>>
67897>>>>>>>>>External_Function CryptDeriveKey "CryptDeriveKey" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hBaseData ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
67898>>>>>>>>>
67898>>>>>>>>>External_Function CryptGetHashParam "CryptGetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    DWord dwFlags ;    Returns Integer
67899>>>>>>>>>
67899>>>>>>>>>External_Function CryptDestroyKey "CryptDestroyKey" advapi32.dll ;    Handle hKey ;    Returns Boolean
67900>>>>>>>>>
67900>>>>>>>>>External_Function CryptImportKey "CryptImportKey" advapi32.dll ;    Handle hProv ;    Pointer pbData ;    Integer dwDataLen ;    Handle hPubKey ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
67901>>>>>>>>>
67901>>>>>>>>>External_Function CryptGetKeyParam "CryptGetKeyParam" advapi32.dll ;    Handle hKey ;    Integer dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwFlags ;    Returns Boolean
67902>>>>>>>>>    
67902>>>>>>>>>External_Function CryptSetKeyParam "CryptSetKeyParam" advapi32.dll ;    Handle   hKey ;    UInteger dwParam ;    Pointer  pbdata ;    UInteger dwFlags ;    Returns  Boolean
67903>>>>>>>>>
67903>>>>>>>>>External_Function CryptEncrypt "CryptEncrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwBufLen ;    Returns Boolean
67904>>>>>>>>>
67904>>>>>>>>>External_Function CryptDecrypt "CryptDecrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Returns Boolean
67905>>>>>>>>>
67905>>>>>>>>>External_Function CryptGenRandom "CryptGenRandom" advapi32.dll ;    Handle hProv ;    DWord dwLen ;    Pointer pbBuffer ;    Returns Boolean
67906>>>>>>>>>    
67906>>>>>>>>>External_Function CryptSetHashParam "CryptSetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Integer dwFlags ;    Returns Boolean
67907>>>>>>>>>    
67907>>>>>>>
67907>>>>>>>Class cCryptographer is a cObject
67908>>>>>>>    
67908>>>>>>>    Procedure Construct_Object
67910>>>>>>>        Forward Send Construct_Object
67912>>>>>>>        
67912>>>>>>>        Property String     psProvider  MS_ENHANCED_PROV
67913>>>>>>>        Property Integer    piProvider  PROV_RSA_FULL
67914>>>>>>>        Property Integer    piCipher    CALG_RC4
67915>>>>>>>        Property Integer    piHash      CALG_MD5
67916>>>>>>>        
67916>>>>>>>        // Private properties
67916>>>>>>>        Property Handle     Private_phProv
67917>>>>>>>    End_Procedure
67918>>>>>>>    
67918>>>>>>>    
67918>>>>>>>    // Acquire key container handle
67918>>>>>>>    Function AcquireContext Returns Handle
67920>>>>>>>        Integer iProvider
67920>>>>>>>        String sProvider
67920>>>>>>>        Handle hProv
67920>>>>>>>        Boolean bOk
67920>>>>>>>        Address addrProv
67920>>>>>>>        
67920>>>>>>>        Move 0 to hProv
67921>>>>>>>        Get piProvider to iProvider
67922>>>>>>>        Get psProvider to sProvider
67923>>>>>>>        
67923>>>>>>>        //  Determine address to be passed as provider
67923>>>>>>>        If (Trim(sProvider) <> "") Begin
67925>>>>>>>            Move (AddressOf(sProvider)) to addrProv
67926>>>>>>>        End
67926>>>>>>>>
67926>>>>>>>        Else Begin
67927>>>>>>>            Move 0 to addrProv
67928>>>>>>>        End
67928>>>>>>>>
67928>>>>>>>        
67928>>>>>>>        //  Acquire Crypto Context
67928>>>>>>>        Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_VERIFYCONTEXT)) to bOk
67929>>>>>>>        If (not(bOk) or hProv = 0) Begin
67931>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET ior CRYPT_VERIFYCONTEXT)) to bOk
67932>>>>>>>        End
67932>>>>>>>>
67932>>>>>>>        
67932>>>>>>>        If (not(bOk) or hProv = 0) Begin
67934>>>>>>>            // Fallback to original
67934>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,0)) to bOk
67935>>>>>>>            
67935>>>>>>>            If (not(bOk) or hProv = 0) Begin
67937>>>>>>>                Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET)) to bOk
67938>>>>>>>            End
67938>>>>>>>>
67938>>>>>>>        End
67938>>>>>>>>
67938>>>>>>>        Set Private_phProv to hProv
67939>>>>>>>        
67939>>>>>>>        Function_Return hProv
67940>>>>>>>    End_Function
67941>>>>>>>    
67941>>>>>>>    // Releases key container handle
67941>>>>>>>    Function ReleaseContext Handle hProv Returns Boolean
67943>>>>>>>        Function_Return (CryptReleaseContext(hProv,0))
67944>>>>>>>    End_Function
67945>>>>>>>    
67945>>>>>>>    // Creates hash object
67945>>>>>>>    Function CreateHash Handle hProv Returns Handle
67947>>>>>>>        Integer iAlgorithm
67947>>>>>>>        Handle hHash
67947>>>>>>>        Boolean bOk
67947>>>>>>>        
67947>>>>>>>        Move 0 to hHash
67948>>>>>>>        Get piHash to iAlgorithm
67949>>>>>>>        Move (CryptCreateHash(hProv,iAlgorithm,0,0,AddressOf(hHash))) to bOk
67950>>>>>>>        
67950>>>>>>>        Function_Return hHash
67951>>>>>>>    End_Function
67952>>>>>>>    
67952>>>>>>>    // Destroys the hash object
67952>>>>>>>    Function DestroyHash Handle hHash Returns Boolean
67954>>>>>>>        Function_Return (CryptDestroyHash(hHash))
67955>>>>>>>    End_Function
67956>>>>>>>    
67956>>>>>>>    // Adds data to hash object
67956>>>>>>>    Function HashData Handle hHash String sData Returns Boolean
67958>>>>>>>        Function_Return (CryptHashData(hHash,AddressOf(sData),Length(sData),0))
67959>>>>>>>    End_Function
67960>>>>>>>    
67960>>>>>>>    // Generates session key
67960>>>>>>>    Function DeriveKey Handle hProv Handle hHash Returns Handle
67962>>>>>>>        Integer iAlgorithm
67962>>>>>>>        Handle hKey
67962>>>>>>>        Boolean bOk
67962>>>>>>>        
67962>>>>>>>        Move 0 to hKey
67963>>>>>>>        Get piCipher to iAlgorithm
67964>>>>>>>        Move (CryptDeriveKey(hProv,iAlgorithm,hHash,CRYPT_EXPORTABLE,AddressOf(hKey))) to bOk
67965>>>>>>>        
67965>>>>>>>        Function_Return hKey
67966>>>>>>>    End_Function
67967>>>>>>>    
67967>>>>>>>    // Imports a plain text key
67967>>>>>>>    Function ImportPlainTextKey Handle hProv UChar[] ucaKey Returns Handle
67969>>>>>>>        tPLAINTEXTKEYBLOB blobhead
67969>>>>>>>        tPLAINTEXTKEYBLOB blobhead
67969>>>>>>>        Boolean   bSuccess
67969>>>>>>>        Handle    hKey
67969>>>>>>>        Integer   iHeadSize iKeySize
67969>>>>>>>        UChar[]   ucaKeyblob
67970>>>>>>>        Integer iVoid
67970>>>>>>>        
67970>>>>>>>        Move (SizeOfType(tPLAINTEXTKEYBLOB)) to iHeadSize
67971>>>>>>>        Move (SizeOfArray(ucaKey)) to iKeySize
67972>>>>>>>        
67972>>>>>>>        Move PLAINTEXTKEYBLOB to blobhead.hdr.bType
67973>>>>>>>        Move CUR_BLOB_VERSION   to blobhead.hdr.bVersion
67974>>>>>>>        Get piCipher            to blobhead.hdr.aiKeyAlg
67975>>>>>>>        Move iKeySize           to blobhead.dwKeySize
67976>>>>>>>        
67976>>>>>>>        Move (ResizeArray(ucaKeyblob, iHeadSize)) to ucaKeyblob
67977>>>>>>>        Move (CopyMemory(AddressOf(ucaKeyblob), AddressOf(blobhead), iHeadSize)) to iVoid
67978>>>>>>>        Move (AppendArray(ucaKeyblob, ucaKey)) to ucaKeyblob
67979>>>>>>>        
67979>>>>>>>        Move 0 to hKey
67980>>>>>>>        Move (CryptImportKey(hProv, AddressOf(ucaKeyblob), SizeOfArray(ucaKeyblob), 0, 0, AddressOf(hKey))) to bSuccess
67981>>>>>>>        If (not(bSuccess)) Begin
67983>>>>>>>            Move (ShowLastError()) to iVoid
67984>>>>>>>        End
67984>>>>>>>>
67984>>>>>>>        
67984>>>>>>>        Function_Return hKey
67985>>>>>>>    End_Function
67986>>>>>>>    
67986>>>>>>>    // Destroys the key
67986>>>>>>>    Function DestroyKey Handle hKey Returns Boolean
67988>>>>>>>        Function_Return (CryptDestroyKey(hKey))
67989>>>>>>>    End_Function
67990>>>>>>>    
67990>>>>>>>    // Retrieves key data
67990>>>>>>>    Function KeyParameter Handle hKey Integer iQuery Returns Integer
67992>>>>>>>        Integer iBuffer iLen
67992>>>>>>>        Boolean bOk
67992>>>>>>>        
67992>>>>>>>        Move (SizeOfType(Integer)) to iLen
67993>>>>>>>        Move (CryptGetKeyParam(hKey,iQuery,AddressOf(iBuffer),AddressOf(iLen),0)) to bOk
67994>>>>>>>        Function_Return iBuffer
67995>>>>>>>    End_Function
67996>>>>>>>    
67996>>>>>>>    // Retrieves a hash value
67996>>>>>>>    Function HashValue Handle lhHash Returns String
67998>>>>>>>        String  lsHash
67998>>>>>>>        Integer liResult
67998>>>>>>>        DWord   dwDataLen
67998>>>>>>>        
67998>>>>>>>        Move 0 to dwDataLen
67999>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,0,AddressOf(dwDataLen),0)) to liResult
68000>>>>>>>        If (liResult = 0) ;            Function_Return ""
68003>>>>>>>        
68003>>>>>>>        Move (Repeat(Character(0),dwDataLen)) to lsHash
68004>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,AddressOf(lsHash),AddressOf(dwDataLen),0)) to liResult
68005>>>>>>>        If (liResult = 0) ;            Function_Return ""
68008>>>>>>>        
68008>>>>>>>        Function_Return lsHash
68009>>>>>>>    End_Function
68010>>>>>>>
68010>>>>>>>    // Encrypts data
68010>>>>>>>    Function Encrypt String sPassword String sData Returns String
68012>>>>>>>        Handle hProv hHash hKey
68012>>>>>>>        Integer iAlgorithm iDataLen iCipherLen iErr
68012>>>>>>>        Boolean bOk
68012>>>>>>>        
68012>>>>>>>        Get AcquireContext to hProv
68013>>>>>>>        If (hProv) Begin
68015>>>>>>>            Get CreateHash hProv to hHash
68016>>>>>>>            If (hHash) Begin
68018>>>>>>>                Get HashData hHash sPassword to bOk
68019>>>>>>>                If (bOk) Begin
68021>>>>>>>                    Get piCipher to iAlgorithm
68022>>>>>>>                    Get DeriveKey hProv hHash to hKey
68023>>>>>>>                End
68023>>>>>>>>
68023>>>>>>>                Get DestroyHash hHash to bOk
68024>>>>>>>            End
68024>>>>>>>>
68024>>>>>>>            
68024>>>>>>>            If (hKey) Begin
68026>>>>>>>                //  First call to determine resulting data size
68026>>>>>>>                Move (Length(sData)) to iDataLen
68027>>>>>>>                Move (Length(sData)) to iCipherLen
68028>>>>>>>                Move (CryptEncrypt(hKey, 0, True, 0, 0, AddressOf(iCipherLen), iDataLen)) to bOk
68029>>>>>>>                
68029>>>>>>>                //  Reserve space in string
68029>>>>>>>                If (iDataLen < iCipherLen) Begin
68031>>>>>>>                    Move (sData + Repeat(" ", iCipherLen - iDataLen)) to sData
68032>>>>>>>                End
68032>>>>>>>>
68032>>>>>>>                
68032>>>>>>>                //  Call to really decrypt
68032>>>>>>>                Move (CryptEncrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen),Length(sData))) to bOk
68033>>>>>>>                //If (not(bOk)) Begin
68033>>>>>>>                //Move "" to sData
68033>>>>>>>                //Move (GetLastError()) to iErr
68033>>>>>>>                //End
68033>>>>>>>                
68033>>>>>>>                Get DestroyKey hKey to bOk
68034>>>>>>>            End 
68034>>>>>>>>
68034>>>>>>>            Get ReleaseContext hProv to bOk
68035>>>>>>>        End 
68035>>>>>>>>
68035>>>>>>>        Function_Return sData
68036>>>>>>>    End_Function
68037>>>>>>>    
68037>>>>>>>    // Decrypts data
68037>>>>>>>    Function Decrypt String sPassword String sData Returns String
68039>>>>>>>        Handle hProv hHash hKey
68039>>>>>>>        Integer iAlgorithm iDataLen
68039>>>>>>>        Boolean bOk
68039>>>>>>>        
68039>>>>>>>        Get AcquireContext to hProv
68040>>>>>>>        If (hProv) Begin
68042>>>>>>>            Get CreateHash hProv to hHash
68043>>>>>>>            If (hHash) Begin
68045>>>>>>>                Get HashData hHash sPassword to bOk
68046>>>>>>>                If (bOk) Begin
68048>>>>>>>                    Get piCipher to iAlgorithm
68049>>>>>>>                    Get DeriveKey hProv hHash to hKey
68050>>>>>>>                End
68050>>>>>>>>
68050>>>>>>>                Get DestroyHash hHash to bOk
68051>>>>>>>            End
68051>>>>>>>>
68051>>>>>>>            
68051>>>>>>>            If (hKey) Begin
68053>>>>>>>                Move (Length(sData)) to iDataLen
68054>>>>>>>                Move (CryptDecrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen))) to bOk
68055>>>>>>>                //  Resulting dat can be shorter as the input string, in that case we shorten the result string
68055>>>>>>>                If (Length(sData) > iDataLen) Begin
68057>>>>>>>                    Move (Left(sData, iDataLen)) to sData
68058>>>>>>>                End
68058>>>>>>>>
68058>>>>>>>                
68058>>>>>>>                Get DestroyKey hKey to bOk
68059>>>>>>>            End
68059>>>>>>>>
68059>>>>>>>            Get ReleaseContext hProv to bOk
68060>>>>>>>        End
68060>>>>>>>>
68060>>>>>>>        Function_Return sData
68061>>>>>>>    End_Function
68062>>>>>>>    
68062>>>>>>>    //  Generates random data.
68062>>>>>>>    Function GenerateRandom Integer iBytes Returns UChar[]
68064>>>>>>>        Handle hProv
68064>>>>>>>        UChar[] uaResult
68065>>>>>>>        Boolean bRes
68065>>>>>>>        
68065>>>>>>>        Get AcquireContext to hProv
68066>>>>>>>        
68066>>>>>>>        Move (ResizeArray(uaResult, iBytes)) to uaResult
68067>>>>>>>        Move (CryptGenRandom(hProv, iBytes, AddressOf(uaResult))) to bRes
68068>>>>>>>        
68068>>>>>>>        Get ReleaseContext hProv to bRes
68069>>>>>>>        
68069>>>>>>>        Function_Return uaResult
68070>>>>>>>    End_Function
68071>>>>>>>    
68071>>>>>>>    //  Generates random data and does a base64 encoding to properly present it as a string.
68071>>>>>>>    Function GenerateRandomString Integer iLenght Returns String
68073>>>>>>>        String sResult
68073>>>>>>>        UChar[] aData
68074>>>>>>>        Address pBase64
68074>>>>>>>        Integer iVoid
68074>>>>>>>        
68074>>>>>>>        Get GenerateRandom iLenght to aData
68075>>>>>>>        
68075>>>>>>>        Move (Base64Encode(AddressOf(aData), iLenght)) to pBase64
68076>>>>>>>        Move pBase64 to sResult
68077>>>>>>>        Move (Free(pBase64)) to iVoid
68078>>>>>>>        
68078>>>>>>>        Function_Return (Left(sResult, iLenght))
68079>>>>>>>    End_Function
68080>>>>>>>    
68080>>>>>>>End_Class
68081>>>>>
68081>>>>>Class cLoginEncryption is a cObject
68082>>>>>    
68082>>>>>    Procedure Construct_Object
68084>>>>>        Forward Send Construct_Object
68086>>>>>        // this must be set to a multi (40ish) character random key
68086>>>>>        Property String psEncryptPassword ""
68087>>>>>        
68087>>>>>        Object oDataCrypter is a cCryptographer
68089>>>>>            Set piHash to CALG_SHA_256
68090>>>>>            Set piCipher to CALG_AES_256
68091>>>>>            Set psProvider to "" //  Not providing a specific provider gives the default provider for the provider type
68092>>>>>            Set piProvider to PROV_RSA_AES
68093>>>>>        End_Object
68094>>>>>    End_Procedure
68095>>>>>    
68095>>>>>    // This can be augmented to return a password encryption key using any
68095>>>>>    // hidden mechanism desired.
68095>>>>>    Function GetEncryptionPassword Returns String
68097>>>>>        String sPassword
68097>>>>>        Get psEncryptPassword to sPassword
68098>>>>>        Function_Return sPassword
68099>>>>>    End_Function
68100>>>>>    
68100>>>>>    // Encrypts a string into an unreadable hash that can later be decrypted using DecryptKey.
68100>>>>>    //
68100>>>>>    // Params:
68100>>>>>    //   sPlainText     String to encrypt.
68100>>>>>    // Returns:
68100>>>>>    //   Base64 encoded hash.
68100>>>>>    Function EncryptPassword String sPlainText Returns String
68102>>>>>        String sEncryptPassword sBinary sBase64
68102>>>>>        Address pBase64
68102>>>>>        Integer iVoid
68102>>>>>        
68102>>>>>        //  Encrypt Key
68102>>>>>        Get GetEncryptionPassword to sEncryptPassword
68103>>>>>        If (sEncryptPassword = "") Begin
68105>>>>>            Error DFERR_PROGRAM "No encryption password set"
68106>>>>>>
68106>>>>>        End
68106>>>>>>
68106>>>>>        
68106>>>>>        Get Encrypt of oDataCrypter sEncryptPassword sPlainText to sBinary
68107>>>>>        
68107>>>>>        If (sPlainText = sBinary or sBinary = "") Begin
68109>>>>>            Error DFERR_PROGRAM "Unable to encrypt database login password"
68110>>>>>>
68110>>>>>            Function_Return ""
68111>>>>>        End
68111>>>>>>
68111>>>>>        
68111>>>>>        //  Encode binary hash to Base64
68111>>>>>        Move (Base64Encode(AddressOf(sBinary), Length(sBinary))) to pBase64
68112>>>>>        Move pBase64 to sBase64
68113>>>>>        Move (Free(pBase64)) to iVoid
68114>>>>>        
68114>>>>>        Function_Return sBase64
68115>>>>>    End_Function
68116>>>>>    
68116>>>>>    
68116>>>>>    // Decrypts the unreadable hash generated by EncryptKey into a readable string.
68116>>>>>    //
68116>>>>>    // Params:
68116>>>>>    //   sBase64EncryptedPassword       Base64 Encrypted password
68116>>>>>    // Returns:
68116>>>>>    //   Readable plain text password
68116>>>>>    Function DecryptPassword String sBase64EncryptedPassword Returns String
68118>>>>>        String sEncryptPassword sPlainText sBinary
68118>>>>>        Boolean bIsHex
68118>>>>>        Integer iLen iVoid
68118>>>>>        Address pBinary
68118>>>>>        
68118>>>>>        If (sBase64EncryptedPassword <> "") Begin
68120>>>>>            //  Decode from Base64
68120>>>>>            Move (Base64Decode(AddressOf(sBase64EncryptedPassword), &iLen)) to pBinary
68121>>>>>            
68121>>>>>            Move (Repeat(Character(0), iLen)) to sBinary
68122>>>>>            Move (CopyMemory(AddressOf(sBinary), pBinary, iLen)) to iVoid
68123>>>>>            
68123>>>>>            Move (Free(pBinary)) to iVoid
68124>>>>>            
68124>>>>>            //  Encrypted binary hash to string
68124>>>>>            Get GetEncryptionPassword to sEncryptPassword
68125>>>>>            Get Decrypt of oDataCrypter sEncryptPassword sBinary to sPlainText
68126>>>>>        End
68126>>>>>>
68126>>>>>        
68126>>>>>        Function_Return sPlainText
68127>>>>>    End_Function
68128>>>>>End_Class
68129>>>
68129>>>Object oLoginEncryption is a cLoginEncryption
68131>>>
68131>>>    // this must be created in your appsrc directory and must contain an encryption
68131>>>    // key that is set to psEncryptPassword. It will look something like this
68131>>>    //
68131>>>    // Set psEncryptPassword to "JchUAo7W@r.b{<Yk~OONi0nq=sMi[*Rn[A-`Vo)q"
68131>>>    //  
Including file: LoginEncryptionKey.inc    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\LoginEncryptionKey.inc)
68131>>>>// Studio generated login encryption key
68131>>>>Set psEncryptPassword to "rHn+igXUe(,,M<?dkNtebWQJ$w>FT\9<FI)(MsQz"
68132>>>>
68132>>>    
68132>>>    // use this to register this object to your cConnection Object. This object
68132>>>    // must be created after the cConnection object
68132>>>    Move Self to ghoLoginEncryption
68133>>>End_Object
68134>        Use DatabaseLoginDialog.dg
Including file: DatabaseLoginDialog.dg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\DatabaseLoginDialog.dg)
68134>>>
68134>>>Use Windows.pkg
68134>>>Use cConnection.pkg
68134>>>Use dfLine.pkg
68134>>>
68134>>>Object oDatabaseLoginDialog is a ModalPanel
68136>>>    Set Label to "Database Login"
68137>>>    Set Location to 2 2
68138>>>    Set Size to 110 211
68139>>>    
68139>>>    Property String psId
68141>>>    Property Boolean pbOk False
68143>>>    Property Boolean pbChanged False
68145>>>    Property Boolean pbAllowRemember True
68147>>>    
68147>>>    // this registers this object with the cConnection object.
68147>>>    Move Self to ghoLoginConnectDialog
68148>>>    
68148>>>    Object oUserIDForm is a Form
68150>>>        Set Label to "User Name"
68151>>>        Set Size to 12 85
68152>>>        Set Location to 34 79
68153>>>        Set Label_Col_Offset to 64
68154>>>        Set peAnchors to anTopLeftRight
68155>>>    End_Object
68156>>>    
68156>>>    Object oPwdForm is a Form
68158>>>        Set Size to 12 85
68159>>>        Set Location to 49 79
68160>>>        Set Label_Col_Offset to 64
68161>>>        Set Password_State to True
68162>>>        Set peAnchors to anTopLeftRight
68163>>>        Set Label to "Password"
68164>>>    End_Object
68165>>>    
68165>>>    Object oTrustedConnection is a CheckBox
68167>>>        Set Size to 10 50
68168>>>        Set Location to 65 79
68169>>>        Set Label to "Trusted Connection"
68170>>>    End_Object
68171>>>    
68171>>>    Object oRemember is a CheckBox
68173>>>        Set Size to 10 50
68174>>>        Set Location to 79 14
68175>>>        Set Label to "Remember and don't ask again"
68176>>>        Set Checked_State to True
68177>>>    End_Object
68178>>>    
68178>>>    Object oLogin_btn is a Button
68180>>>        Set Label to "&Login"
68181>>>        Set Location to 92 102
68182>>>        Set peAnchors to anBottomRight
68183>>>        Set Default_State to True
68184>>>        
68184>>>        Procedure OnClick
68187>>>            Boolean bTrust
68187>>>            String sUser sPwd sConn sErr sId
68187>>>            Integer iError
68187>>>            Get psId to sId
68188>>>            Get Value of oUserIDForm to sUser
68189>>>            Get Value of oPwdForm to sPwd
68190>>>            Get Checked_State of oTrustedConnection to bTrust
68191>>>            
68191>>>            Get LoginConnectIdNewCredentials of ghoConnection sId sUser sPwd bTrust to iError
68192>>>            If (iError=0) Begin
68194>>>                Set pbOk to True
68195>>>                Set pbChanged to True
68196>>>                Send Close_Panel
68197>>>            End
68197>>>>
68197>>>            Else Begin
68198>>>                Get psErrorText of ghoConnection to sErr
68199>>>                Send UserError sErr "Login Error"
68200>>>            End
68200>>>>
68200>>>        End_Procedure
68201>>>    End_Object
68202>>>    
68202>>>    Object oCancel_btn is a Button
68204>>>        Set Label to "&Cancel"
68205>>>        Set Location to 92 157
68206>>>        Set peAnchors to anBottomRight
68207>>>        
68207>>>        Procedure OnClick
68210>>>            Send Close_Panel
68211>>>        End_Procedure
68212>>>    End_Object
68213>>>    
68213>>>    Object oConnectionIdInfo is a TextBox
68215>>>        Set Size to 10 50
68216>>>        Set Location to 4 14
68217>>>        Set Label to 'Connection Id='
68218>>>    End_Object
68219>>>    
68219>>>    Object oConnectionServerInfo is a TextBox
68221>>>        Set Size to 10 50
68222>>>        Set Location to 16 14
68223>>>        Set Label to 'Server'
68224>>>    End_Object
68225>>>    
68225>>>    Object oLineControl1 is a LineControl
68227>>>        Set Size to 2 202
68228>>>        Set Location to 29 5
68229>>>    End_Object
68230>>>    
68230>>>    Function LoginConnectIdDialog String sId Returns Boolean
68233>>>        Boolean bOk bChanged bTrusted bAllowRemember bRemember
68233>>>        String sUser sPwd sDescription
68233>>>        tConnection Connect
68233>>>        tConnection Connect
68233>>>        
68233>>>        Get pbAllowRemember to bAllowRemember
68234>>>        
68234>>>        
68234>>>        If not bAllowRemember Begin
68236>>>            Set Enabled_State of oRemember to bRemember
68237>>>            Set Visible_State of oRemember to bRemember
68238>>>        End
68238>>>>
68238>>>        
68238>>>        Get ConnectionIdInfo of ghoConnection sId to Connect
68239>>>        Set Value of oConnectionIdInfo to ("Connection ID="+Connect.sId)
68240>>>        Set Value of oConnectionServerInfo to Connect.sString
68241>>>        
68241>>>        Set psId to sId
68242>>>        Set pbOk to False
68243>>>        Set pbChanged to False
68244>>>        Set Value of oUserIDForm to Connect.sUID
68245>>>        Set Value of oPwdForm to ""
68246>>>        
68246>>>        Send Popup
68247>>>        
68247>>>        Get pbOk to bOk
68248>>>        Get pbChanged to bChanged
68249>>>        If (bChanged and bOk) Begin
68251>>>            If bAllowRemember Begin
68253>>>                Get Checked_State of oRemember to bRemember
68254>>>                If bRemember Begin
68256>>>                    Get Checked_State of oTrustedConnection to bTrusted
68257>>>                    If not (bTrusted) Begin
68259>>>                        Get Value of oUserIDForm to sUser
68260>>>                        Get Value of oPwdForm to sPwd
68261>>>                    End
68261>>>>
68261>>>                    Get StoreConnectionIdCredentials of ghoConnection sId sUser sPwd bTrusted to bOk
68262>>>                End
68262>>>>
68262>>>            End
68262>>>>
68262>>>        End
68262>>>>
68262>>>        Function_Return bOk
68263>>>    End_Function
68264>>>    
68264>>>    
68264>>>    On_Key Key_Alt+Key_O Send KeyAction of oLogin_btn
68265>>>    On_Key Key_Alt+Key_L Send KeyAction of oCancel_btn
68266>>>End_Object
68267>>>
68267>    End_Object
68268>
68268>End_Object
68269>
68269>Object oToolTipController is a cToolTipController
68271>    Move Self to ghoToolTipController
68272>End_Object
68273>
68273>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\oEditContextMenu.pkg)
68273>>>Use cCJStandardMenuItemClasses.pkg
68273>>>
68273>>>Object oEditContextMenu is a cCJContextMenu
68275>>>    
68275>>>    Move Self to Default_Form_Floating_Menu_ID
68276>>>    
68276>>>    Object oUndoMenuItem is a cCJUndoMenuItem
68278>>>    End_Object
68279>>>    
68279>>>    Object oCutMenuItem is a cCJCutMenuItem
68281>>>        Set pbControlBeginGroup to True
68282>>>    End_Object
68283>>>    
68283>>>    Object oCopyMenuItem is a cCJCopyMenuItem
68285>>>    End_Object
68286>>>
68286>>>    Object oPasteMenuItem is a cCJPasteMenuItem
68288>>>    End_Object
68289>>>
68289>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
68291>>>    End_Object
68292>>>
68292>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
68294>>>        Set pbControlBeginGroup to True
68295>>>    End_Object
68296>>>
68296>>>End_Object
68297>>>
68297>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\oDEOEditContextMenu17.pkg)
68297>>>Use Windows.pkg
68297>>>Use cCJStandardMenuItemClasses.pkg
68297>>>Use cCJDeoMenuItemClasses.pkg
68297>>>
68297>>>
68297>>>Object oDEOEditContextMenu17 is a cCJContextMenu
68299>>>    
68299>>>    Move Self to Default_dbFloating_Menu_ID
68300>>>    
68300>>>    Object oUndoMenuItem is a cCJUndoMenuItem
68302>>>    End_Object
68303>>>    
68303>>>    Object oCutMenuItem is a cCJCutMenuItem
68305>>>        Set pbControlBeginGroup to True
68306>>>    End_Object
68307>>>    
68307>>>    Object oCopyMenuItem is a cCJCopyMenuItem
68309>>>    End_Object
68310>>>
68310>>>    Object oPasteMenuItem is a cCJPasteMenuItem
68312>>>    End_Object
68313>>>
68313>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
68315>>>    End_Object
68316>>>
68316>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
68318>>>        Set pbControlBeginGroup to True
68319>>>    End_Object
68320>>>
68320>>>    Object oPromptMenuItem is a cCJPromptMenuItem
68322>>>        Set pbControlBeginGroup to True
68323>>>    End_Object
68324>>>
68324>>>    Object oFindNextMenu is a cCJFindNextMenuItem
68326>>>        Set pbControlBeginGroup to True
68327>>>    End_Object
68328>>>
68328>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
68330>>>    End_Object
68331>>>
68331>>>    Object oClearMenuItem is a cCJClearMenuItem
68333>>>        Set pbControlBeginGroup to True
68334>>>    End_Object
68335>>>
68335>>>    Object oClearAllMenu is a cCJClearAllMenuItem
68337>>>    End_Object
68338>>>
68338>>>    Object oSaveMenu is a cCJSaveMenuItem
68340>>>    End_Object
68341>>>    
68341>>>    Object oDeleteMenu is a cCJDeleteMenuItem
68343>>>    End_Object
68344>>>
68344>>>    Object oRememberitem is a cCJRememberFieldMenuItem
68346>>>        Set pbControlBeginGroup to True
68347>>>    End_Object
68348>>>
68348>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
68350>>>    End_Object
68351>>>
68351>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
68353>>>    End_Object
68354>>>
68354>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
68356>>>    End_Object
68357>>>
68357>>>End_Object
68358>
68358>Object oMain is a Panel
68360>    Set Label To "My Project"
68361>    Set Location to 4 3
68362>    Set Size to 300 450
68363>
68363>    Object oCommandBarSystem is a cCJCommandBarSystem
68365>        Set pbTimerUpdate to True
68366>        Set peVisualTheme to xtpThemeOffice2013Outlook
68367>        Set pbAutoResizeIcons to True
68368>
68368>        Procedure OnCreateCommandBars
68371>            Handle hoOptions
68371>            Get OptionsObject to hoOptions
68372>            Forward Send OnCreateCommandBars
68374>        End_Procedure
68375>
68375>        Object oMenuBar is a cCJMenuBar
68377>
68377>            Object oFileMenu is a cCJMenuItem
68379>                Set peControlType to xtpControlPopup          
68380>                Set psCaption   to "&File"
68381>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
68382>                Set psCategory to "Menus"
68383>
68383>                Object oClearMenuItem is a cCJClearMenuItem
68385>                    Set pbAddToDesignerMenu to True
68386>                End_Object
68387>
68387>                Object oClearAllMenu is a cCJClearAllMenuItem
68389>                    Set pbAddToDesignerMenu to True
68390>                End_Object
68391>
68391>                Object oPromptMenuItem is a cCJPromptMenuItem
68393>                    Set pbAddToDesignerMenu to True
68394>                    Set pbControlBeginGroup to True
68395>                End_Object
68396>
68396>                Object oFindMenuItem is a cCJFindMenuItem
68398>                    Set pbAddToDesignerMenu to True
68399>                    Set pbControlBeginGroup to True
68400>                End_Object
68401>
68401>                Object oFindNextMenu is a cCJFindNextMenuItem
68403>                    Set pbAddToDesignerMenu to True
68404>                End_Object
68405>
68405>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
68407>                    Set pbAddToDesignerMenu to True
68408>                End_Object
68409>
68409>                Object oFindFirstMenu is a cCJFindFirstMenuItem
68411>                    Set pbAddToDesignerMenu to True
68412>                End_Object
68413>
68413>                Object oFindLastMenu is a cCJFindLastMenuItem
68415>                    Set pbAddToDesignerMenu to True
68416>                End_Object
68417>
68417>                Object oSaveMenuItem is a cCJSaveMenuItem
68419>                    Set pbAddToDesignerMenu to True
68420>                    Set pbControlBeginGroup to True
68421>                End_Object
68422>
68422>                Object oDeleteMenuItem is a cCJDeleteMenuItem
68424>                    Set pbAddToDesignerMenu to True
68425>                End_Object
68426>
68426>                Object oExitMenu is a cCJExitMenuItem
68428>                    Set pbControlBeginGroup to True
68429>                End_Object
68430>
68430>            End_Object
68431>
68431>            Object oViewMenu is a cCJMenuItem
68433>                Set peControlType to xtpControlPopup
68434>                Set psCaption to "&View"
68435>                Set psToolTip to "View"
68436>                Set psDescription to "Available Views"
68437>
68437>                Object oEmpEntryMenuItem is a cCJMenuItem
68439>                    Set psCaption to "EmpEntry"
68440>                    Set psTooltip to "EmpEntry"
68441>                
68441>                    Procedure OnExecute Variant vCommandBarControl
68444>                        Handle hoClient
68444>                        Get Client_Id to hoClient
68445>                        Send Activate_oEmpEntry of hoClient
68446>                    End_Procedure
68447>                End_Object
68448>
68448>                Object oLineEntryMenuItem is a cCJMenuItem
68450>                    Set psCaption to "LineEntry"
68451>                    Set psTooltip to "LineEntry"
68452>                
68452>                    Procedure OnExecute Variant vCommandBarControl
68455>                        Handle hoClient
68455>                        Get Client_Id to hoClient
68456>                        Send Activate_oLineEntry of hoClient
68457>                    End_Procedure
68458>                End_Object
68459>
68459>                Object oPageHeaderEntryMenuItem is a cCJMenuItem
68461>                    Set psCaption to "PageHeaderEntry"
68462>                    Set psTooltip to "PageHeaderEntry"
68463>                
68463>                    Procedure OnExecute Variant vCommandBarControl
68466>                        Handle hoClient
68466>                        Get Client_Id to hoClient
68467>                        Send Activate_oPageHeaderEntry of hoClient
68468>                    End_Procedure
68469>                End_Object
68470>
68470>                Object oShoeEntryMenuItem is a cCJMenuItem
68472>                    Set psCaption to "ShoeEntry"
68473>                    Set psTooltip to "ShoeEntry"
68474>                
68474>                    Procedure OnExecute Variant vCommandBarControl
68477>                        Handle hoClient
68477>                        Get Client_Id to hoClient
68478>                        Send Activate_oShoeEntry of hoClient
68479>                    End_Procedure
68480>                End_Object
68481>
68481>                Object oPageFooterEntryMenuItem is a cCJMenuItem
68483>                    Set psCaption to "PageFooterEntry"
68484>                    Set psTooltip to "PageFooterEntry"
68485>                
68485>                    Procedure OnExecute Variant vCommandBarControl
68488>                        Handle hoClient
68488>                        Get Client_Id to hoClient
68489>                        Send Activate_oPageFooterEntry of hoClient
68490>                    End_Procedure
68491>                End_Object
68492>
68492>                Object oPageFooterEntry2MenuItem is a cCJMenuItem
68494>                    Set psCaption to "PageFooterEntry2"
68495>                    Set psTooltip to "PageFooterEntry2"
68496>                
68496>                    Procedure OnExecute Variant vCommandBarControl
68499>                        Handle hoClient
68499>                        Get Client_Id to hoClient
68500>                        Send Activate_oPageFooterEntry2 of hoClient
68501>                    End_Procedure
68502>                End_Object
68503>
68503>                Object oPageFooterEntry3MenuItem is a cCJMenuItem
68505>                    Set psCaption to "PageFooterEntry3"
68506>                    Set psTooltip to "PageFooterEntry3"
68507>                
68507>                    Procedure OnExecute Variant vCommandBarControl
68510>                        Handle hoClient
68510>                        Get Client_Id to hoClient
68511>                        Send Activate_oPageFooterEntry3 of hoClient
68512>                    End_Procedure
68513>                End_Object
68514>            End_Object
68515>            
68515>            Object oReportMenu is a cCJMenuItem
68517>                Set peControlType to xtpControlPopup
68518>                Set psCaption to "&Report"
68519>                Set psToolTip to "Report"
68520>                Set psDescription to "Available Reports"
68521>
68521>                Object oReportViewMenuItem is a cCJMenuItem
68523>                    Set psCaption to "ReportView"
68524>                    Set psTooltip to "ReportView"
68525>                
68525>                    Procedure OnExecute Variant vCommandBarControl
68528>                        Handle hoClient
68528>                        Get Client_Id to hoClient
68529>                        Send Activate_oReportView of hoClient
68530>                    End_Procedure
68531>                End_Object
68532>            End_Object
68533>
68533>            Object oNavigateMenu is a cCJMenuItem
68535>                Set peControlType to xtpControlPopup      
68536>                Set psCaption to "&Navigate"    
68537>                Set psTooltip to "Navigate"    
68538>                Set psDescription to "Move to different areas of the application"
68539>
68539>                Object oNextAreaMenu is a cCJNextAreaMenu
68541>                End_Object
68542>
68542>                Object oPriorAreaMenu is a cCJPriorAreaMenu
68544>                End_Object
68545>
68545>                Object oNextViewMenu is a cCJNextViewMenu
68547>                End_Object
68548>
68548>                Object oPriorViewMenu is a cCJPriorViewMenu
68550>                End_Object
68551>
68551>                Object oPromptMenu is a cCJPromptMenuItem
68553>                    Set pbControlBeginGroup to True
68554>                End_Object
68555>
68555>                Object oZoomMenu is a cCJZoomMenuItem
68557>                End_Object
68558>
68558>            End_Object
68559>
68559>            Object oWindowMenu is a cCJMDIWindowsMenuItem
68561>                Set peControlType to xtpControlPopup
68562>                Set psCaption to "&Window"
68563>                Set psToolTip to "Window"
68564>                Set psDescription to "Display Current Views and set other display options."    
68565>
68565>                // These are the static windows items. More will be created in onInitPopup 
68565>                Object oDisplayOptionsMenu is a cCJMenuItem
68567>                    Set peControlType to xtpControlPopup          
68568>                    Set psCaption to "&Display Options"
68569>                    Set psToolTip to "Display Options"
68570>                    Set psDescription to "Set display options"
68571>
68571>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
68573>                    End_Object
68574>
68574>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
68576>                    End_Object
68577>
68577>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
68579>                        Set pbControlBeginGroup to True
68580>                    End_Object
68581>
68581>                End_Object
68582>
68582>                Object oCascadeMenu is a cCJCascadeMenuItem
68584>                    Set pbControlBeginGroup to True
68585>                End_Object
68586>
68586>                Object oHorizTile is a cCJTileHorizontally
68588>                End_Object
68589>
68589>                Object oVertTile is a cCJTileVertically
68591>                End_Object
68592>
68592>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
68594>                    Set pbControlBeginGroup to True
68595>                End_Object
68596>
68596>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
68598>                End_Object
68599>
68599>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
68601>                    Set pbControlBeginGroup to True
68602>                End_Object
68603>
68603>            End_Object
68604>
68604>            Object oHelpMenu is a cCJMenuItem
68606>                Set peControlType to xtpControlPopup    
68607>                Set psCaption to "&Help"
68608>                Set psDescription to "Access Information for learning and using this DataFlex application."
68609>                Set psToolTip to "Help"
68610>
68610>                Object oHelpMenuItem is a cCJHelpMenuItem 
68612>                End_Object
68613>
68613>                Object oAboutMenuItem is a cCJAboutMenuItem
68615>                End_Object
68616>
68616>            End_Object
68617>
68617>        End_Object
68618>
68618>        Object oFindToolBar is a cCJToolbar
68620>            Set psTitle to "Finding Toolbar"
68621>
68621>            Object oFindFirstTool is a cCJFindFirstMenuItem
68623>            End_Object
68624>
68624>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
68626>            End_Object
68627>
68627>            Object oFindMenuTool is a cCJFindMenuItem
68629>            End_Object
68630>
68630>            Object oFindNextTool is a cCJFindNextMenuItem
68632>            End_Object
68633>
68633>            Object oFindLastTool is a cCJFindLastMenuItem
68635>            End_Object
68636>
68636>            Object oPromptToolItem is a cCJPromptMenuItem
68638>                Set pbControlBeginGroup to True
68639>            End_Object
68640>
68640>        End_Object
68641>
68641>        Object oFileToolBar is a cCJToolbar
68643>            Set psTitle to "Data Entry Toolbar"
68644>
68644>            Object oClearToolItem is a cCJClearMenuItem
68646>                Set peControlStyle to xtpButtonIconAndCaption
68647>            End_Object
68648>
68648>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
68650>                Set peControlStyle to xtpButtonIconAndCaption
68651>            End_Object
68652>
68652>            Object oSaveToolItem is a cCJSaveMenuItem
68654>                Set peControlStyle to xtpButtonIconAndCaption
68655>                Set pbControlBeginGroup to True
68656>            End_Object
68657>
68657>            Object oDeleteToolItem is a cCJDeleteMenuItem
68659>                Set peControlStyle to xtpButtonIconAndCaption
68660>            End_Object
68661>
68661>        End_Object
68662>
68662>        Object oEditToolBar is a cCJToolbar
68664>            Set psTitle to "Edit Toolbar"
68665>
68665>            Object oCutToolbarItem is a cCJCutMenuItem
68667>            End_Object
68668>
68668>            Object oCopyToolbarItem is a cCJCopyMenuItem
68670>            End_Object
68671>
68671>            Object oPasteToolbarItem is a cCJPasteMenuItem
68673>            End_Object
68674>
68674>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
68676>                Set pbControlBeginGroup to True
68677>            End_Object
68678>
68678>        End_Object
68679>
68679>        Object oRememberToolbar is a cCJToolbar
68681>            Set psTitle to C_$Remember
68682>
68682>            Object oRememberItems is a cCJMenuItem
68684>
68684>                Set peControlType to xtpControlPopup
68685>                Set peControlStyle to xtpButtonCaption
68686>                Set psCaption to C_$Remember
68687>                
68687>                Object oMenuItem is a cCJRememberFieldMenuItem
68689>                    Set peControlStyle to xtpButtonIconAndCaption
68690>                End_Object
68691>                
68691>                Object oMenuItem is a cCJRememberLastFieldMenuItem
68693>                    Set peControlStyle to xtpButtonIconAndCaption
68694>                End_Object
68695>                
68695>                Object oMenuItem is a cCJUnRememberFieldMenuItem
68697>                    Set peControlStyle to xtpButtonIconAndCaption
68698>                End_Object
68699>                
68699>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
68701>                    Set peControlStyle to xtpButtonIconAndCaption
68702>                End_Object
68703>
68703>            End_Object
68704>            
68704>        End_Object
68705>        
68705>        Object oStatusBar is a cCJStatusBar
68707>
68707>            Object oStatusPane1 is a cCJStatusBarPane
68709>                Set piID to sbpIDIdlePane
68710>                Set pbStyleStretch to True
68711>            End_Object
68712>
68712>            Object oStatusPane2 is a cCJStatusBarPane
68714>                Set phoViewPane to Self
68715>                Set pbStyleStretch to True
68716>            End_Object
68717>
68717>        End_Object
68718>
68718>    End_Object
68719>
68719>    Object oClientArea is a ClientArea
68721>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\StdAbout.pkg)
68721>>>// This provides a quick and simple way to create an about package for a program.
68721>>>// You need to create a message inside you client area called Activate_About.
68721>>>// Within this message you should send the message DoAbout passing needed
68721>>>// string information.
68721>>>//
68721>>>//       Procedure Activate_About
68721>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
68721>>>//       End_Procedure
68721>>>//    where: sTitle =     Name of application. If none provided, uses caption
68721>>>//                        bar title
68721>>>//           sVersion   = Version Line. If none provided, will be blank
68721>>>//           sCopyRight = Copyright Line. If none provided, will be blank
68721>>>//           sAuthor    = Author name, blank if none provided
68721>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
68721>>>//                        is used.
68721>>>// It is expected that you will place this in your own object package. For
68721>>>// example an order about package may look like this:
68721>>>//
68721>>>//   // OrderAbout.pkg
68721>>>//   Use StdAbout.pkg
68721>>>//   Procedure Activate_About
68721>>>//      String sTitle sCopyright sVersion sAuthor
68721>>>//      Move "My Order Entry System" to sTitle
68721>>>//      Move "Version 2.1" to sVersion
68721>>>//      Move "Copyright xxxx, Super Software Inc." to sCopyright
68721>>>//      Move "John Smith"  to sAuthor
68721>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
68721>>>//   end_procedure
68721>>>//   // end of file.
68721>>>
68721>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Dfabout.pkg)
68721>>>>>Use LanguageText.pkg
68721>>>>>Use Windows.pkg
68721>>>>>Use DFbitmap.pkg
68721>>>>>Use GlobalFunctionsProcedures.pkg
68721>>>>>Use cTextEdit.pkg
68721>>>>>Use tWinStructs.pkg
68721>>>>>
68721>>>>>Use cli.pkg
68721>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 19.1\Pkg\DFBTRDRV.PKG)
68721>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
68721>>>>>>>// Notice      : This package contains constants and commands, used to call
68721>>>>>>>//               specific functions in the DFBTRDRV.
68721>>>>>>>Use Ui
68721>>>>>>>//
68721>>>>>>>// Driver Indentification
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>// Driver attributes
68721>>>>>>>//
68721>>>>>>>// Call_Driver functions ID's
68721>>>>>>>//
68721>>>>>>>//
68721>>>>>>>// DFBTRFN_CONVERT_FILE options
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// DFBTRFN_SET_OWNER options
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to create all vars which may be needed
68721>>>>>>>// in other commands.
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to set the owner of a Btrieve file.
68721>>>>>>>// File must have been opened.
68721>>>>>>>// Filenumber needs to be passed.
68721>>>>>>>// To clear set the owner to "".
68721>>>>>>>// Examples:
68721>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
68721>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
68721>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
68721>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
68721>>>>>>>// To clear:
68721>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to parse DFBTR_SET_OWNVER
68721>>>>>>>// options.
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to parse for Callback
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to clear the owner of a Btrieve file.
68721>>>>>>>// File must have been opened.
68721>>>>>>>// Filenumber needs to be passed.
68721>>>>>>>// Examples:
68721>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to add a owner name to the internal list of ownernames
68721>>>>>>>// which will be tries when opening files.
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to remove all owners from the internal list of ownernames
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to set the owner name to be used when opening the DDF files.
68721>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
68721>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
68721>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to change the transaction type.
68721>>>>>>>// Valid types are:
68721>>>>>>>//     DFBTRTT_NONE
68721>>>>>>>//     DFBTRTT_EXCLUSIVE
68721>>>>>>>//     DFBTRTT_CONCURRENT
68721>>>>>>>//
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to get the current transaction type.
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to set explicit_locking
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to get explicit locking
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>//
68721>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
68721>>>>>>>//
68721>>>>>>>
68721>>>>>>>// Purpose: An instance of this class can be used as a broker object to
68721>>>>>>>//          call several Dfbtrdrv releated methods.
68721>>>>>>>
68721>>>>>>>Class cDFBtrDrvHandler is an Array
68722>>>>>>>    
68722>>>>>>>    Procedure Construct_Object Integer iImage
68724>>>>>>>        Forward Send Construct_object iImage
68726>>>>>>>        
68726>>>>>>>        Property String  psDriverID "DFBTRDRV"
68727>>>>>>>    End_Procedure
68728>>>>>>>    
68728>>>>>>>    //  The revsion of a Dfbtrdrv Connectivity Kit
68728>>>>>>>    //
68728>>>>>>>    
68728>>>>>>>    Function CKRevision Returns String
68730>>>>>>>        String  sDriverID
68730>>>>>>>        String  sRevision
68730>>>>>>>        String  sVoid
68730>>>>>>>        Integer iRetval
68730>>>>>>>        
68730>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68730>>>>>>>        // This error would otherwise be raised when we have an older
68730>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68730>>>>>>>        Send Ignore_error to Error_object_Id 20491
68731>>>>>>>        Get psDriverID to sDriverID
68732>>>>>>>        Move (Repeat(" ", 255)) to sRevision
68733>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
68738>>>>>>>        Send Trap_Error to Error_object_Id 20491
68739>>>>>>>        If (Trim(sRevision) = "") Begin
68741>>>>>>>            // Unable to get the revision. return all zeroes.
68741>>>>>>>            Move "0.0.0.0" to sRevision
68742>>>>>>>        End
68742>>>>>>>>
68742>>>>>>>        Function_Return sRevision
68743>>>>>>>    End_Function
68744>>>>>>>    
68744>>>>>>>    Function CkUsesUri Returns Integer
68746>>>>>>>        String  sDriverID
68746>>>>>>>        String  sVoid1
68746>>>>>>>        String  sVoid2
68746>>>>>>>        Integer iRetval
68746>>>>>>>        
68746>>>>>>>        Get psDriverID to sDriverID
68747>>>>>>>        
68747>>>>>>>        Move 0 to iRetval
68748>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68748>>>>>>>        // This error would otherwise be raised when we have an older
68748>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
68748>>>>>>>        Send Ignore_error to Error_object_Id 20491
68749>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
68754>>>>>>>        Send Trap_Error to Error_object_Id 20491
68755>>>>>>>        
68755>>>>>>>        Function_Return iRetval
68756>>>>>>>    End_Function
68757>>>>>>>    
68757>>>>>>>    
68757>>>>>>>    
68757>>>>>>>    // Extract the Nth part of a a.b.c.d revsion string.
68757>>>>>>>    //
68757>>>>>>>    // Returns : The part version number or -1 if there is no such part number.
68757>>>>>>>    //
68757>>>>>>>    
68757>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
68759>>>>>>>        Integer iPartRev
68759>>>>>>>        Integer iCurrentPart
68759>>>>>>>        Integer iSeparatorPos
68759>>>>>>>        
68759>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
68762>>>>>>>        
68762>>>>>>>        Move 0 to iCurrentPart
68763>>>>>>>        Repeat
68763>>>>>>>>
68763>>>>>>>            Move (Pos(".", sRevision)) to iSeparatorPos
68764>>>>>>>            If (iSeparatorPos > 0) Begin
68766>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) to iPartRev
68767>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) to sRevision
68768>>>>>>>                Increment iCurrentPart
68769>>>>>>>            End
68769>>>>>>>>
68769>>>>>>>            Else If (sRevision <> "") Begin
68772>>>>>>>                Move sRevision to iPartRev
68773>>>>>>>                Move "" to sRevision
68774>>>>>>>                Increment iCurrentPart
68775>>>>>>>            End
68775>>>>>>>>
68775>>>>>>>            Else ;                Move -1 to iPartRev
68777>>>>>>>        Until (iCurrentPart >= iPartNum or iPartRev = -1)
68779>>>>>>>        
68779>>>>>>>        Function_Return iPartRev
68780>>>>>>>    End_Function
68781>>>>>>>    
68781>>>>>>>    
68781>>>>>>>    
68781>>>>>>>    //
68781>>>>>>>    //  Returns the major revision of the CK
68781>>>>>>>    //
68781>>>>>>>    
68781>>>>>>>    Function CKMajorRevision Returns Integer
68783>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
68784>>>>>>>    End_Function
68785>>>>>>>    
68785>>>>>>>    
68785>>>>>>>    
68785>>>>>>>    //  Returns the minor revision of the CK
68785>>>>>>>    //
68785>>>>>>>    
68785>>>>>>>    Function CKMinorRevision Returns Integer
68787>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
68788>>>>>>>    End_Function
68789>>>>>>>    
68789>>>>>>>    
68789>>>>>>>    //  Returns the release revision of the CK
68789>>>>>>>    //
68789>>>>>>>    
68789>>>>>>>    Function CKReleaseRevision Returns Integer
68791>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
68792>>>>>>>    End_Function
68793>>>>>>>    
68793>>>>>>>    
68793>>>>>>>    //  Returns the major revision of the CK
68793>>>>>>>    //
68793>>>>>>>    
68793>>>>>>>    Function CKBuildRevision Returns Integer
68795>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
68796>>>>>>>    End_Function
68797>>>>>>>    
68797>>>>>>>    
68797>>>>>>>    //  Determines if the CK conforms to a passed minimal revsion.
68797>>>>>>>    //
68797>>>>>>>    
68797>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
68799>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_Return (True)
68802>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
68805>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_Return (True)
68808>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
68811>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_Return (True)
68814>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) and iBuild <= CKBuildRevision(Current_object)) ;                    Function_Return (True)
68818>>>>>>>            End
68818>>>>>>>>
68818>>>>>>>        End
68818>>>>>>>>
68818>>>>>>>        
68818>>>>>>>        Function_Return (False)
68819>>>>>>>    End_Function
68820>>>>>>>    
68820>>>>>>>    //   Functions to query the Pervasive.SQL version:
68820>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
68820>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
68820>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
68820>>>>>>>    //
68820>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
68820>>>>>>>    //   in the following format:
68820>>>>>>>    //       <version>.<revision>.<type>
68820>>>>>>>    //   possible values for <type>:
68820>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
68820>>>>>>>    //         server using Workgroup authentication mode
68820>>>>>>>    //       C for client cache engine
68820>>>>>>>    //       D for DOS workstation
68820>>>>>>>    //       N for client Requester
68820>>>>>>>    //       S for NetWare server
68820>>>>>>>    //       T for 32-bit Windows server engine
68820>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
68820>>>>>>>    //
68820>>>>>>>    //   example:
68820>>>>>>>    //       8.50.T
68820>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
68820>>>>>>>    //   32-bits Windows server.
68820>>>>>>>    //
68820>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
68820>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
68820>>>>>>>    //
68820>>>>>>>    //   If the version information is not available or can not be obtained
68820>>>>>>>    //   the functions will return "0.0.0"
68820>>>>>>>    
68820>>>>>>>    //  Returns the version information of the
68820>>>>>>>    //           Pervasive.SQL Client requester.
68820>>>>>>>    
68820>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
68822>>>>>>>        
68822>>>>>>>        String  sDriverID
68822>>>>>>>        String  sVersion
68822>>>>>>>        String  sVoid
68822>>>>>>>        Integer iRetval
68822>>>>>>>        
68822>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68822>>>>>>>        // This error would otherwise be raised when we have an older
68822>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68822>>>>>>>        Send Ignore_error to Error_object_Id 20491
68823>>>>>>>        Get psDriverID to sDriverID
68824>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68825>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68830>>>>>>>        Send Trap_Error to Error_object_Id 20491
68831>>>>>>>        If (Trim(sVersion) = "") Begin
68833>>>>>>>            // Unable to get the revision. return all zeroes.
68833>>>>>>>            Move "0.0.0" to sVersion
68834>>>>>>>        End
68834>>>>>>>>
68834>>>>>>>        Function_Return sVersion
68835>>>>>>>    End_Function
68836>>>>>>>    
68836>>>>>>>    //           Pervasive.SQL Engine
68836>>>>>>>    
68836>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
68838>>>>>>>        
68838>>>>>>>        String  sDriverID
68838>>>>>>>        String  sVersion
68838>>>>>>>        String  sVoid
68838>>>>>>>        Integer iRetval
68838>>>>>>>        
68838>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68838>>>>>>>        // This error would otherwise be raised when we have an older
68838>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68838>>>>>>>        Send Ignore_error to Error_object_Id 20491
68839>>>>>>>        Get psDriverID to sDriverID
68840>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68841>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68846>>>>>>>        Send Trap_Error to Error_object_Id 20491
68847>>>>>>>        If (Trim(sVersion) = "") Begin
68849>>>>>>>            // Unable to get the revision. return all zeroes.
68849>>>>>>>            Move "0.0.0" to sVersion
68850>>>>>>>        End
68850>>>>>>>>
68850>>>>>>>        Function_Return sVersion
68851>>>>>>>    End_Function
68852>>>>>>>    
68852>>>>>>>    //  Returns the version information of the
68852>>>>>>>    //           Pervasive.SQL Server Engine
68852>>>>>>>    
68852>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
68854>>>>>>>        
68854>>>>>>>        String  sDriverID
68854>>>>>>>        String  sVersion
68854>>>>>>>        String  sVoid
68854>>>>>>>        Integer iRetval
68854>>>>>>>        
68854>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68854>>>>>>>        // This error would otherwise be raised when we have an older
68854>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68854>>>>>>>        Send Ignore_error to Error_object_Id 20491
68855>>>>>>>        Get psDriverID to sDriverID
68856>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68857>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68862>>>>>>>        Send Trap_Error to Error_object_Id 20491
68863>>>>>>>        If (Trim(sVersion) = "") Begin
68865>>>>>>>            // Unable to get the revision. return all zeroes.
68865>>>>>>>            Move "0.0.0" to sVersion
68866>>>>>>>        End
68866>>>>>>>>
68866>>>>>>>        Function_Return sVersion
68867>>>>>>>    End_Function
68868>>>>>>>    
68868>>>>>>>End_Class
68869>>>>>>>
68869>>>>>>>
68869>>>>>Use MSSqldrv.pkg
Including file: MSSqldrv.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\MSSqldrv.pkg)
68869>>>>>>>//     Package that declares MS SQL driver constants and functions.
68869>>>>>>>//     This package can be used by developers who want to add Data Access
68869>>>>>>>//     MS SQL Client specific code to a DataFlex application.
68869>>>>>>>
68869>>>>>>>Use Cli.pkg
68869>>>>>>>Use SQL.pkg
68869>>>>>>>
68869>>>>>>>//   Driver Indentification
68869>>>>>>>
68869>>>>>>>//   Error number constants
68869>>>>>>>
68869>>>>>>>
68869>>>>>>>//   Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
68869>>>>>>>
68869>>>>>>>
68869>>>>>>>
68869>>>>>>>
68869>>>>>>>
68869>>>>>>>
68869>>>>>>>// SQL Server spcific types.
68869>>>>>>>Define SQL_SS_TIMESTAMPOFFSET   for   (-155) //SQL server datetimeoffset type */
68869>>>>>>>Define SQL_SS_TIME2             for   (-154) //SQL server time type */
68869>>>>>>>Define SQL_SS_XML               for   (-152) //SQL server xml type */
68869>>>>>>>Define SQL_SS_VARIANT           for   (-150) //SQL server variant type */
68869>>>>>>>
68869>>>>>>>// SQL Server spcific types.
68869>>>>>>>Define SQL_TYPE_TIMESTAMP2      for   (-200) //SQL server datetime2 type */
68869>>>>>>>Define SQL_VARCHARMAX           for   (-201) //SQL server varchar(max) type */
68869>>>>>>>Define SQL_WVARCHARMAX          for   (-202) //SQL server wvarchar(max) type */
68869>>>>>>>Define SQL_VARBINARYMAX         for   (-203) //SQL server varbinary(max) type */
68869>>>>>>>Define SQL_TYPE_MONEY           for   (-204) //SQL server money type */
68869>>>>>>>Define SQL_TYPE_SMALLMONEY      for   (-205) //SQL server smallmoney type */
68869>>>>>>>Define SQL_TYPE_SMALLDATETIME   for   (-206) //SQL server smalldatetype type */
68869>>>>>>>
68869>>>>>>>
68869>>>>>>>//   MSSQL_SetConstraint <FileNum> <ConstraintText>
68869>>>>>>>//
68869>>>>>>>//     Setup a constraint for a file.
68869>>>>>>>
68869>>>>>>>
68869>>>>>>>Class cMSSQLHandler is a cCLIHandler
68870>>>>>>>    
68870>>>>>>>    Procedure Construct_Object
68872>>>>>>>        Forward Send Construct_Object
68874>>>>>>>        
68874>>>>>>>        Set psDriverID to MSSQLDRV_ID
68875>>>>>>>    End_Procedure
68876>>>>>>>    
68876>>>>>>>    
68876>>>>>>>    
68876>>>>>>>    //   Extract the list from the out connect string.
68876>>>>>>>    Function ExtractList String sOutConnStr Integer hoStore Returns Integer
68878>>>>>>>        String  sItem
68878>>>>>>>        Integer iStart
68878>>>>>>>        Integer iEnd
68878>>>>>>>        
68878>>>>>>>        If (hoStore = 0) ;            Move Current_object to hoStore
68881>>>>>>>        
68881>>>>>>>        Send Delete_Data to hoStore
68882>>>>>>>        Move (Pos("{", sOutConnStr)) to iStart
68883>>>>>>>        While (iStart > 0)
68887>>>>>>>            Move (Right(sOutConnStr, Length(sOutConnStr) - iStart)) to sOutConnStr
68888>>>>>>>            If (Left(sOutConnStr, 1) = "}") ;                Move 0 to iStart
68891>>>>>>>            Else Begin
68892>>>>>>>                Move (Pos(",", sOutConnStr)) to iStart
68893>>>>>>>                Move (Pos("}", sOutConnStr)) to iEnd
68894>>>>>>>                If ((iStart = 0) or (iEnd < iStart)) ;                    Move iEnd to iStart
68897>>>>>>>                
68897>>>>>>>                If (iStart > 0) ;                    Set Value of hoStore  (Item_Count(Current_Object)) to (Left(sOutConnStr, iStart - 1))
68900>>>>>>>                
68900>>>>>>>                If (iStart = iEnd) ;                    Move 0 to iStart
68903>>>>>>>            End
68903>>>>>>>>
68903>>>>>>>        Loop
68904>>>>>>>>
68904>>>>>>>        
68904>>>>>>>        Function_Return (Item_Count(hoStore))
68905>>>>>>>    End_Function
68906>>>>>>>    
68906>>>>>>>    
68906>>>>>>>    
68906>>>>>>>    //   Call the driver's browse connect function
68906>>>>>>>    Function BrowseConnect String sInConnStr Returns String
68908>>>>>>>        String  sDriver
68908>>>>>>>        String  sOutConnStr
68908>>>>>>>        Integer iArg
68908>>>>>>>        Integer iRetval
68908>>>>>>>        
68908>>>>>>>        Get psDriverID to sDriver
68909>>>>>>>        If (sDriver <> "") Begin
68911>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
68912>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
68917>>>>>>>        End
68917>>>>>>>>
68917>>>>>>>        
68917>>>>>>>        Function_Return sOutConnStr
68918>>>>>>>    End_Function// BrowseConnect
68919>>>>>>>    
68919>>>>>>>    
68919>>>>>>>    Function BrowseConnectLocal String sInConnStr Returns String
68921>>>>>>>        String  sDriver
68921>>>>>>>        String  sOutConnStr
68921>>>>>>>        Integer iArg
68921>>>>>>>        Integer iRetval
68921>>>>>>>        
68921>>>>>>>        Move 1 to iArg // Browses only local
68922>>>>>>>        
68922>>>>>>>        Get psDriverID to sDriver
68923>>>>>>>        If (sDriver <> "") Begin
68925>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
68926>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
68931>>>>>>>        End
68931>>>>>>>>
68931>>>>>>>        
68931>>>>>>>        Function_Return sOutConnStr
68932>>>>>>>    End_Function// BrowseConnect
68933>>>>>>>    
68933>>>>>>>    
68933>>>>>>>    Function EnumerateServersNetworkOrLocal Integer iNetworkLocal  Returns Integer
68935>>>>>>>        
68935>>>>>>>        String  sServerList
68935>>>>>>>        Integer iNumServers
68935>>>>>>>        Integer iDriver
68935>>>>>>>        Integer iClientVersion
68935>>>>>>>        String  sDriver
68935>>>>>>>        
68935>>>>>>>        Get DriverIndex MSSQLDRV_ID to iDriver
68936>>>>>>>        
68936>>>>>>>        If (iDriver) Begin
68938>>>>>>>            
68938>>>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iDriver to iClientVersion
68941>>>>>>>            
68941>>>>>>>            Get SqlServerClientDriverName iClientVersion to sDriver
68942>>>>>>>            
68942>>>>>>>            Move ("DRIVER={" + sDriver + "};") to sDriver
68943>>>>>>>            If (iNetworkLocal = 0) Begin
68945>>>>>>>                Get BrowseConnect sDriver to sServerList
68946>>>>>>>            End
68946>>>>>>>>
68946>>>>>>>            Else Begin
68947>>>>>>>                Get BrowseConnectLocal sDriver to sServerList
68948>>>>>>>            End
68948>>>>>>>>
68948>>>>>>>            Get ExtractList sServerList Current_object to iNumServers
68949>>>>>>>        End
68949>>>>>>>>
68949>>>>>>>        
68949>>>>>>>        Function_Return iNumServers
68950>>>>>>>        
68950>>>>>>>    End_Function
68951>>>>>>>    
68951>>>>>>>    //   Enumerate the available SQL Server database servers
68951>>>>>>>    //   This function will return all SQL Server instances on the network.
68951>>>>>>>    //   This may take a long time.
68951>>>>>>>    //   To enumerate only local SQL Server instances use EnumerateServersLocal
68951>>>>>>>    Function EnumerateServers Returns Integer
68953>>>>>>>        
68953>>>>>>>        Integer iNumServers
68953>>>>>>>        Integer iNetworkLocal
68953>>>>>>>        
68953>>>>>>>        Move 0 to iNetworkLocal // 0 = enumerate network servers
68954>>>>>>>        
68954>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
68955>>>>>>>        
68955>>>>>>>        Function_Return iNumServers
68956>>>>>>>        
68956>>>>>>>    End_Function
68957>>>>>>>    
68957>>>>>>>    
68957>>>>>>>    //   Enumerate the available SQL Server database servers
68957>>>>>>>    //   This function will return only return SQL Server instance on the local machine
68957>>>>>>>    //   To enumerate all SQL Server instances in a network use EnumerateServers
68957>>>>>>>    Function EnumerateServersLocal Returns Integer
68959>>>>>>>        
68959>>>>>>>        Integer iNumServers
68959>>>>>>>        Integer iNetworkLocal
68959>>>>>>>        
68959>>>>>>>        Move 1 to iNetworkLocal // 1 = enumerate local servers
68960>>>>>>>        
68960>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
68961>>>>>>>        
68961>>>>>>>        Function_Return iNumServers
68962>>>>>>>        
68962>>>>>>>    End_Function
68963>>>>>>>    
68963>>>>>>>    
68963>>>>>>>    
68963>>>>>>>    //   Enumerate database in a given server.
68963>>>>>>>    Function EnumerateDatabases String sServer String sUser String sPassWord Returns Integer
68965>>>>>>>        Integer hoSQL
68965>>>>>>>        String  sConnect
68965>>>>>>>        String  sDatabase
68965>>>>>>>        Integer hdbc
68965>>>>>>>        Integer hstmt
68965>>>>>>>        Integer iFetchResult
68965>>>>>>>        
68965>>>>>>>        If (Num_Arguments < 3) ;            Move "" to sPassWord
68968>>>>>>>        If (Num_Arguments < 2) ;            Move "" to sUser
68971>>>>>>>        
68971>>>>>>>        If (sUser <> "") ;            Move ("SERVER=" + Trim(sServer) + ";UID=" + Trim(sUser) + ";PWD=" + Trim(sPassword) + ";") to sConnect
68974>>>>>>>        Else ;            Move ("SERVER=" + Trim(sServer) + ";Trusted_Connection=yes") to sConnect
68976>>>>>>>        
68976>>>>>>>        Object oEnumDBSQLmanager is a cSQLHandleManager
68978>>>>>>>            Move Current_Object to hoSQL
68979>>>>>>>        End_Object
68980>>>>>>>        
68980>>>>>>>        If (hoSQL <> 0) Begin
68982>>>>>>>            Get SQLConnect of hoSQL "MSSQLDRV" sConnect to hdbc
68983>>>>>>>            If (hdbc <> 0) Begin
68985>>>>>>>                Get SQLOpen of hdbc to hstmt
68986>>>>>>>                If (hstmt <> 0) Begin
68988>>>>>>>                    //   We could do a direct select on the sysdatabases table but we use
68988>>>>>>>                    //   the stored procedure sp_database instead. SQL Server recommends this
68988>>>>>>>                    //   approach in case meta data might change, the stored procedure will
68988>>>>>>>                    //   stay the same.
68988>>>>>>>                    Send SQLSetProcedureName to hstmt "sp_databases"
68989>>>>>>>                    Send SQLCall to hstmt
68990>>>>>>>                    Repeat
68990>>>>>>>>
68990>>>>>>>                        Get SQLFetch of hstmt to iFetchResult
68991>>>>>>>                        If (iFetchResult <> 0) Begin
68993>>>>>>>                            Get SQLColumnValue of hstmt 1 to sDatabase
68994>>>>>>>                            Set Value  (Item_Count(Current_Object)) to sDatabase
68995>>>>>>>                        End
68995>>>>>>>>
68995>>>>>>>                    Until (iFetchResult = 0)
68997>>>>>>>                    
68997>>>>>>>                    Send SQLClose to hstmt
68998>>>>>>>                End
68998>>>>>>>>
68998>>>>>>>                Send SQLDisconnect to hdbc
68999>>>>>>>            End
68999>>>>>>>>
68999>>>>>>>        End
68999>>>>>>>>
68999>>>>>>>        Send Destroy_Object to hoSQL
69000>>>>>>>        
69000>>>>>>>        Function_Return (Item_Count(Current_Object))
69001>>>>>>>    End_Function
69002>>>>>>>    
69002>>>>>>>    
69002>>>>>>>    Function SqlServerClientVersionName Integer iClientVersion  Returns String
69004>>>>>>>        
69004>>>>>>>        String  sSqlServerClientVersionName
69004>>>>>>>        
69004>>>>>>>        
69004>>>>>>>        Case Begin
69004>>>>>>>            
69004>>>>>>>            Case (iClientVersion = SQLSERVER2017CLIENT)
69006>>>>>>>                Move SQLSERVER2017CLIENTNAME to sSqlServerClientVersionName
69007>>>>>>>                Case Break
69008>>>>>>>                
69008>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
69011>>>>>>>                Move SQLSERVER2016CLIENTNAME to sSqlServerClientVersionName
69012>>>>>>>                Case Break
69013>>>>>>>            
69013>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
69016>>>>>>>                Move SQLSERVER2014CLIENTNAME to sSqlServerClientVersionName
69017>>>>>>>                Case Break
69018>>>>>>>            
69018>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
69021>>>>>>>                Move SQLSERVER2012CLIENTNAME to sSqlServerClientVersionName
69022>>>>>>>                Case Break
69023>>>>>>>            
69023>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
69026>>>>>>>                Move SQLSERVER2008CLIENTNAME to sSqlServerClientVersionName
69027>>>>>>>                Case Break
69028>>>>>>>            
69028>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
69031>>>>>>>                Move SQLSERVER2005CLIENTNAME to sSqlServerClientVersionName
69032>>>>>>>                Case Break
69033>>>>>>>            
69033>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
69036>>>>>>>                Move SQLSERVER2000CLIENTNAME to sSqlServerClientVersionName
69037>>>>>>>                Case Break
69038>>>>>>>            
69038>>>>>>>            Case Else
69038>>>>>>>                Move SQLSERVERUNKNOWNCLIENTNAME to sSqlServerClientVersionName
69039>>>>>>>                
69039>>>>>>>        Case End
69039>>>>>>>        
69039>>>>>>>        
69039>>>>>>>        Function_Return sSqlServerClientVersionName
69040>>>>>>>        
69040>>>>>>>    End_Function
69041>>>>>>>
69041>>>>>>>
69041>>>>>>>    Function SqlServerClientDriverName Integer iClientVersion  Returns String
69043>>>>>>>        
69043>>>>>>>        String  sSqlServerClientDriverName
69043>>>>>>>        
69043>>>>>>>        Case Begin
69043>>>>>>>            
69043>>>>>>>            Case (iClientVersion = SQLSERVER2017CLIENT)
69045>>>>>>>                Move SQLSERVER2017DRVRSTR to sSqlServerClientDriverName
69046>>>>>>>                Case Break
69047>>>>>>>                
69047>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
69050>>>>>>>                Move SQLSERVER2016DRVRSTR to sSqlServerClientDriverName
69051>>>>>>>                Case Break
69052>>>>>>>            
69052>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
69055>>>>>>>                Move SQLSERVER2014DRVRSTR to sSqlServerClientDriverName
69056>>>>>>>                Case Break
69057>>>>>>>            
69057>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
69060>>>>>>>                Move SQLSERVER2012DRVRSTR to sSqlServerClientDriverName
69061>>>>>>>                Case Break
69062>>>>>>>            
69062>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
69065>>>>>>>                Move SQLSERVER2008DRVRSTR to sSqlServerClientDriverName
69066>>>>>>>                Case Break
69067>>>>>>>            
69067>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
69070>>>>>>>                Move SQLSERVER2005DRVRSTR to sSqlServerClientDriverName
69071>>>>>>>                Case Break
69072>>>>>>>            
69072>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
69075>>>>>>>                Move SQLSERVER2000DRVRSTR to sSqlServerClientDriverName
69076>>>>>>>                Case Break
69077>>>>>>>            
69077>>>>>>>            Case Else
69077>>>>>>>                Move SQLSERVER2000DRVRSTR to sSqlServerClientDriverName
69078>>>>>>>                
69078>>>>>>>        Case End
69078>>>>>>>        
69078>>>>>>>        
69078>>>>>>>        Function_Return sSqlServerClientDriverName
69079>>>>>>>        
69079>>>>>>>    End_Function
69080>>>>>>>    
69080>>>>>>>    
69080>>>>>>>End_Class
69081>>>>>>>
69081>>>>>>>
69081>>>>>
69081>>>>>
69081>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
69082>>>>>
69082>>>>>Register_Function phoWorkspace Returns Handle
69082>>>>>Register_Function Help_filename Returns String
69082>>>>>Register_Function GetHelpFile Returns String
69082>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
69082>>>>>
69082>>>>>//    This function reads the current username Of windows and returns that
69082>>>>>//    name or an text unknown user
69082>>>>>Function Network_User_Name for cDesktop Returns String
69084>>>>>    String sName
69084>>>>>    Integer iRetval iLength
69084>>>>>    
69084>>>>>    Move 0 to iLength
69085>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
69086>>>>>    Move (ZeroString(iLength)) to sName
69087>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
69088>>>>>    
69088>>>>>    If (iRetval = NO_ERROR) Begin
69090>>>>>        Function_Return (CString (sName))
69091>>>>>    End
69091>>>>>>
69091>>>>>    
69091>>>>>    Function_Return "User Unknown"
69092>>>>>End_Function
69093>>>>>
69093>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
69094>>>>>
69094>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
69095>>>>>
69095>>>>>Class SysinfoDisplay is a cTextEdit
69096>>>>>    Procedure Construct_Object
69098>>>>>        Forward Send Construct_Object
69100>>>>>        
69100>>>>>        Set Location to 6 6
69101>>>>>        Set Size to 110 255
69102>>>>>        Set Read_Only_State to True
69103>>>>>        Set pbWrap to False
69104>>>>>    End_Procedure
69105>>>>>    
69105>>>>>    //    This method will show the name Of the current directory in the system
69105>>>>>    //    information box
69105>>>>>    Procedure Show_Current_Directory
69107>>>>>        String sDir
69107>>>>>        
69107>>>>>        Get_Current_Directory to sDir
69108>>>>>        
69108>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
69109>>>>>    End_Procedure
69110>>>>>    
69110>>>>>    Procedure Show_Windows_Directory
69112>>>>>        String sWindir
69112>>>>>        
69112>>>>>        Get_Windows_Directory to sWindir
69113>>>>>        
69113>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
69114>>>>>    End_Procedure
69115>>>>>    
69115>>>>>    Procedure Show_Current_User
69117>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
69118>>>>>    End_Procedure
69119>>>>>    
69119>>>>>    Procedure Show_Number_Format
69121>>>>>        Integer iFormat
69121>>>>>        String sFormatText
69121>>>>>        
69121>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
69124>>>>>        Move (Character (iFormat)) to sFormatText
69125>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
69126>>>>>        
69126>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
69129>>>>>        Move (Character (iFormat)) to sFormatText
69130>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
69131>>>>>    End_Procedure
69132>>>>>    
69132>>>>>    Procedure Show_Filelist_Name
69134>>>>>        String sFilename
69134>>>>>        
69134>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
69137>>>>>        
69137>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
69138>>>>>        Send AppendTextLn ""
69139>>>>>    End_Procedure
69140>>>>>    
69140>>>>>    Procedure Show_Lock_Delay
69142>>>>>        Integer iLockdelay
69142>>>>>        
69142>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
69145>>>>>        
69145>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
69146>>>>>    End_Procedure
69147>>>>>    
69147>>>>>    Procedure Show_Lock_Timeout
69149>>>>>        Integer iLockTimeout
69149>>>>>        
69149>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
69152>>>>>        
69152>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
69153>>>>>    End_Procedure
69154>>>>>    
69154>>>>>    Procedure Show_Screen_Size
69156>>>>>        Integer iYscreensize iXscreensize
69156>>>>>        
69156>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) to iXscreensize
69157>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) to iYscreensize
69158>>>>>        
69158>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
69159>>>>>    End_Procedure
69160>>>>>    
69160>>>>>    Procedure Show_Page_Size
69162>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
69163>>>>>    End_Procedure
69164>>>>>    
69164>>>>>    Procedure Show_Date
69166>>>>>        Date dToday
69166>>>>>        
69166>>>>>        Move (CurrentDateTime()) to  dToday
69167>>>>>        
69167>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
69168>>>>>    End_Procedure
69169>>>>>    
69169>>>>>    Procedure Show_Date_Format
69171>>>>>        Integer iDateFormat
69171>>>>>        String sDateFormat
69171>>>>>        
69171>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
69174>>>>>        Case Begin
69174>>>>>            Case (iDateFormat = DF_DATE_USA)
69176>>>>>                Move C_$USA to sDateFormat
69177>>>>>                Case Break
69178>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
69181>>>>>                Move C_$European to sDateFormat
69182>>>>>                Case Break
69183>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
69186>>>>>                Move C_$Military to sDateFormat
69187>>>>>                Case Break
69188>>>>>            Case Else
69188>>>>>                Move C_$UnknownDateType to sDateFormat
69189>>>>>                Case Break
69190>>>>>        Case End
69190>>>>>        
69190>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
69191>>>>>    End_Procedure
69192>>>>>    
69192>>>>>    Procedure Show_Systemresources
69194>>>>>        tWinMemoryStatusEx MemoryStatusInfo
69194>>>>>        tWinMemoryStatusEx MemoryStatusInfo
69194>>>>>        Integer iRetval
69194>>>>>        
69194>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
69195>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
69196>>>>>        If (iRetval = 0) Begin
69198>>>>>            Move (ShowLastError ()) to iRetval
69199>>>>>        End
69199>>>>>>
69199>>>>>        
69199>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
69200>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
69201>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Integer ( Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0)))
69202>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Integer ( Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0)))
69203>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Integer ( Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0)))
69204>>>>>    End_Procedure
69205>>>>>    
69205>>>>>    Procedure Show_Registration
69207>>>>>        String sRegName
69207>>>>>        Integer iSN iMaxUsers
69207>>>>>        
69207>>>>>        Registration sRegName iSN
69208>>>>>>
69208>>>>>        
69208>>>>>        Get_Licensed_Max_Users to iMaxUsers
69209>>>>>        
69209>>>>>        Send AppendTextLn ""
69210>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
69211>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
69212>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
69213>>>>>    End_Procedure
69214>>>>>    
69214>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
69214>>>>>    // To the workspace object passing the an object and message To send back
69214>>>>>    // To this object. It is expected that the workspace object will send this
69214>>>>>    // message for every line Of information it wants displayed (passing the
69214>>>>>    // information To be displayed
69214>>>>>    Register_Procedure EnumerateWorkspaceData Handle hObjId Handle hmMessId
69214>>>>>    
69214>>>>>    Procedure Show_ServicePack
69216>>>>>        String sKey sVersionDescription sVersion
69216>>>>>        Handle hoRegistry
69216>>>>>        Boolean bExists bOpened
69216>>>>>        
69216>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
69217>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
69218>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
69219>>>>>        
69219>>>>>        Move C_DFVersionRegistryRoot to sKey
69220>>>>>        Get KeyExists of hoRegistry sKey to bExists
69221>>>>>        If (bExists) Begin
69223>>>>>            Get OpenKey of hoRegistry sKey to bOpened
69224>>>>>            If (bOpened) Begin
69226>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
69227>>>>>                If (bExists) Begin
69229>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
69230>>>>>                End
69230>>>>>>
69230>>>>>                
69230>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
69231>>>>>                If (bExists) Begin
69233>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
69234>>>>>                End
69234>>>>>>
69234>>>>>                Send CloseKey of hoRegistry
69235>>>>>            End
69235>>>>>>
69235>>>>>        End
69235>>>>>>
69235>>>>>        Send Destroy of hoRegistry
69236>>>>>        
69236>>>>>        If (sVersionDescription <> "") Begin
69238>>>>>            Send AppendTextLn (sVersionDescription * "-" * sVersion)
69239>>>>>            Send AppendTextLn ""
69240>>>>>        End
69240>>>>>>
69240>>>>>    End_Procedure
69241>>>>>    
69241>>>>>    
69241>>>>>    Procedure Show_WorkspaceInformation
69243>>>>>        Integer hoWorkspace
69243>>>>>        
69243>>>>>        If (ghoApplication <> 0) Begin
69245>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
69246>>>>>            If (hoWorkspace <> 0) Begin
69248>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
69249>>>>>                Send AppendTextLn ""
69250>>>>>            End
69250>>>>>>
69250>>>>>        End
69250>>>>>>
69250>>>>>    End_Procedure
69251>>>>>    
69251>>>>>    // If connection ids are used, we will send the message EnumerateConnections
69251>>>>>    // to the connection manager object passing the an object and message to send
69251>>>>>    // back to this object. It is expected that the connection manager object will
69251>>>>>    // send this message for every line Of information it wants displayed (passing
69251>>>>>    // the information To be displayed
69251>>>>>    Register_Procedure EnumerateConnections Integer hObjId Integer hmMessId
69251>>>>>    
69251>>>>>    Procedure Show_ConnectionIdInformation
69253>>>>>        If (ghoConnection > 0) Begin
69255>>>>>            Send AppendTextLn ""
69256>>>>>            Send EnumerateConnections of ghoConnection Self (RefProc(AppendTextLn))
69257>>>>>        End
69257>>>>>>
69257>>>>>    End_Procedure
69258>>>>>    
69258>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
69260>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
69261>>>>>    End_Function
69262>>>>>    
69262>>>>>    Procedure Show_Versions
69264>>>>>        Integer iVersion iRevision iBuild
69264>>>>>        
69264>>>>>        Version_Information iVersion iRevision iBuild
69266>>>>>        
69266>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
69267>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
69268>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
69269>>>>>    End_Procedure
69270>>>>>    
69270>>>>>    Function CKRevisionNumber String sDriverID Returns String
69272>>>>>        Handle hoCLIHandler
69272>>>>>        Handle hoDFBtrDrvHandler
69272>>>>>        String sCKRevision
69272>>>>>        
69272>>>>>        
69272>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
69274>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
69275>>>>>            Set psDriverID of hoCLIHandler to sDriverID
69276>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
69277>>>>>            Send Destroy of hoCLIHandler
69278>>>>>        End
69278>>>>>>
69278>>>>>        Else Begin
69279>>>>>            If (sDriverID = "DFBTRDRV") Begin
69281>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
69282>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
69283>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
69284>>>>>                Send Destroy of hoDFBtrDrvHandler
69285>>>>>            End
69285>>>>>>
69285>>>>>        End
69285>>>>>>
69285>>>>>        
69285>>>>>        Function_Return sCKRevision
69286>>>>>    End_Function
69287>>>>>    
69287>>>>>    
69287>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
69289>>>>>        
69289>>>>>        If (sDriverID = "DATAFLEX") Begin
69291>>>>>            Function_Return False
69292>>>>>        End
69292>>>>>>
69292>>>>>        
69292>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
69293>>>>>    End_Function
69294>>>>>    
69294>>>>>    
69294>>>>>    Procedure Show_Drivers
69296>>>>>        String sCurrentDriver sRevNumber
69296>>>>>        String sLoadedDrivers sClientDriver
69296>>>>>        Integer iNumberOfDrivers iCount iClientVersion iMSSQLIndex
69296>>>>>        Boolean bOK
69296>>>>>        Handle hoMsqlDrv
69296>>>>>        
69296>>>>>        Move "" to sLoadedDrivers
69297>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
69300>>>>>        For iCount from 1 to iNumberOfDrivers
69306>>>>>>
69306>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
69309>>>>>            If (sLoadedDrivers <> "") Begin
69311>>>>>                Move (Append (sLoadedDrivers, ", ")) to sLoadedDrivers
69312>>>>>            End
69312>>>>>>
69312>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
69313>>>>>            If (bOK) Begin
69315>>>>>                If (sCurrentDriver = "MSSQLDRV") Begin
69317>>>>>                    Move iCount to iMSSQLIndex
69318>>>>>                End
69318>>>>>>
69318>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
69319>>>>>                // if mssqldrv, show the client number
69319>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
69320>>>>>            End
69320>>>>>>
69320>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) to sLoadedDrivers
69321>>>>>        Loop
69322>>>>>>
69322>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
69323>>>>>        If (iMSSQLIndex>0) Begin
69325>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iMSSQLIndex to iClientVersion
69328>>>>>            Get Create (RefClass(cMSSQLHandler)) to hoMsqlDrv
69329>>>>>            Get SqlServerClientVersionName of hoMsqlDrv iClientVersion to sClientDriver
69330>>>>>            Send Destroy of hoMsqlDrv
69331>>>>>            Send AppendTextLn (SFormat("MSSQLDRV Client Version: %1", sClientDriver))
69332>>>>>        End
69332>>>>>>
69332>>>>>    End_Procedure
69333>>>>>    
69333>>>>>    Procedure Show_HelpFile
69335>>>>>        String sHelpFile
69335>>>>>        Integer eHelpType
69335>>>>>        
69335>>>>>        If (ghoApplication <> 0) Begin
69337>>>>>            Get peHelpType of ghoApplication to eHelpType
69338>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
69340>>>>>                Get GetHelpFile of ghoHtmlHelp to sHelpFile
69341>>>>>            End
69341>>>>>>
69341>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
69344>>>>>                Get Help_filename of Help_object_id to sHelpFile
69345>>>>>            End
69345>>>>>>
69345>>>>>            Else Begin
69346>>>>>                Move C_$ThereIsNoHelpfileDefined to sHelpFile
69347>>>>>            End
69347>>>>>>
69347>>>>>            
69347>>>>>            Send AppendTextLn ""
69348>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
69349>>>>>        End
69349>>>>>>
69349>>>>>    End_Procedure
69350>>>>>    
69350>>>>>    Procedure Show_EnterAsTab
69352>>>>>        Boolean bEnterKeyAsTabKey
69352>>>>>        String sText
69352>>>>>        
69352>>>>>        If (ghoApplication <> 0) Begin
69354>>>>>            Get pbEnterKeyAsTabKey of ghoApplication to bEnterKeyAsTabKey
69355>>>>>            If (bEnterKeyAsTabKey) Begin
69357>>>>>                Move "True" to sText
69358>>>>>            End
69358>>>>>>
69358>>>>>            Else Begin
69359>>>>>                Move "False" to sText
69360>>>>>            End
69360>>>>>>
69360>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
69361>>>>>        End
69361>>>>>>
69361>>>>>    End_Procedure
69362>>>>>    
69362>>>>>    //    During activation we will remove the old information and add the newly
69362>>>>>    //    found systeminformation
69362>>>>>    Procedure Add_Focus Integer hoRoot
69364>>>>>        Forward Send Add_Focus hoRoot
69366>>>>>        
69366>>>>>        Send Delete_Data
69367>>>>>        
69367>>>>>        Set Changed_State to False
69368>>>>>        Set Read_Only_State to True
69369>>>>>        
69369>>>>>        Send Show_ServicePack
69370>>>>>        Send Show_Versions
69371>>>>>        Send Show_Drivers
69372>>>>>        If (ghoConnection <> 0) Begin
69374>>>>>            Send Show_ConnectionIdInformation
69375>>>>>        End
69375>>>>>>
69375>>>>>        Send Show_HelpFile
69376>>>>>        Send Show_Current_Directory
69377>>>>>        Send Show_Filelist_Name
69378>>>>>        If (ghoApplication <> 0) Begin
69380>>>>>            Send Show_WorkSpaceInformation // added To show WS info
69381>>>>>        End
69381>>>>>>
69381>>>>>        Send Show_Current_User
69382>>>>>        Send Show_Windows_Directory
69383>>>>>        Send Show_Screen_Size
69384>>>>>        Send Show_Page_Size
69385>>>>>        Send Show_EnterAsTab
69386>>>>>        Send Show_Number_Format
69387>>>>>        Send Show_Date_Format
69388>>>>>        Send Show_Lock_Delay
69389>>>>>        Send Show_Lock_Timeout
69390>>>>>        Send Show_Date
69391>>>>>        Send Show_Systemresources
69392>>>>>        Send Show_Registration
69393>>>>>        Send Beginning_of_Data
69394>>>>>        
69394>>>>>        Set Icon to 'default.ico'
69395>>>>>    End_Procedure
69396>>>>>End_Class
69397>>>>>
69397>>>>>Class SysInfoDialog is a ModalPanel
69398>>>>>    Procedure Construct_Object
69400>>>>>        Forward Send Construct_Object
69402>>>>>        
69402>>>>>        Set Label to C_$SystemInformation
69403>>>>>        Set Size to 140 267
69404>>>>>        Set piMinSize to 140 267
69405>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69406>>>>>        Set Border_Style to Border_Thick
69407>>>>>        
69407>>>>>        Object oSysinfoDisplay is a SysInfoDisplay
69409>>>>>            Set peAnchors to anAll
69410>>>>>        End_Object
69411>>>>>        
69411>>>>>        Object oCloseButton is a Button
69413>>>>>            Set Label to C_$Close
69414>>>>>            Set Location to 120 210
69415>>>>>            Set Message 0 to (Refproc (Close_Panel))
69416>>>>>            Set Default_State to True
69417>>>>>            Set peAnchors to anBottomRight
69418>>>>>        End_Object
69419>>>>>        
69419>>>>>        On_Key kCancel Send Close_Panel
69420>>>>>    End_Procedure
69421>>>>>End_Class
69422>>>>>
69422>>>>>Class AboutDialog is a ModalPanel
69423>>>>>    Procedure Construct_Object
69425>>>>>        String sVdfRootDir
69425>>>>>        
69425>>>>>        Forward Send Construct_Object
69427>>>>>        
69427>>>>>        Set Label to C_$About
69428>>>>>        Set Size to 89 212
69429>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69430>>>>>        
69430>>>>>        Object oSysInfoDialog is a SysInfoDialog
69432>>>>>        End_Object
69433>>>>>        
69433>>>>>        Object oBox is a Container3d
69435>>>>>            Set Border_Style to Border_StaticEdge
69436>>>>>            Set Size to 63 202
69437>>>>>            Set Location to 4 5
69438>>>>>            
69438>>>>>            Object oAboutGraphic is a BitmapContainer
69440>>>>>                Set Border_Style to Border_None
69441>>>>>                Set Bitmap_Style to Bitmap_Center
69442>>>>>                Set Size to 48 48
69443>>>>>                Set Location to 7 2
69444>>>>>            End_Object
69445>>>>>            
69445>>>>>            Object oProductName is a TextBox
69447>>>>>                Set Label to C_$ProductName
69448>>>>>                Set Size to 10 45
69449>>>>>                Set Location to 8 53
69450>>>>>            End_Object
69451>>>>>            
69451>>>>>            Object oVersion is a TextBox
69453>>>>>                Set Label to C_$Version
69454>>>>>                Set Size to 10 25
69455>>>>>                Set Location to 21 53
69456>>>>>            End_Object
69457>>>>>            
69457>>>>>            Object oCopyright is a TextBox
69459>>>>>                Set Label to C_$Copyright
69460>>>>>                Set Size to 10 31
69461>>>>>                Set Location to 34 53
69462>>>>>            End_Object
69463>>>>>            
69463>>>>>            Object oAuthor is a TextBox
69465>>>>>                Set Label to C_$Author
69466>>>>>                Set Size to 10 22
69467>>>>>                Set Location to 46 53
69468>>>>>            End_Object
69469>>>>>        End_Object
69470>>>>>        
69470>>>>>        Object oOKButton is a Button
69472>>>>>            On_Item C_$OK Send Close_Panel
69473>>>>>            Set Size to 14 50
69474>>>>>            Set Location to 71 157
69475>>>>>        End_Object
69476>>>>>        
69476>>>>>        Object oSysInfoButton is a Button
69478>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
69479>>>>>            Set Size to 14 50
69480>>>>>            Set Location to 71 101
69481>>>>>        End_Object
69482>>>>>        
69482>>>>>        On_Key Kcancel Send KeyAction of oOKButton
69483>>>>>        
69483>>>>>        Set Logo to "DacAbout.bmp"  // square bitmaps Of 42x42 work best
69484>>>>>    End_Procedure
69485>>>>>    
69485>>>>>    Procedure Set ProductName String sProductName
69487>>>>>        Set Label of oProductName to sProductName
69488>>>>>    End_Procedure
69489>>>>>    
69489>>>>>    Procedure Set Version String sVersion
69491>>>>>        Set Label of oVersion to sVersion
69492>>>>>    End_Procedure
69493>>>>>    
69493>>>>>    Procedure Set Copyright String sCopyright
69495>>>>>        Set Label of oCopyright to sCopyright
69496>>>>>    End_Procedure
69497>>>>>    
69497>>>>>    Procedure Set Author String sAuthor
69499>>>>>        Set Label of oAuthor to sAuthor
69500>>>>>    End_Procedure
69501>>>>>    
69501>>>>>    Procedure Set Logo String sLogo
69503>>>>>        // square bitmaps Of 42x42 work best
69503>>>>>        Set Bitmap of oAboutGraphic to sLogo
69504>>>>>    End_Procedure
69505>>>>>    
69505>>>>>    Procedure Show_Sysinfo
69507>>>>>        Send Popup_Modal of oSysinfoDialog
69508>>>>>    End_Procedure
69509>>>>>    
69509>>>>>    Procedure End_Construct_Object
69511>>>>>        Handle hoVersionInfo
69511>>>>>        Boolean bIncluded
69511>>>>>        Integer iMajor iMinor iRelease iBuild
69511>>>>>        String sLabel
69511>>>>>        
69511>>>>>        Get Label of oVersion to sLabel
69512>>>>>        If (sLabel = C_$VERSION) Begin
69514>>>>>            // set it To the version info Of the program, if available
69514>>>>>            If (ghoApplication <> 0) Begin
69516>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
69517>>>>>                If (hoVersionInfo <> 0) Begin
69519>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
69520>>>>>                    If (bIncluded) Begin
69522>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
69523>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
69524>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
69525>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
69526>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
69527>>>>>                        Set Version to sLabel
69528>>>>>                    End
69528>>>>>>
69528>>>>>                End
69528>>>>>>
69528>>>>>            End
69528>>>>>>
69528>>>>>        End
69528>>>>>>
69528>>>>>        
69528>>>>>        Forward Send End_Construct_Object
69530>>>>>    End_Procedure
69531>>>>>End_Class
69532>>>
69532>>>//  This is the default message. It is expected that you will
69532>>>//  create your own message to override this
69532>>>Procedure Activate_About
69535>>>    Send DoAbout "" "" "" "" ""
69536>>>End_Procedure
69537>>>
69537>>>//  It is expected that you will send this message (most
69537>>>//  likely from Activate_About. This creates an about object, activates it
69537>>>//  and destroys it when done. It is not exepected that you will augment this.
69537>>>Procedure DoAbout String sTitle String sVersion String sCopyRight String sAuthor String sBitmap
69540>>>    Integer hoObj hoMain
69540>>>    
69540>>>    // create object
69540>>>    Object About is an AboutDialog
69542>>>        // if no title passed use the label of the main panel
69542>>>        // (if a main panel exists).
69542>>>        If (sTitle = "") Begin
69544>>>            Get Main_Window of desktop to hoMain
69545>>>            If hoMain ;                Get Label of hoMain to sTitle
69548>>>        End
69548>>>>
69548>>>        Set productname to sTitle
69549>>>        Set version     to sVersion
69550>>>        Set copyright   to sCopyRight
69551>>>        Set author      to sAuthor
69552>>>        If (sBitmap <> '') ;            Set logo to sBitMap // square bitmaps of 42x42 work best
69555>>>        Move Self to hoObj // object Id
69556>>>    End_Object
69557>>>    Send Popup   of hoObj    // popup the about object
69558>>>    Send Destroy of hoObj // when done, it will be destroyed
69559>>>End_Procedure
69560>>>
69560>        Use EmpEntry.vw
Including file: EmpEntry.vw    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\EmpEntry.vw)
69560>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\EmpEntry.vw
69560>>>// EmpEntry
69560>>>//
69560>>>
69560>>>Use DFClient.pkg
69560>>>Use DFEntry.pkg
69560>>>
69560>>>Use cEmployeeDataDictionary.dd
Including file: cEmployeeDataDictionary.dd    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\DDSrc\cEmployeeDataDictionary.dd)
69560>>>>>Use DataDict.pkg
69560>>>>>
69560>>>>>Open Employee
Including file: Employee.fd    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\DDSrc\Employee.fd)
69562>>>>>Open PageHeader
Including file: PageHeader.fd    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\DDSrc\PageHeader.fd)
69564>>>>>Open system
Including file: system.fd    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\DDSrc\system.fd)
69566>>>>>
69566>>>>>Register_Object Employee_sl
69566>>>>>
69566>>>>>Class cEmployeeDataDictionary is a DataDictionary
69567>>>>>    
69567>>>>>    Procedure Construct_Object
69569>>>>>        Forward Send Construct_Object
69571>>>>>        Set Main_File to Employee.File_Number
69572>>>>>
69572>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69573>>>>>
69573>>>>>        Set Add_Client_File to PageHeader.File_Number
69574>>>>>
69574>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69575>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69576>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69577>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69578>>>>>
69578>>>>>        Set Field_Auto_Increment Field Employee.id to File_Field system.employee_id
69579>>>>>        Set Field_Prompt_Object Field Employee.id to Employee_sl
69580>>>>>
69580>>>>>    End_Procedure
69581>>>>>
69581>>>>>End_Class
69582>>>>>
69582>>>>>Use Employee.sl
Including file: Employee.sl    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\Employee.sl)
69582>>>>>>>// Employee.sl
69582>>>>>>>// Employee Lookup List
69582>>>>>>>
69582>>>>>>>Use DFClient.pkg
69582>>>>>>>Use cDbCJGridPromptList.pkg
69582>>>>>>>Use cDbCJGridColumn.pkg
69582>>>>>>>Use Windows.pkg
69582>>>>>>>
69582>>>>>>>Use cEmployeeDataDictionary.dd
69582>>>>>>>
69582>>>>>>>CD_Popup_Object Employee_sl is a dbModalPanel
69600>>>>>>>>
69600>>>>>>>    Set Location to 5 5
69601>>>>>>>    Set Size to 134 288
69602>>>>>>>    Set Label To "Employee Lookup List"
69603>>>>>>>    Set Border_Style to Border_Thick
69604>>>>>>>    Set Minimize_Icon to False
69605>>>>>>>
69605>>>>>>>
69605>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
69607>>>>>>>    End_Object 
69608>>>>>>>
69608>>>>>>>    Set Main_DD To oEmployee_DD
69609>>>>>>>    Set Server  To oEmployee_DD
69610>>>>>>>
69610>>>>>>>
69610>>>>>>>
69610>>>>>>>    Object oSelList is a cDbCJGridPromptList
69612>>>>>>>        Set Size to 105 278
69613>>>>>>>        Set Location to 5 5
69614>>>>>>>        Set peAnchors to anAll
69615>>>>>>>        Set psLayoutSection to "Employee_sl_oSelList"
69616>>>>>>>        Set Ordering to 1
69617>>>>>>>        Set pbAutoServer to True
69618>>>>>>>
69618>>>>>>>        Object oEmployee_id is a cDbCJGridColumn
69620>>>>>>>            Entry_Item Employee.id
69621>>>>>>>            Set piWidth to 46
69622>>>>>>>            Set psCaption to "id"
69623>>>>>>>        End_Object 
69624>>>>>>>
69624>>>>>>>        Object oEmployee_name is a cDbCJGridColumn
69626>>>>>>>            Entry_Item Employee.name
69627>>>>>>>            Set piWidth to 250
69628>>>>>>>            Set psCaption to "name"
69629>>>>>>>        End_Object 
69630>>>>>>>
69630>>>>>>>        Object oEmployee_id_card is a cDbCJGridColumn
69632>>>>>>>            Entry_Item Employee.id_card
69633>>>>>>>            Set piWidth to 150
69634>>>>>>>            Set psCaption to "id card"
69635>>>>>>>        End_Object 
69636>>>>>>>
69636>>>>>>>
69636>>>>>>>    End_Object 
69637>>>>>>>
69637>>>>>>>    Object oOk_bn is a Button
69639>>>>>>>        Set Label to "&Ok"
69640>>>>>>>        Set Location to 115 125
69641>>>>>>>        Set peAnchors to anBottomRight
69642>>>>>>>
69642>>>>>>>        Procedure OnClick
69645>>>>>>>            Send OK of oSelList
69646>>>>>>>        End_Procedure
69647>>>>>>>
69647>>>>>>>    End_Object 
69648>>>>>>>
69648>>>>>>>    Object oCancel_bn is a Button
69650>>>>>>>        Set Label to "&Cancel"
69651>>>>>>>        Set Location to 115 179
69652>>>>>>>        Set peAnchors to anBottomRight
69653>>>>>>>
69653>>>>>>>        Procedure OnClick
69656>>>>>>>            Send Cancel of oSelList
69657>>>>>>>        End_Procedure
69658>>>>>>>
69658>>>>>>>    End_Object 
69659>>>>>>>
69659>>>>>>>    Object oSearch_bn is a Button
69661>>>>>>>        Set Label to "&Search..."
69662>>>>>>>        Set Location to 115 233
69663>>>>>>>        Set peAnchors to anBottomRight
69664>>>>>>>
69664>>>>>>>        Procedure OnClick
69667>>>>>>>            Send Search of oSelList
69668>>>>>>>        End_Procedure
69669>>>>>>>
69669>>>>>>>    End_Object 
69670>>>>>>>
69670>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
69671>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
69672>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
69673>>>>>>>
69673>>>>>>>
69673>>>>>>>CD_End_Object // Employee_sl
69675>>>>>>>>
69675>>>
69675>>>ACTIVATE_VIEW Activate_oEmpEntry FOR oEmpEntry
69685>>>>
69685>>>Object oEmpEntry is a dbView
69687>>>    Set Location to 5 5
69688>>>    Set Size to 240 452
69689>>>    Set Label To "EmpEntry"
69690>>>    Set Border_Style to Border_Thick
69691>>>
69691>>>
69691>>>    Object oEmployee_DD is a cEmployeeDataDictionary
69693>>>    End_Object 
69694>>>
69694>>>    Set Main_DD To oEmployee_DD
69695>>>    Set Server  To oEmployee_DD
69696>>>
69696>>>
69696>>>
69696>>>    Object oEmployeeid is a dbForm
69698>>>        Entry_Item Employee.id
69699>>>        Set Size to 12 34
69700>>>        Set Location to 5 13
69701>>>        Set peAnchors to anTopLeftRight
69702>>>        Set Label to "id"
69703>>>        Set Label_Justification_mode to jMode_Left
69704>>>        Set Label_Col_Offset to 8
69705>>>        Set Label_row_Offset to 0
69706>>>    End_Object 
69707>>>
69707>>>    Object oEmployeename is a dbForm
69709>>>        Entry_Item Employee.name
69710>>>        Set Size to 12 250
69711>>>        Set Location to 5 72
69712>>>        Set peAnchors to anTopRight
69713>>>        Set Label to "name"
69714>>>        Set Label_Justification_mode to jMode_Left
69715>>>        Set Label_Col_Offset to 20
69716>>>        Set Label_row_Offset to 0
69717>>>    End_Object 
69718>>>
69718>>>    Object oEmployeeid_card is a dbForm
69720>>>        Entry_Item Employee.id_card
69721>>>        Set Size to 12 96
69722>>>        Set Location to 5 351
69723>>>        Set peAnchors to anTopRight
69724>>>        Set Label to "id card"
69725>>>        Set Label_Justification_mode to jMode_Left
69726>>>        Set Label_Col_Offset to 24
69727>>>        Set Label_row_Offset to 0
69728>>>    End_Object
69729>>>    
69729>>>    Object oDetailGrid is a cDbCJGrid
69731>>>        Set Size to 447 348
69732>>>        Set Location to 73 5
69733>>>        Set Server to oEmployee_DD
69734>>>        Set Ordering to 1
69735>>>        Set peAnchors to anAll
69736>>>        Set psLayoutSection to "oEmployeeEntry_oDetailGrid"
69737>>>        Set pbAllowInsertRow to False
69738>>>        Set pbHeaderPrompts to True
69739>>>        
69739>>>        
69739>>>        
69739>>>        Object oEmployeeId is a cDbCJGridColumn
69741>>>        Entry_Item Employee.id
69742>>>        Set piWidth to 78
69743>>>        Set psCaption to "Azonosito"
69744>>>        End_Object
69745>>>        
69745>>>        
69745>>>        
69745>>>        Object oEmployeeName is a cDbCJGridColumn
69747>>>        Entry_Item Employee.name
69748>>>        Set piWidth to 115
69749>>>        Set psCaption to "Nv"
69750>>>        End_Object
69751>>>        
69751>>>        
69751>>>        
69751>>>        Object oEmployeeIdCard is a cDbCJGridColumn
69753>>>        Entry_Item Employee.id_card
69754>>>        Set piWidth to 387
69755>>>        Set psCaption to "Szemlyig."
69756>>>        End_Object
69757>>>
69757>>>
69757>>>
69757>>>    End_Object
69758>>>    
69758>>>End_Object 
69759>        Use LineEntry.vw
Including file: LineEntry.vw    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\LineEntry.vw)
69759>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\LineEntry.vw
69759>>>// LineEntry
69759>>>//
69759>>>
69759>>>Use DFClient.pkg
69759>>>Use DFEntry.pkg
69759>>>
69759>>>Use cLineDataDictionary.dd
Including file: cLineDataDictionary.dd    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\DDSrc\cLineDataDictionary.dd)
69759>>>>>Use DataDict.pkg
69759>>>>>
69759>>>>>Open Line
Including file: Line.fd    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\DDSrc\Line.fd)
69761>>>>>Open PageHeader
69763>>>>>Open system
69765>>>>>
69765>>>>>Object oTypeValid is a DescriptionValidationTable
69767>>>>>    Procedure Fill_List
69770>>>>>        Forward Send Fill_List
69772>>>>>        Send Add_Table_Value "Type A" "Type A"
69773>>>>>        Send Add_Table_Value "Type B" "Type B"
69774>>>>>        Send Add_Table_Value "Type C" "Type C"
69775>>>>>        Send Add_Table_Value "Type D" "Type D"
69776>>>>>        Send Add_Table_Value "Type E" "Type E"
69777>>>>>    End_Procedure
69778>>>>>End_Object
69779>>>>>
69779>>>>>Register_Object Line_sl
69779>>>>>
69779>>>>>Class cLineDataDictionary is a DataDictionary
69780>>>>>    
69780>>>>>    Procedure Construct_Object
69782>>>>>        Forward Send Construct_Object
69784>>>>>        Set Main_File to Line.File_Number
69785>>>>>
69785>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69786>>>>>
69786>>>>>        Set Add_Client_File to PageHeader.File_Number
69787>>>>>
69787>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69788>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69789>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69790>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69791>>>>>
69791>>>>>        Set Field_Auto_Increment Field Line.id to File_Field system.line_id
69792>>>>>        Set Field_Prompt_Object Field Line.id to Line_sl
69793>>>>>
69793>>>>>        Set Field_Value_Table Field Line.type to oTypeValid
69794>>>>>
69794>>>>>    End_Procedure
69795>>>>>
69795>>>>>End_Class
69796>>>>>
69796>>>>>Use Line.sl
Including file: Line.sl    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\Line.sl)
69796>>>>>>>// Line.sl
69796>>>>>>>// Line Lookup List
69796>>>>>>>
69796>>>>>>>Use DFClient.pkg
69796>>>>>>>Use cDbCJGridPromptList.pkg
69796>>>>>>>Use cDbCJGridColumn.pkg
69796>>>>>>>Use Windows.pkg
69796>>>>>>>
69796>>>>>>>Use cLineDataDictionary.dd
69796>>>>>>>
69796>>>>>>>CD_Popup_Object Line_sl is a dbModalPanel
69814>>>>>>>>
69814>>>>>>>    Set Location to 5 5
69815>>>>>>>    Set Size to 134 72
69816>>>>>>>    Set Label To "Line Lookup List"
69817>>>>>>>    Set Border_Style to Border_Thick
69818>>>>>>>    Set Minimize_Icon to False
69819>>>>>>>
69819>>>>>>>
69819>>>>>>>    Object oLine_DD is a cLineDataDictionary
69821>>>>>>>    End_Object 
69822>>>>>>>
69822>>>>>>>    Set Main_DD To oLine_DD
69823>>>>>>>    Set Server  To oLine_DD
69824>>>>>>>
69824>>>>>>>
69824>>>>>>>
69824>>>>>>>    Object oSelList is a cDbCJGridPromptList
69826>>>>>>>        Set Size to 105 62
69827>>>>>>>        Set Location to 5 5
69828>>>>>>>        Set peAnchors to anAll
69829>>>>>>>        Set psLayoutSection to "Line_sl_oSelList"
69830>>>>>>>        Set Ordering to 1
69831>>>>>>>        Set pbAutoServer to True
69832>>>>>>>
69832>>>>>>>        Object oLine_id is a cDbCJGridColumn
69834>>>>>>>            Entry_Item Line.id
69835>>>>>>>            Set piWidth to 46
69836>>>>>>>            Set psCaption to "id"
69837>>>>>>>        End_Object 
69838>>>>>>>
69838>>>>>>>        Object oLine_type is a cDbCJGridColumn
69840>>>>>>>            Entry_Item Line.type
69841>>>>>>>            Set piWidth to 40
69842>>>>>>>            Set psCaption to "type"
69843>>>>>>>        End_Object 
69844>>>>>>>
69844>>>>>>>
69844>>>>>>>    End_Object 
69845>>>>>>>
69845>>>>>>>    Object oOk_bn is a Button
69847>>>>>>>        Set Label to "&Ok"
69848>>>>>>>        Set Location to 115 -91
69849>>>>>>>        Set peAnchors to anBottomRight
69850>>>>>>>
69850>>>>>>>        Procedure OnClick
69853>>>>>>>            Send OK of oSelList
69854>>>>>>>        End_Procedure
69855>>>>>>>
69855>>>>>>>    End_Object 
69856>>>>>>>
69856>>>>>>>    Object oCancel_bn is a Button
69858>>>>>>>        Set Label to "&Cancel"
69859>>>>>>>        Set Location to 115 -37
69860>>>>>>>        Set peAnchors to anBottomRight
69861>>>>>>>
69861>>>>>>>        Procedure OnClick
69864>>>>>>>            Send Cancel of oSelList
69865>>>>>>>        End_Procedure
69866>>>>>>>
69866>>>>>>>    End_Object 
69867>>>>>>>
69867>>>>>>>    Object oSearch_bn is a Button
69869>>>>>>>        Set Label to "&Search..."
69870>>>>>>>        Set Location to 115 17
69871>>>>>>>        Set peAnchors to anBottomRight
69872>>>>>>>
69872>>>>>>>        Procedure OnClick
69875>>>>>>>            Send Search of oSelList
69876>>>>>>>        End_Procedure
69877>>>>>>>
69877>>>>>>>    End_Object 
69878>>>>>>>
69878>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
69879>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
69880>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
69881>>>>>>>
69881>>>>>>>
69881>>>>>>>CD_End_Object // Line_sl
69883>>>>>>>>
69883>>>
69883>>>ACTIVATE_VIEW Activate_oLineEntry FOR oLineEntry
69893>>>>
69893>>>Object oLineEntry is a dbView
69895>>>    Set Location to 5 5
69896>>>    Set Size to 22 138
69897>>>    Set Label To "LineEntry"
69898>>>    Set Border_Style to Border_Thick
69899>>>
69899>>>
69899>>>    Object oLine_DD is a cLineDataDictionary
69901>>>    End_Object 
69902>>>
69902>>>    Set Main_DD To oLine_DD
69903>>>    Set Server  To oLine_DD
69904>>>
69904>>>
69904>>>
69904>>>    Object oLineid is a dbForm
69906>>>        Entry_Item Line.id
69907>>>        Set Size to 12 55
69908>>>        Set Location to 5 13
69909>>>        Set peAnchors to anTopLeftRight
69910>>>        Set Label to "id"
69911>>>        Set Label_Justification_mode to jMode_Left
69912>>>        Set Label_Col_Offset to 8
69913>>>        Set Label_row_Offset to 0
69914>>>    End_Object 
69915>>>
69915>>>    Object oLinetype is a dbForm
69917>>>        Entry_Item Line.type
69918>>>        Set Size to 12 44
69919>>>        Set Location to 5 88
69920>>>        Set peAnchors to anTopRight
69921>>>        Set Label to "type"
69922>>>        Set Label_Justification_mode to jMode_Left
69923>>>        Set Label_Col_Offset to 16
69924>>>        Set Label_row_Offset to 0
69925>>>    End_Object 
69926>>>
69926>>>
69926>>>End_Object 
69927>        Use PageHeaderEntry.vw
Including file: PageHeaderEntry.vw    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageHeaderEntry.vw)
69927>>>// C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageHeaderEntry.vw
69927>>>// PageHeaderEntry
69927>>>//
69927>>>
69927>>>Use DFClient.pkg
69927>>>Use DFEntry.pkg
69927>>>Use DfTabDlg.pkg
69927>>>
69927>>>Use cEmployeeDataDictionary.dd
69927>>>Use cLineDataDictionary.dd
69927>>>Use cPageHeaderDataDictionary.dd
Including file: cPageHeaderDataDictionary.dd    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\DDSrc\cPageHeaderDataDictionary.dd)
69927>>>>>Use DataDict.pkg
69927>>>>>
69927>>>>>Open PageHeader
69929>>>>>Open Employee
69931>>>>>Open Line
69933>>>>>Open system
69935>>>>>Open PageFooter
Including file: PageFooter.fd    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\DDSrc\PageFooter.fd)
69937>>>>>
69937>>>>>Register_Object PageHeader_sl
69937>>>>>
69937>>>>>Class cPageHeaderDataDictionary is a DataDictionary
69938>>>>>    
69938>>>>>    Procedure Construct_Object
69940>>>>>        Forward Send Construct_Object
69942>>>>>        Set Main_File to PageHeader.File_Number
69943>>>>>
69943>>>>>        Set Add_Client_File to PageFooter.File_Number
69944>>>>>
69944>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
69945>>>>>
69945>>>>>        Set Add_Server_File to Employee.File_Number
69946>>>>>        Set Add_Server_File to Line.File_Number
69947>>>>>
69947>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69948>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69949>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69950>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69951>>>>>
69951>>>>>        Set Field_Auto_Increment Field PageHeader.id to File_Field system.page_header_id
69952>>>>>        Set Field_Prompt_Object Field PageHeader.id to PageHeader_sl
69953>>>>>
69953>>>>>    End_Procedure
69954>>>>>    
69954>>>>>    Procedure OnConstrain
69956>>>>>        Constrain PageHeader.Date Between "2020/1/1" and "2023/1/1"
69960>>>>>    End_Procedure
69961>>>>>
69961>>>>>End_Class
69962>>>>>
69962>>>>>Use PageHeader.sl
Including file: PageHeader.sl    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageHeader.sl)
69962>>>>>>>// PageHeader.sl
69962>>>>>>>// PageHeader Lookup List
69962>>>>>>>
69962>>>>>>>Use DFClient.pkg
69962>>>>>>>Use cDbCJGridPromptList.pkg
69962>>>>>>>Use cDbCJGridColumn.pkg
69962>>>>>>>Use Windows.pkg
69962>>>>>>>
69962>>>>>>>Use cEmployeeDataDictionary.dd
69962>>>>>>>Use cLineDataDictionary.dd
69962>>>>>>>Use cPageHeaderDataDictionary.dd
69962>>>>>>>
69962>>>>>>>CD_Popup_Object PageHeader_sl is a dbModalPanel
69980>>>>>>>>
69980>>>>>>>    Set Location to 5 5
69981>>>>>>>    Set Size to 134 126
69982>>>>>>>    Set Label To "PageHeader Lookup List"
69983>>>>>>>    Set Border_Style to Border_Thick
69984>>>>>>>    Set Minimize_Icon to False
69985>>>>>>>
69985>>>>>>>
69985>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
69987>>>>>>>    End_Object 
69988>>>>>>>
69988>>>>>>>    Object oLine_DD is a cLineDataDictionary
69990>>>>>>>    End_Object 
69991>>>>>>>
69991>>>>>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
69993>>>>>>>        Set DDO_Server To oEmployee_DD
69994>>>>>>>        Set DDO_Server To oLine_DD
69995>>>>>>>    End_Object 
69996>>>>>>>
69996>>>>>>>    Set Main_DD To oPageHeader_DD
69997>>>>>>>    Set Server  To oPageHeader_DD
69998>>>>>>>
69998>>>>>>>
69998>>>>>>>
69998>>>>>>>    Object oSelList is a cDbCJGridPromptList
70000>>>>>>>        Set Size to 105 116
70001>>>>>>>        Set Location to 5 5
70002>>>>>>>        Set peAnchors to anAll
70003>>>>>>>        Set psLayoutSection to "PageHeader_sl_oSelList"
70004>>>>>>>        Set Ordering to 1
70005>>>>>>>        Set pbAutoServer to True
70006>>>>>>>
70006>>>>>>>        Object oPageHeader_id is a cDbCJGridColumn
70008>>>>>>>            Entry_Item PageHeader.id
70009>>>>>>>            Set piWidth to 46
70010>>>>>>>            Set psCaption to "id"
70011>>>>>>>        End_Object 
70012>>>>>>>
70012>>>>>>>        Object oEmployee_id is a cDbCJGridColumn
70014>>>>>>>            Entry_Item Employee.id
70015>>>>>>>            Set piWidth to 81
70016>>>>>>>            Set psCaption to "employee id"
70017>>>>>>>        End_Object 
70018>>>>>>>
70018>>>>>>>        Object oLine_id is a cDbCJGridColumn
70020>>>>>>>            Entry_Item Line.id
70021>>>>>>>            Set piWidth to 48
70022>>>>>>>            Set psCaption to "line id"
70023>>>>>>>        End_Object 
70024>>>>>>>
70024>>>>>>>
70024>>>>>>>    End_Object 
70025>>>>>>>
70025>>>>>>>    Object oOk_bn is a Button
70027>>>>>>>        Set Label to "&Ok"
70028>>>>>>>        Set Location to 115 -37
70029>>>>>>>        Set peAnchors to anBottomRight
70030>>>>>>>
70030>>>>>>>        Procedure OnClick
70033>>>>>>>            Send OK of oSelList
70034>>>>>>>        End_Procedure
70035>>>>>>>
70035>>>>>>>    End_Object 
70036>>>>>>>
70036>>>>>>>    Object oCancel_bn is a Button
70038>>>>>>>        Set Label to "&Cancel"
70039>>>>>>>        Set Location to 115 17
70040>>>>>>>        Set peAnchors to anBottomRight
70041>>>>>>>
70041>>>>>>>        Procedure OnClick
70044>>>>>>>            Send Cancel of oSelList
70045>>>>>>>        End_Procedure
70046>>>>>>>
70046>>>>>>>    End_Object 
70047>>>>>>>
70047>>>>>>>    Object oSearch_bn is a Button
70049>>>>>>>        Set Label to "&Search..."
70050>>>>>>>        Set Location to 115 71
70051>>>>>>>        Set peAnchors to anBottomRight
70052>>>>>>>
70052>>>>>>>        Procedure OnClick
70055>>>>>>>            Send Search of oSelList
70056>>>>>>>        End_Procedure
70057>>>>>>>
70057>>>>>>>    End_Object 
70058>>>>>>>
70058>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
70059>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
70060>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
70061>>>>>>>
70061>>>>>>>
70061>>>>>>>CD_End_Object // PageHeader_sl
70063>>>>>>>>
70063>>>Use MonthCalendarPrompt.dg
Including file: MonthCalendarPrompt.dg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\MonthCalendarPrompt.dg)
70063>>>>>// Month Calendar Prompt dialog
70063>>>>>Use cMonthCalendarPrompt.pkg
Including file: cMonthCalendarPrompt.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cMonthCalendarPrompt.pkg)
70063>>>>>>>Use cMonthCalendar.pkg
Including file: cMonthCalendar.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cMonthCalendar.pkg)
70063>>>>>>>>>Use Windows.pkg
70063>>>>>>>>>Use Commctrl.pkg
70063>>>>>>>>>Use tWinStructs.pkg
70063>>>>>>>>>Use cWinControlEx.pkg
Including file: cWinControlEx.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cWinControlEx.pkg)
70063>>>>>>>>>>>Use cWinControl.pkg
Including file: cWinControl.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cWinControl.pkg)
70063>>>>>>>>>>>>>Use Windows.pkg
70063>>>>>>>>>>>>>
70063>>>>>>>>>>>>>// Key State Masks for Mouse Messages
70063>>>>>>>>>>>>>
70063>>>>>>>>>>>>>Define MK_LBUTTON  for |CI$0001
70063>>>>>>>>>>>>>Define MK_RBUTTON  for |CI$0002
70063>>>>>>>>>>>>>Define MK_SHIFT    for |CI$0004
70063>>>>>>>>>>>>>Define MK_CONTROL  for |CI$0008
70063>>>>>>>>>>>>>Define MK_MBUTTON  for |CI$0010
70063>>>>>>>>>>>>>Define MK_XBUTTON1 for |CI$0020
70063>>>>>>>>>>>>>Define MK_XBUTTON2 for |CI$0040
70063>>>>>>>>>>>>>
70063>>>>>>>>>>>>>Enum_List // Mouse Key Flags
70063>>>>>>>>>>>>>    Define mkLeft    for MK_LBUTTON
70063>>>>>>>>>>>>>    Define mkMiddle  for MK_MBUTTON
70063>>>>>>>>>>>>>    Define mkRight   for MK_RBUTTON
70063>>>>>>>>>>>>>    Define mkX1      for MK_XBUTTON1
70063>>>>>>>>>>>>>    Define mkX2      for MK_XBUTTON2
70063>>>>>>>>>>>>>    Define mkShift   for MK_SHIFT
70063>>>>>>>>>>>>>    Define mkControl for MK_CONTROL
70063>>>>>>>>>>>>>End_Enum_List
70063>>>>>>>>>>>>>
70063>>>>>>>>>>>>>Enum_List // Mouse Buttons. Used in OnMouseXXX messages
70063>>>>>>>>>>>>>    Define mbLeft
70063>>>>>>>>>>>>>    Define mbMiddle
70063>>>>>>>>>>>>>    Define mbRight
70063>>>>>>>>>>>>>    Define mbX1
70063>>>>>>>>>>>>>    Define mbX2
70063>>>>>>>>>>>>>End_Enum_List
70063>>>>>>>>>>>>>
70063>>>>>>>>>>>>>Class cWinControl is a DfBaseControl
70064>>>>>>>>>>>>>    Procedure Construct_Object
70066>>>>>>>>>>>>>        Forward Send Construct_Object
70068>>>>>>>>>>>>>        Property Integer private_pbEnabled True
70069>>>>>>>>>>>>>        Property Integer private_pbVisible True
70070>>>>>>>>>>>>>    End_Procedure
70071>>>>>>>>>>>>>    
70071>>>>>>>>>>>>>    Procedure End_Construct_Object
70073>>>>>>>>>>>>>        Forward Send End_Construct_Object
70075>>>>>>>>>>>>>        
70075>>>>>>>>>>>>>        Set External_Message WM_LBUTTONDOWN   to msg_OnWmLButtonDown
70076>>>>>>>>>>>>>        Set External_Message WM_MBUTTONDOWN   to msg_OnWmMButtonDown
70077>>>>>>>>>>>>>        Set External_Message WM_RBUTTONDOWN   to msg_OnWmRButtonDown
70078>>>>>>>>>>>>>        Set External_Message WM_LBUTTONUP     to msg_OnWmLButtonUp
70079>>>>>>>>>>>>>        Set External_Message WM_MBUTTONUP     to msg_OnWmMButtonUp
70080>>>>>>>>>>>>>        Set External_Message WM_RBUTTONUP     to msg_OnWmRButtonUp
70081>>>>>>>>>>>>>        Set External_Message WM_LBUTTONDBLCLK to msg_OnWmLButtonDblClk
70082>>>>>>>>>>>>>        Set External_Message WM_MBUTTONDBLCLK to msg_OnWmMButtonDblClk
70083>>>>>>>>>>>>>        Set External_Message WM_RBUTTONDBLCLK to msg_OnWmRButtonDblClk
70084>>>>>>>>>>>>>        Set External_Message WM_MOUSEMOVE     to msg_OnWmMouseMove
70085>>>>>>>>>>>>>    End_Procedure
70086>>>>>>>>>>>>>    
70086>>>>>>>>>>>>>    Procedure Notify Longptr wParam Longptr lParam
70088>>>>>>>>>>>>>        //Intentionally cancelled
70088>>>>>>>>>>>>>    End_Procedure
70089>>>>>>>>>>>>>    
70089>>>>>>>>>>>>>    Procedure Command Integer wParam Integer lParam
70091>>>>>>>>>>>>>        //Intentionally cancelled
70091>>>>>>>>>>>>>    End_Procedure
70092>>>>>>>>>>>>>    
70092>>>>>>>>>>>>>    Procedure DoRecreateWindow
70094>>>>>>>>>>>>>        // Recreates the window
70094>>>>>>>>>>>>>        If (Window_Handle(Self)) Begin
70096>>>>>>>>>>>>>            // attempt to do this without disturbing the focus tree.
70096>>>>>>>>>>>>>            Send Page_delete // prior to 8.3 this was Send Page_Object 0
70097>>>>>>>>>>>>>            Send Page 1      //                       Send Page_Object 1
70098>>>>>>>>>>>>>        End
70098>>>>>>>>>>>>>>
70098>>>>>>>>>>>>>    End_Procedure
70099>>>>>>>>>>>>>    
70099>>>>>>>>>>>>>    Procedure DoUpdateWindow
70101>>>>>>>>>>>>>        // Forces windows to update the window by bypassing WM_PAINT
70101>>>>>>>>>>>>>        Handle hWnd
70101>>>>>>>>>>>>>        
70101>>>>>>>>>>>>>        Get Window_Handle to hWnd
70102>>>>>>>>>>>>>        If hWnd ;            Move (UpdateWindow(hWnd)) to hWnd
70105>>>>>>>>>>>>>    End_Procedure
70106>>>>>>>>>>>>>    
70106>>>>>>>>>>>>>    Procedure Page Integer iState
70108>>>>>>>>>>>>>        Set Window_Style to WS_DISABLED (private_pbEnabled(Self) =False)
70109>>>>>>>>>>>>>        Set Window_Style to WS_VISIBLE (private_pbVisible(Self))
70110>>>>>>>>>>>>>        Forward Send Page iState
70112>>>>>>>>>>>>>    End_Procedure
70113>>>>>>>>>>>>>    
70113>>>>>>>>>>>>>    Procedure OnWmLButtonUp Integer wParam Integer lParam
70115>>>>>>>>>>>>>        Integer x y eButton
70115>>>>>>>>>>>>>        
70115>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70116>>>>>>>>>>>>>        Move (Low(lParam)) to x
70117>>>>>>>>>>>>>        
70117>>>>>>>>>>>>>        Send OnMouseUp mbLeft x y wParam
70118>>>>>>>>>>>>>    End_Procedure
70119>>>>>>>>>>>>>    
70119>>>>>>>>>>>>>    Procedure OnWmMButtonUp Integer wParam Integer lParam
70121>>>>>>>>>>>>>        Integer x y eButton
70121>>>>>>>>>>>>>        
70121>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70122>>>>>>>>>>>>>        Move (Low(lParam)) to x
70123>>>>>>>>>>>>>        
70123>>>>>>>>>>>>>        Send OnMouseUp mbMiddle x y wParam
70124>>>>>>>>>>>>>    End_Procedure
70125>>>>>>>>>>>>>    
70125>>>>>>>>>>>>>    Procedure OnWmRButtonUp Integer wParam Integer lParam
70127>>>>>>>>>>>>>        Integer x y eButton
70127>>>>>>>>>>>>>        
70127>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70128>>>>>>>>>>>>>        Move (Low(lParam)) to x
70129>>>>>>>>>>>>>        
70129>>>>>>>>>>>>>        Send OnMouseUp mbRight x y wParam
70130>>>>>>>>>>>>>    End_Procedure
70131>>>>>>>>>>>>>    
70131>>>>>>>>>>>>>    Procedure OnWmLButtonDown Integer wParam Integer lParam
70133>>>>>>>>>>>>>        Integer x y eButton fKeys
70133>>>>>>>>>>>>>        
70133>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70134>>>>>>>>>>>>>        Move (Low(lParam)) to x
70135>>>>>>>>>>>>>        
70135>>>>>>>>>>>>>        Send OnMouseDown mbLeft x y wParam
70136>>>>>>>>>>>>>    End_Procedure
70137>>>>>>>>>>>>>    Procedure OnWmMButtonDown Integer wParam Integer lParam
70139>>>>>>>>>>>>>        Integer x y eButton
70139>>>>>>>>>>>>>        
70139>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70140>>>>>>>>>>>>>        Move (Low(lParam)) to x
70141>>>>>>>>>>>>>        
70141>>>>>>>>>>>>>        Send OnMouseDown mbMiddle x y wParam
70142>>>>>>>>>>>>>    End_Procedure
70143>>>>>>>>>>>>>    Procedure OnWmRButtonDown Integer wParam Integer lParam
70145>>>>>>>>>>>>>        Integer x y eButton
70145>>>>>>>>>>>>>        
70145>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70146>>>>>>>>>>>>>        Move (Low(lParam)) to x
70147>>>>>>>>>>>>>        
70147>>>>>>>>>>>>>        Send OnMouseDown mbRight x y wParam
70148>>>>>>>>>>>>>    End_Procedure
70149>>>>>>>>>>>>>    
70149>>>>>>>>>>>>>    Procedure OnWmLButtonDblClk Integer wParam Integer lParam
70151>>>>>>>>>>>>>        Integer x y eButton
70151>>>>>>>>>>>>>        
70151>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70152>>>>>>>>>>>>>        Move (Low(lParam)) to x
70153>>>>>>>>>>>>>        
70153>>>>>>>>>>>>>        Send OnMouseDoubleClick mbLeft x y wParam
70154>>>>>>>>>>>>>    End_Procedure
70155>>>>>>>>>>>>>    Procedure OnWmMButtonDblClk Integer wParam Integer lParam
70157>>>>>>>>>>>>>        Integer x y eButton
70157>>>>>>>>>>>>>        
70157>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70158>>>>>>>>>>>>>        Move (Low(lParam)) to x
70159>>>>>>>>>>>>>        
70159>>>>>>>>>>>>>        Send OnMouseDoubleClick mbMiddle x y wParam
70160>>>>>>>>>>>>>    End_Procedure
70161>>>>>>>>>>>>>    Procedure OnWmRButtonDblClk Integer wParam Integer lParam
70163>>>>>>>>>>>>>        Integer x y eButton
70163>>>>>>>>>>>>>        
70163>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70164>>>>>>>>>>>>>        Move (Low(lParam)) to x
70165>>>>>>>>>>>>>        
70165>>>>>>>>>>>>>        Send OnMouseDoubleClick mbRight x y wParam
70166>>>>>>>>>>>>>    End_Procedure
70167>>>>>>>>>>>>>    
70167>>>>>>>>>>>>>    Procedure OnWmMouseMove Integer wParam Integer lParam
70169>>>>>>>>>>>>>        Integer x y eButton
70169>>>>>>>>>>>>>        
70169>>>>>>>>>>>>>        Move (Hi(lParam))  to y
70170>>>>>>>>>>>>>        Move (Low(lParam)) to x
70171>>>>>>>>>>>>>        
70171>>>>>>>>>>>>>        Send OnMouseMove x y wParam
70172>>>>>>>>>>>>>    End_Procedure
70173>>>>>>>>>>>>>    
70173>>>>>>>>>>>>>    Procedure OnMouseDown Integer eButton Integer x Integer y Integer fKeys
70175>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70175>>>>>>>>>>>>>        //String sButton
70175>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70175>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70175>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70175>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70175>>>>>>>>>>>>>        
70175>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
70175>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
70175>>>>>>>>>>>>>        //Showln 'OnMouseDown ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70175>>>>>>>>>>>>>    End_Procedure
70176>>>>>>>>>>>>>    
70176>>>>>>>>>>>>>    Procedure OnMouseUp Integer eButton Integer x Integer y Integer fKeys
70178>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70178>>>>>>>>>>>>>        //String sButton
70178>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70178>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70178>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70178>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70178>>>>>>>>>>>>>        
70178>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
70178>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
70178>>>>>>>>>>>>>        //Showln 'OnMouseUp ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70178>>>>>>>>>>>>>    End_Procedure
70179>>>>>>>>>>>>>    
70179>>>>>>>>>>>>>    Procedure OnMouseDoubleClick Integer eButton Integer x Integer y Integer fKeys
70181>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70181>>>>>>>>>>>>>        //String sButton
70181>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70181>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70181>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70181>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70181>>>>>>>>>>>>>        
70181>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
70181>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
70181>>>>>>>>>>>>>        //Showln 'OnMouseDblClk ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70181>>>>>>>>>>>>>    End_Procedure
70182>>>>>>>>>>>>>    
70182>>>>>>>>>>>>>    Procedure OnMouseMove Integer x Integer y Integer fKeys
70184>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
70184>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
70184>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
70184>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
70184>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
70184>>>>>>>>>>>>>        
70184>>>>>>>>>>>>>        //Showln 'OnMouseMove ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
70184>>>>>>>>>>>>>    End_Procedure
70185>>>>>>>>>>>>>    
70185>>>>>>>>>>>>>    Procedure Set pbEnabled Boolean bEnabled
70187>>>>>>>>>>>>>        Handle hWnd
70187>>>>>>>>>>>>>        
70187>>>>>>>>>>>>>        If (bEnabled <> private_pbEnabled(Self)) Begin
70189>>>>>>>>>>>>>            Set private_pbEnabled to bEnabled
70190>>>>>>>>>>>>>            Get Window_Handle to hWnd
70191>>>>>>>>>>>>>            If hWnd ;                Move (EnableWindow(hWnd, bEnabled)) to hWnd
70194>>>>>>>>>>>>>        End
70194>>>>>>>>>>>>>>
70194>>>>>>>>>>>>>    End_Procedure
70195>>>>>>>>>>>>>    Function pbEnabled Returns Boolean
70197>>>>>>>>>>>>>        Function_Return (private_pbEnabled(Self))
70198>>>>>>>>>>>>>    End_Function
70199>>>>>>>>>>>>>    
70199>>>>>>>>>>>>>    Procedure Set pbVisible Boolean bVisible
70201>>>>>>>>>>>>>        Handle  hWnd
70201>>>>>>>>>>>>>        Integer iVoid
70201>>>>>>>>>>>>>        
70201>>>>>>>>>>>>>        If (bVisible <> private_pbVisible(Self)) Begin
70203>>>>>>>>>>>>>            Set private_pbVisible to bVisible
70204>>>>>>>>>>>>>            Get Window_Handle to hWnd
70205>>>>>>>>>>>>>            If hWnd ;                Move (ShowWindow(hWnd, If (bVisible, SW_SHOWNA, SW_HIDE))) to iVoid
70208>>>>>>>>>>>>>        End
70208>>>>>>>>>>>>>>
70208>>>>>>>>>>>>>    End_Procedure
70209>>>>>>>>>>>>>    Function pbVisible Returns Boolean
70211>>>>>>>>>>>>>        Function_Return (private_pbVisible(Self))
70212>>>>>>>>>>>>>    End_Function
70213>>>>>>>>>>>>>    
70213>>>>>>>>>>>>>End_Class
70214>>>>>>>>>>>// This adds proper navigation and default button support for
70214>>>>>>>>>>>// external classes
70214>>>>>>>>>>>
70214>>>>>>>>>>>Class cWinControlEx is a cWinControl
70215>>>>>>>>>>>    Import_Class_Protocol Standard_Form_Mixin
70216>>>>>>>>>>>    Procedure Construct_Object
70218>>>>>>>>>>>        Forward Send Construct_Object
70220>>>>>>>>>>>        Send define_standard_Form_Mixin
70221>>>>>>>>>>>    End_Procedure
70222>>>>>>>>>>>    
70222>>>>>>>>>>>    Function item_count Integer iItem Returns Integer
70224>>>>>>>>>>>        Function_Return 1
70225>>>>>>>>>>>    End_Function
70226>>>>>>>>>>>    
70226>>>>>>>>>>>    Procedure External_SetFocus
70228>>>>>>>>>>>        Send notify_focus_change 1
70229>>>>>>>>>>>    End_Procedure
70230>>>>>>>>>>>    
70230>>>>>>>>>>>    Procedure External_KillFocus
70232>>>>>>>>>>>        Send notify_focus_change 0
70233>>>>>>>>>>>    End_Procedure
70234>>>>>>>>>>>    
70234>>>>>>>>>>>    Procedure End_Construct_Object
70236>>>>>>>>>>>        Forward Send End_Construct_Object
70238>>>>>>>>>>>        Set External_Message WM_SETFOCUS  to External_SetFocus
70239>>>>>>>>>>>        Set External_Message WM_KILLFOCUS to External_KillFocus
70240>>>>>>>>>>>    End_Procedure
70241>>>>>>>>>>>    
70241>>>>>>>>>>>End_Class
70242>>>>>>>>>>>
70242>>>>>>>>>
70242>>>>>>>>>Class cMonthCalendar is a cWinControlEx
70243>>>>>>>>>    Procedure Construct_Object
70245>>>>>>>>>        Integer iResult
70245>>>>>>>>>        tWinInitCommonControlsEX InitCC
70245>>>>>>>>>        tWinInitCommonControlsEX InitCC
70245>>>>>>>>>        
70245>>>>>>>>>        Forward Send Construct_Object
70247>>>>>>>>>        
70247>>>>>>>>>        Move (SizeOfType (tWinInitCommonControlsEX)) to InitCC.dwSize
70248>>>>>>>>>        Move ICC_DATE_CLASSES to InitCC.dwICC
70249>>>>>>>>>        Move (InitCommonControlsEx(AddressOf(InitCC))) to iResult
70250>>>>>>>>>        
70250>>>>>>>>>        Set External_Class_Name 'cMonthCalendar' to 'SysMonthCal32'
70251>>>>>>>>>        Set External_Message WM_LBUTTONDBLCLK to msg_OnLButtonDblClick
70252>>>>>>>>>        
70252>>>>>>>>>        Set Border_Style to Border_Normal
70253>>>>>>>>>        
70253>>>>>>>>>        Property Boolean pbNoToday False
70254>>>>>>>>>        Property Boolean pbNoTodayCircle False
70255>>>>>>>>>        Property Boolean pbMultiSelect False
70256>>>>>>>>>        Property Boolean pbWeekNumbers False
70257>>>>>>>>>        Property Integer piMaxSelectedCount 90
70258>>>>>>>>>        
70258>>>>>>>>>        // this is minimum Dialog units required for a single picker rectangle
70258>>>>>>>>>        Property Integer piMinWidth 0
70259>>>>>>>>>        Property Integer piMinHeight 0
70260>>>>>>>>>        
70260>>>>>>>>>        // stores initial date before control is activated
70260>>>>>>>>>        Property Date pdPrivateDate
70261>>>>>>>>>        // if multi-select, this is the end range
70261>>>>>>>>>        Property Date pdPrivateDate2
70262>>>>>>>>>        
70262>>>>>>>>>    End_Procedure
70263>>>>>>>>>    
70263>>>>>>>>>    // returns control's value when single select
70263>>>>>>>>>    Function SelectedDate Returns Date
70265>>>>>>>>>        tWinSystemTime CurrentSystemTime
70265>>>>>>>>>        tWinSystemTime CurrentSystemTime
70265>>>>>>>>>        Integer iRetval
70265>>>>>>>>>        DateTime dtSel
70265>>>>>>>>>        Handle hWnd
70265>>>>>>>>>        Get Window_Handle to hWnd
70266>>>>>>>>>        If (hWnd) Begin
70268>>>>>>>>>            Move (WindowsMessage (MCM_GETCURSEL, 0, AddressOf (CurrentSystemTime))) to iRetval
70269>>>>>>>>>            Move (DateSetDay(dtSel,CurrentSystemTime.wDay)) to dtSel
70270>>>>>>>>>            Move (DateSetMonth(dtSel,CurrentSystemTime.wMonth)) to dtSel
70271>>>>>>>>>            Move (DateSetYear(dtSel,CurrentSystemTime.wYear)) to dtSel
70272>>>>>>>>>        End
70272>>>>>>>>>>
70272>>>>>>>>>        Else Begin
70273>>>>>>>>>            Get pdPrivateDate to dtSel
70274>>>>>>>>>        End
70274>>>>>>>>>>
70274>>>>>>>>>        Function_Return (Date(dtSel))
70275>>>>>>>>>    End_Function
70276>>>>>>>>>    
70276>>>>>>>>>    // returns control's values when multi select
70276>>>>>>>>>    Function SelectedDateRange Returns Date[]
70278>>>>>>>>>        tWinSystemTime[2] CurrentSystemTime
70278>>>>>>>>>        tWinSystemTime[2] CurrentSystemTime
70279>>>>>>>>>        Integer iRetval
70279>>>>>>>>>        DateTime dtSel1 dtsel2
70279>>>>>>>>>        Date[] dtSel
70280>>>>>>>>>        Handle hWnd
70280>>>>>>>>>        Get Window_Handle to hWnd
70281>>>>>>>>>        If (hWnd) Begin
70283>>>>>>>>>            Move (WindowsMessage (MCM_GETSELRANGE, 0, AddressOf (CurrentSystemTime))) to iRetval
70284>>>>>>>>>            
70284>>>>>>>>>            Move (DateSetDay(dtSel1,CurrentSystemTime[0].wDay)) to dtSel1
70285>>>>>>>>>            Move (DateSetMonth(dtSel1,CurrentSystemTime[0].wMonth)) to dtSel1
70286>>>>>>>>>            Move (DateSetYear(dtSel1,CurrentSystemTime[0].wYear)) to dtSel1
70287>>>>>>>>>            
70287>>>>>>>>>            Move (DateSetDay(dtSel2,CurrentSystemTime[1].wDay)) to dtSel2
70288>>>>>>>>>            Move (DateSetMonth(dtSel2,CurrentSystemTime[1].wMonth)) to dtSel2
70289>>>>>>>>>            Move (DateSetYear(dtSel2,CurrentSystemTime[1].wYear)) to dtSel2
70290>>>>>>>>>            
70290>>>>>>>>>            Move dtSel1 to dtSel[0]
70291>>>>>>>>>            Move dtsel2 to dtSel[1]
70292>>>>>>>>>        End
70292>>>>>>>>>>
70292>>>>>>>>>        Else Begin
70293>>>>>>>>>            Get pdPrivateDate to dtSel[0]
70294>>>>>>>>>            Get pdPrivateDate2 to dtSel[1]
70295>>>>>>>>>        End
70295>>>>>>>>>>
70295>>>>>>>>>        Function_Return dtSel
70296>>>>>>>>>    End_Function
70297>>>>>>>>>    
70297>>>>>>>>>    // Set control's value when single select
70297>>>>>>>>>    Procedure SetSelectedDate Date dDate
70299>>>>>>>>>        tWinSystemTime CurrentSystemTime
70299>>>>>>>>>        tWinSystemTime CurrentSystemTime
70299>>>>>>>>>        Integer iRetval
70299>>>>>>>>>        Handle hWnd
70299>>>>>>>>>        
70299>>>>>>>>>        Get Window_Handle to hWnd
70300>>>>>>>>>        Set pdPrivateDate to dDate
70301>>>>>>>>>        If (hWnd) Begin
70303>>>>>>>>>            Move (DateGetDay(dDate)) to CurrentSystemTime.wDay
70304>>>>>>>>>            Move (DateGetMonth(dDate)) to CurrentSystemTime.wMonth
70305>>>>>>>>>            Move (DateGetYear(dDate)) to CurrentSystemTime.wYear
70306>>>>>>>>>            
70306>>>>>>>>>            Move (WindowsMessage (MCM_SETCURSEL, 0, AddressOf (CurrentSystemTime))) to iRetval
70307>>>>>>>>>        End
70307>>>>>>>>>>
70307>>>>>>>>>    End_Procedure
70308>>>>>>>>>    
70308>>>>>>>>>    // Set control's values when multi select
70308>>>>>>>>>    Procedure SetSelectedDateRange Date dDate Date dDate2
70310>>>>>>>>>        tWinSystemTime[] CurrentSystemTime
70310>>>>>>>>>        tWinSystemTime[] CurrentSystemTime
70311>>>>>>>>>        Integer iRetval
70311>>>>>>>>>        Handle hWnd
70311>>>>>>>>>        
70311>>>>>>>>>        Get Window_Handle to hWnd
70312>>>>>>>>>        Set pdPrivateDate to dDate
70313>>>>>>>>>        Set pdPrivateDate2 to dDate2
70314>>>>>>>>>        If (hWnd) Begin
70316>>>>>>>>>            Move (DateGetDay(dDate)) to CurrentSystemTime[0].wDay
70317>>>>>>>>>            Move (DateGetMonth(dDate)) to CurrentSystemTime[0].wMonth
70318>>>>>>>>>            Move (DateGetYear(dDate)) to CurrentSystemTime[0].wYear
70319>>>>>>>>>            
70319>>>>>>>>>            Move (DateGetDay(dDate2)) to CurrentSystemTime[1].wDay
70320>>>>>>>>>            Move (DateGetMonth(dDate2)) to CurrentSystemTime[1].wMonth
70321>>>>>>>>>            Move (DateGetYear(dDate2)) to CurrentSystemTime[1].wYear
70322>>>>>>>>>            
70322>>>>>>>>>            Move (WindowsMessage (MCM_SETSELRANGE, 0, AddressOf (CurrentSystemTime))) to iRetval
70323>>>>>>>>>        End
70323>>>>>>>>>>
70323>>>>>>>>>    End_Procedure
70324>>>>>>>>>    
70324>>>>>>>>>    // augment to set dates from control, so they can be accessed after the control is closed
70324>>>>>>>>>    Procedure Remove_Object
70326>>>>>>>>>        Date[] SelDate
70327>>>>>>>>>        If (pbMultiSelect(Self)) Begin
70329>>>>>>>>>            Get SelectedDateRange to SelDate
70330>>>>>>>>>            Set pdPrivateDate2 to SelDate[1]
70331>>>>>>>>>        End
70331>>>>>>>>>>
70331>>>>>>>>>        Else Begin
70332>>>>>>>>>            Get SelectedDate to SelDate[0]
70333>>>>>>>>>        End
70333>>>>>>>>>>
70333>>>>>>>>>        Set pdPrivateDate to SelDate[0]
70334>>>>>>>>>        Forward Send Remove_Object
70336>>>>>>>>>    End_Procedure
70337>>>>>>>>>    
70337>>>>>>>>>    Procedure Page Integer iState
70339>>>>>>>>>        Integer iRetval iSize iHeight iWidth
70339>>>>>>>>>        tWinRect WindowRect
70339>>>>>>>>>        tWinRect WindowRect
70339>>>>>>>>>        Date dDate dDate2
70339>>>>>>>>>        Handle hWnd
70339>>>>>>>>>        Integer  iMaxSelectedCount
70339>>>>>>>>>        Boolean bNoToday bWeekNumbers bMultiSelect bNoTodayCircle
70339>>>>>>>>>        
70339>>>>>>>>>        If (iState<>1) Begin
70341>>>>>>>>>            Forward Send Page iState
70343>>>>>>>>>            Procedure_Return
70344>>>>>>>>>        End
70344>>>>>>>>>>
70344>>>>>>>>>        
70344>>>>>>>>>        Set Icon to 'ActionCalendar.ico'
70345>>>>>>>>>        
70345>>>>>>>>>        Get pbNoToday to bNoToday
70346>>>>>>>>>        Get pbNoTodayCircle to bNoTodayCircle
70347>>>>>>>>>        Get pbMultiSelect to bMultiSelect
70348>>>>>>>>>        Get pbWeekNumbers to bWeekNumbers
70349>>>>>>>>>        Get piMaxSelectedCount to iMaxSelectedCount
70350>>>>>>>>>        
70350>>>>>>>>>        Set Window_Style MCS_MULTISELECT to bMultiSelect
70351>>>>>>>>>        Set Window_Style MCS_NOTODAY to bNoToday
70352>>>>>>>>>        Set Window_Style MCS_NOTODAYCIRCLE to bNoTodayCircle
70353>>>>>>>>>        Set Window_Style MCS_WEEKNUMBERS to bWeekNumbers
70354>>>>>>>>>        Forward Send Page iState
70356>>>>>>>>>        
70356>>>>>>>>>        Get Window_Handle to hWnd
70357>>>>>>>>>        // support double click
70357>>>>>>>>>        Move (SetClassLongPtr(hWnd,GCL_STYLE,CS_DBLCLKS ior CS_GLOBALCLASS)) to iRetval
70358>>>>>>>>>        // set range when multi select
70358>>>>>>>>>        Move (WindowsMessage(MCM_SETMAXSELCOUNT,iMaxSelectedCount,0)) to iRetval
70359>>>>>>>>>        
70359>>>>>>>>>        // store minimum size for calendar control and set the size to this by default
70359>>>>>>>>>        Move (WindowsMessage (MCM_GETMINREQRECT, 0, AddressOf(WindowRect))) to iRetval
70360>>>>>>>>>        Get GuiToDialog WindowRect.bottom WindowRect.right to iSize
70361>>>>>>>>>        Move (Hi(iSize)) to iHeight
70362>>>>>>>>>        Move (Low(iSize)) to iWidth
70363>>>>>>>>>        Set piMinWidth to iWidth
70364>>>>>>>>>        Set piMinHeight to iHeight
70365>>>>>>>>>        Set Size to iHeight iWidth
70366>>>>>>>>>        
70366>>>>>>>>>        // now that we are activated set starting date or date range
70366>>>>>>>>>        Get pdPrivateDate to dDate
70367>>>>>>>>>        If (pbMultiSelect(Self)) Begin
70369>>>>>>>>>            Get pdPrivateDate2 to dDate2
70370>>>>>>>>>            Send SetSelectedDateRange dDate dDate2
70371>>>>>>>>>        End
70371>>>>>>>>>>
70371>>>>>>>>>        Else Begin
70372>>>>>>>>>            Send SetSelectedDate dDate
70373>>>>>>>>>        End
70373>>>>>>>>>>
70373>>>>>>>>>    End_Procedure
70374>>>>>>>>>    
70374>>>>>>>>>    Procedure Notify Longptr wParam Longptr lParam
70376>>>>>>>>>        Integer iRetval
70376>>>>>>>>>        DateTime dtSel dtSel2
70376>>>>>>>>>        tWintagNMSelChange CalenderInfo
70376>>>>>>>>>        tWintagNMSelChange CalenderInfo
70376>>>>>>>>>        Boolean bMulti
70376>>>>>>>>>        
70376>>>>>>>>>        Move (MemCopy (AddressOf (CalenderInfo), lParam, SizeOfType (tWintagNMSelChange))) to iRetval
70377>>>>>>>>>        If (CalenderInfo.nmHdr.code = MCN_SELCHANGE) Begin
70379>>>>>>>>>            Get pbMultiSelect to bMulti
70380>>>>>>>>>            Move (DateSetDay(dtSel,CalenderInfo.stSelStart.wDay)) to dtSel
70381>>>>>>>>>            Move (DateSetMonth(dtSel,CalenderInfo.stSelStart.wMonth)) to dtSel
70382>>>>>>>>>            Move (DateSetYear(dtSel,CalenderInfo.stSelStart.wYear)) to dtSel
70383>>>>>>>>>            If bMulti Begin
70385>>>>>>>>>                Move (DateSetDay(dtSel,CalenderInfo.stSelEnd.wDay)) to dtSel2
70386>>>>>>>>>                Move (DateSetMonth(dtSel,CalenderInfo.stSelEnd.wMonth)) to dtSel2
70387>>>>>>>>>                Move (DateSetYear(dtSel,CalenderInfo.stSelEnd.wYear)) to dtSel2
70388>>>>>>>>>            End
70388>>>>>>>>>>
70388>>>>>>>>>            Send OnChange (Date(dtSel)) (Date(dtSel2))
70389>>>>>>>>>        End
70389>>>>>>>>>>
70389>>>>>>>>>    End_Procedure
70390>>>>>>>>>    
70390>>>>>>>>>    // sent whenever there is a selection change within the calendar
70390>>>>>>>>>    Procedure OnChange Date dDate Date dDate2
70392>>>>>>>>>    End_Procedure
70393>>>>>>>>>    
70393>>>>>>>>>    // sent when a click occurs in the calendar
70393>>>>>>>>>    Procedure OnClick
70395>>>>>>>>>    End_Procedure
70396>>>>>>>>>    
70396>>>>>>>>>    // sent when a double click occurs in the calendar
70396>>>>>>>>>    Procedure OnDoubleClick
70398>>>>>>>>>    End_Procedure
70399>>>>>>>>>    
70399>>>>>>>>>    // sends OnClick if the double click is on a calendar day
70399>>>>>>>>>    Procedure OnLButtonDblClick Integer wParam Integer lParam
70401>>>>>>>>>        Boolean bDayHit
70401>>>>>>>>>        Get MonthDayHit to bDayHit
70402>>>>>>>>>        If bDayHit Begin
70404>>>>>>>>>            Send OnDoubleClick
70405>>>>>>>>>        End
70405>>>>>>>>>>
70405>>>>>>>>>    End_Procedure
70406>>>>>>>>>    
70406>>>>>>>>>    // sends OnClick if the click is on a calendar day
70406>>>>>>>>>    Procedure OnWmLButtonUp Integer wParam Integer lParam
70408>>>>>>>>>        Boolean bDayHit
70408>>>>>>>>>        Get MonthDayHit to bDayHit
70409>>>>>>>>>        If bDayHit Begin
70411>>>>>>>>>            Send OnClick
70412>>>>>>>>>        End
70412>>>>>>>>>>
70412>>>>>>>>>    End_Procedure
70413>>>>>>>>>    
70413>>>>>>>>>    // returns true if the month calander is up and the mouse is over a day
70413>>>>>>>>>    Function MonthDayHit Returns Boolean
70415>>>>>>>>>        UInteger iRet
70415>>>>>>>>>        Move (WindowsMessage( MCM_GETCURRENTVIEW, 0, 0)) to iRet
70416>>>>>>>>>        If (iRet=MCMV_MONTH) Begin
70418>>>>>>>>>            Get HitTest to iRet
70419>>>>>>>>>            Function_Return (iRet=MCHT_CALENDARDATE)
70420>>>>>>>>>        End
70420>>>>>>>>>>
70420>>>>>>>>>        Function_Return False
70421>>>>>>>>>    End_Function
70422>>>>>>>>>    
70422>>>>>>>>>    // return what was hit in the control
70422>>>>>>>>>    Function HitTest Returns UInteger
70424>>>>>>>>>        tWinMCHitTestInfo HitInfo
70424>>>>>>>>>        tWinMCHitTestInfo HitInfo
70424>>>>>>>>>        Handle hWnd iRet
70424>>>>>>>>>        Integer iVoid
70424>>>>>>>>>        Pointer lpPt
70424>>>>>>>>>        tWinPoint Pt
70424>>>>>>>>>        tWinPoint Pt
70424>>>>>>>>>        Get Window_Handle to hWnd
70425>>>>>>>>>        Move (AddressOf(Pt)) to lpPt
70426>>>>>>>>>        Move (GetCursorPos(lpPt)) to iVoid
70427>>>>>>>>>        Move (ScreenToClient(hWnd, lpPt)) to iVoid
70428>>>>>>>>>        Move Pt to HitInfo.Pt
70429>>>>>>>>>        Move (SizeOfType(tWinMCHitTestInfo)) to HitInfo.cbSize
70430>>>>>>>>>        Move (WindowsMessage(MCM_HITTEST, 0, AddressOf(HitInfo))) to iRet
70431>>>>>>>>>        Function_Return HitInfo.uHit
70432>>>>>>>>>    End_Function
70433>>>>>>>>>    
70433>>>>>>>>>End_Class
70434>>>>>>>
70434>>>>>>>// peMouseSelectOk choices
70434>>>>>>>Enum_List
70434>>>>>>>    Define msoClick
70434>>>>>>>    Define msoDblClick
70434>>>>>>>    Define msoNone
70434>>>>>>>End_Enum_List
70434>>>>>>>
70434>>>>>>>// It is expected that this class will only be used inside of ModalPanel and
70434>>>>>>>// will be used as a prompt object component in a framework style application.
70434>>>>>>>// If you wish to Use a month calendar in some other non prompt situation,
70434>>>>>>>// use cMonthCalendar
70434>>>>>>>
70434>>>>>>>Class cMonthCalendarPrompt is a cMonthCalendar
70435>>>>>>>    
70435>>>>>>>    Procedure Construct_Object
70437>>>>>>>        
70437>>>>>>>        Forward Send Construct_Object
70439>>>>>>>        
70439>>>>>>>        Property Integer peUpdateMode umPromptValue
70440>>>>>>>        
70440>>>>>>>        Property Integer peMouseSelectOk msoClick
70441>>>>>>>        
70441>>>>>>>        Property Date pdSeedValue
70442>>>>>>>        
70442>>>>>>>        // if multi-select, this is the end range
70442>>>>>>>        Property Date pdSeedValue2
70443>>>>>>>        
70443>>>>>>>        Property Handle phmPromptUpdateCallback 0
70444>>>>>>>        
70444>>>>>>>        Property Integer phoInvokingObject
70445>>>>>>>        
70445>>>>>>>        Property Integer peStoredUpdateMode
70446>>>>>>>        Property Handle  phmStoredPromptUpdateCallback
70447>>>>>>>        Property Boolean pbStoredWeekNumbers
70448>>>>>>>        Property Boolean pbStoredNoToday
70449>>>>>>>        Property Boolean pbStoredNoTodayCircle
70450>>>>>>>        Property Boolean pbStoredMultiSelect
70451>>>>>>>        Property Integer piStoredMaxSelectedCount
70452>>>>>>>        Property Integer peStoredpeMouseSelectOk
70453>>>>>>>        
70453>>>>>>>        // internally set by list
70453>>>>>>>        // these must be set upon closing the list and can be used for manual list updates
70453>>>>>>>        Property Boolean pbCanceled
70454>>>>>>>        
70454>>>>>>>    End_Procedure
70455>>>>>>>    
70455>>>>>>>    Procedure OnStoreDefaults
70457>>>>>>>        Integer iVal
70457>>>>>>>        Boolean bVal
70457>>>>>>>        
70457>>>>>>>        Get peUpdateMode to iVal
70458>>>>>>>        Set peStoredUpdateMode to iVal
70459>>>>>>>        
70459>>>>>>>        Get phmPromptUpdateCallback to iVal
70460>>>>>>>        Set phmStoredPromptUpdateCallback to iVal
70461>>>>>>>        
70461>>>>>>>        Get pbMultiSelect to bVal
70462>>>>>>>        Set pbStoredMultiSelect to bVal
70463>>>>>>>        
70463>>>>>>>        Get pbNoToday to bVal
70464>>>>>>>        Set pbStoredNoToday to bVal
70465>>>>>>>        
70465>>>>>>>        Get pbNoTodayCircle to bVal
70466>>>>>>>        Set pbStoredNoTodayCircle to bVal
70467>>>>>>>        
70467>>>>>>>        Get pbWeekNumbers to bVal
70468>>>>>>>        Set pbStoredWeekNumbers to bVal
70469>>>>>>>        
70469>>>>>>>        Get piMaxSelectedCount to iVal
70470>>>>>>>        Set piStoredMaxSelectedCount to iVal
70471>>>>>>>        
70471>>>>>>>        Get peMouseSelectOk to iVal
70472>>>>>>>        Set peStoredpeMouseSelectOk to iVal
70473>>>>>>>        
70473>>>>>>>    End_Procedure
70474>>>>>>>    
70474>>>>>>>    Procedure OnRestoreDefaults
70476>>>>>>>        Integer iVal
70476>>>>>>>        Boolean bVal
70476>>>>>>>        
70476>>>>>>>        Get peStoredUpdateMode to iVal
70477>>>>>>>        Set peUpdateMode to iVal
70478>>>>>>>        
70478>>>>>>>        Get phmStoredPromptUpdateCallback to iVal
70479>>>>>>>        Set phmPromptUpdateCallback to iVal
70480>>>>>>>        
70480>>>>>>>        Get pbStoredMultiSelect to bVal
70481>>>>>>>        Set pbMultiSelect to bVal
70482>>>>>>>        
70482>>>>>>>        Get pbStoredNoToday to bVal
70483>>>>>>>        Set pbNoToday to bVal
70484>>>>>>>        
70484>>>>>>>        Get pbStoredNoTodayCircle to bVal
70485>>>>>>>        Set pbNoTodayCircle to bVal
70486>>>>>>>        
70486>>>>>>>        Get pbStoredWeekNumbers to bVal
70487>>>>>>>        Set pbWeekNumbers to bVal
70488>>>>>>>        
70488>>>>>>>        Get piStoredMaxSelectedCount to iVal
70489>>>>>>>        Set piMaxSelectedCount to iVal
70490>>>>>>>        
70490>>>>>>>        Get peStoredpeMouseSelectOk to iVal
70491>>>>>>>        Set peMouseSelectOk to iVal
70492>>>>>>>        
70492>>>>>>>    End_Procedure
70493>>>>>>>    
70493>>>>>>>    Procedure Add_Focus Handle hoParent Returns Integer
70495>>>>>>>        Integer eMode
70495>>>>>>>        Set pbCanceled to True // assume cancel unless changed
70496>>>>>>>        Get peUpdateMode to eMode
70497>>>>>>>        If (eMode<>umPromptNonInvoking) Begin
70499>>>>>>>            Send OnStoreDefaults
70500>>>>>>>        End
70500>>>>>>>>
70500>>>>>>>        Send InitializePrompt
70501>>>>>>>        Forward Send Add_Focus hoParent
70503>>>>>>>    End_Procedure
70504>>>>>>>    
70504>>>>>>>    // augment to send OnRestoreDefaults.
70504>>>>>>>    Procedure Release_Focus
70506>>>>>>>        Integer eUpdateMode
70506>>>>>>>        Get peUpdateMode to eUpdateMode
70507>>>>>>>        Forward Send Release_Focus
70509>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70511>>>>>>>            Send OnRestoreDefaults
70512>>>>>>>        End
70512>>>>>>>>
70512>>>>>>>    End_Procedure
70513>>>>>>>    
70513>>>>>>>    // This is only called in a successful close
70513>>>>>>>    Procedure ClosePrompt
70515>>>>>>>        Handle hoInvokingObject
70515>>>>>>>        Handle hmCallBack
70515>>>>>>>        Integer eUpdateMode
70515>>>>>>>        Date[] dDates
70516>>>>>>>        
70516>>>>>>>        Set pbCanceled to False
70517>>>>>>>        
70517>>>>>>>        Get peUpdateMode to eUpdateMode
70518>>>>>>>        // if non-invoking there is by definition, no move value out
70518>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70520>>>>>>>            
70520>>>>>>>            If (eUpdateMode=umPromptValue) Begin
70522>>>>>>>                Send OnMoveValueOutByValue
70523>>>>>>>            End
70523>>>>>>>>
70523>>>>>>>            Else If (eUpdateMode=umPromptCustom) Begin
70526>>>>>>>                Send OnMoveValueOutByCustom
70527>>>>>>>            End
70527>>>>>>>>
70527>>>>>>>            Get phmPromptUpdateCallback to hmCallBack
70528>>>>>>>            If hmCallBack Begin
70530>>>>>>>                Get phoInvokingObject to hoInvokingObject
70531>>>>>>>                If (pbMultiSelect(Self)) Begin
70533>>>>>>>                    Get SelectedDateRange to dDates
70534>>>>>>>                    Send hmCallBack of hoInvokingObject Self dDates[0] dDates[1]
70535>>>>>>>                    
70535>>>>>>>                End
70535>>>>>>>>
70535>>>>>>>                Else Begin
70536>>>>>>>                    Get SelectedDate to dDates[0]
70537>>>>>>>                    Send hmCallBack of hoInvokingObject Self dDates[0]
70538>>>>>>>                End
70538>>>>>>>>
70538>>>>>>>            End
70538>>>>>>>>
70538>>>>>>>        End
70538>>>>>>>>
70538>>>>>>>        
70538>>>>>>>        Send Close_Panel
70539>>>>>>>    End_Procedure
70540>>>>>>>    
70540>>>>>>>    Procedure OnMoveValueOutByValue
70542>>>>>>>        Handle hoInvokingObject
70542>>>>>>>        Date dSelDate
70542>>>>>>>        Boolean bMulti
70542>>>>>>>        // we can only do an automatic move value out with
70542>>>>>>>        // single select. If multi-select you will probably want to
70542>>>>>>>        // use a callback method (hmCallBack) to update the values.
70542>>>>>>>        Get pbMultiSelect to bMulti
70543>>>>>>>        If (not(bMulti)) Begin
70545>>>>>>>            Get SelectedDate to dSelDate
70546>>>>>>>            Get phoInvokingObject to hoInvokingObject
70547>>>>>>>            Set Value of hoInvokingObject to dSelDate
70548>>>>>>>            Set Item_Changed_State of hoInvokingObject to True
70549>>>>>>>        End
70549>>>>>>>>
70549>>>>>>>    End_Procedure
70550>>>>>>>    
70550>>>>>>>    Procedure OnMoveValueOutByCustom
70552>>>>>>>    End_Procedure
70553>>>>>>>    
70553>>>>>>>    // called before the list is activated.
70553>>>>>>>    Procedure InitializePrompt
70555>>>>>>>        Handle hoInvokingObject
70555>>>>>>>        Integer eUpdateMode
70555>>>>>>>        Boolean bMulti
70555>>>>>>>        Date dValue
70555>>>>>>>        
70555>>>>>>>        Get peUpdateMode to eUpdateMode
70556>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70558>>>>>>>            
70558>>>>>>>            Get Focus of Desktop to hoInvokingObject
70559>>>>>>>            If (hoInvokingObject<=Desktop) Begin
70561>>>>>>>                Error DFERR_PROGRAM "Calendar Prompt has no invoking object"
70562>>>>>>>>
70562>>>>>>>                Procedure_Return
70563>>>>>>>            End
70563>>>>>>>>
70563>>>>>>>            
70563>>>>>>>            Set phoInvokingObject to hoInvokingObject
70564>>>>>>>            Send Prompt_Callback to hoInvokingObject Self
70565>>>>>>>            Get peUpdateMode to eUpdateMode
70566>>>>>>>        End
70566>>>>>>>>
70566>>>>>>>        
70566>>>>>>>        Get pdSeedValue to dValue
70567>>>>>>>        Get pbMultiSelect to bMulti
70568>>>>>>>        If (not(bMulti) and eUpdateMode=umPromptValue and dValue=0) Begin
70570>>>>>>>            Get Value of hoInvokingObject to dValue
70571>>>>>>>            Set pdSeedValue to dValue
70572>>>>>>>        End
70572>>>>>>>>
70572>>>>>>>        Send OnSeedData
70573>>>>>>>        Set pdSeedValue to 0
70574>>>>>>>        Set pdSeedValue2 to 0
70575>>>>>>>    End_Procedure
70576>>>>>>>    
70576>>>>>>>    Procedure OnSeedData
70578>>>>>>>        Boolean bMulti
70578>>>>>>>        Date dValue dValue2
70578>>>>>>>        Integer iMax iRange
70578>>>>>>>        DateTime dt1 dt2
70578>>>>>>>        Get pbMultiSelect to bMulti
70579>>>>>>>        Get pdSeedValue to dValue
70580>>>>>>>        If (not(bMulti)) Begin
70582>>>>>>>            // if no date, use current date
70582>>>>>>>            If (dValue=0) Begin
70584>>>>>>>                Move (CurrentDateTime()) to dValue
70585>>>>>>>            End
70585>>>>>>>>
70585>>>>>>>            Send SetSelectedDate dValue
70586>>>>>>>        End
70586>>>>>>>>
70586>>>>>>>        Else Begin
70587>>>>>>>            Get pdSeedValue2 to dValue2
70588>>>>>>>            // if no dates, use current date
70588>>>>>>>            If (dValue=0 and dValue2=0) Begin
70590>>>>>>>                Move (CurrentDateTime()) to dValue
70591>>>>>>>            End
70591>>>>>>>>
70591>>>>>>>            // if only one date, make that the range
70591>>>>>>>            If (dValue=0) Begin
70593>>>>>>>                Move dValue2 to dValue
70594>>>>>>>            End
70594>>>>>>>>
70594>>>>>>>            Else If (dValue2=0) Begin
70597>>>>>>>                Move dValue to dValue2
70598>>>>>>>            End
70598>>>>>>>>
70598>>>>>>>            
70598>>>>>>>            // test for valid range
70598>>>>>>>            Get piMaxSelectedCount to iMax
70599>>>>>>>            Move dValue to dt1
70600>>>>>>>            Move dValue2 to dt2
70601>>>>>>>            Move (SpanTotalDays(dt1 - dt2)) to iRange
70602>>>>>>>            If (iRange>iMax) Begin
70604>>>>>>>                Error DFERR_OPERATOR (SFormat(C_$DateRangeExceeded,iMax))
70605>>>>>>>>
70605>>>>>>>                Move dValue to dValue2
70606>>>>>>>            End
70606>>>>>>>>
70606>>>>>>>            
70606>>>>>>>            Send SetSelectedDateRange dValue dValue2
70607>>>>>>>        End
70607>>>>>>>>
70607>>>>>>>    End_Procedure
70608>>>>>>>    
70608>>>>>>>    Procedure OnDoubleClick
70610>>>>>>>        Integer eSelectOn
70610>>>>>>>        Get peMouseSelectOk to eSelectOn
70611>>>>>>>        If (eSelectOn=msoDblClick) Begin
70613>>>>>>>            Send Ok
70614>>>>>>>        End
70614>>>>>>>>
70614>>>>>>>    End_Procedure
70615>>>>>>>    
70615>>>>>>>    Procedure OnClick
70617>>>>>>>        Integer eSelectOn
70617>>>>>>>        Get peMouseSelectOk to eSelectOn
70618>>>>>>>        If (eSelectOn=msoClick) Begin
70620>>>>>>>            Send Ok
70621>>>>>>>        End
70621>>>>>>>>
70621>>>>>>>    End_Procedure
70622>>>>>>>    
70622>>>>>>>    Procedure Ok Returns Integer
70624>>>>>>>        Send ClosePrompt
70625>>>>>>>    End_Procedure
70626>>>>>>>    
70626>>>>>>>    Procedure Cancel Returns Integer
70628>>>>>>>        Send Close_Panel
70629>>>>>>>    End_Procedure
70630>>>>>>>    
70630>>>>>>>End_Class
70631>>>>>Use Dfclient.pkg
70631>>>>>
70631>>>>>Cd_Popup_Object oMonthCalendarPrompt is a ModalPanel
70649>>>>>>
70649>>>>>    Set Location to 10 10
70650>>>>>    Set Size to 145 145
70651>>>>>    // resizable
70651>>>>>    Set Border_Style to Border_Thick
70652>>>>>    
70652>>>>>    Set Label to C_$DateSelector
70653>>>>>    
70653>>>>>    Set piMinSize to 0 0 // set this dynamically // 145 145
70654>>>>>    Set piMaxSize to 310 460
70655>>>>>    
70655>>>>>    // tells us if this been activated and sized yet
70655>>>>>    Property Boolean pbSizeInited False
70657>>>>>    
70657>>>>>    Object oCalendar is a cMonthCalendarPrompt
70659>>>>>        Set Size to 120 135 // not real size, will be assigned
70660>>>>>        Set Location to 5 5
70661>>>>>        Set Border_Style to Border_None
70662>>>>>    End_Object
70663>>>>>    
70663>>>>>    Object oOKButton is a Button
70665>>>>>        Set Label to C_$OK
70666>>>>>        Set Default_State to True
70667>>>>>        Set Location to 129 34
70668>>>>>        Set peAnchors to anBottomRight
70669>>>>>        
70669>>>>>        Procedure OnClick
70672>>>>>            Send Ok of oCalendar
70673>>>>>        End_Procedure
70674>>>>>    End_Object
70675>>>>>    
70675>>>>>    Object oCancelButton is a Button
70677>>>>>        Set Label to C_$Cancel
70678>>>>>        Set Location to 129 89
70679>>>>>        Set peAnchors to anBottomRight
70680>>>>>        
70680>>>>>        Procedure OnClick
70683>>>>>            Send Cancel of oCalendar
70684>>>>>        End_Procedure
70685>>>>>    End_Object
70686>>>>>    
70686>>>>>    Procedure OnResize
70689>>>>>        Integer iSize iHeight iWidth iMinSize
70689>>>>>        Boolean bInited
70689>>>>>        
70689>>>>>        Get piMinHeight of oCalendar to iHeight
70690>>>>>        // when 0, the control has not yet been created. Nothing to do.
70690>>>>>        If (iHeight=0) Begin
70692>>>>>            Procedure_Return
70693>>>>>        End
70693>>>>>>
70693>>>>>        
70693>>>>>        Get pbSizeInited to bInited
70694>>>>>        
70694>>>>>        Get piMinWidth of oCalendar to iWidth
70695>>>>>        Get piMinSize to iMinSize
70696>>>>>        // Minumum size of panel - add 1 to each to each for wiggle room
70696>>>>>        Move (iHeight+25+1) to iHeight
70697>>>>>        Move (iWidth+10+1) to iWidth
70698>>>>>        
70698>>>>>        Set piMinSize to iHeight iWidth
70699>>>>>        
70699>>>>>        If (not(bInited))  Begin
70701>>>>>            Set Size to iHeight iWidth
70702>>>>>            Set pbSizeInited to True
70703>>>>>        End
70703>>>>>>
70703>>>>>        Else Begin
70704>>>>>            Send Adjust_Logicals
70705>>>>>            Get Size to iSize
70706>>>>>            If (Hi(iSize)<iHeight or Low(iSize)<iWidth) Begin
70708>>>>>                Set Size to (iHeight max Hi(iSize)) (iWidth max Low(iSize))
70709>>>>>                Get Size to iSize
70710>>>>>            End
70710>>>>>>
70710>>>>>            Set Size of oCalendar to (Hi(iSize) - 25) (Low(iSize) - 10)
70711>>>>>        End
70711>>>>>>
70711>>>>>        
70711>>>>>    End_Procedure
70712>>>>>    
70712>>>>>    Procedure Add_Focus Handle hoParent Returns Integer
70715>>>>>        Forward Send Add_Focus hoParent
70717>>>>>        Send OnResize
70718>>>>>    End_Procedure
70719>>>>>    
70719>>>>>    On_Key kCancel Send KeyAction to oCancelButton
70720>>>>>    
70720>>>>>Cd_End_Object
70722>>>>>>
70722>>>>>
70722>>>
70722>>>ACTIVATE_VIEW Activate_oPageHeaderEntry FOR oPageHeaderEntry
70732>>>>
70732>>>Object oPageHeaderEntry is a dbView
70734>>>    Set Location to 5 5
70735>>>    Set Size to 107 420
70736>>>    Set Label To "PageHeaderEntry"
70737>>>    Set Border_Style to Border_Thick
70738>>>
70738>>>
70738>>>    Object oEmployee_DD is a cEmployeeDataDictionary
70740>>>    End_Object 
70741>>>
70741>>>    Object oLine_DD is a cLineDataDictionary
70743>>>    End_Object 
70744>>>
70744>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
70746>>>        Set DDO_Server To oEmployee_DD
70747>>>        Set DDO_Server To oLine_DD
70748>>>    End_Object 
70749>>>
70749>>>    Set Main_DD To oPageHeader_DD
70750>>>    Set Server  To oPageHeader_DD
70751>>>
70751>>>
70751>>>
70751>>>    Object oPageHeaderid is a dbForm
70753>>>        Entry_Item PageHeader.id
70754>>>        Set Size to 12 34
70755>>>        Set Location to 5 21
70756>>>        Set peAnchors to anTopLeftRight
70757>>>        Set Label to "id"
70758>>>        Set Label_Justification_mode to jMode_Left
70759>>>        Set Label_Col_Offset to 16
70760>>>        Set Label_row_Offset to 0
70761>>>    End_Object 
70762>>>
70762>>>    Object oEmployeeid is a dbForm
70764>>>        Entry_Item Employee.id
70765>>>        Set Size to 12 34
70766>>>        Set Location to 5 101
70767>>>        Set peAnchors to anTopRight
70768>>>        Set Label to "employee id"
70769>>>        Set Label_Justification_mode to jMode_Left
70770>>>        Set Label_Col_Offset to 41
70771>>>        Set Label_row_Offset to 0
70772>>>    End_Object 
70773>>>
70773>>>    Object oLineid is a dbForm
70775>>>        Entry_Item Line.id
70776>>>        Set Size to 12 34
70777>>>        Set Location to 5 161
70778>>>        Set peAnchors to anTopRight
70779>>>        Set Label to "line id"
70780>>>        Set Label_Justification_mode to jMode_Left
70781>>>        Set Label_Col_Offset to 21
70782>>>        Set Label_row_Offset to 0
70783>>>    End_Object 
70784>>>
70784>>>    Object oPageHeaderdate is a dbForm
70786>>>        Entry_Item PageHeader.date
70787>>>        Set Size to 12 66
70788>>>        Set Location to 19 21
70789>>>        Set peAnchors to anTopLeftRight
70790>>>        Set Label to "date"
70791>>>        Set Label_Justification_mode to jMode_Left
70792>>>        Set Label_Col_Offset to 16
70793>>>        Set Label_row_Offset to 0
70794>>>        Set Prompt_Object to oMonthCalendarPrompt
70795>>>        Set Prompt_Button_Mode to PB_PromptOn
70796>>>        Procedure OnExitObject
70799>>>            Date dDateSelected
70799>>>            
70799>>>            Get File_Field_Current_Value of oPageHeader_DD File_Field PageHeader.Date to dDateSelected
70800>>>            
70800>>>            If (dDateSelected < "1/1/2020" or dDateSelected > "12/31/2022" ) Begin
70802>>>                Send Info_Box "Date must be between 1/1/2020 and 12/31/2022"
70803>>>            End
70803>>>>
70803>>>            
70803>>>        End_Procedure
70804>>>    End_Object 
70805>>>
70805>>>    Object oPageHeaderhours is a dbForm
70807>>>        Entry_Item PageHeader.hours
70808>>>        Set Size to 12 34
70809>>>        Set Location to 19 112
70810>>>        Set peAnchors to anTopRight
70811>>>        Set Label to "hours"
70812>>>        Set Label_Justification_mode to jMode_Left
70813>>>        Set Label_Col_Offset to 20
70814>>>        Set Label_row_Offset to 0
70815>>>    End_Object 
70816>>>
70816>>>    Object oTabDialog is a dbTabDialog
70818>>>        Set Size to 61 410
70819>>>        Set Location to 41 5
70820>>>        Set peAnchors to anTopLeftRight
70821>>>
70821>>>        Object oTabPage1 is a dbTabPage
70823>>>            Set Label to "Tab Page Label"
70824>>>
70824>>>            Object oLinetype is a dbForm
70826>>>                Entry_Item Line.type
70827>>>                Set Size to 12 250
70828>>>                Set Location to 10 25
70829>>>                Set peAnchors to anTopLeftRight
70830>>>                Set Label to "type"
70831>>>                Set Label_Justification_mode to jMode_Left
70832>>>                Set Label_Col_Offset to 20
70833>>>                Set Label_row_Offset to 0
70834>>>            End_Object 
70835>>>
70835>>>            Object oEmployeename is a dbForm
70837>>>                Entry_Item Employee.name
70838>>>                Set Size to 12 250
70839>>>                Set Location to 24 25
70840>>>                Set peAnchors to anTopLeftRight
70841>>>                Set Label to "name"
70842>>>                Set Label_Justification_mode to jMode_Left
70843>>>                Set Label_Col_Offset to 20
70844>>>                Set Label_row_Offset to 0
70845>>>            End_Object 
70846>>>
70846>>>            Object oEmployeeid_card is a dbForm
70848>>>                Entry_Item Employee.id_card
70849>>>                Set Size to 12 96
70850>>>                Set Location to 24 304
70851>>>                Set peAnchors to anTopRight
70852>>>                Set Label to "id card"
70853>>>                Set Label_Justification_mode to jMode_Left
70854>>>                Set Label_Col_Offset to 24
70855>>>                Set Label_row_Offset to 0
70856>>>            End_Object 
70857>>>
70857>>>        End_Object 
70858>>>
70858>>>    End_Object 
70859>>>
70859>>>
70859>>>End_Object 
70860>        Use ShoeEntry.vw
Including file: ShoeEntry.vw    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\ShoeEntry.vw)
70860>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\ShoeEntry.vw
70860>>>// ShoeEntry
70860>>>//
70860>>>
70860>>>Use DFClient.pkg
70860>>>Use DFEntry.pkg
70860>>>
70860>>>Use cShoeDataDictionary.dd
Including file: cShoeDataDictionary.dd    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\DDSrc\cShoeDataDictionary.dd)
70860>>>>>Use DataDict.pkg
70860>>>>>
70860>>>>>Open Shoe
Including file: Shoe.fd    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\DDSrc\Shoe.fd)
70862>>>>>Open system
70864>>>>>Open PageFooter
70866>>>>>
70866>>>>>Register_Object Shoe_sl
70866>>>>>
70866>>>>>Class cShoeDataDictionary is a DataDictionary
70867>>>>>    
70867>>>>>    Procedure Construct_Object
70869>>>>>        Forward Send Construct_Object
70871>>>>>        Set Main_File to Shoe.File_Number
70872>>>>>
70872>>>>>        Set Add_Client_File to PageFooter.File_Number
70873>>>>>
70873>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
70874>>>>>
70874>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
70875>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
70876>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
70877>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
70878>>>>>
70878>>>>>        Set Field_Auto_Increment Field Shoe.id to File_Field system.shoe_id
70879>>>>>        Set Field_Prompt_Object Field Shoe.id to Shoe_sl
70880>>>>>
70880>>>>>        Set Field_Prompt_Object Field Shoe.name to Shoe_sl
70881>>>>>
70881>>>>>        Set Field_Prompt_Object Field Shoe.price to Shoe_sl
70882>>>>>
70882>>>>>    End_Procedure
70883>>>>>
70883>>>>>End_Class
70884>>>>>
70884>>>>>Use Shoe.sl
Including file: Shoe.sl    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\Shoe.sl)
70884>>>>>>>// Shoe.sl
70884>>>>>>>// Shoe Lookup List
70884>>>>>>>
70884>>>>>>>Use DFClient.pkg
70884>>>>>>>Use cDbCJGridPromptList.pkg
70884>>>>>>>Use cDbCJGridColumn.pkg
70884>>>>>>>Use Windows.pkg
70884>>>>>>>
70884>>>>>>>Use cShoeDataDictionary.dd
70884>>>>>>>
70884>>>>>>>CD_Popup_Object Shoe_sl is a dbModalPanel
70902>>>>>>>>
70902>>>>>>>    Set Location to 5 5
70903>>>>>>>    Set Size to 134 272
70904>>>>>>>    Set Label To "Shoe Lookup List"
70905>>>>>>>    Set Border_Style to Border_Thick
70906>>>>>>>    Set Minimize_Icon to False
70907>>>>>>>
70907>>>>>>>
70907>>>>>>>    Object oShoe_DD is a cShoeDataDictionary
70909>>>>>>>    End_Object 
70910>>>>>>>
70910>>>>>>>    Set Main_DD To oShoe_DD
70911>>>>>>>    Set Server  To oShoe_DD
70912>>>>>>>
70912>>>>>>>
70912>>>>>>>
70912>>>>>>>    Object oSelList is a cDbCJGridPromptList
70914>>>>>>>        Set Size to 105 262
70915>>>>>>>        Set Location to 5 5
70916>>>>>>>        Set peAnchors to anAll
70917>>>>>>>        Set psLayoutSection to "Shoe_sl_oSelList"
70918>>>>>>>        Set Ordering to 1
70919>>>>>>>        Set pbAutoServer to True
70920>>>>>>>
70920>>>>>>>        Object oShoe_id is a cDbCJGridColumn
70922>>>>>>>            Entry_Item Shoe.id
70923>>>>>>>            Set piWidth to 60
70924>>>>>>>            Set psCaption to "id"
70925>>>>>>>        End_Object 
70926>>>>>>>
70926>>>>>>>        Object oShoe_name is a cDbCJGridColumn
70928>>>>>>>            Entry_Item Shoe.name
70929>>>>>>>            Set piWidth to 250
70930>>>>>>>            Set psCaption to "name"
70931>>>>>>>        End_Object 
70932>>>>>>>
70932>>>>>>>        Object oShoe_price is a cDbCJGridColumn
70934>>>>>>>            Entry_Item Shoe.price
70935>>>>>>>            Set piWidth to 110
70936>>>>>>>            Set psCaption to "price"
70937>>>>>>>        End_Object 
70938>>>>>>>
70938>>>>>>>
70938>>>>>>>    End_Object 
70939>>>>>>>
70939>>>>>>>    Object oOk_bn is a Button
70941>>>>>>>        Set Label to "&Ok"
70942>>>>>>>        Set Location to 115 109
70943>>>>>>>        Set peAnchors to anBottomRight
70944>>>>>>>
70944>>>>>>>        Procedure OnClick
70947>>>>>>>            Send OK of oSelList
70948>>>>>>>        End_Procedure
70949>>>>>>>
70949>>>>>>>    End_Object 
70950>>>>>>>
70950>>>>>>>    Object oCancel_bn is a Button
70952>>>>>>>        Set Label to "&Cancel"
70953>>>>>>>        Set Location to 115 163
70954>>>>>>>        Set peAnchors to anBottomRight
70955>>>>>>>
70955>>>>>>>        Procedure OnClick
70958>>>>>>>            Send Cancel of oSelList
70959>>>>>>>        End_Procedure
70960>>>>>>>
70960>>>>>>>    End_Object 
70961>>>>>>>
70961>>>>>>>    Object oSearch_bn is a Button
70963>>>>>>>        Set Label to "&Search..."
70964>>>>>>>        Set Location to 115 217
70965>>>>>>>        Set peAnchors to anBottomRight
70966>>>>>>>
70966>>>>>>>        Procedure OnClick
70969>>>>>>>            Send Search of oSelList
70970>>>>>>>        End_Procedure
70971>>>>>>>
70971>>>>>>>    End_Object 
70972>>>>>>>
70972>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
70973>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
70974>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
70975>>>>>>>
70975>>>>>>>
70975>>>>>>>CD_End_Object // Shoe_sl
70977>>>>>>>>
70977>>>
70977>>>ACTIVATE_VIEW Activate_oShoeEntry FOR oShoeEntry
70987>>>>
70987>>>Object oShoeEntry is a dbView
70989>>>    Set Location to 5 5
70990>>>    Set Size to 22 430
70991>>>    Set Label To "ShoeEntry"
70992>>>    Set Border_Style to Border_Thick
70993>>>
70993>>>
70993>>>    Object oShoe_DD is a cShoeDataDictionary
70995>>>    End_Object 
70996>>>
70996>>>    Set Main_DD To oShoe_DD
70997>>>    Set Server  To oShoe_DD
70998>>>
70998>>>
70998>>>
70998>>>    Object oShoeid is a dbForm
71000>>>        Entry_Item Shoe.id
71001>>>        Set Size to 12 42
71002>>>        Set Location to 5 13
71003>>>        Set peAnchors to anTopLeftRight
71004>>>        Set Label to "id"
71005>>>        Set Label_Justification_mode to jMode_Left
71006>>>        Set Label_Col_Offset to 8
71007>>>        Set Label_row_Offset to 0
71008>>>    End_Object 
71009>>>
71009>>>    Object oShoename is a dbForm
71011>>>        Entry_Item Shoe.name
71012>>>        Set Size to 12 250
71013>>>        Set Location to 5 80
71014>>>        Set peAnchors to anTopRight
71015>>>        Set Label to "name"
71016>>>        Set Label_Justification_mode to jMode_Left
71017>>>        Set Label_Col_Offset to 20
71018>>>        Set Label_row_Offset to 0
71019>>>    End_Object 
71020>>>
71020>>>    Object oShoeprice is a dbForm
71022>>>        Entry_Item Shoe.price
71023>>>        Set Size to 12 72
71024>>>        Set Location to 5 353
71025>>>        Set peAnchors to anTopRight
71026>>>        Set Label to "price"
71027>>>        Set Label_Justification_mode to jMode_Left
71028>>>        Set Label_Col_Offset to 18
71029>>>        Set Label_row_Offset to 0
71030>>>    End_Object 
71031>>>
71031>>>
71031>>>End_Object 
71032>        Use PageFooterEntry.vw
Including file: PageFooterEntry.vw    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageFooterEntry.vw)
71032>>>// C:\DataFlex Projects\ShoeFactory\AppSrc\PageFooterEntry.vw
71032>>>// PageFooterEntry
71032>>>//
71032>>>
71032>>>Use DFClient.pkg
71032>>>Use DFEntry.pkg
71032>>>Use DfTabDlg.pkg
71032>>>
71032>>>Use cEmployeeDataDictionary.dd
71032>>>Use cLineDataDictionary.dd
71032>>>Use cPageHeaderDataDictionary.dd
71032>>>Use cShoeDataDictionary.dd
71032>>>Use cPageFooterDataDictionary.dd
Including file: cPageFooterDataDictionary.dd    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\DDSrc\cPageFooterDataDictionary.dd)
71032>>>>>Use DataDict.pkg
71032>>>>>
71032>>>>>Open PageFooter
71034>>>>>Open PageHeader
71036>>>>>Open Shoe
71038>>>>>Open system
71040>>>>>
71040>>>>>Register_Object PageFooter_sl
71040>>>>>
71040>>>>>Class cPageFooterDataDictionary is a DataDictionary
71041>>>>>    
71041>>>>>    Procedure Construct_Object
71043>>>>>        Forward Send Construct_Object
71045>>>>>        Set Main_File to PageFooter.File_Number
71046>>>>>
71046>>>>>        Set Add_System_File to system.File_Number DD_Lock_On_All
71047>>>>>
71047>>>>>        Set Add_Server_File to PageHeader.File_Number
71048>>>>>        Set Add_Server_File to Shoe.File_Number
71049>>>>>
71049>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
71050>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
71051>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
71052>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
71053>>>>>
71053>>>>>        Set Field_Auto_Increment Field PageFooter.id to File_Field system.page_footer_id
71054>>>>>        Set Field_Prompt_Object Field PageFooter.id to PageFooter_sl
71055>>>>>
71055>>>>>    End_Procedure
71056>>>>>
71056>>>>>End_Class
71057>>>>>
71057>>>>>Use PageFooter.sl
Including file: PageFooter.sl    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageFooter.sl)
71057>>>>>>>// PageFooter.sl
71057>>>>>>>// PageFooter Lookup List
71057>>>>>>>
71057>>>>>>>Use DFClient.pkg
71057>>>>>>>Use cDbCJGridPromptList.pkg
71057>>>>>>>Use cDbCJGridColumn.pkg
71057>>>>>>>Use Windows.pkg
71057>>>>>>>
71057>>>>>>>Use cEmployeeDataDictionary.dd
71057>>>>>>>Use cLineDataDictionary.dd
71057>>>>>>>Use cPageHeaderDataDictionary.dd
71057>>>>>>>Use cShoeDataDictionary.dd
71057>>>>>>>Use cPageFooterDataDictionary.dd
71057>>>>>>>
71057>>>>>>>CD_Popup_Object PageFooter_sl is a dbModalPanel
71075>>>>>>>>
71075>>>>>>>    Set Location to 5 5
71076>>>>>>>    Set Size to 134 141
71077>>>>>>>    Set Label To "PageFooter Lookup List"
71078>>>>>>>    Set Border_Style to Border_Thick
71079>>>>>>>    Set Minimize_Icon to False
71080>>>>>>>
71080>>>>>>>
71080>>>>>>>    Object oEmployee_DD is a cEmployeeDataDictionary
71082>>>>>>>    End_Object 
71083>>>>>>>
71083>>>>>>>    Object oLine_DD is a cLineDataDictionary
71085>>>>>>>    End_Object 
71086>>>>>>>
71086>>>>>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
71088>>>>>>>        Set DDO_Server To oEmployee_DD
71089>>>>>>>        Set DDO_Server To oLine_DD
71090>>>>>>>    End_Object 
71091>>>>>>>
71091>>>>>>>    Object oShoe_DD is a cShoeDataDictionary
71093>>>>>>>    End_Object 
71094>>>>>>>
71094>>>>>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
71096>>>>>>>        Set DDO_Server To oPageHeader_DD
71097>>>>>>>        Set DDO_Server To oShoe_DD
71098>>>>>>>    End_Object 
71099>>>>>>>
71099>>>>>>>    Set Main_DD To oPageFooter_DD
71100>>>>>>>    Set Server  To oPageFooter_DD
71101>>>>>>>
71101>>>>>>>
71101>>>>>>>
71101>>>>>>>    Object oSelList is a cDbCJGridPromptList
71103>>>>>>>        Set Size to 105 131
71104>>>>>>>        Set Location to 5 5
71105>>>>>>>        Set peAnchors to anAll
71106>>>>>>>        Set psLayoutSection to "PageFooter_sl_oSelList"
71107>>>>>>>        Set Ordering to 1
71108>>>>>>>        Set pbAutoServer to True
71109>>>>>>>
71109>>>>>>>        Object oPageFooter_id is a cDbCJGridColumn
71111>>>>>>>            Entry_Item PageFooter.id
71112>>>>>>>            Set piWidth to 46
71113>>>>>>>            Set psCaption to "id"
71114>>>>>>>        End_Object 
71115>>>>>>>
71115>>>>>>>        Object oPageHeader_id is a cDbCJGridColumn
71117>>>>>>>            Entry_Item PageHeader.id
71118>>>>>>>            Set piWidth to 95
71119>>>>>>>            Set psCaption to "page header id"
71120>>>>>>>        End_Object 
71121>>>>>>>
71121>>>>>>>        Object oShoe_id is a cDbCJGridColumn
71123>>>>>>>            Entry_Item Shoe.id
71124>>>>>>>            Set piWidth to 60
71125>>>>>>>            Set psCaption to "shoe id"
71126>>>>>>>        End_Object 
71127>>>>>>>
71127>>>>>>>
71127>>>>>>>    End_Object 
71128>>>>>>>
71128>>>>>>>    Object oOk_bn is a Button
71130>>>>>>>        Set Label to "&Ok"
71131>>>>>>>        Set Location to 115 -22
71132>>>>>>>        Set peAnchors to anBottomRight
71133>>>>>>>
71133>>>>>>>        Procedure OnClick
71136>>>>>>>            Send OK of oSelList
71137>>>>>>>        End_Procedure
71138>>>>>>>
71138>>>>>>>    End_Object 
71139>>>>>>>
71139>>>>>>>    Object oCancel_bn is a Button
71141>>>>>>>        Set Label to "&Cancel"
71142>>>>>>>        Set Location to 115 32
71143>>>>>>>        Set peAnchors to anBottomRight
71144>>>>>>>
71144>>>>>>>        Procedure OnClick
71147>>>>>>>            Send Cancel of oSelList
71148>>>>>>>        End_Procedure
71149>>>>>>>
71149>>>>>>>    End_Object 
71150>>>>>>>
71150>>>>>>>    Object oSearch_bn is a Button
71152>>>>>>>        Set Label to "&Search..."
71153>>>>>>>        Set Location to 115 86
71154>>>>>>>        Set peAnchors to anBottomRight
71155>>>>>>>
71155>>>>>>>        Procedure OnClick
71158>>>>>>>            Send Search of oSelList
71159>>>>>>>        End_Procedure
71160>>>>>>>
71160>>>>>>>    End_Object 
71161>>>>>>>
71161>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
71162>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
71163>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
71164>>>>>>>
71164>>>>>>>
71164>>>>>>>CD_End_Object // PageFooter_sl
71166>>>>>>>>
71166>>>
71166>>>ACTIVATE_VIEW Activate_oPageFooterEntry FOR oPageFooterEntry
71176>>>>
71176>>>Object oPageFooterEntry is a dbView
71178>>>    Set Location to 5 5
71179>>>    Set Size to 79 445
71180>>>    Set Label To "PageFooterEntry"
71181>>>    Set Border_Style to Border_Thick
71182>>>
71182>>>
71182>>>    Object oEmployee_DD is a cEmployeeDataDictionary
71184>>>    End_Object 
71185>>>
71185>>>    Object oLine_DD is a cLineDataDictionary
71187>>>    End_Object 
71188>>>
71188>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
71190>>>        Set DDO_Server To oEmployee_DD
71191>>>        Set DDO_Server To oLine_DD
71192>>>    End_Object 
71193>>>
71193>>>    Object oShoe_DD is a cShoeDataDictionary
71195>>>    End_Object 
71196>>>
71196>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
71198>>>        Set DDO_Server To oPageHeader_DD
71199>>>        Set DDO_Server To oShoe_DD
71200>>>    End_Object 
71201>>>
71201>>>    Set Main_DD To oPageFooter_DD
71202>>>    Set Server  To oPageFooter_DD
71203>>>
71203>>>
71203>>>
71203>>>    Object oPageFooterid is a dbForm
71205>>>        Entry_Item PageFooter.id
71206>>>        Set Size to 12 34
71207>>>        Set Location to 5 13
71208>>>        Set peAnchors to anTopLeftRight
71209>>>        Set Label to "id"
71210>>>        Set Label_Justification_mode to jMode_Left
71211>>>        Set Label_Col_Offset to 8
71212>>>        Set Label_row_Offset to 0
71213>>>    End_Object 
71214>>>
71214>>>    Object oPageHeaderid is a dbForm
71216>>>        Entry_Item PageHeader.id
71217>>>        Set Size to 12 34
71218>>>        Set Location to 5 119
71219>>>        Set peAnchors to anTopRight
71220>>>        Set Label to "page header id"
71221>>>        Set Label_Justification_mode to jMode_Left
71222>>>        Set Label_Col_Offset to 49
71223>>>        Set Label_row_Offset to 0
71224>>>    End_Object 
71225>>>
71225>>>    Object oShoeid is a dbForm
71227>>>        Entry_Item Shoe.id
71228>>>        Set Size to 12 42
71229>>>        Set Location to 5 202
71230>>>        Set peAnchors to anTopRight
71231>>>        Set Label to "shoe id"
71232>>>        Set Label_Justification_mode to jMode_Left
71233>>>        Set Label_Col_Offset to 25
71234>>>        Set Label_row_Offset to 0
71235>>>    End_Object 
71236>>>
71236>>>    Object oTabDialog is a dbTabDialog
71238>>>        Set Size to 47 435
71239>>>        Set Location to 27 5
71240>>>        Set peAnchors to anTopLeftRight
71241>>>
71241>>>        Object oTabPage1 is a dbTabPage
71243>>>            Set Label to "Tab Page Label"
71244>>>
71244>>>            Object oPageHeaderid is a dbForm
71246>>>                Entry_Item PageHeader.id
71247>>>                Set Size to 12 34
71248>>>                Set Location to 10 13
71249>>>                Set peAnchors to anTopLeftRight
71250>>>                Set Label to "id"
71251>>>                Set Label_Justification_mode to jMode_Left
71252>>>                Set Label_Col_Offset to 8
71253>>>                Set Label_row_Offset to 0
71254>>>            End_Object 
71255>>>
71255>>>            Object oEmployeeid is a dbForm
71257>>>                Entry_Item Employee.id
71258>>>                Set Size to 12 34
71259>>>                Set Location to 10 93
71260>>>                Set peAnchors to anTopRight
71261>>>                Set Label to "employee id"
71262>>>                Set Label_Justification_mode to jMode_Left
71263>>>                Set Label_Col_Offset to 41
71264>>>                Set Label_row_Offset to 0
71265>>>            End_Object 
71266>>>
71266>>>            Object oLineid is a dbForm
71268>>>                Entry_Item Line.id
71269>>>                Set Size to 12 34
71270>>>                Set Location to 10 153
71271>>>                Set peAnchors to anTopRight
71272>>>                Set Label to "line id"
71273>>>                Set Label_Justification_mode to jMode_Left
71274>>>                Set Label_Col_Offset to 21
71275>>>                Set Label_row_Offset to 0
71276>>>            End_Object 
71277>>>
71277>>>        End_Object 
71278>>>
71278>>>        Object oTabPage2 is a dbTabPage
71280>>>            Set Label to "Tab Page Label"
71281>>>
71281>>>            Object oShoeid is a dbForm
71283>>>                Entry_Item Shoe.id
71284>>>                Set Size to 12 42
71285>>>                Set Location to 10 13
71286>>>                Set peAnchors to anTopLeftRight
71287>>>                Set Label to "id"
71288>>>                Set Label_Justification_mode to jMode_Left
71289>>>                Set Label_Col_Offset to 8
71290>>>                Set Label_row_Offset to 0
71291>>>            End_Object 
71292>>>
71292>>>            Object oShoename is a dbForm
71294>>>                Entry_Item Shoe.name
71295>>>                Set Size to 12 250
71296>>>                Set Location to 10 80
71297>>>                Set peAnchors to anTopRight
71298>>>                Set Label to "name"
71299>>>                Set Label_Justification_mode to jMode_Left
71300>>>                Set Label_Col_Offset to 20
71301>>>                Set Label_row_Offset to 0
71302>>>            End_Object 
71303>>>
71303>>>            Object oShoeprice is a dbForm
71305>>>                Entry_Item Shoe.price
71306>>>                Set Size to 12 72
71307>>>                Set Location to 10 353
71308>>>                Set peAnchors to anTopRight
71309>>>                Set Label to "price"
71310>>>                Set Label_Justification_mode to jMode_Left
71311>>>                Set Label_Col_Offset to 18
71312>>>                Set Label_row_Offset to 0
71313>>>            End_Object 
71314>>>
71314>>>        End_Object 
71315>>>
71315>>>    End_Object 
71316>>>    
71316>>>     Object oDetailGrid is a cDbCJGrid
71318>>>        
71318>>>        Set Size to 447 348
71319>>>        Set Location to 73 5
71320>>>        Set Server to oPageFooter_DD
71321>>>        Set Ordering to 1
71322>>>        Set peAnchors to anAll
71323>>>        Set psLayoutSection to "oPageFooterEntry_oDetailGrid"
71324>>>        Set pbAllowInsertRow to False
71325>>>        Set pbHeaderPrompts to True
71326>>>        
71326>>>        
71326>>>        
71326>>>        Object oFooteridGrid is a cDbCJGridColumn
71328>>>        Entry_Item PageFooter.id
71329>>>        Set piWidth to 78
71330>>>        Set psCaption to "Footer"
71331>>>        End_Object
71332>>>        
71332>>>        
71332>>>        
71332>>>        Object oHeaderidGrid is a cDbCJGridColumn
71334>>>        Entry_Item PageFooter.page_header_id
71335>>>        Set piWidth to 115
71336>>>        Set psCaption to "Header"
71337>>>        End_Object
71338>>>        
71338>>>        
71338>>>        
71338>>>        Object oShoeidGrid is a cDbCJGridColumn
71340>>>        Entry_Item PageFooter.shoe_id
71341>>>        Set piWidth to 387
71342>>>        Set psCaption to "Shoe"
71343>>>        End_Object
71344>>>
71344>>>
71344>>>
71344>>>    End_Object
71345>>>
71345>>>End_Object 
71346>        Use PageFooterEntry2.vw
Including file: PageFooterEntry2.vw    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageFooterEntry2.vw)
71346>>>// C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageFooterEntry2.vw
71346>>>// PageFooterEntry2
71346>>>//
71346>>>
71346>>>Use DFClient.pkg
71346>>>Use DFEntry.pkg
71346>>>Use cDbCJGrid.pkg
71346>>>Use cDbCJGridColumn.pkg
71346>>>
71346>>>Use cEmployeeDataDictionary.dd
71346>>>Use cLineDataDictionary.dd
71346>>>Use cPageHeaderDataDictionary.dd
71346>>>Use cShoeDataDictionary.dd
71346>>>Use cPageFooterDataDictionary.dd
71346>>>
71346>>>ACTIVATE_VIEW Activate_oPageFooterEntry2 FOR oPageFooterEntry2
71356>>>>
71356>>>Object oPageFooterEntry2 is a dbView
71358>>>    Set Location to 5 5
71359>>>    Set Size to 132 370
71360>>>    Set Label To "PageFooterEntry2"
71361>>>    Set Border_Style to Border_Thick
71362>>>
71362>>>
71362>>>    Object oEmployee_DD is a cEmployeeDataDictionary
71364>>>    End_Object 
71365>>>
71365>>>    Object oLine_DD is a cLineDataDictionary
71367>>>    End_Object 
71368>>>
71368>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
71370>>>        Set DDO_Server To oEmployee_DD
71371>>>        Set DDO_Server To oLine_DD
71372>>>        // this lets you save a new parent DD from within child DD
71372>>>        Set Allow_Foreign_New_Save_State to True
71373>>>    End_Object 
71374>>>
71374>>>    Object oShoe_DD is a cShoeDataDictionary
71376>>>    End_Object 
71377>>>
71377>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
71379>>>        Set DDO_Server To oPageHeader_DD
71380>>>        Set DDO_Server To oShoe_DD
71381>>>        Set Constrain_File To PageHeader.File_Number
71382>>>    End_Object 
71383>>>
71383>>>    Set Main_DD To oPageHeader_DD
71384>>>    Set Server  To oPageHeader_DD
71385>>>
71385>>>
71385>>>
71385>>>    Object oPageHeaderid is a dbForm
71387>>>        Entry_Item PageHeader.id
71388>>>        Set Size to 12 204
71389>>>        Set Location to 5 21
71390>>>        Set peAnchors to anTopLeftRight
71391>>>        Set Label to "id"
71392>>>        Set Label_Justification_mode to jMode_Left
71393>>>        Set Label_Col_Offset to 16
71394>>>        Set Label_row_Offset to 0
71395>>>    End_Object 
71396>>>
71396>>>    Object oEmployeeid is a dbForm
71398>>>        Entry_Item Employee.id
71399>>>        Set Size to 12 34
71400>>>        Set Location to 5 271
71401>>>        Set peAnchors to anTopRight
71402>>>        Set Label to "employee id"
71403>>>        Set Label_Justification_mode to jMode_Left
71404>>>        Set Label_Col_Offset to 41
71405>>>        Set Label_row_Offset to 0
71406>>>    End_Object 
71407>>>
71407>>>    Object oLineid is a dbForm
71409>>>        Entry_Item Line.id
71410>>>        Set Size to 12 34
71411>>>        Set Location to 5 331
71412>>>        Set peAnchors to anTopRight
71413>>>        Set Label to "line id"
71414>>>        Set Label_Justification_mode to jMode_Left
71415>>>        Set Label_Col_Offset to 21
71416>>>        Set Label_row_Offset to 0
71417>>>    End_Object 
71418>>>
71418>>>    Object oPageHeaderdate is a dbForm
71420>>>        Entry_Item PageHeader.date
71421>>>        Set Size to 12 236
71422>>>        Set Location to 19 21
71423>>>        Set peAnchors to anTopLeftRight
71424>>>        Set Label to "date"
71425>>>        Set Label_Justification_mode to jMode_Left
71426>>>        Set Label_Col_Offset to 16
71427>>>        Set Label_row_Offset to 0
71428>>>    End_Object 
71429>>>
71429>>>    Object oPageHeaderhours is a dbForm
71431>>>        Entry_Item PageHeader.hours
71432>>>        Set Size to 12 34
71433>>>        Set Location to 19 282
71434>>>        Set peAnchors to anTopRight
71435>>>        Set Label to "hours"
71436>>>        Set Label_Justification_mode to jMode_Left
71437>>>        Set Label_Col_Offset to 20
71438>>>        Set Label_row_Offset to 0
71439>>>    End_Object 
71440>>>
71440>>>    Object oDetailGrid is a cDbCJGrid
71442>>>        Set Size to 86 354
71443>>>        Set Location to 41 5
71444>>>        Set Server to oPageFooter_DD
71445>>>        Set Ordering to 2
71446>>>        Set peAnchors to anAll
71447>>>        Set psLayoutSection to "oPageFooterEntry2_oDetailGrid"
71448>>>        Set pbAllowInsertRow to False
71449>>>        Set pbHeaderPrompts to True
71450>>>
71450>>>        Object oShoe_id is a cDbCJGridColumn
71452>>>            Entry_Item Shoe.id
71453>>>            Set piWidth to 122
71454>>>            Set psCaption to "shoe id"
71455>>>        End_Object 
71456>>>
71456>>>        Object oPageFooter_price is a cDbCJGridColumn
71458>>>            Entry_Item PageFooter.price
71459>>>            Set piWidth to 345
71460>>>            Set psCaption to "price"
71461>>>        End_Object 
71462>>>
71462>>>        Object oPageFooter_quantity is a cDbCJGridColumn
71464>>>            Entry_Item PageFooter.quantity
71465>>>            Set piWidth to 123
71466>>>            Set psCaption to "quantity"
71467>>>        End_Object 
71468>>>
71468>>>    End_Object 
71469>>>
71469>>>    //-----------------------------------------------------------------------
71469>>>    // Create custom confirmation messages for save and delete
71469>>>    // We must create the new functions and assign verify messages
71469>>>    // to them.
71469>>>    //-----------------------------------------------------------------------
71469>>>
71469>>>    Function ConfirmDeleteHeader Returns Boolean
71472>>>        Boolean bFail
71472>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
71473>>>        Function_Return bFail
71474>>>    End_Function 
71475>>>
71475>>>    // Only confirm on the saving of new records
71475>>>    Function ConfirmSaveHeader Returns Boolean
71478>>>        Boolean bNoSave bHasRecord
71478>>>        Handle  hoSrvr
71478>>>        Get Server to hoSrvr
71479>>>        Get HasRecord of hoSrvr to bHasRecord
71480>>>        If not bHasRecord Begin
71482>>>            Get Confirm "Save this NEW header?" to bNoSave
71483>>>        End
71483>>>>
71483>>>        Function_Return bNoSave
71484>>>    End_Function 
71485>>>
71485>>>    // Define alternate confirmation Messages
71485>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
71486>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
71487>>>    // Saves in header should not clear the view
71487>>>    Set Auto_Clear_Deo_State to False
71488>>>
71488>>>
71488>>>End_Object 
71489>        Use PageFooterEntry3.vw
Including file: PageFooterEntry3.vw    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageFooterEntry3.vw)
71489>>>// C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\PageFooterEntry3.vw
71489>>>// PageFooterEntry3
71489>>>//
71489>>>
71489>>>Use DFClient.pkg
71489>>>Use DFEntry.pkg
71489>>>Use cDbCJGrid.pkg
71489>>>Use cDbCJGridColumn.pkg
71489>>>
71489>>>Use cEmployeeDataDictionary.dd
71489>>>Use cLineDataDictionary.dd
71489>>>Use cPageHeaderDataDictionary.dd
71489>>>Use cShoeDataDictionary.dd
71489>>>Use cPageFooterDataDictionary.dd
71489>>>
71489>>>ACTIVATE_VIEW Activate_oPageFooterEntry3 FOR oPageFooterEntry3
71499>>>>
71499>>>Object oPageFooterEntry3 is a dbView
71501>>>    Set Location to 5 5
71502>>>    Set Size to 112 200
71503>>>    Set Label To "PageFooterEntry3"
71504>>>    Set Border_Style to Border_Thick
71505>>>
71505>>>
71505>>>    Object oEmployee_DD is a cEmployeeDataDictionary
71507>>>    End_Object 
71508>>>
71508>>>    Object oLine_DD is a cLineDataDictionary
71510>>>    End_Object 
71511>>>
71511>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
71513>>>        Set DDO_Server To oEmployee_DD
71514>>>        Set DDO_Server To oLine_DD
71515>>>        // this lets you save a new parent DD from within child DD
71515>>>        Set Allow_Foreign_New_Save_State to True
71516>>>    End_Object 
71517>>>
71517>>>    Object oShoe_DD is a cShoeDataDictionary
71519>>>    End_Object 
71520>>>
71520>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
71522>>>        Set DDO_Server To oPageHeader_DD
71523>>>        Set DDO_Server To oShoe_DD
71524>>>        Set Constrain_File To PageHeader.File_Number
71525>>>    End_Object 
71526>>>
71526>>>    Set Main_DD To oPageHeader_DD
71527>>>    Set Server  To oPageHeader_DD
71528>>>
71528>>>
71528>>>
71528>>>    Object oPageHeaderid is a dbForm
71530>>>        Entry_Item PageHeader.id
71531>>>        Set Size to 12 34
71532>>>        Set Location to 5 21
71533>>>        Set peAnchors to anTopLeftRight
71534>>>        Set Label to "id"
71535>>>        Set Label_Justification_mode to jMode_Left
71536>>>        Set Label_Col_Offset to 16
71537>>>        Set Label_row_Offset to 0
71538>>>    End_Object 
71539>>>
71539>>>    Object oEmployeeid is a dbForm
71541>>>        Entry_Item Employee.id
71542>>>        Set Size to 12 34
71543>>>        Set Location to 5 101
71544>>>        Set peAnchors to anTopRight
71545>>>        Set Label to "employee id"
71546>>>        Set Label_Justification_mode to jMode_Left
71547>>>        Set Label_Col_Offset to 41
71548>>>        Set Label_row_Offset to 0
71549>>>    End_Object 
71550>>>
71550>>>    Object oLineid is a dbForm
71552>>>        Entry_Item Line.id
71553>>>        Set Size to 12 34
71554>>>        Set Location to 5 161
71555>>>        Set peAnchors to anTopRight
71556>>>        Set Label to "line id"
71557>>>        Set Label_Justification_mode to jMode_Left
71558>>>        Set Label_Col_Offset to 21
71559>>>        Set Label_row_Offset to 0
71560>>>    End_Object 
71561>>>
71561>>>    Object oPageHeaderdate is a dbForm
71563>>>        Entry_Item PageHeader.date
71564>>>        Set Size to 12 66
71565>>>        Set Location to 19 21
71566>>>        Set peAnchors to anTopLeftRight
71567>>>        Set Label to "date"
71568>>>        Set Label_Justification_mode to jMode_Left
71569>>>        Set Label_Col_Offset to 16
71570>>>        Set Label_row_Offset to 0
71571>>>    End_Object 
71572>>>
71572>>>    Object oPageHeaderhours is a dbForm
71574>>>        Entry_Item PageHeader.hours
71575>>>        Set Size to 12 34
71576>>>        Set Location to 19 112
71577>>>        Set peAnchors to anTopRight
71578>>>        Set Label to "hours"
71579>>>        Set Label_Justification_mode to jMode_Left
71580>>>        Set Label_Col_Offset to 20
71581>>>        Set Label_row_Offset to 0
71582>>>    End_Object 
71583>>>
71583>>>    Object oDetailGrid is a cDbCJGrid
71585>>>        Set Size to 66 148
71586>>>        Set Location to 41 5
71587>>>        Set Server to oPageFooter_DD
71588>>>        Set Ordering to 2
71589>>>        Set peAnchors to anAll
71590>>>        Set psLayoutSection to "oPageFooterEntry3_oDetailGrid"
71591>>>        Set pbAllowInsertRow to False
71592>>>        Set pbHeaderPrompts to True
71593>>>
71593>>>        Object oShoe_id is a cDbCJGridColumn
71595>>>            Entry_Item Shoe.id
71596>>>            Set piWidth to 60
71597>>>            Set psCaption to "shoe id"
71598>>>        End_Object 
71599>>>
71599>>>        Object oShoe_price is a cDbCJGridColumn
71601>>>            Entry_Item Shoe.price
71602>>>            Set piWidth to 110
71603>>>            Set psCaption to "price"
71604>>>        End_Object 
71605>>>
71605>>>        Object oPageFooter_quantity is a cDbCJGridColumn
71607>>>            Entry_Item PageFooter.quantity
71608>>>            Set piWidth to 60
71609>>>            Set psCaption to "quantity"
71610>>>        End_Object 
71611>>>
71611>>>    End_Object 
71612>>>
71612>>>    //-----------------------------------------------------------------------
71612>>>    // Create custom confirmation messages for save and delete
71612>>>    // We must create the new functions and assign verify messages
71612>>>    // to them.
71612>>>    //-----------------------------------------------------------------------
71612>>>
71612>>>    Function ConfirmDeleteHeader Returns Boolean
71615>>>        Boolean bFail
71615>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
71616>>>        Function_Return bFail
71617>>>    End_Function 
71618>>>
71618>>>    // Only confirm on the saving of new records
71618>>>    Function ConfirmSaveHeader Returns Boolean
71621>>>        Boolean bNoSave bHasRecord
71621>>>        Handle  hoSrvr
71621>>>        Get Server to hoSrvr
71622>>>        Get HasRecord of hoSrvr to bHasRecord
71623>>>        If not bHasRecord Begin
71625>>>            Get Confirm "Save this NEW header?" to bNoSave
71626>>>        End
71626>>>>
71626>>>        Function_Return bNoSave
71627>>>    End_Function 
71628>>>
71628>>>    // Define alternate confirmation Messages
71628>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
71629>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
71630>>>    // Saves in header should not clear the view
71630>>>    Set Auto_Clear_Deo_State to False
71631>>>
71631>>>
71631>>>End_Object 
71632>        Use ReportView.rv
Including file: ReportView.rv    (C:\Users\bades\Documents\GitHub\jubilant-octo-umbrella\AppSrc\ReportView.rv)
71632>>>// ReportView.rv
71632>>>// ReportView
71632>>>Register_Object oReport
71632>>>
71632>>>Use DFRptVw.pkg
71632>>>Use cWinReport2.pkg
Including file: cWinReport2.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cWinReport2.pkg)
71632>>>>>// defines support for Winprint2 cWinReport2 class
71632>>>>>
71632>>>>>
71632>>>>>Use DFRpt.pkg              // BasicReport RO Class for VDF
71632>>>>>Use WinPrint2.pkg          // WinPrint2 engine
Including file: Winprint2.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Winprint2.pkg)
71632>>>>>>>Use windows.pkg
71632>>>>>>>Use LanguageText.pkg
71632>>>>>>>Use DLL.pkg
71632>>>>>>>Use WinPrint2_Api.pkg
Including file: WinPrint2_API.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\WinPrint2_API.pkg)
71632>>>>>>>>>Use DLL.pkg
71632>>>>>>>>>
71632>>>>>>>>>External_Function WP_IsPrinterValid "IsPrinterValid" WinPrint.dll ;    Returns Boolean // True if the the current printer is a valid one. False, otherwise.
71633>>>>>>>>>
71633>>>>>>>>>External_Function WP_ArePrintersInstalled "ArePrintersInstalled" WinPrint.dll ; // determines whether at least one printer is installed    Returns Boolean // True, if a printer is installed, False if it is not.
71634>>>>>>>>>
71634>>>>>>>>>External_Function WP_ExecutePrinterSetupDialog "ExecutePrinterSetupDialog" WinPrint.dll ; // displays the "printer setup" dialog    Handle hWndParent; // window handle of the parent window    Returns Boolean // True if the OK button pressed; False, otherwise.
71635>>>>>>>>>
71635>>>>>>>>>External_Function WP_ExecutePrintDialog "ExecutePrintDialog" WinPrint.dll ; // displays the "Print" dialog    Handle hWndParent; // window handle of the parent window    Returns Boolean // True if the OK button pressed; False, otherwise.
71636>>>>>>>>>
71636>>>>>>>>>External_Function WP_GetCurrentDevice "GetCurrentDevice" WinPrint.dll ; // retrieves the name of the current printer device    Address aDevice ; // address of the string (255 chars) that will hold the device name upon return    Returns Boolean // True, if success; False if error occurred
71637>>>>>>>>>
71637>>>>>>>>>External_Function WP_GetPrintDialogFlags "GetPrintDialogFlags" WinPrint.dll ; // retrieves the current print options    Returns UInteger // array of flags representing print-related options that are currently set
71638>>>>>>>>>
71638>>>>>>>>>External_Function WP_GetUserDefinedPapersize "GetUserDefinedPapersize" WinPrint.dll ;  // gets the size of user-defined paper    Returns UInteger // // hi-word=length; lo-word=width
71639>>>>>>>>>
71639>>>>>>>>>External_Function WP_IsPrintDialogFlagSet "IsPrintDialogFlagSet" WinPrint.dll ; // determines whether a specific print-flag is set    UInteger iFlag ; // the printer flag    Returns Boolean // True, if the flag is set; False, if it isn't
71640>>>>>>>>>
71640>>>>>>>>>External_Function WP_SelectPrinter "SelectPrinter" WinPrint.dll ; // selects a printer programatically    String sDevice; // the name of the printer    Returns Boolean // True, if success; False, if error (such as an invalid printer name)
71641>>>>>>>>>
71641>>>>>>>>>External_Function WP_SetFirstPagePaperSource "SetFirstPagePaperSource"  WinPrint.dll ;    Integer iBin ; // the bim constant    Returns Boolean // True if success, false if error
71642>>>>>>>>>
71642>>>>>>>>>External_Function WP_SetNumberOfPrintCopies "SetNumberOfPrintCopies" WinPrint.dll ; // sets the number of copies to print    UInteger iNumCopies; // number of copies to make    Returns Boolean // Always True
71643>>>>>>>>>
71643>>>>>>>>>External_Function WP_SetSpecificPrintDialogFlag "SetSpecificPrintDialogFlag" WinPrint.dll; // Sets/unsets one printer flag    UInteger fFlag; // printer flag    Returns Boolean // True, if success; False if error occurred
71644>>>>>>>>>
71644>>>>>>>>>External_Function WP_SetPrintDialogFlags "SetPrintDialogFlags" WinPrint.dll; // Sets/unsets all printer flags in one call    UInteger fFlags; // printer flags    Returns Boolean // True, if success; False if error occurred
71645>>>>>>>>>
71645>>>>>>>>>External_Function WP_SetUserDefinedPapersize "SetUserDefinedPapersize" WinPrint.dll ;  // sets the size of user-defined paper    UInteger iPaperSize ; // hi-word=length; lo-word=width    Returns Boolean // True, if success; False if error occurred
71646>>>>>>>>>
71646>>>>>>>>>External_Function WP_SetFontStyle "SetFontStyle" WinPrint.dll ; // sets multiple font attributes    Integer iStyles ; // series of flags    Returns Boolean // always True
71647>>>>>>>>>
71647>>>>>>>>>External_Function WP_SetFontBold "SetFontBold" WinPrint.dll ; // toggles the bold attribute of the current font    Boolean bBold ; // True to switch bold attribute on; False to switch it off    Returns Boolean // always True
71648>>>>>>>>>
71648>>>>>>>>>External_Function WP_SetFontItalic "SetFontItalic" WinPrint.dll ; // toggles the italic attribute of the current font    Boolean bItalic ; // True to switch italic attribute on; False to switch it off    Returns Boolean  // always True
71649>>>>>>>>>
71649>>>>>>>>>External_Function WP_SetFontUnderline "SetFontUnderline" WinPrint.dll ; // toggles the underline attribute of the current font    Boolean bUnderline ; // True to switch underline attribute on; False to switch it off    Returns Boolean  // always True
71650>>>>>>>>>
71650>>>>>>>>>External_Function WP_SetFontStrikeout "SetFontStrikeout" WinPrint.dll ; // toggles the strikeout attribute of the current font    Boolean bStrikeout ; // True to switch strikeout attribute on; False to switch it off    Returns Boolean  // always True
71651>>>>>>>>>
71651>>>>>>>>>External_Function WP_SetFontColor "SetFontColor" WinPrint.dll ; // sets the color of the current font    Integer iColor ; // color of the font    Returns Boolean  // always True
71652>>>>>>>>>
71652>>>>>>>>>External_Function WP_SetFontHeight "SetFontHeight" WinPrint.dll ; // sets the height of the font    UInteger iHeight ; // height of the font in points (multiplied by 100. Eg 12.5 point should be sent as 1250)    Returns Boolean  // always True
71653>>>>>>>>>
71653>>>>>>>>>External_Function WP_SetFontName "SetFontName" WinPrint.dll ; // Sets the name of the font to use    String sFontName ; // name of the font to use    Returns Boolean  // always True
71654>>>>>>>>>
71654>>>>>>>>>External_Function WP_DrawBitmap "DrawBitmap" WinPrint.dll ; // Draws a bitmap (BMP, JPG)    String  sBitmap;                 // Name of the bitmap    Integer iLeft;                   // distance from left edge to draw bitmap    Integer iTop;                    // distance from top edge to draw bitmap    Integer iWidth;                  // width of the bitmap    Integer iHeight;                 // height of the bitmap    Boolean bUpdateCurrentPosition;  // after drawing, should the current position be updated?    Returns Boolean // True, if OK; False, if an error occurred.
71655>>>>>>>>>
71655>>>>>>>>>External_Function WP_DrawEllipse "DrawEllipse" WinPrint.dll ; // draws an elipse within a bounding rectangle    Integer iLeft;                   // distance from left edge to draw the ellipse    Integer iTop;                    // distance from top edge to draw the ellipse    Integer iWidth;                  // width of the bounding rectangle    Integer iHeight;                 // height of the bounding rectangle    Integer iBorderColor;            // color of the ellipse's edge    Integer iFillColor;              // internal color of the ellipse    Boolean  bFill;                  // should the ellipse be filled? (False=transparent)    UInteger iThickness;             // thickness of the elipse    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the ellipse be drawn on future soft-page breaks?    Returns Boolean // True, if OK; False, if an error occurred.
71656>>>>>>>>>
71656>>>>>>>>>External_Function WP_DrawLine "DrawLine" WinPrint.dll ; // draws a line from the current position    Integer iLeft;                   // distance from left edge to draw the line    Integer iTop;                    // distance from top edge to draw the line    Integer iLength;                 // length of the line    Boolean  bHorizontal;            // draw horizontal? (False=vertical)    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Returns Boolean // True, if OK; False, if an error occurred.
71657>>>>>>>>>
71657>>>>>>>>>External_Function WP_DrawRectangle "DrawRectangle" WinPrint.dll ; // draws a rectangle    Integer iLeft;                   // distance from left edge to draw the rectangle    Integer iTop;                    // distance from top edge to draw the rectangle    Integer iWidth;                  // width of the rectangle    Integer iHeight;                 // height of the rectangle    Integer iBorderColor;            // color of the rectangle's border    Integer iFillColor;              // internal color of the rectangle    Boolean  bFill;                  // should the rectangle be filled? (False=transparent)    UInteger iThickness;             // thickness of the rectangle's border    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the rectangle be drawn on future soft-page breaks?    Returns Boolean // True, if OK; False, if an error occurred.
71658>>>>>>>>>
71658>>>>>>>>>External_Function WP_DrawXYLine "DrawXYLine" WinPrint.dll ; // draws a line between two points    Integer iLeftStart;              // distance from left edge to draw from    Integer iTopStart;               // distance from top edge to draw from    Integer iLeftEnd;                // distance from left edge to draw to    Integer iTopEnd;                 // distance from top edge to draw to    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the line be drawn on future soft-page breaks?    Returns Boolean // True, if OK; False, if an error occurred.
71659>>>>>>>>>
71659>>>>>>>>>External_Function WP_SetAbsoluteMargins "SetAbsoluteMargins" WinPrint.dll ; // modifies the top/bottom non-printable margin    UInteger iTop;      // the top margin offset    UInteger iBottom;   // the bottom margin offset    Boolean  bAllPages; // should all pages be affected? True=AllPages; False=first page only    Returns Boolean // always True
71660>>>>>>>>>
71660>>>>>>>>>External_Function WP_SetMargins "SetMargins" WinPrint.dll ; // Sets the user-margins    UInteger iLeft;   // the left margin    UInteger iTop;    // the top margin    UInteger iRight;  // the right margin    UInteger iBottom; // the bottom margin    Returns Boolean // always True
71661>>>>>>>>>
71661>>>>>>>>>External_Function WP_CreateDiagram "CreateDiagram" WinPrint.dll ; // Creates a new diagram    UInteger eType;       // type of diagram (Bar, Line, Pie)    UInteger eEffect;     // how it is drawn (2d or 3d, etc)    UInteger iWidth;      // width of the diagram    UInteger iHeight;     // height of the diagram    Boolean  bDrawXyAxis; // draw the xy-axis (for bar charts only)?    Returns Handle // unique id for the diagram used in other diagram funtions
71662>>>>>>>>>
71662>>>>>>>>>External_Function WP_AddDiagramEntry "AddDiagramEntry" WinPrint.dll ; // Adds an item into a diagram    Handle   hDiagram;          // diagram handle returned by CreateDiagram()    String   sValueDescription; // description of the item    String   sValue;            // value of the item    Integer iBorderColor;       // color of the item's border    Integer iFillColor;         // color of the item's interior    Boolean  bFilled;           // should the item be drawn filled (with iFillColor), or transparent?    UInteger iNumDecimals;      // Number of decimals in the sValue argument    UInteger eValueOrPercent;   // How the value should be displayed (as value or percentage, etc)    Boolean  bExploded;         // should the value be "pulled out" (pie charts only)    Returns Boolean // True, if success; False, if error
71663>>>>>>>>>
71663>>>>>>>>>External_Function WP_DrawDiagram "DrawDiagram" WinPrint.dll ; // draws a diagram    Handle   hDiagram;               // diagram handle returned by CreateDiagram()    UInteger iLeft;                  // x-coordinate to draw the diagram    UInteger iTop;                   // y-coordinate to draw the diagram    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Returns Boolean // True, if success; False, if error
71664>>>>>>>>>
71664>>>>>>>>>External_Function WP_LockDiagram "LockDiagram" WinPrint.dll ; // Locks a diagram so that no more entries can be added    Handle hDiagram; // diagram handle returned by CreateDiagram()    Returns Boolean // True, if success; False, if error
71665>>>>>>>>>
71665>>>>>>>>>External_Function WP_SetDiagramCaption "SetDiagramCaption" WinPrint.dll ; // Sets the caption of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sCaption; // the diagram's caption    Returns Boolean // True, if success; False, if error
71666>>>>>>>>>
71666>>>>>>>>>External_Function WP_SetDiagramXText "SetDiagramXText" WinPrint.dll ; // Sets the horizontal label of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sText;    // the diagram's horizonal label    Returns Boolean // True, if success; False, if error
71667>>>>>>>>>
71667>>>>>>>>>External_Function WP_SetDiagramYText "SetDiagramYText" WinPrint.dll ; // Sets the vertical label of a diagram    Handle  hDiagram;      // diagram handle returned by CreateDiagram()    String  sText;         // the diagram's vertical label    Boolean bVerticalText; // should the text be drawn vertically (False=horizontally)    Returns Boolean // True, if success; False, if error
71668>>>>>>>>>
71668>>>>>>>>>External_Function WP_BeginHeader "BeginHeader" WinPrint.dll ; // creates a new header    UInteger iHeaderType; // the type of header    UInteger iSubHeaderNum; // for subheaders, then number (1-0)    Returns Boolean // always True
71669>>>>>>>>>
71669>>>>>>>>>External_Function WP_EndHeader "EndHeader" WinPrint.dll ; // declares the end of the current header    Returns Boolean // always True
71670>>>>>>>>>
71670>>>>>>>>>External_Function WP_SetExtraLineCheck "SetExtraLineCheck" WinPrint.dll ; // forces a soft page break if header plus number of lines don't fit on page    UInteger iNumLines; // number of lines in addition to header required before forcing a soft page-break    Returns Boolean; // always True    
71671>>>>>>>>>External_Function WP_SetHeaderFrame "SetHeaderFrame" WinPrint.dll ; // sets the style, color and frame of a header    UInteger eFrame;     // style of frame (margin-to-margin, etc)    Integer iColor;      // color of the frame's edge    UInteger iThickness; // thickness of the frame    Integer iFillCol;    // the internal color of the frame (only used if bBilled=True)    Boolean  bFilled;    // True, if the frame should be filled with the iFillColor (False=Transparent)    Returns Boolean // Always True
71672>>>>>>>>>
71672>>>>>>>>>External_Function WP_SetHeaderMargin "SetHeaderMargin" WinPrint.dll ; // Sets a margin of space on the inside and outside of the current header    UInteger eType;      // Specifies which margin areas is being set.    Integer  iSize;      // Size of the margin setting in the current report metrics    Returns Boolean  // False if document is not started
71673>>>>>>>>>
71673>>>>>>>>>External_Function WP_SetHeaderPlacement "SetHeaderPlacement" WinPrint.dll ; // placement (left, center or right) of the header    UInteger ePlacement; // placed left, center or right    Returns Boolean //always True
71674>>>>>>>>>
71674>>>>>>>>>External_Function WP_SetHeaderWrap "SetHeaderWrap" WinPrint.dll ; // determines whether the current header is drawn on soft page-breaks    Boolean bWrap; // True, to wrap onto following pages; False, for current page only    Returns Boolean // always True
71675>>>>>>>>>
71675>>>>>>>>>External_Function WP_WriteHeader "WriteHeader" WinPrint.dll ; // writes a header to the current page    UInteger eHeaderType;   // type of header    UInteger iSubHeaderNum; // for subheaders, the number (1-9)    Returns Boolean // True, if success; False, if error
71676>>>>>>>>>
71676>>>>>>>>>External_Function WP_RGBToDFPrintColor "RGBToDFPrintColor" WinPrint.dll ; // converts R, G, and B values into a composite color that WinPrint expects    UInteger iRed;   // red component (1-255)    UInteger iGreen; // green component (1-255)    UInteger iBlue;  // blue component (1-255)    Returns Integer // composite color
71677>>>>>>>>>
71677>>>>>>>>>External_Function WP_GetMetrics "GetMetrics" WinPrint.dll ; // gets the current unit of measurement    Returns UInteger // unit of measurement (Inch or CM)
71678>>>>>>>>>
71678>>>>>>>>>External_Function WP_SetMetrics "SetMetrics" WinPrint.dll ; // sets the unit of measurement    UInteger eMetrics; // Inch or CM    Returns Boolean // always True
71679>>>>>>>>>
71679>>>>>>>>>External_Function WP_ClearDocument "ClearDocument" WinPrint.dll ; // clears the resources of the document from memory    Returns Boolean // always True
71680>>>>>>>>>
71680>>>>>>>>>External_Function WP_NewDocument "NewDocument" WinPrint.dll ; // starts a new document, but preserves the printer settings    Boolean bAutoPreview ; // Should the Previewer be displayed immediately    Returns Boolean // True, if success; False, if an error occurred
71681>>>>>>>>>
71681>>>>>>>>>External_Function WP_EndDocument "EndDocument" WinPrint.dll ; // Indicates that the document is finished    Returns Boolean // always True
71682>>>>>>>>>
71682>>>>>>>>>External_Function WP_ClearPrinter "ClearPrinter" WinPrint.dll ; // clears all printer and document resources    Returns Boolean // True, if success; False, if an error occurred
71683>>>>>>>>>
71683>>>>>>>>>External_Function WP_ConfirmLines "ConfirmLines" WinPrint.dll ; // ensures that a specified number of lines will fit on the page; if not, a soft page-break is performed automatically    UInteger iNumLines; // number of lines that must fit on the page    Returns Boolean // True, if success; False, if an error occurred
71684>>>>>>>>>
71684>>>>>>>>>External_Function WP_CreatePage "CreatePage" WinPrint.dll ; // creates a new page of specified columns    UInteger iNumColumns; // number of columns (zero= no columns)    Returns UInteger; // page number that was created    
71685>>>>>>>>>External_Function WP_PreviewDocument "PreviewDocument" WinPrint.dll ; // previews the current document    Boolean bPrintDialog; // Determines whether the Print Dialog (range, etc) is displayed when the "print" button is clicked in the preview window.    Boolean bPrintSetup;  // Determines whether the Print Setup button is enabled (allows to change orientation, etc)    Boolean bPrint;       // Determines whether the Print button is enabled    Returns Handle // non-zero = hViewerProcess; zero= error
71686>>>>>>>>>
71686>>>>>>>>>External_Function WP_ClosePreview "ClosePreview" WinPrint.dll ; // closes the preview window    Returns Boolean // True, if closed; False, if an error occurred (such as it not being already open)
71687>>>>>>>>>
71687>>>>>>>>>External_Function WP_PrintDocument "PrintDocument" WinPrint.dll ; // prints the current document    Handle hWndParent; // window handle of object to use for any modal output    Returns Boolean // True, if success; False, if an error occurred
71688>>>>>>>>>
71688>>>>>>>>>External_Function WP_SetAlign "SetAlign" WinPrint.dll ; // align future text    UInteger eAlign; // left, center or right    Returns Boolean // always True
71689>>>>>>>>>
71689>>>>>>>>>External_Function WP_WriteText "WriteText" WinPrint.dll ; // write text to the current position or column    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iColumnNum;        // number of the column to write to (zero=no column, use current position)    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncating    Returns Boolean // True, if success; False, if an error occurred
71690>>>>>>>>>
71690>>>>>>>>>External_Function WP_WriteTextAtPosition "WriteTextAtPosition" WinPrint.dll ; // writes text to a specific position    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iPosition;         // horizontal position to write the text    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncating    Returns Boolean // True, if success; False, if an error occurred
71691>>>>>>>>>
71691>>>>>>>>>External_Function WP_SetProgressCaption "SetProgressCaption" WinPrint.dll ;    String sProgressCaption ;    Returns Boolean
71692>>>>>>>>>
71692>>>>>>>>>External_Function WP_SetReportTitle     "SetReportTitle"     WinPrint.dll ;    String sCaption ;    Returns Boolean
71693>>>>>>>>>
71693>>>>>>>>>External_Function WP_ViewerWantsToClose "ViewerWantsToClose" WinPrint.dll ;    Returns Integer
71694>>>>>>>>>
71694>>>>>>>>>External_Function WP_DisplayMessageBox  "DisplayMessageBox"  WinPrint.dll ;    String sCaption String sText ;    Returns Integer
71695>>>>>>>>>
71695>>>>>>>>>External_Function WP_GetViewerWindow "GetViewerWindow" Winprint.dll ;    Returns Handle
71696>>>>>>>>>
71696>>>>>>>>>External_Function WP_GetDocumentStatus "GetDocumentStatus" Winprint.dll ;    Returns Integer // returns dsNotStarted, dsStarted, or dsFinished
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>Use WinPrint_Constants.pkg
Including file: Winprint_Constants.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Winprint_Constants.pkg)
71697>>>>>>>>>// Constants used by Winprint1 and Winprint 2
71697>>>>>>>>>
71697>>>>>>>>>// Define Winprint Constants
71697>>>>>>>>>
71697>>>>>>>>>Enum_List // Metrics
71697>>>>>>>>>    Define WPM_CM
71697>>>>>>>>>    Define WPM_INCH
71697>>>>>>>>>End_Enum_List
71697>>>>>>>>>
71697>>>>>>>>>// values returns by GetDocumentStatus
71697>>>>>>>>>Enum_List
71697>>>>>>>>>    Define dsNotStarted for 0 // The document is cleared or has never started
71697>>>>>>>>>    Define dsStarted    for 1 // The document has been created, but is not finished.
71697>>>>>>>>>    Define dsFinished   for 2 // The document is completed, and is currently valid
71697>>>>>>>>>End_Enum_List
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>// Fonts/Align
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>// Header position on page
71697>>>>>>>>>
71697>>>>>>>>>// Header frame types
71697>>>>>>>>>
71697>>>>>>>>>// Header Margin
71697>>>>>>>>>
71697>>>>>>>>>// Header page breake/wrap
71697>>>>>>>>>
71697>>>>>>>>>// Headers
71697>>>>>>>>>
71697>>>>>>>>>// RGB colors for WinPrint
71697>>>>>>>>>// If you want to define more colors, use the function DFGetDFColor.
71697>>>>>>>>>// Default
71697>>>>>>>>>// Dark
71697>>>>>>>>>// Same as magenta, i will leav them becauce they exist in ver 1.0
71697>>>>>>>>>
71697>>>>>>>>>// Graphics
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>// PD flags for print setup/dialog
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>>>
71697>>>>>>>Use Rgb.pkg
71697>>>>>>>Use GlobalFunctionsProcedures.pkg
71697>>>>>>>
71697>>>>>>>Define INFINITE for -1
71697>>>>>>>Define WAIT_TIMEOUT for |CI$00000102
71697>>>>>>>
71697>>>>>>>
71697>>>>>>>Define QS_KEY            for |CI$0001
71697>>>>>>>Define QS_MOUSEMOVE      for |CI$0002
71697>>>>>>>Define QS_MOUSEBUTTON    for |CI$0004
71697>>>>>>>Define QS_POSTMESSAGE    for |CI$0008
71697>>>>>>>Define QS_TIMER          for |CI$0010
71697>>>>>>>Define QS_PAINT          for |CI$0020
71697>>>>>>>Define QS_SENDMESSAGE    for |CI$0040
71697>>>>>>>Define QS_HOTKEY         for |CI$0080
71697>>>>>>>Define QS_ALLPOSTMESSAGE for |CI$0100
71697>>>>>>>Define QS_MOUSE          for (QS_MOUSEMOVE ior QS_MOUSEBUTTON)
71697>>>>>>>Define QS_INPUT          for (QS_MOUSE ior QS_KEY)
71697>>>>>>>Define QS_ALLEVENTS      for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY)
71697>>>>>>>Define QS_ALLINPUT       for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY ior QS_SENDMESSAGE)
71697>>>>>>>
71697>>>>>>>External_Function WaitForSingleObject "WaitForSingleObject" Kernel32.dll Handle hHandle DWord dwMilliseconds Returns DWord
71698>>>>>>>External_Function GetCurrentProcessId "GetCurrentProcessId" Kernel32.dll Returns DWord
71699>>>>>>>External_Function GetCurrentProcess "GetCurrentProcess" Kernel32.dll Returns Handle
71700>>>>>>>
71700>>>>>>>External_Function MsgWaitForMultipleObjects "MsgWaitForMultipleObjects" User32.dll ;    DWord nCount;             // number of handles in the object handle array    Address pHandles;     // pointer to the object-handle array    Boolean fWaitAll;     // wait for all or wait for one    DWord dwMilliseconds; // time-out interval in milliseconds    DWord dwWakeMask;     // type of input events to wait for    Returns DWord
71701>>>>>>>
71701>>>>>>>Use GlobalFunctionsProcedures.pkg
71701>>>>>>>
71701>>>>>>>Class cWinPrint2 is a cObject
71702>>>>>>>    Procedure Construct_Object
71704>>>>>>>        Forward Send construct_object
71706>>>>>>>        
71706>>>>>>>        // internal properties
71706>>>>>>>        Property Integer DFCurrent_Color       0
71707>>>>>>>        Property String  DFCurrent_OutPut      "WinPrint"
71708>>>>>>>        Property Integer DFCurrent_Diagram     0
71709>>>>>>>        Property Integer DFCurrent_HeaderType  0
71710>>>>>>>        Property Integer DFCurrent_HeaderNr    0
71711>>>>>>>        Property Number  DFCurrent_FontSize    10
71712>>>>>>>        Property String  DFCurrent_Font        "Arial"
71713>>>>>>>        
71713>>>>>>>        // Default values for margins 2.53 CM = 1 inch
71713>>>>>>>        Property Number  DFLeft_Margin    2.53
71714>>>>>>>        Property Number  DFTop_Margin     2.53
71715>>>>>>>        Property Number  DFright_Margin   2.53
71716>>>>>>>        Property Number  DFBottom_Margin  2.53
71717>>>>>>>        
71717>>>>>>>        // If WP1 this defaults to false. In 2, it is true which means that the print job
71717>>>>>>>        // dialog appears when you hitprint in previewer.
71717>>>>>>>        Property Integer PrintDlgInPreview   1
71718>>>>>>>        // This does nothing in Wp2 (because you can't to this anyway)
71718>>>>>>>        Property Integer EnablePrintSetupFromPreview  True
71719>>>>>>>        Property Integer EnablePrintFromPreview  1
71720>>>>>>>        
71720>>>>>>>        // is the GUI Suspended. This is privately maintained and is used
71720>>>>>>>        // to figure out if a preview panel is up or not
71720>>>>>>>        Property Integer pbIsSuspended False
71721>>>>>>>        
71721>>>>>>>        Object oDFColorArray is an Array
71723>>>>>>>            //Moved into array
71723>>>>>>>            Set Value  0  to RGB_WHITE
71724>>>>>>>            Set Value  1  to RGB_RED
71725>>>>>>>            Set Value  2  to RGB_BLUE
71726>>>>>>>            Set Value  3  to RGB_GREEN
71727>>>>>>>            Set Value  4  to RGB_YELLOW
71728>>>>>>>            Set Value  5  to RGB_GREY
71729>>>>>>>            Set Value  6  to RGB_CYAN
71730>>>>>>>            Set Value  7  to RGB_MAGENTA
71731>>>>>>>            Set Value  8  to RGB_DRED
71732>>>>>>>            Set Value  9  to RGB_DBLUE
71733>>>>>>>            Set Value  10 to RGB_DGREEN
71734>>>>>>>            Set Value  11 to RGB_DYELLOW
71735>>>>>>>            Set Value  12 to RGB_DGREY
71736>>>>>>>            Set Value  13 to RGB_DCYAN
71737>>>>>>>            Set Value  14 to RGB_DMAGENTA
71738>>>>>>>            Set Value  15 to RGB_BLACK
71739>>>>>>>        End_Object
71740>>>>>>>        
71740>>>>>>>        Object oDiagramArray is an Array
71742>>>>>>>        End_Object
71743>>>>>>>        
71743>>>>>>>    End_Procedure
71744>>>>>>>    
71744>>>>>>>    Function ViewerWantsToClose Returns Boolean
71746>>>>>>>        Function_Return (WP_ViewerWantsToClose())
71747>>>>>>>    End_Function
71748>>>>>>>    
71748>>>>>>>    Function IsViewerActive Returns Boolean
71750>>>>>>>        Function_Return (WP_GetViewerWindow()<>0)
71751>>>>>>>    End_Function
71752>>>>>>>    
71752>>>>>>>    Function IsPrinterValid Returns Boolean
71754>>>>>>>        Function_Return (WP_IsPrinterValid()<>0)
71755>>>>>>>    End_Function
71756>>>>>>>    
71756>>>>>>>    Function ArePrintersInstalled Returns Boolean
71758>>>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
71759>>>>>>>    End_Function
71760>>>>>>>    
71760>>>>>>>    
71760>>>>>>>    // returns docucument state: dsNotStarted, dsStarted, dsFinished
71760>>>>>>>    Function DocumentStatus Returns Integer
71762>>>>>>>        Function_Return (WP_GetDocumentStatus())
71763>>>>>>>    End_Function
71764>>>>>>>    
71764>>>>>>>    // Might still be called from report class. Leave dummy stub
71764>>>>>>>    Procedure DFZeroCounters
71766>>>>>>>    End_Procedure
71767>>>>>>>    
71767>>>>>>>    //
71767>>>>>>>    Function DFNewPage Integer Columns Returns Integer
71769>>>>>>>        Integer iPageNum
71769>>>>>>>        // This returns a page number used in report object....(this may change)
71769>>>>>>>        Move (WP_CreatePage(Columns)) to iPageNum
71770>>>>>>>        If (iPageNum=0) Begin
71772>>>>>>>            Error DFERR_WINPRINT DFPrintError900
71773>>>>>>>>
71773>>>>>>>        End
71773>>>>>>>>
71773>>>>>>>        Function_Return iPageNum
71774>>>>>>>    End_Function
71775>>>>>>>    
71775>>>>>>>    //Return handle to use for winprint dialog. If main_window
71775>>>>>>>    //   exists, use it. Else, get object's handle
71775>>>>>>>    Function Report_Window_Handle Returns Handle
71777>>>>>>>        Handle hWnd
71777>>>>>>>        Handle hoObj
71777>>>>>>>        Get Focus of desktop to hoObj // start with the focus
71778>>>>>>>        Move (gOwnerWindowHandle(hoObj)) to hWnd // global function finds the right handle for us
71779>>>>>>>        Function_Return hWnd
71780>>>>>>>    End_Function
71781>>>>>>>    
71781>>>>>>>    
71781>>>>>>>    //
71781>>>>>>>    Function DFPrintDialog Returns Boolean
71783>>>>>>>        Handle hwnd
71783>>>>>>>        Boolean bOk
71783>>>>>>>        
71783>>>>>>>        Get Report_Window_Handle to hWnd
71784>>>>>>>        Move (WP_ExecutePrintDialog(hwnd)) to bOk
71785>>>>>>>        
71785>>>>>>>        Function_Return bOk
71786>>>>>>>    End_Function
71787>>>>>>>    
71787>>>>>>>    
71787>>>>>>>    // You can only invoke the print setup if the report is cleared. If you try to to do this in
71787>>>>>>>    //    the wrong state you will get an error.
71787>>>>>>>    Function DFPrintSetupDialog Returns Boolean
71789>>>>>>>        Handle hwnd
71789>>>>>>>        Boolean bOk
71789>>>>>>>        Integer iStatus
71789>>>>>>>        Get ArePrintersInstalled to bOk
71790>>>>>>>        If not bOk Begin
71792>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
71793>>>>>>>>
71793>>>>>>>        End
71793>>>>>>>>
71793>>>>>>>        Else Begin
71794>>>>>>>            Get DocumentStatus to iStatus
71795>>>>>>>            
71795>>>>>>>            If (iStatus=dsNotStarted) Begin
71797>>>>>>>                Get Report_Window_Handle to hWnd
71798>>>>>>>                Move (WP_ExecutePrinterSetupDialog(hwnd)) to bOk
71799>>>>>>>                
71799>>>>>>>                // test that the selected printer is valid....
71799>>>>>>>                If bOK Begin
71801>>>>>>>                    Get IsPrinterValid to bOk // if printer not valid, it's not ok
71802>>>>>>>                    If not bOk Begin
71804>>>>>>>                        Error DFERR_WINPRINT DFPrintError936  // could not select a valid printer
71805>>>>>>>>
71805>>>>>>>                    End
71805>>>>>>>>
71805>>>>>>>                End
71805>>>>>>>>
71805>>>>>>>            End
71805>>>>>>>>
71805>>>>>>>            Else Begin
71806>>>>>>>                Error DFERR_WINPRINT DFPrintError966      // cannot change printer when report is active
71807>>>>>>>>
71807>>>>>>>            End
71807>>>>>>>>
71807>>>>>>>        End
71807>>>>>>>>
71807>>>>>>>        Function_Return bOk
71808>>>>>>>    End_Function
71809>>>>>>>    
71809>>>>>>>    
71809>>>>>>>    // Provided for backwards compatibility. DFPrintSetupDialog is more flexible because it returns a
71809>>>>>>>    //    false if cancel was selected.
71809>>>>>>>    Procedure DFPrintSetup
71811>>>>>>>        Boolean bOk
71811>>>>>>>        Get DFPrintSetupDialog to bOk
71812>>>>>>>    End_Procedure
71813>>>>>>>    
71813>>>>>>>    // This invokes the print job dialog, prints the report, then clears the report document.
71813>>>>>>>    //    This should be called after the report is complete.
71813>>>>>>>    Procedure DFPrint
71815>>>>>>>        Integer bOk
71815>>>>>>>        Get DFPrintDialog to bOk
71816>>>>>>>        If bOk Begin
71818>>>>>>>            Send DFPrintDoc
71819>>>>>>>            Send DFClearDoc
71820>>>>>>>        End
71820>>>>>>>>
71820>>>>>>>    End_Procedure
71821>>>>>>>    
71821>>>>>>>    Procedure DFSuspendGui Boolean bSuspend
71823>>>>>>>        If (bSuspend<>pbIsSuspended(Self)) Begin
71825>>>>>>>            Send SuspendGui of Desktop bSuspend
71826>>>>>>>            Set pbIsSuspended to bSuspend
71827>>>>>>>        End
71827>>>>>>>>
71827>>>>>>>    End_Procedure
71828>>>>>>>    
71828>>>>>>>    // this is protected so that the queue is only pumped if the
71828>>>>>>>    // gui is suspended.
71828>>>>>>>    Procedure PumpMsgQueue
71830>>>>>>>        If (pbIsSuspended(Self)) Begin
71832>>>>>>>            Send PumpMsgQueue of desktop // permit painting
71833>>>>>>>        End
71833>>>>>>>>
71833>>>>>>>    End_Procedure
71834>>>>>>>    
71834>>>>>>>    
71834>>>>>>>    // This does a modeless preview. This is what you'd want during
71834>>>>>>>    //    report generation and it may be what you want for report viewing.
71834>>>>>>>    Procedure DFPreviewNoWait
71836>>>>>>>        Boolean bOk
71836>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
71836>>>>>>>        Integer iStatus
71836>>>>>>>        Get PrintDlgInPreview to bPrntDlg
71837>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
71838>>>>>>>        Get EnablePrintFromPreview to bPrint
71839>>>>>>>        Get DocumentStatus to iStatus
71840>>>>>>>        If (iStatus=dsStarted) Begin
71842>>>>>>>            Send DfSuspendGui True
71843>>>>>>>        End
71843>>>>>>>>
71843>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) to bOk
71844>>>>>>>        If not bOk Begin
71846>>>>>>>            Error DFERR_WINPRINT DFPrintError901
71847>>>>>>>>
71847>>>>>>>            Send DfSuspendGui False
71848>>>>>>>        End
71848>>>>>>>>
71848>>>>>>>    End_Procedure
71849>>>>>>>    
71849>>>>>>>    
71849>>>>>>>    // This does a modal preview. You might want this for report
71849>>>>>>>    //    viewing as the program knows when the viewer is closed
71849>>>>>>>    // Note that this is a private message and it was never intended that this
71849>>>>>>>    // should be used. We expect winprint reports to use modeless viewers.
71849>>>>>>>    Procedure DFPreviewWait
71851>>>>>>>        Handle hViewerProcess
71851>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
71851>>>>>>>        Integer iRetVal
71851>>>>>>>        Handle hwMain hMain
71851>>>>>>>        
71851>>>>>>>        Get PrintDlgInPreview to bPrntDlg
71852>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
71853>>>>>>>        Get EnablePrintFromPreview to bPrint
71854>>>>>>>        
71854>>>>>>>        Send DfSuspendGui True
71855>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) to hViewerProcess
71856>>>>>>>        
71856>>>>>>>        If (hViewerProcess = 0) Begin
71858>>>>>>>            Error DFERR_WINPRINT DFPrintError901
71859>>>>>>>>
71859>>>>>>>        End
71859>>>>>>>>
71859>>>>>>>        Else Begin
71860>>>>>>>            // We need to wait for either the Viewer to close, or a WM_PAINT message in the thread's queue...
71860>>>>>>>            Repeat
71860>>>>>>>>
71860>>>>>>>                Move (MsgWaitForMultipleObjects(1, AddressOf(hViewerProcess), False, INFINITE, QS_PAINT)) to iRetVal
71861>>>>>>>                Send PumpMsgQueue // permit painting
71862>>>>>>>            Until (iRetVal = 0) // 0 means that the viewer process terminated
71864>>>>>>>        End
71864>>>>>>>>
71864>>>>>>>        Send DfSuspendGui False
71865>>>>>>>        
71865>>>>>>>        // Do what we can to force VDF application to the top.
71865>>>>>>>        // As 12.0 dfSuspendGUI actually properly disables the underlying windows. When the viewer
71865>>>>>>>        // is closed it cannot give the focus back to this so it goes elsewhere. This will force it
71865>>>>>>>        // back.
71865>>>>>>>        
71865>>>>>>>        Get main_window of desktop to hMain
71866>>>>>>>        If hMain Begin
71868>>>>>>>            Get window_handle of hMain to hwMain
71869>>>>>>>            If hwMain Begin
71871>>>>>>>                If (GetForegroundWindow()<>hwMain) Begin
71873>>>>>>>                    Move (SetForegroundWindow(hwMain)) to hwMain
71874>>>>>>>                End
71874>>>>>>>>
71874>>>>>>>            End
71874>>>>>>>>
71874>>>>>>>        End
71874>>>>>>>>
71874>>>>>>>        
71874>>>>>>>    End_Procedure
71875>>>>>>>    
71875>>>>>>>    Procedure DfPreview
71877>>>>>>>        Send DfPreviewNoWait
71878>>>>>>>    End_Procedure
71879>>>>>>>    
71879>>>>>>>    
71879>>>>>>>    //
71879>>>>>>>    Procedure DFPrintDoc
71881>>>>>>>        Handle hwnd
71881>>>>>>>        Boolean bOk
71881>>>>>>>        Get Report_Window_Handle to hWnd
71882>>>>>>>        Move (WP_PrintDocument(hwnd)) to bOk
71883>>>>>>>        
71883>>>>>>>        If not bOk Begin
71885>>>>>>>            Error DFERR_WINPRINT DFPrintError902
71886>>>>>>>>
71886>>>>>>>        End
71886>>>>>>>>
71886>>>>>>>    End_Procedure
71887>>>>>>>    
71887>>>>>>>    
71887>>>>>>>    //
71887>>>>>>>    Procedure DFClearDoc
71889>>>>>>>        Boolean bOk
71889>>>>>>>        Get ArePrintersInstalled to bOk
71890>>>>>>>        If bOk Begin
71892>>>>>>>            Move (WP_ClearDocument()) to bOk
71893>>>>>>>            Send DFSuspendGUI False
71894>>>>>>>            If not bOk Begin
71896>>>>>>>                Error DFERR_WINPRINT DFPrintError903 // error number right?
71897>>>>>>>>
71897>>>>>>>            End
71897>>>>>>>>
71897>>>>>>>        End
71897>>>>>>>>
71897>>>>>>>    End_Procedure
71898>>>>>>>    
71898>>>>>>>    Procedure DFNewDoc Boolean bAutoPreview
71900>>>>>>>        Boolean bOk
71900>>>>>>>        // this is the most likely place we will encounter when we start a report. Check for
71900>>>>>>>        // printers and return an explicit error to make it easy to identify the error
71900>>>>>>>        Get ArePrintersInstalled to bOk
71901>>>>>>>        If not bOk Begin
71903>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
71904>>>>>>>>
71904>>>>>>>        End
71904>>>>>>>>
71904>>>>>>>        Else Begin
71905>>>>>>>            Send DfClearDoc // a new doc should always start with a clear
71906>>>>>>>            If bAutoPreview ;                Send DFSuspendGUI True
71909>>>>>>>            Move (WP_NewDocument(bAutoPreview)) to bOk
71910>>>>>>>            
71910>>>>>>>            If not bOk Begin
71912>>>>>>>                Error DFERR_WINPRINT DFPrintError902  // could not print document
71913>>>>>>>>
71913>>>>>>>                Send DFSuspendGUI False
71914>>>>>>>            End
71914>>>>>>>>
71914>>>>>>>        End
71914>>>>>>>>
71914>>>>>>>    End_Procedure
71915>>>>>>>    
71915>>>>>>>    //
71915>>>>>>>    Procedure DFSetFont String sFontName
71917>>>>>>>        Boolean bOk
71917>>>>>>>        Move (WP_SetFontName(sFontName)) to bOk
71918>>>>>>>        
71918>>>>>>>        If not bOK Begin
71920>>>>>>>            Error DFERR_WINPRINT DFPrintError904
71921>>>>>>>>
71921>>>>>>>        End
71921>>>>>>>>
71921>>>>>>>    End_Procedure
71922>>>>>>>    
71922>>>>>>>    
71922>>>>>>>    //
71922>>>>>>>    Procedure DFSetFontSize Integer iHeight Integer iWidth
71924>>>>>>>        Boolean bOk
71924>>>>>>>        // note that width is ignored in new implementation
71924>>>>>>>        Move (WP_SetFontHeight(iHeight)) to bOk
71925>>>>>>>        
71925>>>>>>>        If not bOK Begin
71927>>>>>>>            Error DFERR_WINPRINT  DFPrintError905
71928>>>>>>>>
71928>>>>>>>        End
71928>>>>>>>>
71928>>>>>>>    End_Procedure
71929>>>>>>>    
71929>>>>>>>    
71929>>>>>>>    //
71929>>>>>>>    Procedure DFSetFontStyle DWord dwStyle
71931>>>>>>>        Boolean bOk
71931>>>>>>>        Move (WP_SetFontStyle(dwStyle)) to bOk
71932>>>>>>>        
71932>>>>>>>        If not bOK Begin
71934>>>>>>>            Error DFERR_WINPRINT DFPrintError906
71935>>>>>>>>
71935>>>>>>>        End
71935>>>>>>>>
71935>>>>>>>    End_Procedure
71936>>>>>>>    
71936>>>>>>>    
71936>>>>>>>    //
71936>>>>>>>    Procedure DFSetUnderline Boolean bUnderline
71938>>>>>>>        Boolean bOk
71938>>>>>>>        
71938>>>>>>>        Move (WP_SetFontUnderline(bUnderline)) to bOk
71939>>>>>>>        
71939>>>>>>>        If not bOK Begin
71941>>>>>>>            Error DFERR_WINPRINT DFPrintError907
71942>>>>>>>>
71942>>>>>>>        End
71942>>>>>>>>
71942>>>>>>>    End_Procedure
71943>>>>>>>    
71943>>>>>>>    
71943>>>>>>>    //
71943>>>>>>>    Procedure DFSetBold Boolean bBold
71945>>>>>>>        Boolean bOk
71945>>>>>>>        
71945>>>>>>>        Move (WP_SetFontBold(bBold)) to bOk
71946>>>>>>>        
71946>>>>>>>        If not bOK Begin
71948>>>>>>>            Error DFERR_WINPRINT DFPrintError908
71949>>>>>>>>
71949>>>>>>>        End
71949>>>>>>>>
71949>>>>>>>    End_Procedure
71950>>>>>>>    
71950>>>>>>>    
71950>>>>>>>    //
71950>>>>>>>    Procedure DFSetItalic Boolean bItalic
71952>>>>>>>        Boolean bOk
71952>>>>>>>        
71952>>>>>>>        Move (WP_SetFontItalic(bItalic)) to bOk
71953>>>>>>>        
71953>>>>>>>        If not bOK Begin
71955>>>>>>>            Error DFERR_WINPRINT DFPrintError909
71956>>>>>>>>
71956>>>>>>>        End
71956>>>>>>>>
71956>>>>>>>    End_Procedure
71957>>>>>>>    
71957>>>>>>>    
71957>>>>>>>    //
71957>>>>>>>    Procedure DFSetStrikeout Boolean bStrikeout
71959>>>>>>>        Boolean bOk
71959>>>>>>>        
71959>>>>>>>        Move (WP_SetFontStrikeout(bStrikeout)) to bOk
71960>>>>>>>        
71960>>>>>>>        If not bOK Begin
71962>>>>>>>            Error DFERR_WINPRINT DFPrintError910
71963>>>>>>>>
71963>>>>>>>        End
71963>>>>>>>>
71963>>>>>>>    End_Procedure
71964>>>>>>>    
71964>>>>>>>    
71964>>>>>>>    //
71964>>>>>>>    Procedure DFSetMargins Number nLeft Number nTop Number nRight Number nBottom
71966>>>>>>>        Boolean bOk
71966>>>>>>>        Integer iLeft iRight iTop iBottom
71966>>>>>>>        
71966>>>>>>>        Move (nLeft   * 100) to iLeft
71967>>>>>>>        Move (nRight  * 100) to iRight
71968>>>>>>>        Move (nTop    * 100) to iTop
71969>>>>>>>        Move (nBottom * 100) to iBottom
71970>>>>>>>        
71970>>>>>>>        Move (WP_SetMargins(iLeft,iTop,iRight,iBottom)) to bOk
71971>>>>>>>        
71971>>>>>>>        If bOk Begin
71973>>>>>>>            Set DFLeft_Margin   to nLeft
71974>>>>>>>            Set DFTop_Margin    to nTop
71975>>>>>>>            Set DFRight_Margin  to nRight
71976>>>>>>>            Set DFBottom_Margin to nBottom
71977>>>>>>>        End
71977>>>>>>>>
71977>>>>>>>        Else Begin
71978>>>>>>>            Error DFERR_WINPRINT DFPrintError911
71979>>>>>>>>
71979>>>>>>>        End
71979>>>>>>>>
71979>>>>>>>    End_Procedure
71980>>>>>>>    
71980>>>>>>>    
71980>>>>>>>    //
71980>>>>>>>    Procedure DFSetLeftMargin Number nLeft
71982>>>>>>>        Number  nTop nRight nBottom
71982>>>>>>>        Get DFTop_Margin    to nTop
71983>>>>>>>        Get DFRight_Margin  to nRight
71984>>>>>>>        Get DFBottom_Margin to nBottom
71985>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
71986>>>>>>>    End_Procedure
71987>>>>>>>    
71987>>>>>>>    
71987>>>>>>>    //
71987>>>>>>>    Procedure DFSetRightMargin Number nRight
71989>>>>>>>        Number  nLeft nTop nBottom
71989>>>>>>>        Get DFLeft_Margin   to nLeft
71990>>>>>>>        Get DFTop_Margin    to nTop
71991>>>>>>>        Get DFBottom_Margin to nBottom
71992>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
71993>>>>>>>    End_Procedure
71994>>>>>>>    
71994>>>>>>>    
71994>>>>>>>    //
71994>>>>>>>    Procedure DFSetTopMargin Number nTop
71996>>>>>>>        Number  nLeft nRight nBottom
71996>>>>>>>        Get DFLeft_Margin   to nLeft
71997>>>>>>>        Get DFRight_Margin  to nRight
71998>>>>>>>        Get DFBottom_Margin to nBottom
71999>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
72000>>>>>>>    End_Procedure
72001>>>>>>>    
72001>>>>>>>    
72001>>>>>>>    //
72001>>>>>>>    Procedure DFSetBottomMargin Number nBottom
72003>>>>>>>        Number  nLeft nTop nRight
72003>>>>>>>        Get DFLeft_Margin   to nLeft
72004>>>>>>>        Get DFTop_Margin    to nTop
72005>>>>>>>        Get DFRight_Margin  to nRight
72006>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
72007>>>>>>>    End_Procedure
72008>>>>>>>    
72008>>>>>>>    
72008>>>>>>>    //
72008>>>>>>>    Procedure DFWriteText String sText Integer iStyle Integer iColumn Integer iDecimal Boolean bNewLineAfterPrint
72010>>>>>>>        Boolean bOk
72010>>>>>>>        
72010>>>>>>>        Send DFSetFontStyle iStyle
72011>>>>>>>        Move (ToAnsi(sText)) to sText
72012>>>>>>>        Move (WP_WriteText(sText,bNewLineAfterPrint,iColumn,iDecimal,0)) to bOk
72013>>>>>>>        If not bOk Begin
72015>>>>>>>            Error DFERR_WINPRINT DFPrintError918
72016>>>>>>>>
72016>>>>>>>        End
72016>>>>>>>>
72016>>>>>>>        Send PumpMsgQueue // permit painting
72017>>>>>>>    End_Procedure
72018>>>>>>>    
72018>>>>>>>    //
72018>>>>>>>    Procedure DFWrite String sText DWord iStyle Integer iColumn Integer iDecimal Boolean bTrim
72020>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
72022>>>>>>>            Move (Rtrim(sText)) to sText
72023>>>>>>>        End
72023>>>>>>>>
72023>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal False
72024>>>>>>>    End_Procedure
72025>>>>>>>    
72025>>>>>>>    //
72025>>>>>>>    Procedure DFWriteLn String sText DWord iStyle Integer iColumn Integer iDecimal Boolean bTrim
72027>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
72029>>>>>>>            Move (Rtrim(sText)) to sText
72030>>>>>>>        End
72030>>>>>>>>
72030>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal True
72031>>>>>>>    End_Procedure
72032>>>>>>>    
72032>>>>>>>    
72032>>>>>>>    //
72032>>>>>>>    Procedure DFWriteTextAtPosition String sText Integer iStyle Number nPosition Integer iDecimal ;            Number nMaxLength Boolean bNewLineAfterPrint
72034>>>>>>>        Boolean bOk
72034>>>>>>>        Integer iPosition iMaxLength
72034>>>>>>>        Send DFSetFontStyle iStyle
72035>>>>>>>        Move (ToAnsi(sText)) to sText
72036>>>>>>>        Move (nPosition * 100) to iPosition
72037>>>>>>>        Move (nMaxLength * 100) to iMaxLength
72038>>>>>>>        Move (WP_WriteTextAtPosition(sText,bNewLineAfterPrint,iPosition,iDecimal,iMaxLength)) to bOk
72039>>>>>>>        If not bOk Begin
72041>>>>>>>            Error DFERR_WINPRINT DFPrintError922
72042>>>>>>>>
72042>>>>>>>        End
72042>>>>>>>>
72042>>>>>>>        Send PumpMsgQueue // permit painting
72043>>>>>>>    End_Procedure
72044>>>>>>>    
72044>>>>>>>    //
72044>>>>>>>    Procedure DFWritePos String sText Integer iStyle Number nPosition Integer iDecimal Number nMaxLength Boolean bTrim
72046>>>>>>>        Number nMax
72046>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
72048>>>>>>>            Move (Rtrim(sText)) to sText
72049>>>>>>>        End
72049>>>>>>>>
72049>>>>>>>        
72049>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
72052>>>>>>>        Else ;            Move nMaxLength to nMax
72054>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax False
72055>>>>>>>    End_Procedure
72056>>>>>>>    
72056>>>>>>>    //
72056>>>>>>>    Procedure DFWriteLnPos String sText Integer iStyle Number nPosition Integer iDecimal Number nMaxLength Boolean bTrim
72058>>>>>>>        Number nMax
72058>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
72060>>>>>>>            Move (Rtrim(sText)) to sText
72061>>>>>>>        End
72061>>>>>>>>
72061>>>>>>>        
72061>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
72064>>>>>>>        Else ;            Move nMaxLength to nMax
72066>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax True
72067>>>>>>>    End_Procedure
72068>>>>>>>    
72068>>>>>>>    Procedure DFSetMetrics String sMetrics
72070>>>>>>>        Integer eMetrics
72070>>>>>>>        // for backwards compatibility support both string names and integer enumerations
72070>>>>>>>        // it is better to use the enumeration value
72070>>>>>>>        If (sMetrics="INCH" or sMetrics="CM") Begin
72072>>>>>>>            Set DFCurrent_Metrics to sMetrics
72073>>>>>>>        End
72073>>>>>>>>
72073>>>>>>>        Else Begin
72074>>>>>>>            Move sMetrics to eMetrics
72075>>>>>>>            Move (WP_SetMetrics(eMetrics)) to eMetrics
72076>>>>>>>        End
72076>>>>>>>>
72076>>>>>>>    End_Procedure
72077>>>>>>>    
72077>>>>>>>    Function DFGetMetrics Returns Integer
72079>>>>>>>        Integer eMetrics
72079>>>>>>>        Move (WP_GetMetrics()) to eMetrics
72080>>>>>>>        Function_Return eMetrics
72081>>>>>>>    End_Function
72082>>>>>>>    
72082>>>>>>>    
72082>>>>>>>    // Properties Maintained for compatibility with old Winprint (obsolete)
72082>>>>>>>    Function DFCurrent_Metrics Returns String
72084>>>>>>>        Integer eMetrics
72084>>>>>>>        Get DFGetMetrics to eMetrics
72085>>>>>>>        Function_Return (If(eMetrics=WPM_INCH,"INCH","CM"))
72086>>>>>>>    End_Function
72087>>>>>>>    
72087>>>>>>>    Procedure Set DFCurrent_Metrics String sCMorINCH
72089>>>>>>>        Send DFSetMetrics (If(sCMorINCH="INCH", WPM_INCH, WPM_CM))
72090>>>>>>>    End_Procedure
72091>>>>>>>    
72091>>>>>>>    
72091>>>>>>>    
72091>>>>>>>    
72091>>>>>>>    
72091>>>>>>>    //
72091>>>>>>>    Procedure DFBeginHeaderType Integer iHeaderNr Integer eHeaderType
72093>>>>>>>        Boolean bOk
72093>>>>>>>        
72093>>>>>>>        If (eHeaderType=DFSubHeader or eHeaderType=DFSubTotal) Begin
72095>>>>>>>            // Do nothing for the moment
72095>>>>>>>        End
72095>>>>>>>>
72095>>>>>>>        Else ;            Move 0 to iHeaderNr // If the user made a mistake
72097>>>>>>>        
72097>>>>>>>        Set DFCurrent_HeaderType to eHeaderType
72098>>>>>>>        Set DFCurrent_HeaderNr   to iHeaderNr
72099>>>>>>>        
72099>>>>>>>        Move (WP_BeginHeader(eHeaderType, iHeaderNr)) to bOk
72100>>>>>>>        
72100>>>>>>>        If not bOk Begin
72102>>>>>>>            Error DFERR_WINPRINT DFPrintError925
72103>>>>>>>>
72103>>>>>>>        End
72103>>>>>>>>
72103>>>>>>>    End_Procedure
72104>>>>>>>    
72104>>>>>>>    
72104>>>>>>>    //
72104>>>>>>>    Procedure DFEndHeaderType
72106>>>>>>>        Boolean bOk
72106>>>>>>>        
72106>>>>>>>        Move (WP_EndHeader()) to bOk
72107>>>>>>>        
72107>>>>>>>        If not bOk Begin
72109>>>>>>>            Error DFERR_WINPRINT DFPrintError926
72110>>>>>>>>
72110>>>>>>>        End
72110>>>>>>>>
72110>>>>>>>    End_Procedure
72111>>>>>>>    
72111>>>>>>>    
72111>>>>>>>    //
72111>>>>>>>    Procedure DFWriteHeaderType Integer iHeaderNr Integer eHeaderType
72113>>>>>>>        Boolean bOk
72113>>>>>>>        Move (WP_WriteHeader(eHeaderType, iHeaderNr)) to bOk
72114>>>>>>>        If not bOk Begin
72116>>>>>>>            Error DFERR_WINPRINT DFPrintError927
72117>>>>>>>>
72117>>>>>>>        End
72117>>>>>>>>
72117>>>>>>>    End_Procedure
72118>>>>>>>    
72118>>>>>>>    
72118>>>>>>>    //
72118>>>>>>>    Procedure DFHeaderPosition Integer ePlace
72120>>>>>>>        Boolean bOk
72120>>>>>>>        
72120>>>>>>>        Move (WP_SetHeaderPlacement(ePlace)) to bOk
72121>>>>>>>        
72121>>>>>>>        If not bOk Begin
72123>>>>>>>            Error DFERR_WINPRINT DFPrintError929
72124>>>>>>>>
72124>>>>>>>        End
72124>>>>>>>>
72124>>>>>>>    End_Procedure
72125>>>>>>>    
72125>>>>>>>    
72125>>>>>>>    //
72125>>>>>>>    Procedure DFHeaderFrameType Integer eFrame Integer iColor Number nWeight;            Integer iFillColor Boolean bFillFrame
72127>>>>>>>        Integer iWeight
72127>>>>>>>        Boolean bOk
72127>>>>>>>        
72127>>>>>>>        Move (nWeight*100) to iWeight
72128>>>>>>>        
72128>>>>>>>        Move (WP_SetHeaderFrame(eFrame,iColor,iWeight,iFillColor,bFillFrame)) to bOk
72129>>>>>>>        
72129>>>>>>>        If not bOk Begin
72131>>>>>>>            Error DFERR_WINPRINT DFPrintError930
72132>>>>>>>>
72132>>>>>>>        End
72132>>>>>>>>
72132>>>>>>>    End_Procedure
72133>>>>>>>    
72133>>>>>>>    Procedure DFHeaderMargin Integer eType Number nSize
72135>>>>>>>        Boolean bOk
72135>>>>>>>        Integer iSize
72135>>>>>>>        
72135>>>>>>>        Move (nSize * 100) to iSize
72136>>>>>>>        
72136>>>>>>>        Move (WP_SetHeaderMargin(eType, iSize)) to bOk
72137>>>>>>>        
72137>>>>>>>        If not bOk Begin
72139>>>>>>>            Error DFERR_WINPRINT DFPrintError930
72140>>>>>>>>
72140>>>>>>>        End
72140>>>>>>>>
72140>>>>>>>    End_Procedure
72141>>>>>>>    
72141>>>>>>>    
72141>>>>>>>    //
72141>>>>>>>    Procedure DFHeaderWrap Integer eOnOff
72143>>>>>>>        Boolean bOk
72143>>>>>>>        
72143>>>>>>>        Move (WP_SetHeaderWrap(eOnOff)) to bOk
72144>>>>>>>        
72144>>>>>>>        If not bOk Begin
72146>>>>>>>            Error DFERR_WINPRINT DFPrintError931
72147>>>>>>>>
72147>>>>>>>        End
72147>>>>>>>>
72147>>>>>>>    End_Procedure
72148>>>>>>>    
72148>>>>>>>    //
72148>>>>>>>    Procedure DFWriteBMP String sFileName Number nStartX Number nStartY Number nHeight Number nWidth Boolean bUCp
72150>>>>>>>        Boolean bOk
72150>>>>>>>        Integer iStartX iStartY iHeight iWidth
72150>>>>>>>        
72150>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            Move nStartX to iStartX
72153>>>>>>>        Else ;            Move (nStartX*100) to iStartX
72155>>>>>>>        
72155>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            Move nStartY to iStartY
72158>>>>>>>        Else ;            Move (nStartY*100) to iStartY
72160>>>>>>>        
72160>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            Move nWidth to iWidth
72163>>>>>>>        Else ;            Move (nWidth*100) to iWidth
72165>>>>>>>        
72165>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            Move nHeight to iHeight
72168>>>>>>>        Else ;            Move (nHeight*100) to iHeight
72170>>>>>>>        
72170>>>>>>>        Get_File_Path sFileName to sFileName
72171>>>>>>>        Move (WP_DrawBitmap(sFileName,iStartX,iStartY,iWidth,iHeight,bUCp)) to bOk
72172>>>>>>>        
72172>>>>>>>        If not bOk Begin
72174>>>>>>>            Error DFERR_WINPRINT DFPrintError932
72175>>>>>>>>
72175>>>>>>>        End
72175>>>>>>>>
72175>>>>>>>    End_Procedure
72176>>>>>>>    
72176>>>>>>>    
72176>>>>>>>    //
72176>>>>>>>    Procedure DFHeaderLineCheck Integer iLines
72178>>>>>>>        Boolean bOk
72178>>>>>>>        
72178>>>>>>>        Move (WP_SetExtraLineCheck(iLines)) to bOk
72179>>>>>>>        
72179>>>>>>>        If not bOk Begin
72181>>>>>>>            Error DFERR_WINPRINT DFPrintError934
72182>>>>>>>>
72182>>>>>>>        End
72182>>>>>>>>
72182>>>>>>>    End_Procedure
72183>>>>>>>    
72183>>>>>>>    
72183>>>>>>>    //
72183>>>>>>>    Procedure DFPrintFlags Integer Flags
72185>>>>>>>        Boolean bOk
72185>>>>>>>        
72185>>>>>>>        Move (WP_SetPrintDialogFlags(Flags)) to bOk
72186>>>>>>>        
72186>>>>>>>        If not bOk Begin
72188>>>>>>>            Error DFERR_WINPRINT DFPrintError935
72189>>>>>>>>
72189>>>>>>>        End
72189>>>>>>>>
72189>>>>>>>    End_Procedure
72190>>>>>>>    
72190>>>>>>>    
72190>>>>>>>    // obsolete and maintained for winprint-I backwards compatibility (maybe should be removed)
72190>>>>>>>    //
72190>>>>>>>    Procedure DFSelectPrinter String sDriver String sDevice String sPort Boolean bUpdate
72192>>>>>>>        Send DFSetDevice sDevice
72193>>>>>>>    End_Procedure
72194>>>>>>>    
72194>>>>>>>    // Preferred usage for WinprintII
72194>>>>>>>    Procedure DFSetDevice String sDevice
72196>>>>>>>        Boolean bOk
72196>>>>>>>        
72196>>>>>>>        Move (WP_SelectPrinter(sDevice)) to bOk
72197>>>>>>>        
72197>>>>>>>        If not bOk Begin
72199>>>>>>>            Error DFERR_WINPRINT DFPrintError936
72200>>>>>>>>
72200>>>>>>>        End
72200>>>>>>>>
72200>>>>>>>    End_Procedure
72201>>>>>>>    
72201>>>>>>>    Procedure DFPrinterBinFirstPage Integer eBin
72203>>>>>>>        Boolean bOk
72203>>>>>>>        
72203>>>>>>>        Move (WP_SetFirstPagePaperSource(eBin)) to bOk
72204>>>>>>>        
72204>>>>>>>        If not bOk Begin
72206>>>>>>>            Error DFERR_WINPRINT DFPrintError937
72207>>>>>>>>
72207>>>>>>>        End
72207>>>>>>>>
72207>>>>>>>    End_Procedure
72208>>>>>>>    
72208>>>>>>>    
72208>>>>>>>    //
72208>>>>>>>    Function DFGetDFColor Integer iRed Integer iGreen Integer iBlue Returns Integer
72210>>>>>>>        Integer iColor
72210>>>>>>>        
72210>>>>>>>        Move (WP_RGBToDFPrintColor(iRed,iGreen,iBlue)) to iColor
72211>>>>>>>        
72211>>>>>>>        If (iColor=0) Begin
72213>>>>>>>            Error DFERR_WINPRINT DFPrintError938
72214>>>>>>>>
72214>>>>>>>        End
72214>>>>>>>>
72214>>>>>>>        Function_Return iColor
72215>>>>>>>    End_Function
72216>>>>>>>    
72216>>>>>>>    
72216>>>>>>>    //
72216>>>>>>>    Procedure DFSetDFColor DWord dwColor
72218>>>>>>>        Integer bOk
72218>>>>>>>        
72218>>>>>>>        Move (WP_SetFontColor(dwColor)) to bOk
72219>>>>>>>        
72219>>>>>>>        If not bOk Begin
72221>>>>>>>            Error DFERR_WINPRINT DFPrintError939
72222>>>>>>>>
72222>>>>>>>        End
72222>>>>>>>>
72222>>>>>>>    End_Procedure
72223>>>>>>>    
72223>>>>>>>    
72223>>>>>>>    //
72223>>>>>>>    Procedure DFSetTopBottom Number nTop Number nBottom Boolean bAllPages
72225>>>>>>>        Boolean bOk
72225>>>>>>>        Integer iTop iBottom
72225>>>>>>>        
72225>>>>>>>        Move (nTop*100)    to iTop
72226>>>>>>>        Move (nBottom*100) to iBottom
72227>>>>>>>        
72227>>>>>>>        Move (WP_SetAbsoluteMargins(iTop,iBottom,bAllPages)) to bOk
72228>>>>>>>        
72228>>>>>>>        If not bOk Begin
72230>>>>>>>            Error DFERR_WINPRINT DFPrintError940
72231>>>>>>>>
72231>>>>>>>        End
72231>>>>>>>>
72231>>>>>>>    End_Procedure
72232>>>>>>>    
72232>>>>>>>    
72232>>>>>>>    //
72232>>>>>>>    Procedure DFSetJMode Integer eAlign
72234>>>>>>>        Boolean bOk
72234>>>>>>>        
72234>>>>>>>        Move (WP_SetAlign(eAlign)) to bOk
72235>>>>>>>        
72235>>>>>>>        If not bOk Begin
72237>>>>>>>            Error DFERR_WINPRINT DFPrintError941
72238>>>>>>>>
72238>>>>>>>        End
72238>>>>>>>>
72238>>>>>>>    End_Procedure
72239>>>>>>>    
72239>>>>>>>    
72239>>>>>>>    //
72239>>>>>>>    Procedure DFWriteEllip Number nStartX Number nStartY Number nHeight Number nWidth ;            DWord dwBColor DWord dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
72241>>>>>>>        
72241>>>>>>>        Boolean bOk
72241>>>>>>>        Integer iWeight
72241>>>>>>>        Integer iStartX iStartY iHeight iWidth
72241>>>>>>>        
72241>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            Move nStartX to iStartX
72244>>>>>>>        Else ;            Move (nStartX*100) to iStartX
72246>>>>>>>        
72246>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            Move nStartY to iStartY
72249>>>>>>>        Else ;            Move (nStartY*100) to iStartY
72251>>>>>>>        
72251>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            Move nWidth to iWidth
72254>>>>>>>        Else ;            Move (nWidth*100) to iWidth
72256>>>>>>>        
72256>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            Move nHeight to iHeight
72259>>>>>>>        Else ;            Move (nHeight*100) to iHeight
72261>>>>>>>        
72261>>>>>>>        Move (nWeight*100) to iWeight
72262>>>>>>>        
72262>>>>>>>        
72262>>>>>>>        Move (WP_DrawEllipse(iStartX,iStartY,iWidth,iHeight,;            dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) to bOk
72263>>>>>>>        
72263>>>>>>>        If not bOk Begin
72265>>>>>>>            Error DFERR_WINPRINT DFPrintError942
72266>>>>>>>>
72266>>>>>>>        End
72266>>>>>>>>
72266>>>>>>>    End_Procedure
72267>>>>>>>    
72267>>>>>>>    
72267>>>>>>>    
72267>>>>>>>    
72267>>>>>>>    //
72267>>>>>>>    Procedure DFWriteRect Number nStartX Number nStartY Number nHeight Number nWidth;            DWord dwBColor DWord dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
72269>>>>>>>        
72269>>>>>>>        Boolean bOk
72269>>>>>>>        Integer iWeight
72269>>>>>>>        Integer iStartX iStartY iHeight iWidth
72269>>>>>>>        
72269>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            Move nStartX to iStartX
72272>>>>>>>        Else ;            Move (nStartX*100) to iStartX
72274>>>>>>>        
72274>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            Move nStartY to iStartY
72277>>>>>>>        Else ;            Move (nStartY*100) to iStartY
72279>>>>>>>        
72279>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            Move nWidth to iWidth
72282>>>>>>>        Else ;            Move (nWidth*100) to iWidth
72284>>>>>>>        
72284>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            Move nHeight to iHeight
72287>>>>>>>        Else ;            Move (nHeight*100) to iHeight
72289>>>>>>>        
72289>>>>>>>        Move (nWeight*100) to iWeight
72290>>>>>>>        
72290>>>>>>>        Move (WP_DrawRectangle(iStartX,iStartY,iWidth,iHeight,;            dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) to bOk
72291>>>>>>>        
72291>>>>>>>        If not bOk Begin
72293>>>>>>>            Error DFERR_WINPRINT DFPrintError944
72294>>>>>>>>
72294>>>>>>>        End
72294>>>>>>>>
72294>>>>>>>    End_Procedure
72295>>>>>>>    
72295>>>>>>>    
72295>>>>>>>    
72295>>>>>>>    
72295>>>>>>>    //
72295>>>>>>>    Procedure DFLineCheck Integer iLines
72297>>>>>>>        Boolean bOk
72297>>>>>>>        
72297>>>>>>>        Move (WP_ConfirmLines(iLines)) to bOk
72298>>>>>>>        
72298>>>>>>>        If not bOk Begin
72300>>>>>>>            Error DFERR_WINPRINT DFPrintError946
72301>>>>>>>>
72301>>>>>>>        End
72301>>>>>>>>
72301>>>>>>>    End_Procedure
72302>>>>>>>    
72302>>>>>>>    
72302>>>>>>>    //
72302>>>>>>>    Procedure DFCreateDiagram Integer eType Integer eFx Number nHeight Number nWidth Integer bXyAxis
72304>>>>>>>        Handle hDiagram
72304>>>>>>>        Integer iWidth iHeight
72304>>>>>>>        
72304>>>>>>>        Move (nHeight*100) to iHeight
72305>>>>>>>        Move (nWidth*100)  to iWidth
72306>>>>>>>        
72306>>>>>>>        Set DFCurrent_Color to 0
72307>>>>>>>        
72307>>>>>>>        Move (WP_CreateDiagram(eType,eFx,iWidth,iHeight,bXyAxis)) to hDiagram
72308>>>>>>>        
72308>>>>>>>        If (hDiagram) Begin
72310>>>>>>>            Error DFERR_WINPRINT DFPrintError947
72311>>>>>>>>
72311>>>>>>>        End
72311>>>>>>>>
72311>>>>>>>        Else Begin
72312>>>>>>>            Set DFCurrent_Diagram to hDiagram
72313>>>>>>>        End
72313>>>>>>>>
72313>>>>>>>    End_Procedure
72314>>>>>>>    
72314>>>>>>>    
72314>>>>>>>    //
72314>>>>>>>    Procedure DFDiagram_Item Handle hDiagram String sLabel Number nValue;            DWord dwBColor DWord dwFColor Integer eFill;            Integer iDec Integer eValueOrPercent Integer eExt
72316>>>>>>>        
72316>>>>>>>        Boolean bOk
72316>>>>>>>        Integer iCurrColor iValue
72316>>>>>>>        
72316>>>>>>>        If (dwFColor = -1) Begin
72318>>>>>>>            Get DFCurrent_Color to iCurrColor
72319>>>>>>>            Increment iCurrColor
72320>>>>>>>            If (iCurrColor>15) ;                Move 1 to iCurrColor
72323>>>>>>>            Set DFCurrent_Color to iCurrColor
72324>>>>>>>            Get DFGetColor iCurrColor to dwFColor
72325>>>>>>>        End
72325>>>>>>>>
72325>>>>>>>        
72325>>>>>>>        Move (nValue *100) to iValue
72326>>>>>>>        
72326>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
72327>>>>>>>        
72327>>>>>>>        Move (WP_AddDiagramEntry(hDiagram,sLabel,iValue,dwBColor,dwFColor,eFill,iDec,eValueorPercent,eExt)) to bOk
72328>>>>>>>        
72328>>>>>>>        If not bOk Begin
72330>>>>>>>            Error DFERR_WINPRINT DFPrintError948
72331>>>>>>>>
72331>>>>>>>        End
72331>>>>>>>>
72331>>>>>>>    End_Procedure
72332>>>>>>>    
72332>>>>>>>    
72332>>>>>>>    //
72332>>>>>>>    Procedure DFLockDiagram Handle hDiagram
72334>>>>>>>        Boolean bOk
72334>>>>>>>        
72334>>>>>>>        Move (WP_LockDiagram(hDiagram)) to bOk
72335>>>>>>>        
72335>>>>>>>        If not bOk Begin
72337>>>>>>>            Error DFERR_WINPRINT DFPrintError949
72338>>>>>>>>
72338>>>>>>>        End
72338>>>>>>>>
72338>>>>>>>    End_Procedure
72339>>>>>>>    
72339>>>>>>>    
72339>>>>>>>    
72339>>>>>>>    //
72339>>>>>>>    Procedure DFDrawDiagram Handle hDiagram Number nYPos Number nXPos Boolean bUCp
72341>>>>>>>        Boolean bOk
72341>>>>>>>        Integer iXPos
72341>>>>>>>        Integer iYPos
72341>>>>>>>        
72341>>>>>>>        Move (nXPos*100) to iXPos
72342>>>>>>>        Move (nYPos*100) to iYPos
72343>>>>>>>        
72343>>>>>>>        If (nYPos = -999) ;            Move -999 to iYPos
72346>>>>>>>        
72346>>>>>>>        Move (WP_DrawDiagram(hDiagram,iXPos,iYPos,bUCp)) to bOk
72347>>>>>>>        
72347>>>>>>>        If not bOk Begin
72349>>>>>>>            Error DFERR_WINPRINT DFPrintError950
72350>>>>>>>>
72350>>>>>>>        End
72350>>>>>>>>
72350>>>>>>>    End_Procedure
72351>>>>>>>    
72351>>>>>>>    
72351>>>>>>>    
72351>>>>>>>    //
72351>>>>>>>    Procedure DFDiagramLabel Handle hDiagram String sLabel
72353>>>>>>>        Boolean bOk
72353>>>>>>>        Integer iLabelLen
72353>>>>>>>        
72353>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
72354>>>>>>>        
72354>>>>>>>        Move (WP_SetDiagramCaption(hDiagram,sLabel)) to bOk
72355>>>>>>>        
72355>>>>>>>        If not bOk Begin
72357>>>>>>>            Error DFERR_WINPRINT DFPrintError952
72358>>>>>>>>
72358>>>>>>>        End
72358>>>>>>>>
72358>>>>>>>    End_Procedure
72359>>>>>>>    
72359>>>>>>>    
72359>>>>>>>    //
72359>>>>>>>    Procedure DFDiagramXLabel Handle hDiagram String sLabel
72361>>>>>>>        Boolean bOk
72361>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
72362>>>>>>>        
72362>>>>>>>        Move (WP_SetDiagramXText(hDiagram,sLabel)) to bOk
72363>>>>>>>        
72363>>>>>>>        If not bOk Begin
72365>>>>>>>            Error DFERR_WINPRINT DFPrintError953
72366>>>>>>>>
72366>>>>>>>        End
72366>>>>>>>>
72366>>>>>>>    End_Procedure
72367>>>>>>>    
72367>>>>>>>    
72367>>>>>>>    //
72367>>>>>>>    Procedure DFDiagramYLabel Handle hDiagram String sLabel Boolean bVertical
72369>>>>>>>        Boolean bOk
72369>>>>>>>        Move (ToAnsi(sLabel)) to sLabel
72370>>>>>>>        
72370>>>>>>>        Move (WP_SetDiagramYText(hDiagram,sLabel,bVertical)) to bOk
72371>>>>>>>        
72371>>>>>>>        If not bOk Begin
72373>>>>>>>            Error DFERR_WINPRINT DFPrintError954
72374>>>>>>>>
72374>>>>>>>        End
72374>>>>>>>>
72374>>>>>>>    End_Procedure
72375>>>>>>>    
72375>>>>>>>    
72375>>>>>>>    //
72375>>>>>>>    Procedure DFWriteXYLine Number nStartX Number nStartY Number nStopX Number nStopY;            DWord dwColor Number nWeight Boolean bWrap Boolean bUCp
72377>>>>>>>        
72377>>>>>>>        Boolean bOk
72377>>>>>>>        Integer iStartX iStartY iStopX iStopY
72377>>>>>>>        Integer iWeight
72377>>>>>>>        
72377>>>>>>>        Move (nStartX*100)  to iStartX
72378>>>>>>>        Move (nStartY*100)  to iStartY
72379>>>>>>>        Move (nStopX*100)   to iStopX
72380>>>>>>>        Move (nStopY*100)   to iStopY
72381>>>>>>>        
72381>>>>>>>        Move (nWeight*100) to iWeight
72382>>>>>>>        
72382>>>>>>>        If (nStopY  = -998) ;            Move -998 to iStopY
72385>>>>>>>        If (nStopX  = -998) ;            Move -998 to iStopX
72388>>>>>>>        
72388>>>>>>>        If (nStartY  = -999) ;            Move -999 to iStartY
72391>>>>>>>        If (nStartX  = -999) ;            Move -999 to iStartX
72394>>>>>>>        
72394>>>>>>>        Move (WP_DrawXYLine(iStartX,iStartY,iStopX,iStopY,dwColor,iWeight,bUCp,bWrap)) to bOk
72395>>>>>>>        
72395>>>>>>>        If not bOk Begin
72397>>>>>>>            Error DFERR_WINPRINT DFPrintError955
72398>>>>>>>>
72398>>>>>>>        End
72398>>>>>>>>
72398>>>>>>>    End_Procedure
72399>>>>>>>    
72399>>>>>>>    
72399>>>>>>>    //
72399>>>>>>>    Procedure DFWriteLine Number nStartX Number nStartY Number nLength;            Boolean bHorizontal DWord dwColor Number nWeight Boolean bUCp
72401>>>>>>>        
72401>>>>>>>        Boolean bOk
72401>>>>>>>        Integer iStartX iStartY iLength
72401>>>>>>>        Integer iWeight
72401>>>>>>>        
72401>>>>>>>        Move (nStartX*100)  to iStartX
72402>>>>>>>        Move (nStartY*100)  to iStartY
72403>>>>>>>        Move (nLength*100)  to iLength
72404>>>>>>>        Move (nWeight*100)  to iWeight
72405>>>>>>>        
72405>>>>>>>        If (nStartY = -999) ;            Move -999 to iStartY
72408>>>>>>>        If (nStartX = -999) ;            Move -999 to iStartX
72411>>>>>>>        If (nLength = -998) ;            Move -998 to iLength
72414>>>>>>>        
72414>>>>>>>        Move (WP_DrawLine(iSTartX,iStartY,iLength,bHorizontal,dwColor,iWeight,bUCp)) to bOk
72415>>>>>>>        
72415>>>>>>>        If not bOk Begin
72417>>>>>>>            Error DFERR_WINPRINT DFPrintError956
72418>>>>>>>>
72418>>>>>>>        End
72418>>>>>>>>
72418>>>>>>>    End_Procedure
72419>>>>>>>    
72419>>>>>>>    
72419>>>>>>>    //
72419>>>>>>>    Procedure DFClearPrinter
72421>>>>>>>        Boolean bOk
72421>>>>>>>        
72421>>>>>>>        Move (WP_ClearPrinter()) to bOk
72422>>>>>>>        
72422>>>>>>>        If not bOk Begin
72424>>>>>>>            Error DFERR_WINPRINT DFPrintError957
72425>>>>>>>>
72425>>>>>>>        End
72425>>>>>>>>
72425>>>>>>>    End_Procedure
72426>>>>>>>    
72426>>>>>>>    
72426>>>>>>>    
72426>>>>>>>    //
72426>>>>>>>    Function DFGetCurrentDevice Returns String
72428>>>>>>>        Boolean bOk
72428>>>>>>>        String  sDFStr
72428>>>>>>>        Address pDFStr
72428>>>>>>>        
72428>>>>>>>        Move (Repeat( Character(0), 255 )) to sDFStr
72429>>>>>>>        Move (AddressOf(sDFStr)) to pDFStr
72430>>>>>>>        
72430>>>>>>>        Move (WP_GetCurrentDevice(pDFStr)) to bOk
72431>>>>>>>        
72431>>>>>>>        If not bOk Begin
72433>>>>>>>            Error DFERR_WINPRINT DFPrintError959
72434>>>>>>>>
72434>>>>>>>        End
72434>>>>>>>>
72434>>>>>>>        
72434>>>>>>>        Move (CString(sDFStr)) to sDFStr
72435>>>>>>>        Function_Return sDFStr
72436>>>>>>>    End_Function
72437>>>>>>>    
72437>>>>>>>    
72437>>>>>>>    // Note: DfGetCurrentPort and DFGetCurrentDriver do not exist in winprint2. Trying to
72437>>>>>>>    //       use these will result in a runtime error (which is good - don't use them)
72437>>>>>>>    
72437>>>>>>>    
72437>>>>>>>    //
72437>>>>>>>    Function DFGetPrintDialogFlags Returns DWord
72439>>>>>>>        DWord dwRetVal
72439>>>>>>>        
72439>>>>>>>        Move (WP_GetPrintDialogFlags()) to dwRetVal
72440>>>>>>>        
72440>>>>>>>        Function_Return dwRetVal
72441>>>>>>>    End_Function
72442>>>>>>>    
72442>>>>>>>    
72442>>>>>>>    //
72442>>>>>>>    // Returns PRN_TRUE=  if the flag is set     (1)
72442>>>>>>>    // Returns PRN_FALSE= If the flag not is set (0)
72442>>>>>>>    //
72442>>>>>>>    Function DFCheckPrintDialogFlag DWord dwPDFlag Returns Boolean
72444>>>>>>>        Boolean bIsSet
72444>>>>>>>        
72444>>>>>>>        Move (WP_IsPrintDialogFlagSet(dwPDFlag)) to bIsSet
72445>>>>>>>        
72445>>>>>>>        Function_Return bIsSet
72446>>>>>>>    End_Function
72447>>>>>>>    
72447>>>>>>>    
72447>>>>>>>    //
72447>>>>>>>    Procedure DFSetSpecPrintFlag DWord dwPDFlag
72449>>>>>>>        Boolean bOk
72449>>>>>>>        
72449>>>>>>>        Move (WP_SetSpecificPrintDialogFlag(dwPDFlag)) to bOk
72450>>>>>>>        
72450>>>>>>>        If not bOk Begin
72452>>>>>>>            Error DFERR_WINPRINT DFPrintError961
72453>>>>>>>>
72453>>>>>>>        End
72453>>>>>>>>
72453>>>>>>>    End_Procedure
72454>>>>>>>    
72454>>>>>>>    
72454>>>>>>>    //
72454>>>>>>>    Function DFGetUserDefinedLength Returns Number
72456>>>>>>>        Integer iRetVal
72456>>>>>>>        Number  nRetVal
72456>>>>>>>        
72456>>>>>>>        Move (WP_GetUserDefinedPapersize()) to iRetVal
72457>>>>>>>        
72457>>>>>>>        If (iRetVal=0) Begin
72459>>>>>>>            Error DFERR_WINPRINT DFPrintError962
72460>>>>>>>>
72460>>>>>>>            Function_Return 0
72461>>>>>>>        End
72461>>>>>>>>
72461>>>>>>>        
72461>>>>>>>        Move (Hi(iRetVal)) to nRetVal
72462>>>>>>>        Move (nRetVal/100) to nRetVal //Returns CM
72463>>>>>>>        
72463>>>>>>>        Function_Return nRetVal
72464>>>>>>>    End_Function
72465>>>>>>>    
72465>>>>>>>    
72465>>>>>>>    //
72465>>>>>>>    Function DFGetUserDefinedWidth Returns Number
72467>>>>>>>        Integer iRetVal
72467>>>>>>>        Number  nRetVal
72467>>>>>>>        
72467>>>>>>>        Move (WP_GetUserDefinedPapersize()) to iRetVal
72468>>>>>>>        
72468>>>>>>>        If (iRetVal=0) Begin
72470>>>>>>>            Error DFERR_WINPRINT DFPrintError963
72471>>>>>>>>
72471>>>>>>>            Function_Return 0
72472>>>>>>>        End
72472>>>>>>>>
72472>>>>>>>        
72472>>>>>>>        Move (Low(iRetVal)) to nRetVal
72473>>>>>>>        Move (nRetVal/100) to nRetVal //Returns CM
72474>>>>>>>        
72474>>>>>>>        Function_Return nRetVal
72475>>>>>>>    End_Function
72476>>>>>>>    
72476>>>>>>>    
72476>>>>>>>    // To be set in CM
72476>>>>>>>    Procedure DFSetUserDefinedPapersize Number nLength Number nWidth
72478>>>>>>>        Integer bOk
72478>>>>>>>        Integer iLength iWidth iSize
72478>>>>>>>        
72478>>>>>>>        Move (nLength*100) to iLength
72479>>>>>>>        Move (nWidth*100)  to iWidth
72480>>>>>>>        Move ((iLength*65536)+iWidth) to iSize
72481>>>>>>>        
72481>>>>>>>        Move (WP_SetUserDefinedPapersize(iSize)) to bOk
72482>>>>>>>        
72482>>>>>>>        If not bOk Begin
72484>>>>>>>            Error DFERR_WINPRINT DFPrintError964
72485>>>>>>>>
72485>>>>>>>        End
72485>>>>>>>>
72485>>>>>>>    End_Procedure
72486>>>>>>>    
72486>>>>>>>    Procedure DFSetNumberOfCopies Integer iNrOfCopies
72488>>>>>>>        Boolean bOk
72488>>>>>>>        
72488>>>>>>>        Move (WP_SetNumberOfPrintCopies(iNrOfCopies)) to bOk
72489>>>>>>>        
72489>>>>>>>        If not bOk Begin
72491>>>>>>>            Error DFERR_WINPRINT DFPrintError965
72492>>>>>>>>
72492>>>>>>>        End
72492>>>>>>>>
72492>>>>>>>    End_Procedure
72493>>>>>>>    
72493>>>>>>>    
72493>>>>>>>    
72493>>>>>>>    
72493>>>>>>>    // This procedures and functions are used when building 
72493>>>>>>>    // complex graphics when you need to change value of the
72493>>>>>>>    // current diagram, so you can mix diagrams within each 
72493>>>>>>>    // other.                                               
72493>>>>>>>    
72493>>>>>>>    
72493>>>>>>>    Function DFGetCurrentDiagram Returns Integer
72495>>>>>>>        Integer iRetVal
72495>>>>>>>        Get DFCurrent_Diagram to iRetVal
72496>>>>>>>        Function_Return iRetVal
72497>>>>>>>    End_Function
72498>>>>>>>    
72498>>>>>>>    Procedure DFSetCurrentDiagram Integer iDiagram
72500>>>>>>>        Set DFCurrent_Diagram to iDiagram
72501>>>>>>>    End_Procedure
72502>>>>>>>    
72502>>>>>>>    Procedure DFSetDiagramList Integer iItem Integer iDiagram
72504>>>>>>>        Set Value of oDiagramArray iItem to iDiagram
72505>>>>>>>    End_Procedure
72506>>>>>>>    
72506>>>>>>>    Function DFGetDiagramList Integer iItem Returns Integer
72508>>>>>>>        Integer iRetVal
72508>>>>>>>        Get Value of oDiagramArray iItem to iRetVal
72509>>>>>>>        Function_Return iRetVal
72510>>>>>>>    End_Function
72511>>>>>>>    
72511>>>>>>>    Procedure DFClearDiagramList
72513>>>>>>>        Send Delete_Data to oDiagramArray
72514>>>>>>>    End_Procedure
72515>>>>>>>    
72515>>>>>>>    
72515>>>>>>>    Function DFGetColor Integer iColor Returns DWord
72517>>>>>>>        DWord   dwRetVal
72517>>>>>>>        Get Value of oDFColorArray iColor to dwRetVal
72518>>>>>>>        Function_Return dwRetVal
72519>>>>>>>    End_Function
72520>>>>>>>    
72520>>>>>>>    Function DFGetCurrentColor Returns DWord
72522>>>>>>>        DWord   dwRetVal
72522>>>>>>>        Integer iCurrColor
72522>>>>>>>        
72522>>>>>>>        Get DFCurrent_Color to iCurrColor
72523>>>>>>>        Get DFGetColor iCurrColor to dwRetVal
72524>>>>>>>        
72524>>>>>>>        Function_Return dwRetVal
72525>>>>>>>    End_Function
72526>>>>>>>    
72526>>>>>>>    Procedure DFEndDocument
72528>>>>>>>        Integer iVoid
72528>>>>>>>        Move (WP_EndDocument()) to iVoid
72529>>>>>>>        Send DfSuspendGui False
72530>>>>>>>    End_Procedure
72531>>>>>>>    
72531>>>>>>>    Procedure DFClosePreview
72533>>>>>>>        Integer iVoid
72533>>>>>>>        Move (WP_ClosePreview()) to iVoid
72534>>>>>>>        Send DfSuspendGui False
72535>>>>>>>    End_Procedure
72536>>>>>>>    
72536>>>>>>>    Procedure SetProgressCaption String sCaption
72538>>>>>>>        Integer iVoid
72538>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
72539>>>>>>>        Move (WP_SetProgressCaption(sCaption)) to iVoid
72540>>>>>>>    End_Procedure
72541>>>>>>>    
72541>>>>>>>    Procedure SetReportTitle String sTitle
72543>>>>>>>        Integer iVoid
72543>>>>>>>        Move (ToAnsi(sTitle)) to sTitle
72544>>>>>>>        Move (WP_SetReportTitle(sTitle)) to iVoid
72545>>>>>>>    End_Procedure
72546>>>>>>>    
72546>>>>>>>    Function PreviewYesNoBox String sCaption String sText Returns Integer
72548>>>>>>>        Integer eResult
72548>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
72549>>>>>>>        Move (ToAnsi(sText))    to sText
72550>>>>>>>        Move (WP_DisplayMessageBox(sCaption, sText)) to eResult
72551>>>>>>>        Function_Return eResult
72552>>>>>>>    End_Function
72553>>>>>>>    
72553>>>>>>>    // internal function, used to extract different printer flags ranges based on
72553>>>>>>>    // the print flag integer. These flags use a decimal style of packing information
72553>>>>>>>    // where different printer options (paper, bin, etc) use different ranges and
72553>>>>>>>    // different steps. Everything above iTopVal is removed and everything that is not
72553>>>>>>>    // within the iStep range is removed.
72553>>>>>>>    Function PrintFlagRange Integer iTopVal Integer iStep Returns Integer
72555>>>>>>>        Integer iFgs iFg
72555>>>>>>>        Get DFGetPrintDialogFlags to iFg
72556>>>>>>>        Move (mod(iFg,iTopVal) / iStep * iStep ) to iFg
72557>>>>>>>        Function_Return iFg
72558>>>>>>>    End_Function
72559>>>>>>>    
72559>>>>>>>    Procedure DFSetPrinterPaper Integer ePaperType
72561>>>>>>>        Send DFSetSpecPrintFlag ePaperType
72562>>>>>>>    End_Procedure
72563>>>>>>>    
72563>>>>>>>    Function DFGetPrinterPaper Returns Integer //ePaperType
72565>>>>>>>        Integer ePaperType
72565>>>>>>>        Get PrintFlagRange 500 10 to ePaperType // 10-490 in steps of 10
72566>>>>>>>        Function_Return ePaperType
72567>>>>>>>    End_Function
72568>>>>>>>    
72568>>>>>>>    
72568>>>>>>>    Procedure DFSetPrinterBin Integer eBinType
72570>>>>>>>        Send DFSetSpecPrintFlag eBinType
72571>>>>>>>    End_Procedure
72572>>>>>>>    
72572>>>>>>>    Function DFGetPrinterBin Returns Integer //eBinType
72574>>>>>>>        Integer eBinType
72574>>>>>>>        Get PrintFlagRange 10000 500 to eBinType // 1000-9000 steps 500
72575>>>>>>>        Function_Return eBinType
72576>>>>>>>    End_Function
72577>>>>>>>    
72577>>>>>>>    
72577>>>>>>>    Procedure DFSetPrinterResolution Integer eResType
72579>>>>>>>        Send DFSetSpecPrintFlag eResType
72580>>>>>>>    End_Procedure
72581>>>>>>>    
72581>>>>>>>    Function DFGetPrinterResolution Returns Integer //eResType
72583>>>>>>>        Integer eResType
72583>>>>>>>        Get PrintFlagRange 50000 10000 to eResType // 10000-500000 steps 10000
72584>>>>>>>        Function_Return eResType
72585>>>>>>>    End_Function
72586>>>>>>>    
72586>>>>>>>    
72586>>>>>>>    Procedure DFSetLandscape Boolean bIsLandscape
72588>>>>>>>        Send DFSetSpecPrintFlag (If(bIsLandscape,DF_Landscape,DF_Portrait))
72589>>>>>>>    End_Procedure
72590>>>>>>>    
72590>>>>>>>    Function DFGetLandscape Returns Boolean // bIsLandscape
72592>>>>>>>        Boolean bIsLandscape
72592>>>>>>>        Get DFCheckPrintDialogFlag DF_Landscape to bIsLandscape
72593>>>>>>>        Function_Return bIsLandscape
72594>>>>>>>    End_Function
72595>>>>>>>    
72595>>>>>>>    Function RGBToWPColor Integer iRgb Returns Integer
72597>>>>>>>        Integer iRed iGreen iBlue
72597>>>>>>>        Integer iWPColor
72597>>>>>>>        Move (R_from_rgb(iRGB)) to iRed
72598>>>>>>>        Move (G_from_rgb(iRGB)) to iGreen
72599>>>>>>>        Move (B_from_rgb(iRGB)) to iBlue
72600>>>>>>>        Get DfGetDfColor iRed iGreen iBlue to iWPColor
72601>>>>>>>        Function_Return iWPColor
72602>>>>>>>    End_Function
72603>>>>>>>    
72603>>>>>>>    
72603>>>>>>>    
72603>>>>>>>End_Class
72604>>>>>>>
72604>>>>>>>Global_Variable Integer ghoWinPrint2
72604>>>>>>>
72604>>>>>>>Get Create of desktop U_cWinPrint2 to ghoWinPrint2
72605>>>>>Use Winprint_Commands.pkg  // commands used by this class
Including file: Winprint_Commands.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Winprint_Commands.pkg)
72605>>>>>>>// Commands used by Winprint (old and new).
72605>>>>>>>Global_Variable Integer WinPrintId  // Provide simple access to global object //JT
72605>>>>>>>Move 0 to WinPrintId
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// With the DFWRITE/LN commands you can use 1-3 arguments
72606>>>>>>>// 1. Not Required = Text
72606>>>>>>>// 2. Not Req. = FonstStyle
72606>>>>>>>// 3. Not Req. = Number of decimals
72606>>>>>>>//    !!! If you want to set decimals you MUST use all 3 arguments
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// With the WRITECOL/LN commands you can use 2-4 arguments
72606>>>>>>>// 1. Required = Text
72606>>>>>>>// 2. Required = Column to write to
72606>>>>>>>// 3. Not Req. = FonstStyle
72606>>>>>>>// 4. Not Req. = Number of decimals
72606>>>>>>>//    !!! If you want to set decimals you MUST use all 4 arguments
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// With the WWRITEPOS/LN commands you can use 2-4 arguments
72606>>>>>>>// 1. Required = Text
72606>>>>>>>// 2. Required = Position to start at from left margin. Depending
72606>>>>>>>//    on if DFCurrent_Metrics is set to CM or INCH
72606>>>>>>>// 3. Not Req. = FonstStyle
72606>>>>>>>// 4. Not Req. = Number of decimals
72606>>>>>>>//    !!! If you want to set decimals you MUST use all 4 arguments
72606>>>>>>>// 5. Max length (0 means no max)
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// Following command sets the font and remains active until
72606>>>>>>>// you change to another font
72606>>>>>>>// 1. Required = A valid Windows font
72606>>>>>>>//
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// With the WFontsize command you can use 1-2 arguments
72606>>>>>>>// 1. Required = Hi
72606>>>>>>>// 2. Not Req. = Wi
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// Following commands sets the margins of your document
72606>>>>>>>// 1. Required = Margin in CM or INCH depending in metrics
72606>>>>>>>//
72606>>>>>>>// You can also use the procedure DFSetMargins to set all
72606>>>>>>>// margins at the same time.
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFBeginHeader creates a headertype of your choise
72606>>>>>>>// 1. Required = HeaderType
72606>>>>>>>// 2. Not Req. = Headernumber
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFEndHeader endns a header section. And prints the header.
72606>>>>>>>// Headers can NOT be nested
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFHeaderPos
72606>>>>>>>// 1. Required = Header position
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFHeaderFrame
72606>>>>>>>// 1. Required = Header frame type
72606>>>>>>>// 2. Not Req. = Weight of line
72606>>>>>>>// 3. Not Req. = line color        //RGB_??
72606>>>>>>>// 4. Not Reg. = Fill color        //RGB_??
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>// DFHeaderMargin (JvH)
72606>>>>>>>// 1. Required = Margin type
72606>>>>>>>//   HM_TOPOUTER    = 0   // margin above the top of the header's frame
72606>>>>>>>//   HM_TOPINNER    = 1   // margin below the top of the header's frame
72606>>>>>>>//   HM_BOTTOMINNER = 2   // margin above the bottom of the header's frame
72606>>>>>>>//   HM_BOTTOMOUTER = 3   // margin below the bottom of the header's frame
72606>>>>>>>// 2. Required = Size of margin
72606>>>>>>>//
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFHeaderWrap
72606>>>>>>>// 1. Required = On/Off
72606>>>>>>>// HDR_NOWRAP = 0
72606>>>>>>>// HDR_WRAP   = 1
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFHeaderLineCheck
72606>>>>>>>// 1. Required = Number of lines to check. Using last settings of font
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>// DFWriteBMP
72606>>>>>>>// 1. Required = Filename and path
72606>>>>>>>// 2. Required = Vertical start
72606>>>>>>>// 3. Required = Horizontal start
72606>>>>>>>// 4. Required = Height
72606>>>>>>>// 5. Required = Width
72606>>>>>>>// 6. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFWriteEllip
72606>>>>>>>// 1. Required = Vertical start
72606>>>>>>>// 2. Required = Horizontal start
72606>>>>>>>// 3. Required = Height
72606>>>>>>>// 4. Required = Width
72606>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72606>>>>>>>// 6. Not Req. = Weight of line
72606>>>>>>>// 7. Not Req. = Wrap to next page     //DFGR_NOWRAP,DFGR_WRAP
72606>>>>>>>// 8. Not Req. = Fill color            //RGB_??
72606>>>>>>>// 9. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFWriteRect
72606>>>>>>>// 1. Required = Vertical start
72606>>>>>>>// 2. Required = Horizontal start
72606>>>>>>>// 3. Required = Height
72606>>>>>>>// 4. Required = Width
72606>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72606>>>>>>>// 6. Not Req. = Weight of line
72606>>>>>>>// 7. Not Req. = Wrap to next page     //DFGR_NOWRAP,DFGR_WRAP
72606>>>>>>>// 8. Not Req. = Fill color            //RGB_??
72606>>>>>>>// 9. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFLineCheck
72606>>>>>>>// 1. Required = Number of lines to check. Using last settings of font
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFCreateDiagram
72606>>>>>>>// 1. Required = Type of diagram //DFGR_??
72606>>>>>>>// 2. Required = Type of effect  //DFGR_??
72606>>>>>>>// 3. Required = Height
72606>>>>>>>// 4. Required = Width
72606>>>>>>>// 5. Optional = Display XY Axis (true/false), valid ONLY for bar charts
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFWriteDiagram
72606>>>>>>>// 1. Required = Y-Position using current metrics //Constant can be used !!
72606>>>>>>>// 2. Required = X-Position using current metrics
72606>>>>>>>// 3. Optional = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFBeginDiagram
72606>>>>>>>// 1. Required = Type of diagram //DFGR_??
72606>>>>>>>// 2. Required = Type of effect  //DFGR_??
72606>>>>>>>// 3. Required = Y-Position using current metrics //Constant can be used !!
72606>>>>>>>// 4. Required = X-Position using current metrics
72606>>>>>>>// 5. Required = Height
72606>>>>>>>// 6. Required = Width
72606>>>>>>>// 7. Optional = Display XY Axis (true/false), valid ONLY for bar charts
72606>>>>>>>// 8. Optional = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFDiagram_Item
72606>>>>>>>// 1. Required = Value
72606>>>>>>>// 2. Required = Label
72606>>>>>>>// 3. Not Req. = No value, Value or percent DFGR_NOVAL,DFGR_VAL,DFGR_PER
72606>>>>>>>// 4. Not Req. = Number of decimals
72606>>>>>>>// 5. Not Req. = Move slice in pie     //DFGR_IN, DFGR_OUT
72606>>>>>>>// 6. Not Reg. = Fill color            //RGB_??
72606>>>>>>>// 8. Not Req. = Boarder color         //RGB_??
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFEndDiagram
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFDiagramLabel
72606>>>>>>>// 1. Required = Label text (top)
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFDiagramXLabel
72606>>>>>>>// 1. Required = Label text (top)
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFDiagramYLabel
72606>>>>>>>// 1. Required    = Label text (top)
72606>>>>>>>// 2. Orientation = Vertical/Horizontal
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFWriteXYLine
72606>>>>>>>// 1. Required = Vertical start
72606>>>>>>>// 2. Required = Horizontal start
72606>>>>>>>// 3. Required = Vertical stopp
72606>>>>>>>// 4. Required = Horizontal stopp
72606>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72606>>>>>>>// 6. Not Req. = Weight of line
72606>>>>>>>// 7. Not Req. = Wrap to next page     //DFGR_NOWRAP,DFGR_WRAP
72606>>>>>>>// 8. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFWriteLine
72606>>>>>>>// 1. Required = Vertical start
72606>>>>>>>// 2. Required = Horizontal start
72606>>>>>>>// 3. Required = Length
72606>>>>>>>// 4. Not Req. = Horizontal/Vertical   //RGB_HORI RGB_VERT
72606>>>>>>>// 5. Not Req. = Boarder/line color    //RGB_??
72606>>>>>>>// 6. Not Req. = Weight of line
72606>>>>>>>// 7. Not Req. = Set current position or not //DFGR_NOPOS, DFGR_SETPOS
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>>>// DFSetNumberOfCopies
72606>>>>>>>// 1. Required = Number of copies
72606>>>>>>>//
72606>>>>>>>
72606>>>>>>>
72606>>>>>
72606>>>>>Class cWinReport2 is a BasicReport
72607>>>>>    
72607>>>>>    Procedure Construct_Object
72609>>>>>        Forward Send construct_object
72611>>>>>        
72611>>>>>        Date Today
72611>>>>>        Sysdate Today
72612>>>>>        
72612>>>>>        // should use built in DF function CurrentDateTime()
72612>>>>>        Property Date  RptToday    Today
72613>>>>>        
72613>>>>>        Object RptTotal is an Array
72615>>>>>        End_Object
72616>>>>>        
72616>>>>>        // If true, report is output upon completion. Either preview
72616>>>>>        // or printer depending on output_device_mode
72616>>>>>        Property Boolean AutoOutput_State True
72617>>>>>        
72617>>>>>        // When a new page is created (DFNew_Page) and the number
72617>>>>>        // of columns is not passed, this is used.
72617>>>>>        Property Integer Print_Columns 0
72618>>>>>        
72618>>>>>        // This determines if a DFNew_Page should be executed when the
72618>>>>>        // report starts. In some rare cases, you would not want this to
72618>>>>>        // occur until a subheader
72618>>>>>        Property Boolean AutoNew_Page_State True
72619>>>>>        
72619>>>>>        // Output device (print or preview). Normally this is delegated to
72619>>>>>        // the report view.
72619>>>>>        //
72619>>>>>        
72619>>>>>        Property Integer Private.Output_Device_Mode PRINT_TO_UNDEFINED
72620>>>>>        
72620>>>>>        Property Handle phoWinPrint  ghoWinPrint2 // the report engine to use.
72621>>>>>        
72621>>>>>        // For now this is for testing.
72621>>>>>        Property Boolean pbModalViewer False
72622>>>>>        
72622>>>>>        Property Boolean pbMultiReports False
72623>>>>>        
72623>>>>>        Property Boolean pbFirstPagePrinted False
72624>>>>>        
72624>>>>>    End_Procedure
72625>>>>>    
72625>>>>>    // returns the current status of Winprint Document object. dsNotStarted, dsStarted, dsFinished
72625>>>>>    // note that the status can reflect a status from a different report. The winprint object is global.
72625>>>>>    Function DocumentStatus Returns Boolean
72627>>>>>        Integer iStatus
72627>>>>>        Get DocumentStatus of (phoWinprint(Self)) to iStatus
72628>>>>>        Function_Return iStatus
72629>>>>>    End_Function
72630>>>>>    
72630>>>>>    Function IsViewerActive Returns Boolean
72632>>>>>        Boolean bIsActive
72632>>>>>        Get IsViewerActive of (phoWinPrint(Self)) to bIsActive
72633>>>>>        Function_Return bIsActive
72634>>>>>    End_Function
72635>>>>>    
72635>>>>>    Function IsPrinterValid Returns Boolean
72637>>>>>        Function_Return (WP_IsPrinterValid()<>0)
72638>>>>>    End_Function
72639>>>>>    
72639>>>>>    Function ArePrintersInstalled Returns Boolean
72641>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
72642>>>>>    End_Function
72643>>>>>    
72643>>>>>    
72643>>>>>    // All subtotal commands use the outer main report. This makes it easier to keep
72643>>>>>    // track of these numbers
72643>>>>>    
72643>>>>>    Procedure Add_SubTotal Integer iCounter Number nData
72645>>>>>        Number nValue
72645>>>>>        Integer iObj
72645>>>>>        Move (RptTotal(Main_Report_Id(Self))) to iObj
72646>>>>>        Get Number_Value of iObj iCounter to nValue
72647>>>>>        Add nData to nValue
72648>>>>>        Set Array_Value of iObj iCounter to nValue
72649>>>>>    End_Procedure
72650>>>>>    
72650>>>>>    Procedure Clr_SubTotal Integer iCounter
72652>>>>>        Set Array_Value of (RptTotal(Main_Report_Id(Self))) iCounter to 0
72653>>>>>    End_Procedure
72654>>>>>    
72654>>>>>    Procedure Clr_AllSubTotals
72656>>>>>        Send Delete_Data of (RptTotal(Main_Report_Id(Self)))
72657>>>>>    End_Procedure
72658>>>>>    
72658>>>>>    Function Sum_SubTotal Integer iTotal Returns Number
72660>>>>>        Number nRetVal
72660>>>>>        Get Number_Value of (RptTotal(Main_Report_Id(Self))) iTotal to nRetVal
72661>>>>>        Function_Return nRetVal
72662>>>>>    End_Function
72663>>>>>    
72663>>>>>    //Return sub-total and clear accumulator
72663>>>>>    //
72663>>>>>    Function SubTotal Integer iTotal Returns Number
72665>>>>>        Number nRetVal
72665>>>>>        Get Sum_SubTotal  iTotal to nRetVal
72666>>>>>        Send Clr_SubTotal iTotal
72667>>>>>        Function_Return nRetVal
72668>>>>>    End_Function
72669>>>>>    
72669>>>>>    
72669>>>>>    // Note: Cols is optional. If no argument is passed it will use
72669>>>>>    //       the object's property Print_Columns (0 by default)
72669>>>>>    //
72669>>>>>    Procedure DFNew_Page Integer Cols
72671>>>>>        Integer PageNumber Columns
72671>>>>>        Boolean bFirstPagePrinted
72671>>>>>        // If no args passed used default setting
72671>>>>>        If (Num_Arguments=0) ;            Move (Print_Columns(Main_Report_id(Self))) to Columns
72674>>>>>        Else ;            Move Cols to Columns
72676>>>>>        Set Page_Feed   to -2   // No FormFeed
72677>>>>>        If (Child_Rpt_State(Self)) ;            Send DFNew_Page of (Main_Report_Id(Self)) Columns
72680>>>>>        Else Begin
72681>>>>>            // we only want to print report_header once. When report starts
72681>>>>>            // this is set true, after the first print it is false. You can set
72681>>>>>            // this to true before and explicit dfNew_page to force a header
72681>>>>>            Get pbFirstPagePrinted to bFirstPagePrinted
72682>>>>>            Get  DFNewPage of (phoWinPrint(Self)) Columns to PageNumber
72683>>>>>            If (PageNumber<>0) Begin // if 0, it failed
72685>>>>>                Set No_PageCheck_State to True
72686>>>>>                
72686>>>>>                //Top section
72686>>>>>                Send Page_Top
72687>>>>>                If not bFirstPagePrinted ;                    Send Report_Header
72690>>>>>                Send Page_Header
72691>>>>>                Send Page_Title
72692>>>>>                
72692>>>>>                Set New_Page_State to False
72693>>>>>                Set Page_End_State to False
72694>>>>>                Set No_PageCheck_State to False        // No longer Paging
72695>>>>>                Set pbFirstPagePrinted to True
72696>>>>>            End
72696>>>>>>
72696>>>>>        End
72696>>>>>>
72696>>>>>        
72696>>>>>        // Footer section
72696>>>>>        //
72696>>>>>        // DO NOT CHANGE THE ORDER OF BOTTOM SECTIONS !!!!!
72696>>>>>        //
72696>>>>>        
72696>>>>>        Send Page_Bottom
72697>>>>>        
72697>>>>>        // in WinPrint it is not possible to replace Page_Footer
72697>>>>>        // with Report_Footer. If you use Report_Footer you will
72697>>>>>        // have both Page_Footer and Report_Footer
72697>>>>>        //
72697>>>>>        //If LastTime eq 0 Send Page_Footer
72697>>>>>        //else             Send Report_Footer
72697>>>>>        
72697>>>>>        Send Page_Footer
72698>>>>>        Send Page_Total
72699>>>>>    End_Procedure
72700>>>>>    
72700>>>>>    Procedure Ending_Main_Report
72702>>>>>        Boolean bCancel bMultiReports
72702>>>>>        
72702>>>>>        Get Cancelled_state to bCancel
72703>>>>>        Get pbMultiReports to bMultiReports
72704>>>>>        
72704>>>>>        Forward Send Ending_Main_Report
72706>>>>>        
72706>>>>>        If bCancel Begin
72708>>>>>            Send DFEndDocument
72709>>>>>            Send DFClearDoc // this will also close the previewer
72710>>>>>        End
72710>>>>>>
72710>>>>>        Else Begin
72711>>>>>            Send Report_Footer
72712>>>>>            
72712>>>>>            // if multi-reports, we don't do an end of report yet. The programmer must
72712>>>>>            // manually end the report by sending EndMultiReport
72712>>>>>            If (not(bMultiReports)) Begin
72714>>>>>                Send EndWinPrintReport
72715>>>>>            End
72715>>>>>>
72715>>>>>            
72715>>>>>        End
72715>>>>>>
72715>>>>>        
72715>>>>>    End_Procedure
72716>>>>>    
72716>>>>>    // This must get called when you are running multiple reports (pbMultiReport).
72716>>>>>    // Send this when the last report is complete.
72716>>>>>    Procedure EndMultiReport
72718>>>>>        Send EndWinPrintReport
72719>>>>>    End_Procedure
72720>>>>>    
72720>>>>>    
72720>>>>>    Procedure EndWinPrintReport
72722>>>>>        Boolean bAutoOutput
72722>>>>>        Integer iStatus eMode
72722>>>>>        Get DocumentStatus to iStatus
72723>>>>>        If (iStatus<>dsStarted) ;            Procedure_Return
72726>>>>>        
72726>>>>>        // this tells winprint that the report is complete
72726>>>>>        Send DFEndDocument
72727>>>>>        // if auto-output we print or display automatically.
72727>>>>>        // for winprint2, if in preview mode you must do this so the previewer can enter
72727>>>>>        // a modal state (which it may or may not need to do).
72727>>>>>        Get AutoOutput_state to bAutoOutput
72728>>>>>        Get Output_device_mode to eMode
72729>>>>>        If (bAutoOutput or eMode=PRINT_TO_WINDOW) Begin
72731>>>>>            Send PrintReport
72732>>>>>            // if auto output, we assume that you are done when it is all over
72732>>>>>            // we only can do this with the modal viewer
72732>>>>>            If (bAutoOutput and pbModalViewer(Self)) Begin
72734>>>>>                Send DFClearDoc
72735>>>>>            End
72735>>>>>>
72735>>>>>        End
72735>>>>>>
72735>>>>>        
72735>>>>>    End_Procedure
72736>>>>>    
72736>>>>>    
72736>>>>>    Function Setup_Report Returns Integer
72738>>>>>        Integer iErr iStatus eMode
72738>>>>>        Boolean bActiveViewer bChildReport bMultiReports bOk
72738>>>>>        
72738>>>>>        Get Child_rpt_state to bChildReport
72739>>>>>        
72739>>>>>        If not bChildReport Begin
72741>>>>>            
72741>>>>>            // This makes sure that we are pointing to the new winprint2 engine object.
72741>>>>>            // normally this will be the new winprint, but it can be redirected
72741>>>>>            Get phoWinPrint to WinPrintID
72742>>>>>            
72742>>>>>            // winprint must have installed printer. If not installed, generate error and stop the report
72742>>>>>            Get ArePrintersInstalled to bOk
72743>>>>>            If not bOk Begin
72745>>>>>                Error DFERR_WINPRINT C_$NoInstalledPrinters
72746>>>>>>
72746>>>>>                Function_Return 1
72747>>>>>            End
72747>>>>>>
72747>>>>>            
72747>>>>>            // check if selected printer is valid. If not, generate error and stop the report
72747>>>>>            Get IsPrinterValid to bOk
72748>>>>>            If not bOk Begin
72750>>>>>                Error DFERR_WINPRINT DFPrintError936    // Could not select a valid printer
72751>>>>>>
72751>>>>>                Function_Return 1
72752>>>>>            End
72752>>>>>>
72752>>>>>            
72752>>>>>            // make sure it is ok to start a new report but try to be smart about it.
72752>>>>>            // if a report is active (dsstarted or dsFinished) check to see if it is
72752>>>>>            // finished w/ no viewer. If so, assume the user closed the report and is done
72752>>>>>            // so just clear the report. If a viewer is present, declare an error.
72752>>>>>            Get DocumentStatus to iStatus
72753>>>>>            Get pbMultiReports to bMultiReports
72754>>>>>            // multi-report only in-progress is multi and it is started
72754>>>>>            Move (bMultiReports and iStatus=dsStarted) to bMultiReports
72755>>>>>            If not bMultiReports Begin
72757>>>>>                If (iStatus<>dsNotStarted) Begin
72759>>>>>                    Get IsViewerActive to bActiveViewer
72760>>>>>                    If (iStatus=dsFinished and not(bActiveViewer)) Begin
72762>>>>>                        Send DfClearDoc
72763>>>>>                    End
72763>>>>>>
72763>>>>>                    Else Begin
72764>>>>>                        Error DFERR_WINPRINT DFPrintError967
72765>>>>>>
72765>>>>>                        Function_Return 1
72766>>>>>                    End
72766>>>>>>
72766>>>>>                End
72766>>>>>>
72766>>>>>                
72766>>>>>                // all new reports by default allow printing from viewer and they have the print job set up when you select print
72766>>>>>                // if you need to change these defaults, you can change these inside of Starting_main_report
72766>>>>>                // We only do this with non-multi-reports.
72766>>>>>                Send DFSetPrintDlgInPreview      True
72767>>>>>                Send DFSetEnablePrintFromPreview True
72768>>>>>                
72768>>>>>            End
72768>>>>>>
72768>>>>>            
72768>>>>>            // In the new winprint, this message is not needed and is a stub. For
72768>>>>>            // now it is in here for compatibility purposes
72768>>>>>            //You MUST always start a new report with this procedure
72768>>>>>            Send DFZeroCounters of (phoWinPrint(Self))
72769>>>>>            Send Clr_AllSubTotals
72770>>>>>            
72770>>>>>        End
72770>>>>>>
72770>>>>>        
72770>>>>>        Forward Get Setup_report to iErr
72772>>>>>        
72772>>>>>        If (iErr=0) Begin
72774>>>>>            If not bChildReport Begin
72776>>>>>                // if part of a multi-report we don't do a new doc
72776>>>>>                If not bMultiReports Begin
72778>>>>>                    Get Output_Device_Mode to eMode
72779>>>>>                    Send DFNewDoc of (phoWinPrint(Self))  (eMode = PRINT_TO_WINDOW) // pass True of display while printing
72780>>>>>                End
72780>>>>>>
72780>>>>>                // Do new page if not part of a multi-report and we say don't do a new page
72780>>>>>                If (not(bMultiReports) or AutoNew_Page_State(Self)) Begin
72782>>>>>                    Set pbFirstPagePrinted to False // tells new page that this is the first time for this report
72783>>>>>                    Send DFNew_page
72784>>>>>                End
72784>>>>>>
72784>>>>>            End
72784>>>>>>
72784>>>>>        End
72784>>>>>>
72784>>>>>        Function_Return iErr
72785>>>>>    End_Function
72786>>>>>    
72786>>>>>    
72786>>>>>    
72786>>>>>    // Cancel RO behavior - there is no device to close
72786>>>>>    //
72786>>>>>    Procedure Close_Output_Device
72788>>>>>    End_Procedure
72789>>>>>    
72789>>>>>    // Cancel RO Behavior
72789>>>>>    //
72789>>>>>    Procedure Initialize_Output_Device
72791>>>>>    End_Procedure
72792>>>>>    
72792>>>>>    
72792>>>>>    Function Output_Device_Mode Returns Integer
72794>>>>>        Integer hoId
72794>>>>>        String DevMode
72794>>>>>        Get Private.Output_Device_Mode to DevMode
72795>>>>>        If (DevMode=PRINT_TO_UNDEFINED) Begin
72797>>>>>            Get Report_View_Id to hoId
72798>>>>>            If hoID ;                Get OutPut_Device_Mode of hoID to DevMode
72801>>>>>            If (DevMode=PRINT_TO_UNDEFINED) ;                Move PRINT_TO_WINDOW to DevMode
72804>>>>>        End
72804>>>>>>
72804>>>>>        Function_Return DevMode
72805>>>>>    End_Function
72806>>>>>    
72806>>>>>    Procedure Set Output_Device_Mode Integer DevMode
72808>>>>>        Set Private.Output_Device_Mode to DevMode
72809>>>>>    End_Procedure
72810>>>>>    
72810>>>>>    // displays a metric ruler in .5 increments. This can be
72810>>>>>    // sent to make it easy to see how fields and labels should
72810>>>>>    // be moved for alignment.
72810>>>>>    //
72810>>>>>    Procedure ShowRuler
72812>>>>>        Integer i
72812>>>>>        Number n
72812>>>>>        For i from 0 to 30
72818>>>>>>
72818>>>>>            Send DFWritePos of (phoWinPrint(Self)) (String(i)) FONT_DEFAULT i -1 0
72819>>>>>            Move (i+.5) to n
72820>>>>>            Send DFWritePos of (phoWinPrint(Self)) "." FONT_DEFAULT n -1 0
72821>>>>>        Loop
72822>>>>>>
72822>>>>>        Send DFWriteLn of (phoWinPrint(Self)) ''  FONT_DEFAULT FONT_DEFAULT -1
72823>>>>>    End_Procedure
72824>>>>>    
72824>>>>>    // status panel related agumentations to handle the auto-previewer
72824>>>>>    
72824>>>>>    Procedure Update_Status String sVal
72826>>>>>        Integer eMode
72826>>>>>        Get Output_device_mode to eMode
72827>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72829>>>>>            Send SetProgressCaption  of (phoWinPrint(Self)) sVal
72830>>>>>        End
72830>>>>>>
72830>>>>>        Else Begin
72831>>>>>            Forward Send Update_Status sVal
72833>>>>>        End
72833>>>>>>
72833>>>>>    End_Procedure
72834>>>>>    
72834>>>>>    Procedure Start_Status
72836>>>>>        Integer eMode
72836>>>>>        String sTitle sCaption
72836>>>>>        Get Output_device_mode to eMode
72837>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72839>>>>>            Get Report_Caption to sCaption
72840>>>>>            Get Report_Title to sTitle
72841>>>>>            If (sTitle<>"" and sCaption<>"") Begin
72843>>>>>                Move ( sCaption- ":" * sTitle) to sTitle
72844>>>>>            End
72844>>>>>>
72844>>>>>            Else Begin
72845>>>>>                Move (sCaption - sTitle) to sTitle
72846>>>>>            End
72846>>>>>>
72846>>>>>            Send SetReportTitle of (phoWinPrint(Self)) sTitle
72847>>>>>        End
72847>>>>>>
72847>>>>>        Else Begin
72848>>>>>            Forward Send Start_status
72850>>>>>        End
72850>>>>>>
72850>>>>>    End_Procedure
72851>>>>>    
72851>>>>>    Procedure Resume_Status
72853>>>>>        Integer eMode
72853>>>>>        Get Output_device_mode to eMode
72854>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72856>>>>>            Send DfPreviewNoWait of (phoWinPrint(Self))
72857>>>>>        End
72857>>>>>>
72857>>>>>        Else Begin
72858>>>>>            Forward Send Resume_Status
72860>>>>>        End
72860>>>>>>
72860>>>>>    End_Procedure
72861>>>>>    
72861>>>>>    Procedure End_Status
72863>>>>>        Integer eMode
72863>>>>>        Get Output_device_mode to eMode
72864>>>>>        If (error_processing_state(Self)) Begin
72866>>>>>            Send DFClosePreview
72867>>>>>        End
72867>>>>>>
72867>>>>>        If (eMode=PRINT_TO_WINDOW) Begin
72869>>>>>        End
72869>>>>>>
72869>>>>>        Else Begin
72870>>>>>            Forward Send End_Status
72872>>>>>        End
72872>>>>>>
72872>>>>>    End_Procedure
72873>>>>>    
72873>>>>>    Function Report_Interrupt Returns Integer
72875>>>>>        Integer eStat
72875>>>>>        String sMess
72875>>>>>        Boolean bActiveViewer
72875>>>>>        Get IsViewerActive to bActiveViewer
72876>>>>>        If (Error_Check_State(Self)) Begin
72878>>>>>            Move C_$AnErrorWishToCancel to sMess
72879>>>>>        End
72879>>>>>>
72879>>>>>        Else Begin
72880>>>>>            Move  C_$CancelThisReport to sMess
72881>>>>>        End
72881>>>>>>
72881>>>>>        If bActiveViewer Begin
72883>>>>>            Get PreviewYesNoBox of (phoWinPrint(Self)) C_$ReportInterrupt sMess to eStat
72884>>>>>        End
72884>>>>>>
72884>>>>>        Else Begin
72885>>>>>            Move (YesNo_Box(sMess, C_$ReportInterrupt, MB_DEFBUTTON1)) to eStat
72886>>>>>        End
72886>>>>>>
72886>>>>>        
72886>>>>>        Function_Return (eStat=MBR_YES)
72887>>>>>        
72887>>>>>    End_Function
72888>>>>>    
72888>>>>>    Function Test_KeyPressed Returns Integer
72890>>>>>        Boolean bStop bError bActiveViewer
72890>>>>>        Integer eMode
72890>>>>>        // winreport will do this also, but this makes sure that this gets called
72890>>>>>        // for each body loop -- even if the body loop prints nothing
72890>>>>>        Send PumpMsgQueue of (phoWinPrint(Self)) // permit painting
72891>>>>>        Get IsViewerActive to bActiveViewer
72892>>>>>        Get Output_device_mode to eMode
72893>>>>>        If bActiveViewer Begin
72895>>>>>            Get ViewerWantsToClose of (phoWinPrint(Self)) to bStop
72896>>>>>            Get Error_Check_State to bError
72897>>>>>            If (bStop or bError) Begin
72899>>>>>                Get Report_Interrupt to bStop
72900>>>>>            End
72900>>>>>>
72900>>>>>        End
72900>>>>>>
72900>>>>>        Else Begin
72901>>>>>            Forward Get Test_KeyPressed to bStop
72903>>>>>            If (eMode=PRINT_TO_WINDOW and not(bStop)) Begin
72905>>>>>                Send DfPreviewNoWait
72906>>>>>            End
72906>>>>>>
72906>>>>>        End
72906>>>>>>
72906>>>>>        
72906>>>>>        Function_Return bStop
72907>>>>>    End_Function
72908>>>>>    
72908>>>>>    Procedure OnClosingView
72910>>>>>        Send DFClearDoc
72911>>>>>    End_Procedure
72912>>>>>    
72912>>>>>    
72912>>>>>    // Attempt to make this as intuitive as possible. You cannot invoke this when a
72912>>>>>    // report is active. If a report is not finished, you cannot do this.
72912>>>>>    // If a report is finsihed it may or may not have a viewer present.
72912>>>>>    // If a viewer is not present, we will clear the exising report (making the assumption
72912>>>>>    // that a modeless viewer was closed and the report will not be invoked again). If a viewer
72912>>>>>    // is active, we will pass this through to the winprint object which will show an error
72912>>>>>    
72912>>>>>    Function DFPrintSetupDialog Returns Boolean// invoke printer setup dialog
72914>>>>>        Integer iStatus
72914>>>>>        Boolean bActiveViewer bOk
72914>>>>>        // we must have printers installed for this to work
72914>>>>>        Get ArePrintersInstalled to bOk
72915>>>>>        If not bOk Begin
72917>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
72918>>>>>>
72918>>>>>        End
72918>>>>>>
72918>>>>>        Else Begin
72919>>>>>            Get DocumentStatus to iStatus
72920>>>>>            If (iStatus=dsFinished) Begin
72922>>>>>                Get IsViewerActive to bActiveViewer
72923>>>>>                If not bActiveViewer Begin
72925>>>>>                    Send DfClearDoc
72926>>>>>                End
72926>>>>>>
72926>>>>>            End
72926>>>>>>
72926>>>>>            // the winprint object will generate an error if the status is not dsNotStarted.
72926>>>>>            // we want those errors
72926>>>>>            Get DFPrintSetupDialog of (phoWinPrint(Self)) to bOk
72927>>>>>        End
72927>>>>>>
72927>>>>>        Function_Return bOk
72928>>>>>    End_Function
72929>>>>>    
72929>>>>>    // It is better to use DFPrintSetupDialog which tells you if the dialog was canceled
72929>>>>>    Procedure DFPrintSetup // invoke printer setup dialog
72931>>>>>        Boolean bOk
72931>>>>>        Get DFPrintSetupDialog to bOk
72932>>>>>    End_Procedure
72933>>>>>    
72933>>>>>    Procedure DFClearDoc // clear document, remove viewer
72935>>>>>        Send DFClearDoc of (phoWinPrint(Self))
72936>>>>>    End_Procedure
72937>>>>>    
72937>>>>>    Procedure DFEndDocument // tell winprint that the report is complete
72939>>>>>        Send DfEndDocument of (phoWinPrint(Self))
72940>>>>>    End_Procedure
72941>>>>>    
72941>>>>>    Procedure DFClosePreview //close the previewer, does not clear the document
72943>>>>>        Send DfClosePreview of (phoWinPrint(Self))
72944>>>>>    End_Procedure
72945>>>>>    
72945>>>>>    Procedure DFPrintDialog // popup print job dialog
72947>>>>>        Send DFPrintDialog of (phoWinPrint(Self))
72948>>>>>    End_Procedure
72949>>>>>    
72949>>>>>    Procedure DFPrint // print with printer dialog
72951>>>>>        Send DFPrint of (phoWinPrint(Self))
72952>>>>>    End_Procedure
72953>>>>>    
72953>>>>>    Procedure DFPrintDoc // print without printer dialog
72955>>>>>        Send DFPrintDoc of (phoWinPrint(Self))
72956>>>>>    End_Procedure
72957>>>>>    
72957>>>>>    Procedure DFPreviewWait // invoke previewer in modal mode
72959>>>>>        Send DFPreviewWait of (phoWinPrint(Self))
72960>>>>>    End_Procedure
72961>>>>>    
72961>>>>>    Procedure DFPreviewNoWait // invoke previwer in modeless mode
72963>>>>>        Send DFPreviewNoWait of (phoWinPrint(Self))
72964>>>>>    End_Procedure
72965>>>>>    
72965>>>>>    Procedure DFPreview // invokde previewer based on pbModalViewer property
72967>>>>>        Boolean bModalViewer
72967>>>>>        Get pbModalViewer to bModalViewer
72968>>>>>        If bModalViewer Begin
72970>>>>>            Send DFPreviewWait
72971>>>>>        End
72971>>>>>>
72971>>>>>        Else Begin
72972>>>>>            Send DFPreviewNoWait
72973>>>>>        End
72973>>>>>>
72973>>>>>    End_Procedure
72974>>>>>    
72974>>>>>    // Print report to appropriate device (printer, preview) based
72974>>>>>    // on output_device_mode
72974>>>>>    //
72974>>>>>    Procedure PrintReport
72976>>>>>        Integer eMode
72976>>>>>        Get OutPut_Device_Mode to eMode
72977>>>>>        If ((eMode=PRINT_TO_WINDOW) or (eMode=DEFERRED_PRINT_TO_WINDOW)) Begin
72979>>>>>            Send DFPreview
72980>>>>>        End
72980>>>>>>
72980>>>>>        Else If (eMode=PRINT_TO_PRINTER_NO_DIALOG) Begin
72983>>>>>            Send DFPrintDoc // print, no print job dialog
72984>>>>>        End
72984>>>>>>
72984>>>>>        Else Begin // (eMode=PRINT_TO_PRINTER)
72985>>>>>            Send DFPrint // print with print job dialog
72986>>>>>        End
72986>>>>>>
72986>>>>>    End_Procedure
72987>>>>>    
72987>>>>>    
72987>>>>>    Procedure DFSetPrinterPaper Integer ePaperType
72989>>>>>        Send DFSetPrinterPaper of (phoWinPrint(Self)) ePaperType
72990>>>>>    End_Procedure
72991>>>>>    
72991>>>>>    Function DFGetPrinterPaper Returns Integer //ePaperType
72993>>>>>        Integer ePaperType
72993>>>>>        Get DFGetPrinterPaper of (phoWinPrint(Self)) to ePaperType
72994>>>>>        Function_Return ePaperType
72995>>>>>    End_Function
72996>>>>>    
72996>>>>>    
72996>>>>>    Procedure DFSetPrinterBin Integer eBinType
72998>>>>>        Send DFSetPrinterBin of (phoWinPrint(Self)) eBinType
72999>>>>>    End_Procedure
73000>>>>>    
73000>>>>>    Function DFGetPrinterBin Returns Integer //eBinType
73002>>>>>        Integer eBinType
73002>>>>>        Get DFGetPrinterBin of (phoWinPrint(Self)) to eBinType
73003>>>>>        Function_Return eBinType
73004>>>>>    End_Function
73005>>>>>    
73005>>>>>    
73005>>>>>    Procedure DFSetPrinterResolution Integer eResType
73007>>>>>        Send DFSetPrinterResolution of (phoWinPrint(Self)) eResType
73008>>>>>    End_Procedure
73009>>>>>    
73009>>>>>    Function DFGetPrinterResolution Returns Integer //eResType
73011>>>>>        Boolean eResType
73011>>>>>        Get DFGetPrinterResolution of (phoWinPrint(Self)) to eResType
73012>>>>>        Function_Return eResType
73013>>>>>    End_Function
73014>>>>>    
73014>>>>>    
73014>>>>>    Procedure DFSetLandscape Boolean bIsLandscape
73016>>>>>        Send DFSetLandscape of (phoWinPrint(Self)) bIsLandscape
73017>>>>>    End_Procedure
73018>>>>>    
73018>>>>>    Function DFGetLandscape Returns Boolean // bIsLandscape
73020>>>>>        Boolean bIsLandscape
73020>>>>>        Get DFGetLandscape of (phoWinPrint(Self)) to bIsLandscape
73021>>>>>        Function_Return bIsLandscape
73022>>>>>    End_Function
73023>>>>>    
73023>>>>>    Procedure DFSetMetrics Integer eType
73025>>>>>        Send DFSetMetrics of (phoWinPrint(Self)) eType
73026>>>>>    End_Procedure
73027>>>>>    
73027>>>>>    Function DFGetMetrics Returns Integer
73029>>>>>        Integer eType
73029>>>>>        Get DFGetMetrics of (phoWinPrint(Self)) to eType
73030>>>>>        Function_Return eType
73031>>>>>    End_Function
73032>>>>>    
73032>>>>>    
73032>>>>>    Procedure DFSetPrintDlgInPreview Boolean bShowDialog
73034>>>>>        Set PrintDlgInPreview of (phoWinPrint(Self)) to bShowDialog
73035>>>>>    End_Procedure
73036>>>>>    
73036>>>>>    Function DFGetPrintDlgInPreview Returns Boolean
73038>>>>>        Boolean bShowDialog
73038>>>>>        Get PrintDlgInPreview of (phoWinPrint(Self)) to bShowDialog
73039>>>>>        Function_Return bShowDialog
73040>>>>>    End_Function
73041>>>>>    
73041>>>>>    
73041>>>>>    Procedure DFSetEnablePrintFromPreview Boolean bEnablePrint
73043>>>>>        Set EnablePrintFromPreview of (phoWinPrint(Self)) to bEnablePrint
73044>>>>>    End_Procedure
73045>>>>>    
73045>>>>>    Function DFGetEnablePrintFromPreview Returns Boolean
73047>>>>>        Boolean bEnablePrint
73047>>>>>        Get EnablePrintFromPreview of (phoWinPrint(Self)) to bEnablePrint
73048>>>>>        Function_Return bEnablePrint
73049>>>>>    End_Function
73050>>>>>    
73050>>>>>    
73050>>>>>    
73050>>>>>    Procedure DFSetMargins Number nLeft Number nTop Number nRight Number nBottom
73052>>>>>        Send DFSetMargins of (phoWinPrint(Self)) nLeft nTop nRight nBottom
73053>>>>>    End_Procedure
73054>>>>>    
73054>>>>>    Procedure DFSetTopBottom Number nTop Number nBottom Boolean bAllPages
73056>>>>>        Send DFSetTopBottom of (phoWinPrint(Self)) nTop nBottom bAllPages
73057>>>>>    End_Procedure
73058>>>>>    
73058>>>>>    
73058>>>>>    Procedure DFSetDevice String sPrinterName
73060>>>>>        Send DFSetDevice of (phoWinPrint(Self)) sPrinterName
73061>>>>>    End_Procedure
73062>>>>>    
73062>>>>>    Function DFGetCurrentDevice Returns String // sPrinterName
73064>>>>>        String sPrinterName
73064>>>>>        Get DFGetCurrentDevice of (phoWinPrint(Self)) to sPrinterName
73065>>>>>        Function_Return sPrinterName
73066>>>>>    End_Function
73067>>>>>    
73067>>>>>    
73067>>>>>    Procedure DFSetUserDefinedPapersize Number nLength Number nWidth
73069>>>>>        Send DFSetUserDefinedPapersize of (phoWinPrint(Self)) nLength nWidth
73070>>>>>    End_Procedure
73071>>>>>    
73071>>>>>    Function DFGetUserDefinedLength Returns Number
73073>>>>>        Number nSize
73073>>>>>        Get DFGetUserDefinedLength of (phoWinPrint(Self)) to nSize
73074>>>>>        Function_Return nSize
73075>>>>>    End_Function
73076>>>>>    
73076>>>>>    Function DFGetUserDefinedWidth Returns Number
73078>>>>>        Number nSize
73078>>>>>        Get DFGetUserDefinedWidth of (phoWinPrint(Self)) to nSize
73079>>>>>        Function_Return nSize
73080>>>>>    End_Function
73081>>>>>    
73081>>>>>    
73081>>>>>    Procedure DFSetNumberOfCopies Integer iCopies
73083>>>>>        Send DFSetNumberOfCopies of (phoWinPrint(Self)) iCopies
73084>>>>>    End_Procedure
73085>>>>>    
73085>>>>>    Procedure DFPrinterBinFirstPage Integer eBinType
73087>>>>>        Send DFPrinterBinFirstPage of (phoWinPrint(Self)) eBinType
73088>>>>>    End_Procedure
73089>>>>>    
73089>>>>>    Procedure DFClearPrinter
73091>>>>>        Send DFClearPrinter of (phoWinPrint(Self))
73092>>>>>    End_Procedure
73093>>>>>    
73093>>>>>    Function DFGetDFColor Integer iRed Integer iGreen Integer iBlue Returns Integer
73095>>>>>        Integer iWPColor
73095>>>>>        Get DFGetDFColor of (phoWinPrint(Self)) iRed iGreen iBlue to iWPColor
73096>>>>>        Function_Return iWPColor
73097>>>>>    End_Function
73098>>>>>    
73098>>>>>    Function RGBToWPColor Integer iRgb Returns Integer
73100>>>>>        Integer iWPColor
73100>>>>>        Get RGBToWPColor of (phoWinPrint(Self)) iRGB to iWPColor
73101>>>>>        Function_Return iWPColor
73102>>>>>    End_Function
73103>>>>>    
73103>>>>>    
73103>>>>>End_Class
73104>>>Use Windows.pkg
73104>>>
73104>>>Use cEmployeeDataDictionary.dd
73104>>>Use cLineDataDictionary.dd
73104>>>Use cPageHeaderDataDictionary.dd
73104>>>Use cShoeDataDictionary.dd
73104>>>Use cPageFooterDataDictionary.dd
73104>>>Use MonthCalendarPrompt.dg
73104>>>
73104>>>ACTIVATE_VIEW Activate_oReportView FOR oReportView
73114>>>>
73114>>>Object oReportView is a ReportView
73116>>>    Set Location to 20 59
73117>>>    Set Size to 180 202
73118>>>    Set Label To "ReportView"
73119>>>
73119>>>
73119>>>    Object oEmployee_DD is a cEmployeeDataDictionary
73121>>>    End_Object 
73122>>>
73122>>>    Object oLine_DD is a cLineDataDictionary
73124>>>    End_Object 
73125>>>
73125>>>    Object oPageHeader_DD is a cPageHeaderDataDictionary
73127>>>        Set DDO_Server To oEmployee_DD
73128>>>        Set DDO_Server To oLine_DD
73129>>>        Property Date pdStartdate
73131>>>        Property Date pdStopdate
73133>>>
73133>>>        Procedure OnConstrain 
73136>>>            Date dStart dStop
73136>>>
73136>>>            Get pdStartdate To dStart
73137>>>            Get pdStopdate To dStop
73138>>>
73138>>>            Case Begin
73138>>>                Case (dStart <> 0 and dStop <> 0)
73140>>>                    Constrain PageHeader.date between dStart and dStop
73144>>>                    Case Break
73145>>>                Case (dStart <> 0)
73148>>>                    Constrain PageHeader.date GE dStart
73150>>>                    Case Break
73151>>>                Case (dStop <> 0)
73154>>>                    Constrain PageHeader.date LE dStop
73156>>>            Case End
73156>>>        End_Procedure 
73157>>>    End_Object 
73158>>>
73158>>>    Object oShoe_DD is a cShoeDataDictionary
73160>>>        Property Number pnStartprice
73162>>>        Property Number pnStopprice
73164>>>
73164>>>        Procedure OnConstrain 
73167>>>            Number nStart nStop
73167>>>
73167>>>            Get pnStartprice To nStart
73168>>>            Get pnStopprice To nStop
73169>>>
73169>>>            Case Begin
73169>>>                Case (nStart <> 0 and nStop <> 0)
73171>>>                    Constrain Shoe.price between nStart and nStop
73175>>>                    Case Break
73176>>>                Case (nStart <> 0)
73179>>>                    Constrain Shoe.price GE nStart
73181>>>                    Case Break
73182>>>                Case (nStop <> 0)
73185>>>                    Constrain Shoe.price LE nStop
73187>>>            Case End
73187>>>        End_Procedure 
73188>>>    End_Object 
73189>>>
73189>>>    Object oPageFooter_DD is a cPageFooterDataDictionary
73191>>>        Set DDO_Server To oPageHeader_DD
73192>>>        Set DDO_Server To oShoe_DD
73193>>>        Property Number pnStartquantity
73195>>>        Property Number pnStopquantity
73197>>>
73197>>>        Procedure OnConstrain 
73200>>>            Number nStart nStop
73200>>>
73200>>>            Get pnStartquantity To nStart
73201>>>            Get pnStopquantity To nStop
73202>>>
73202>>>            Case Begin
73202>>>                Case (nStart <> 0 and nStop <> 0)
73204>>>                    Constrain PageFooter.quantity between nStart and nStop
73208>>>                    Case Break
73209>>>                Case (nStart <> 0)
73212>>>                    Constrain PageFooter.quantity GE nStart
73214>>>                    Case Break
73215>>>                Case (nStop <> 0)
73218>>>                    Constrain PageFooter.quantity LE nStop
73220>>>            Case End
73220>>>        End_Procedure 
73221>>>    End_Object 
73222>>>
73222>>>    Set Main_DD To oPageFooter_DD
73223>>>
73223>>>
73223>>>
73223>>>    Object odateSelection is a Group
73225>>>        Set Size to 35 179
73226>>>        Set Location to 5 12
73227>>>        Set Label to "Select date"
73228>>>
73228>>>        Object oSelStart is a Form
73230>>>            Set Label to "From:"
73231>>>            Set Size to 12 60
73232>>>            Set Location to 13 30
73233>>>            Set Status_Help to "First value in selection range."
73234>>>            Set Label_Col_Offset to 2
73235>>>            Set Label_Justification_Mode to jMode_Right
73236>>>            Set Form_datatype to mask_date_window
73237>>>            Set Prompt_Object to oMonthCalendarPrompt
73238>>>            Set Prompt_Button_Mode to PB_PromptOn
73239>>>            Procedure OnExitObject
73242>>>                Date dDateSelected
73242>>>                
73242>>>                Get File_Field_Current_Value of oPageHeader_DD File_Field PageHeader.Date to dDateSelected
73243>>>                
73243>>>                If (dDateSelected < "1/1/2020" or dDateSelected > "12/31/2022" ) Begin
73245>>>                    Send Info_Box "Date must be between 1/1/2020 and 12/31/2022"
73246>>>                End
73246>>>>
73246>>>            
73246>>>            End_Procedure
73247>>>        End_Object 
73248>>>
73248>>>        Object oSelStop is a Form
73250>>>            Set Label to "To:"
73251>>>            Set Size to 12 60
73252>>>            Set Location to 13 111
73253>>>            Set Status_Help to "Last value in selection range."
73254>>>            Set Label_Col_Offset to 2
73255>>>            Set Label_Justification_Mode to jMode_Right
73256>>>            Set Form_datatype to mask_date_window
73257>>>            Set Prompt_Object to oMonthCalendarPrompt
73258>>>            Set Prompt_Button_Mode to PB_PromptOn
73259>>>            Procedure OnExitObject
73262>>>                Date dDateSelected
73262>>>                
73262>>>                Get File_Field_Current_Value of oPageHeader_DD File_Field PageHeader.Date to dDateSelected
73263>>>                
73263>>>                If (dDateSelected < "1/1/2020" or dDateSelected > "12/31/2022" ) Begin
73265>>>                    Send Info_Box "Date must be between 1/1/2020 and 12/31/2022"
73266>>>                End
73266>>>>
73266>>>            
73266>>>            End_Procedure
73267>>>        End_Object 
73268>>>
73268>>>
73268>>>        Function StartValue returns String
73271>>>            string sValue
73271>>>            Get Value of oSelStart to sValue
73272>>>            Function_return sValue
73273>>>        End_Function 
73274>>>
73274>>>        Function StopValue returns String
73277>>>            string sValue
73277>>>            Get Value of oSelStop to sValue
73278>>>            Function_return sValue
73279>>>        End_Function 
73280>>>
73280>>>    End_Object 
73281>>>    Object oquantitySelection is a Group
73283>>>        Set Size to 35 179
73284>>>        Set Location to 45 12
73285>>>        Set Label to "Select quantity"
73286>>>
73286>>>        Object oSelStart is a Form
73288>>>            Set Label to "From:"
73289>>>            Set Size to 12 60
73290>>>            Set Location to 13 30
73291>>>            Set Status_Help to "First value in selection range."
73292>>>            Set Label_Col_Offset to 2
73293>>>            Set Label_Justification_Mode to jMode_Right
73294>>>            Set Form_datatype to 0
73295>>>        End_Object 
73296>>>
73296>>>        Object oSelStop is a Form
73298>>>            Set Label to "To:"
73299>>>            Set Size to 12 60
73300>>>            Set Location to 13 111
73301>>>            Set Status_Help to "Last value in selection range."
73302>>>            Set Label_Col_Offset to 2
73303>>>            Set Label_Justification_Mode to jMode_Right
73304>>>            Set Form_datatype to 0
73305>>>        End_Object 
73306>>>
73306>>>
73306>>>        Function StartValue returns String
73309>>>            string sValue
73309>>>            Get Value of oSelStart to sValue
73310>>>            Function_return sValue
73311>>>        End_Function 
73312>>>
73312>>>        Function StopValue returns String
73315>>>            string sValue
73315>>>            Get Value of oSelStop to sValue
73316>>>            Function_return sValue
73317>>>        End_Function 
73318>>>
73318>>>    End_Object 
73319>>>    Object opriceSelection is a Group
73321>>>        Set Size to 35 179
73322>>>        Set Location to 85 12
73323>>>        Set Label to "Select price"
73324>>>
73324>>>        Object oSelStart is a Form
73326>>>            Set Label to "From:"
73327>>>            Set Size to 12 60
73328>>>            Set Location to 13 30
73329>>>            Set Status_Help to "First value in selection range."
73330>>>            Set Label_Col_Offset to 2
73331>>>            Set Label_Justification_Mode to jMode_Right
73332>>>            Set Form_datatype to 2
73333>>>        End_Object 
73334>>>
73334>>>        Object oSelStop is a Form
73336>>>            Set Label to "To:"
73337>>>            Set Size to 12 60
73338>>>            Set Location to 13 111
73339>>>            Set Status_Help to "Last value in selection range."
73340>>>            Set Label_Col_Offset to 2
73341>>>            Set Label_Justification_Mode to jMode_Right
73342>>>            Set Form_datatype to 2
73343>>>        End_Object 
73344>>>
73344>>>
73344>>>        Function StartValue returns String
73347>>>            string sValue
73347>>>            Get Value of oSelStart to sValue
73348>>>            Function_return sValue
73349>>>        End_Function 
73350>>>
73350>>>        Function StopValue returns String
73353>>>            string sValue
73353>>>            Get Value of oSelStop to sValue
73354>>>            Function_return sValue
73355>>>        End_Function 
73356>>>
73356>>>    End_Object 
73357>>>
73357>>>    Object oPrintTo is a RadioGroup
73359>>>        Set Size to 38 118
73360>>>        Set Location to 130 12
73361>>>        Set Label to "Send Report to"
73362>>>
73362>>>        Object oRadio1 is a Radio
73364>>>            Set Label to "Report Viewer"
73365>>>            Set Size to 10 61
73366>>>            Set Location to 12 6
73367>>>            Set Status_Help to "Prints the report to screen"
73368>>>        End_Object 
73369>>>
73369>>>        Object oRadio2 is a Radio
73371>>>            Set Label to "Printer"
73372>>>            Set Size to 10 42
73373>>>            Set Location to 24 6
73374>>>            Set Status_Help to "Prints the report to printer"
73375>>>        End_Object 
73376>>>
73376>>>
73376>>>        Function IsToPrinter Returns boolean
73379>>>            integer iRadio
73379>>>            Get Current_radio to iRadio
73380>>>            Function_return (iRadio=1)
73381>>>        End_Function 
73382>>>
73382>>>    End_Object 
73383>>>
73383>>>    Object oBtnPrint is a Button
73385>>>        Set Label to "Print"
73386>>>        Set Location to 125 140
73387>>>        Set Status_Help to "Print the Selected report"
73388>>>        Set Default_State to TRUE
73389>>>        Procedure OnClick
73392>>>            Send StartReport
73393>>>        End_Procedure
73394>>>    End_Object 
73395>>>
73395>>>    Object oBtnPrinterSetup is a Button
73397>>>        Set Label to "Printer Setup"
73398>>>        Set Location to 142 140
73399>>>        Set Status_Help to "Set up printer for report"
73400>>>        Procedure OnClick
73403>>>            Send DFPrintSetup of oReport
73404>>>        End_Procedure
73405>>>    End_Object 
73406>>>
73406>>>    Object oBtnCancel is a Button
73408>>>        Set Label to "Cancel"
73409>>>        Set Location to 159 140
73410>>>        Set Status_Help to "Close this Panel"
73411>>>        Procedure OnClick
73414>>>            Send Close_Panel
73415>>>        End_Procedure
73416>>>    End_Object 
73417>>>
73417>>>
73417>>>
73417>>>    Object oReport is a cWinReport2
73419>>>
73419>>>        Set Report_Title to "ReportView"
73420>>>
73420>>>        // Set DDO, Index and breaks for the report
73420>>>        Set Server to oPageFooter_DD
73421>>>        Set Ordering to 6
73422>>>        Report_Breaks PageFooter.page_header_id PageFooter.shoe_id
73437>>>
73437>>>        Function Starting_Main_Report Returns Integer
73440>>>            Boolean bErr
73440>>>            Send DFSetMetrics wpm_cm
73441>>>            Send DFSetmargins 1 1 1 1
73442>>>            //Send DFSetLandscape false // This can be used to force a page orientation
73442>>>            Forward Get Starting_Main_Report to bErr
73444>>>            Function_return bErr
73445>>>        End_Function 
73446>>>
73446>>>        // Page_Top is printed first at the top margin of each page
73446>>>        Procedure Page_Top 
73449>>>            string  sFont
73449>>>            integer iFontSize
73449>>>
73449>>>            Move "arial" to sFont
73450>>>            Move 10 to iFontSize
73451>>>
73451>>>            DFFont sFont
73452>>>            DFFontSize iFontSize
73453>>>            DFBeginHeader DFPageTop
73454>>>                DFHeaderFrame Hdr_NoFrame
73455>>>                DFHeaderPos   Hdr_Left
73456>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
73457>>>            DFEndHeader
73459>>>
73459>>>        End_Procedure 
73460>>>
73460>>>        // Report_Header is printed once in a report after Page_Top
73460>>>        //Procedure Report_Header
73460>>>        //    string  sFont
73460>>>        //    integer iFontSize
73460>>>        //    Move "arial" to sFont
73460>>>        //    Move 10 to iFontSize
73460>>>        //    DFFont sFont
73460>>>        //    DFFontSize iFontSize
73460>>>        //    DFBeginHeader  DFReportHeader
73460>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73460>>>        //        DFHeaderPos    Hdr_Left
73460>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73460>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
73460>>>        //    DFEndHeader
73460>>>        //End_Procedure
73460>>>
73460>>>        Procedure Page_Header 
73463>>>            integer iFill iBorder iStyle
73463>>>            string  sFont sReportTitle
73463>>>            integer iFontSize
73463>>>
73463>>>            Move "arial" to sFont
73464>>>            Move 16 to iFontSize
73465>>>            Move (Font_bold + rgb_White) to iStyle
73466>>>            Move (rgb_dGrey) to iFill
73467>>>            Move (rgb_dGrey) to iBorder
73468>>>            Get Report_Title to sReportTitle
73469>>>
73469>>>            DFFont sFont
73470>>>            DFFontSize iFontSize
73471>>>            DFBeginHeader DFPageHeader
73472>>>                DFHeaderPos   Hdr_Left
73473>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
73474>>>                DFWritelnPos sReportTitle 0.1 iStyle
73475>>>                DFHeaderMargin HM_BottomOuter 0.08
73476>>>            DFEndHeader
73478>>>
73478>>>        End_Procedure 
73479>>>
73479>>>        // Page_Title appears on every page after Page_Header
73479>>>        //Procedure Page_Title
73479>>>        //    string  sFont
73479>>>        //    integer iFontSize
73479>>>        //    Move "arial" to sFont
73479>>>        //    Move 10 to iFontSize
73479>>>        //    DFFont sFont
73479>>>        //    DFFontSize iFontSize
73479>>>        //    DFBeginHeader  DFPageTitle
73479>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73479>>>        //        DFHeaderPos    Hdr_Left
73479>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73479>>>        //        DFWrite     "Page_Title" (Font_Bold+Font_Center)
73479>>>        //    DFEndHeader
73479>>>        //End_Procedure
73479>>>
73479>>>        Procedure SubHeader1 
73482>>>            string  sFont 
73482>>>            integer iFontSize iStyle
73482>>>            integer iFill iBorder iHeaderStyle
73482>>>
73482>>>            Move "arial" to sFont
73483>>>            Move 10 to iFontSize
73484>>>            Move (Font_Bold + rgb_dBlue) to iStyle
73485>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
73486>>>            Move (rgb_dGrey) to iBorder
73487>>>            Get DFGetDFColor 242 242 242 to iFill
73488>>>
73488>>>            DFFont sFont
73489>>>            DFFontSize iFontSize
73490>>>            DFBeginHeader DFSubHeader 1
73491>>>                DFHeaderLineCheck 5
73492>>>                DFHeaderWrap   HDR_Wrap
73493>>>                DFHeaderPos    HDR_Left
73494>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
73495>>>                DFHeaderMargin hm_BottomOuter 0.08
73496>>>                DFHeaderMargin hm_TopInner    0.04
73497>>>                DFHeaderMargin hm_BottomInner 0.04
73498>>>
73498>>>                // display fields to be placed in this sub-header
73498>>>                DFWritePos "id:"                         0.1 iHeaderStyle -1 4.9
73499>>>                DFWritePos PageHeader.id                  5 (iStyle + Font_Right) 0
73500>>>                DFWriteLn
73501>>>                DFWritePos "employee id:"                0.1 iHeaderStyle -1 4.9
73502>>>                DFWritePos PageHeader.employee_id         5 (iStyle + Font_Right) 0
73503>>>                DFWriteLn
73504>>>                DFWritePos "line id:"                    0.1 iHeaderStyle -1 4.9
73505>>>                DFWritePos PageHeader.line_id             5 (iStyle + Font_Right) 0
73506>>>                DFWriteLn
73507>>>                DFWritePos "date:"                       0.1 iHeaderStyle -1 4.9
73508>>>                DFWritePos PageHeader.date                5 iStyle -1
73509>>>                DFWriteLn
73510>>>                DFWritePos "hours:"                      0.1 iHeaderStyle -1 4.9
73511>>>                DFWritePos PageHeader.hours               5 (iStyle + Font_Right) 0
73512>>>                DFWriteLn
73513>>>                DFWritePos "name:"                       0.1 iHeaderStyle -1 4.9
73514>>>                DFWritePos Employee.name                  5 iStyle -1
73515>>>                DFWriteLn
73516>>>
73516>>>            DFEndHeader
73518>>>
73518>>>        End_Procedure 
73519>>>
73519>>>        Procedure SubHeader2 
73522>>>            string  sFont 
73522>>>            integer iFontSize iStyle
73522>>>            integer iFill iBorder iHeaderStyle
73522>>>
73522>>>            Move "arial" to sFont
73523>>>            Move 10 to iFontSize
73524>>>            Move (Font_Bold + rgb_dBlue) to iStyle
73525>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
73526>>>            Move (rgb_dGrey) to iBorder
73527>>>            Get DFGetDFColor 242 242 242 to iFill
73528>>>
73528>>>            DFFont sFont
73529>>>            DFFontSize iFontSize
73530>>>            DFBeginHeader DFSubHeader 2
73531>>>                DFHeaderLineCheck 5
73532>>>                DFHeaderWrap   HDR_Wrap
73533>>>                DFHeaderPos    HDR_Left
73534>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
73535>>>                DFHeaderMargin hm_BottomOuter 0.08
73536>>>                DFHeaderMargin hm_TopInner    0.04
73537>>>                DFHeaderMargin hm_BottomInner 0.04
73538>>>
73538>>>                // display fields to be placed in this sub-header
73538>>>                DFWritePos "id:"                         0.1 iHeaderStyle -1 4.9
73539>>>                DFWritePos Shoe.id                        5 (iStyle + Font_Right) 0
73540>>>                DFWriteLn
73541>>>                DFWritePos "name:"                       0.1 iHeaderStyle -1 4.9
73542>>>                DFWritePos Shoe.name                      5 iStyle -1
73543>>>                DFWriteLn
73544>>>
73544>>>                // write the heading for the body section
73544>>>                DFFontSize 1 // create a very small space on top and below the horizontal bar
73545>>>                DFWriteLn
73546>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
73547>>>                DFWriteLn
73548>>>                DFFontSize iFontSize
73549>>>                DFWritePos "id"                           (0.08 + 0.85) (iHeaderStyle + Font_Right) -1 0.85
73550>>>                DFWritePos "page header id"               (1.01 + 3.58) (iHeaderStyle + Font_Right) -1 3.58
73551>>>                DFWritePos "shoe id"                      (4.67 + 1.79) (iHeaderStyle + Font_Right) -1 1.79
73552>>>                DFWritePos "quantity"                     (6.54 + 2.04) (iHeaderStyle + Font_Right) -1 2.04
73553>>>                DFWritePos "price"                        (8.66 + 2.34) (iHeaderStyle + Font_Right) -1 2.34
73554>>>                DFWriteLn
73555>>>
73555>>>            DFEndHeader
73557>>>
73557>>>        End_Procedure 
73558>>>
73558>>>        Procedure Body 
73561>>>            string  sFont 
73561>>>            integer iFontSize iStyle
73561>>>
73561>>>            Move "arial" to sFont
73562>>>            Move 10 to iFontSize
73563>>>            Move (font_default) to iStyle
73564>>>
73564>>>            DFFont sFont
73565>>>            DFFontSize iFontSize
73566>>>
73566>>>            DFWritePos PageFooter.id                  (0.08 + 0.85) (iStyle + Font_Right) 0 0.85
73567>>>            DFWritePos PageFooter.page_header_id      (1.01 + 3.58) (iStyle + Font_Right) 0 3.58
73568>>>            DFWritePos PageFooter.shoe_id             (4.67 + 1.79) (iStyle + Font_Right) 0 1.79
73569>>>            DFWritePos PageFooter.quantity            (6.54 + 2.04) (iStyle + Font_Right) 0 2.04
73570>>>            DFWritePos Shoe.price                     (8.66 + 2.34) (iStyle + Font_Right) 2 2.34
73571>>>            DFWriteLn
73572>>>
73572>>>        End_Procedure 
73573>>>
73573>>>        // Sub-totals appear at each break
73573>>>        //Procedure SubTotal2
73573>>>        //    string  sFont
73573>>>        //    integer iFontSize
73573>>>        //    Move "arial" to sFont
73573>>>        //    Move 10 to iFontSize
73573>>>        //    DFFont sFont
73573>>>        //    DFFontSize iFontSize
73573>>>        //    DFBeginHeader DFSubTotal
73573>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73573>>>        //        DFHeaderPos    Hdr_Left
73573>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73573>>>        //        DFWrite     "SubTotal2" (Font_Bold+Font_Center)
73573>>>        //    DFEndHeader
73573>>>        //End_Procedure
73573>>>
73573>>>        // Sub-totals appear at each break
73573>>>        //Procedure SubTotal1
73573>>>        //    string  sFont
73573>>>        //    integer iFontSize
73573>>>        //    Move "arial" to sFont
73573>>>        //    Move 10 to iFontSize
73573>>>        //    DFFont sFont
73573>>>        //    DFFontSize iFontSize
73573>>>        //    DFBeginHeader DFSubTotal
73573>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73573>>>        //        DFHeaderPos    Hdr_Left
73573>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73573>>>        //        DFWrite     "SubTotal1" (Font_Bold+Font_Center)
73573>>>        //    DFEndHeader
73573>>>        //End_Procedure
73573>>>
73573>>>        // Totals appear at the end of the report before Report_Footer
73573>>>        //Procedure Total
73573>>>        //    string  sFont
73573>>>        //    integer iFontSize
73573>>>        //    Move "arial" to sFont
73573>>>        //    Move 10 to iFontSize
73573>>>        //    DFFont sFont
73573>>>        //    DFFontSize iFontSize
73573>>>        //    DFBeginHeader  DFTotal
73573>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73573>>>        //        DFHeaderPos    Hdr_Left
73573>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73573>>>        //        DFWrite     "Total" (Font_Bold+Font_Center)
73573>>>        //    DFEndHeader
73573>>>        //End_Procedure
73573>>>
73573>>>        // Report_Footer is printed once on the last page before Page_Footer
73573>>>        //Procedure Report_Footer
73573>>>        //    string  sFont
73573>>>        //    integer iFontSize
73573>>>        //    Move "arial" to sFont
73573>>>        //    Move 10 to iFontSize
73573>>>        //    DFFont sFont
73573>>>        //    DFFontSize iFontSize
73573>>>        //    DFBeginHeader DFReportFooter
73573>>>        //        DFHeaderFrame  Hdr_Margins 0.01
73573>>>        //        DFHeaderPos    Hdr_Left
73573>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
73573>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
73573>>>        //    DFEndHeader
73573>>>        //End_Procedure
73573>>>
73573>>>        Procedure Page_Footer 
73576>>>            string sStart sStop sText
73576>>>            string  sFont 
73576>>>            integer iFontSize iStyle
73576>>>
73576>>>            Move "arial" to sFont
73577>>>            Move 10 to iFontSize
73578>>>            Move (font_default) to iStyle
73579>>>
73579>>>            DFFont sFont
73580>>>            DFFontSize iFontSize
73581>>>            DFBeginHeader DFPageFooter
73582>>>                DFHeaderFrame hdr_NoFrame
73583>>>                DFHeaderPos   hdr_Left
73584>>>
73584>>>                Get pdStartdate of oPageHeader_DD to sStart
73585>>>                Get pdStopdate  of oPageHeader_DD to sStop
73586>>>                Get SelectionCriteraDescription "PageHeader.date" sStart sStop to sText
73587>>>                If (sText<>"") begin
73589>>>                    DFWriteLnPos sText 0.1
73590>>>                end
73590>>>>
73590>>>
73590>>>                Get pnStartquantity of oPageFooter_DD to sStart
73591>>>                Get pnStopquantity  of oPageFooter_DD to sStop
73592>>>                Get SelectionCriteraDescription "PageFooter.quantity" sStart sStop to sText
73593>>>                If (sText<>"") begin
73595>>>                    DFWriteLnPos sText 0.1
73596>>>                end
73596>>>>
73596>>>
73596>>>                Get pnStartprice of oShoe_DD to sStart
73597>>>                Get pnStopprice  of oShoe_DD to sStop
73598>>>                Get SelectionCriteraDescription "Shoe.price" sStart sStop to sText
73599>>>                If (sText<>"") begin
73601>>>                    DFWriteLnPos sText 0.1
73602>>>                end
73602>>>>
73602>>>
73602>>>            DFEndHeader
73604>>>        End_Procedure 
73605>>>
73605>>>        // Page_Bottom is printed last at the bottom margin of each page
73605>>>        Procedure Page_Bottom 
73608>>>            string sFont
73608>>>            integer iFontSize iBorder iStyle
73608>>>            DateTime dtDT
73608>>>
73608>>>            Move (CurrentDateTime()) to dtDT
73609>>>
73609>>>            Move "arial" to sFont
73610>>>            Move 10 to iFontSize
73611>>>            Move (font_default) to iStyle
73612>>>            Move (rgb_dGrey) to iBorder
73613>>>
73613>>>            DFFont sFont
73614>>>            DFFontSize iFontSize
73615>>>            DFBeginHeader DFPageBottom
73616>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
73617>>>                DFHeaderPos Hdr_Left
73618>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
73619>>>            DFEndHeader
73621>>>
73621>>>        End_Procedure 
73622>>>
73622>>>        // Returns string with description of selection ranges
73622>>>        // Pass: Selection title, start value and end value. Return: description
73622>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
73625>>>            string sText
73625>>>            If (sStart=""  AND sStop="") ;                function_return ""
73628>>>            If (sStart="0" AND sStop="0") ;                function_return ""
73631>>>            If (sStart<>"" AND sStop<>"") begin
73633>>>                Move ("between" * sStart * "and" * sStop) to sText
73634>>>            end
73634>>>>
73634>>>            Else if (sStart > "") begin
73637>>>                Move ("starting at" * sStart) to sText
73638>>>            end
73638>>>>
73638>>>            Else if (sStop > "") begin
73641>>>                Move ("up to" * sStop) to sText
73642>>>            End
73642>>>>
73642>>>            function_return (sTitle * sText)
73643>>>        End_Function
73644>>>
73644>>>    End_Object 
73645>>>
73645>>>    Procedure StartReport 
73648>>>        Boolean bToPrinter
73648>>>        String sValue
73648>>>        Number nStart nStop
73648>>>        Date dStart dStop
73648>>>
73648>>>        // Set all selection critera properties
73648>>>        Get StartValue of odateSelection to sValue
73649>>>        Set pdStartdate of oPageHeader_DD To sValue
73650>>>
73650>>>        Get StopValue of odateSelection to sValue
73651>>>        Set pdStopdate of oPageHeader_DD To sValue
73652>>>
73652>>>        Get StartValue of oquantitySelection to sValue
73653>>>        Set pnStartquantity of oPageFooter_DD To sValue
73654>>>
73654>>>        Get StopValue of oquantitySelection to sValue
73655>>>        Set pnStopquantity of oPageFooter_DD To sValue
73656>>>
73656>>>        Get StartValue of opriceSelection to sValue
73657>>>        Set pnStartprice of oShoe_DD To sValue
73658>>>
73658>>>        Get StopValue of opriceSelection to sValue
73659>>>        Set pnStopprice of oShoe_DD To sValue
73660>>>
73660>>>
73660>>>        // determine if direct print
73660>>>        Get IsToPrinter of oPrintTo to bToPrinter
73661>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
73662>>>
73662>>>        // run the report
73662>>>        Send Run_Report of oReport
73663>>>
73663>>>    End_Procedure 
73664>>>
73664>>>End_Object 
73665>
73665>        Procedure Activate_About
73668>            Send DoAbout "" "" "" "" ""
73669>        End_Procedure
73670>
73670>    End_Object
73671>
73671>End_Object
73672>
73672>Start_UI
73673>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 42599
Total Resources: 0
Total Commands : 73672
Total Windows  : 0
Total Pages    : 0
Static Data    : 429237
Message area   : 531060
Total Blocks   : 26627
